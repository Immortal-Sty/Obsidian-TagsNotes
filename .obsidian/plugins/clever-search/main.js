/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var $c=Object.create;var Gn=Object.defineProperty;var Za=Object.getOwnPropertyDescriptor;var Uc=Object.getOwnPropertyNames;var Wc=Object.getPrototypeOf,qc=Object.prototype.hasOwnProperty;var Hc=(n,e)=>()=>(n&&(e=n(n=0)),e);var te=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),el=(n,e)=>{for(var t in e)Gn(n,t,{get:e[t],enumerable:!0})},tl=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Uc(e))!qc.call(n,i)&&i!==t&&Gn(n,i,{get:()=>e[i],enumerable:!(r=Za(e,i))||r.enumerable});return n};var ae=(n,e,t)=>(t=n!=null?$c(Wc(n)):{},tl(e||!n||!n.__esModule?Gn(t,"default",{value:n,enumerable:!0}):t,n)),Gr=n=>tl(Gn({},"__esModule",{value:!0}),n),N=(n,e,t,r)=>{for(var i=r>1?void 0:r?Za(e,t):e,s=n.length-1,o;s>=0;s--)(o=n[s])&&(i=(r?o(e,t,i):o(i))||i);return r&&i&&Gn(e,t,i),i},Xr=(n,e)=>(t,r)=>e(t,r,n);var Yr={};el(Yr,{__assign:()=>ws,__asyncDelegator:()=>af,__asyncGenerator:()=>of,__asyncValues:()=>lf,__await:()=>Xn,__awaiter:()=>Zc,__classPrivateFieldGet:()=>df,__classPrivateFieldSet:()=>hf,__createBinding:()=>tf,__decorate:()=>Yc,__exportStar:()=>nf,__extends:()=>Gc,__generator:()=>ef,__importDefault:()=>ff,__importStar:()=>cf,__makeTemplateObject:()=>uf,__metadata:()=>Qc,__param:()=>Jc,__read:()=>rl,__rest:()=>Xc,__spread:()=>rf,__spreadArrays:()=>sf,__values:()=>xs});function Gc(n,e){bs(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Xc(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Yc(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Jc(n,e){return function(t,r){e(t,r,n)}}function Qc(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Zc(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}function ef(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function tf(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}function nf(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function xs(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rl(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}function rf(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(rl(arguments[e]));return n}function sf(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function Xn(n){return this instanceof Xn?(this.v=n,this):new Xn(n)}function of(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(d){return new Promise(function(p,m){s.push([f,d,p,m])>1||a(f,d)})})}function a(f,d){try{l(r[f](d))}catch(p){h(s[0][3],p)}}function l(f){f.value instanceof Xn?Promise.resolve(f.value.v).then(u,c):h(s[0][2],f)}function u(f){a("next",f)}function c(f){a("throw",f)}function h(f,d){f(d),s.shift(),s.length&&a(s[0][0],s[0][1])}}function af(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,s){e[i]=n[i]?function(o){return(t=!t)?{value:Xn(n[i](o)),done:i==="return"}:s?s(o):o}:s}}function lf(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof xs=="function"?xs(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){o=n[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}function uf(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function cf(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function ff(n){return n&&n.__esModule?n:{default:n}}function df(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function hf(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var bs,ws,Jr=Hc(()=>{bs=function(n,e){return bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},bs(n,e)};ws=function(){return ws=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ws.apply(this,arguments)}});var As=te(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});var Es;(function(n){n[n.Transient=0]="Transient",n[n.Singleton=1]="Singleton",n[n.ResolutionScoped=2]="ResolutionScoped",n[n.ContainerScoped=3]="ContainerScoped"})(Es||(Es={}));Ss.default=Es});var il=te(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});var pf=As();Object.defineProperty(Ts,"Lifecycle",{enumerable:!0,get:function(){return pf.default}})});var Xt=te(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.defineInjectionTokenMetadata=tt.getParamInfo=tt.INJECTION_TOKEN_METADATA_KEY=void 0;tt.INJECTION_TOKEN_METADATA_KEY="injectionTokens";function mf(n){let e=Reflect.getMetadata("design:paramtypes",n)||[],t=Reflect.getOwnMetadata(tt.INJECTION_TOKEN_METADATA_KEY,n)||{};return Object.keys(t).forEach(r=>{e[+r]=t[r]}),e}tt.getParamInfo=mf;function gf(n,e){return function(t,r,i){let s=Reflect.getOwnMetadata(tt.INJECTION_TOKEN_METADATA_KEY,t)||{};s[i]=e?{token:n,transform:e.transformToken,transformArgs:e.args||[]}:n,Reflect.defineMetadata(tt.INJECTION_TOKEN_METADATA_KEY,s,t)}}tt.defineInjectionTokenMetadata=gf});var Cs=te(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.isClassProvider=void 0;function yf(n){return!!n.useClass}Qr.isClassProvider=yf});var Fs=te(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.isFactoryProvider=void 0;function vf(n){return!!n.useFactory}Zr.isFactoryProvider=vf});var ti=te(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.delay=wn.DelayedConstructor=void 0;var ei=class{constructor(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}createProxy(e){let t={},r=!1,i,s=()=>(r||(i=e(this.wrap()),r=!0),i);return new Proxy(t,this.createHandler(s))}createHandler(e){let t={},r=i=>{t[i]=(...s)=>{s[0]=e();let o=Reflect[i];return o(...s)}};return this.reflectMethods.forEach(r),t}};wn.DelayedConstructor=ei;function _f(n){if(typeof n=="undefined")throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new ei(n)}wn.delay=_f});var ni=te(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.isConstructorToken=ct.isTransformDescriptor=ct.isTokenDescriptor=ct.isNormalToken=void 0;var bf=ti();function wf(n){return typeof n=="string"||typeof n=="symbol"}ct.isNormalToken=wf;function xf(n){return typeof n=="object"&&"token"in n&&"multiple"in n}ct.isTokenDescriptor=xf;function Ef(n){return typeof n=="object"&&"token"in n&&"transform"in n}ct.isTransformDescriptor=Ef;function Sf(n){return typeof n=="function"||n instanceof bf.DelayedConstructor}ct.isConstructorToken=Sf});var Ps=te(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.isTokenProvider=void 0;function Af(n){return!!n.useToken}ri.isTokenProvider=Af});var Is=te(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.isValueProvider=void 0;function Tf(n){return n.useValue!=null}ii.isValueProvider=Tf});var ks=te(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var Cf=Cs();Object.defineProperty(Yt,"isClassProvider",{enumerable:!0,get:function(){return Cf.isClassProvider}});var Ff=Fs();Object.defineProperty(Yt,"isFactoryProvider",{enumerable:!0,get:function(){return Ff.isFactoryProvider}});var Pf=ni();Object.defineProperty(Yt,"isNormalToken",{enumerable:!0,get:function(){return Pf.isNormalToken}});var If=Ps();Object.defineProperty(Yt,"isTokenProvider",{enumerable:!0,get:function(){return If.isTokenProvider}});var kf=Is();Object.defineProperty(Yt,"isValueProvider",{enumerable:!0,get:function(){return kf.isValueProvider}})});var sl=te(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.isProvider=void 0;var Mf=Cs(),Df=Is(),Of=Ps(),Rf=Fs();function Lf(n){return Mf.isClassProvider(n)||Df.isValueProvider(n)||Of.isTokenProvider(n)||Rf.isFactoryProvider(n)}si.isProvider=Lf});var Os=te(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});var Ms=class{constructor(){this._registryMap=new Map}entries(){return this._registryMap.entries()}getAll(e){return this.ensure(e),this._registryMap.get(e)}get(e){this.ensure(e);let t=this._registryMap.get(e);return t[t.length-1]||null}set(e,t){this.ensure(e),this._registryMap.get(e).push(t)}setAll(e,t){this._registryMap.set(e,t)}has(e){return this.ensure(e),this._registryMap.get(e).length>0}clear(){this._registryMap.clear()}ensure(e){this._registryMap.has(e)||this._registryMap.set(e,[])}};Ds.default=Ms});var ol=te(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});var Nf=Os(),Rs=class extends Nf.default{};Ls.default=Rs});var al=te(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});var Ns=class{constructor(){this.scopedResolutions=new Map}};js.default=Ns});var Bs=te(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.formatErrorCtor=void 0;function jf(n,e){return n===null?`at position #${e}`:`"${n.split(",")[e].trim()}" at position #${e}`}function Bf(n,e,t="    "){return[n,...e.message.split(`
`).map(r=>t+r)].join(`
`)}function zf(n,e,t){let[,r=null]=n.toString().match(/constructor\(([\w, ]+)\)/)||[],i=jf(r,e);return Bf(`Cannot inject the dependency ${i} of "${n.name}" constructor. Reason:`,t)}oi.formatErrorCtor=zf});var ll=te(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.isDisposable=void 0;function Vf(n){return!(typeof n.dispose!="function"||n.dispose.length>0)}ai.isDisposable=Vf});var cl=te(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.PostResolutionInterceptors=Jt.PreResolutionInterceptors=void 0;var ul=Os(),li=class extends ul.default{};Jt.PreResolutionInterceptors=li;var ui=class extends ul.default{};Jt.PostResolutionInterceptors=ui;var zs=class{constructor(){this.preResolution=new li,this.postResolution=new ui}};Jt.default=zs});var Qt=te(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.instance=mt.typeInfo=void 0;var Kf=(Jr(),Gr(Yr)),ke=ks(),$f=sl(),ci=ni(),Uf=ol(),Re=As(),fl=al(),Wf=Bs(),qf=ti(),Hf=ll(),Gf=cl();mt.typeInfo=new Map;var Yn=class{constructor(e){this.parent=e,this._registry=new Uf.default,this.interceptors=new Gf.default,this.disposed=!1,this.disposables=new Set}register(e,t,r={lifecycle:Re.default.Transient}){this.ensureNotDisposed();let i;if($f.isProvider(t)?i=t:i={useClass:t},ke.isTokenProvider(i)){let s=[e],o=i;for(;o!=null;){let a=o.useToken;if(s.includes(a))throw new Error(`Token registration cycle detected! ${[...s,a].join(" -> ")}`);s.push(a);let l=this._registry.get(a);l&&ke.isTokenProvider(l.provider)?o=l.provider:o=null}}if((r.lifecycle===Re.default.Singleton||r.lifecycle==Re.default.ContainerScoped||r.lifecycle==Re.default.ResolutionScoped)&&(ke.isValueProvider(i)||ke.isFactoryProvider(i)))throw new Error(`Cannot use lifecycle "${Re.default[r.lifecycle]}" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:i,options:r}),this}registerType(e,t){return this.ensureNotDisposed(),ke.isNormalToken(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})}registerInstance(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})}registerSingleton(e,t){if(this.ensureNotDisposed(),ke.isNormalToken(e)){if(ke.isNormalToken(t))return this.register(e,{useToken:t},{lifecycle:Re.default.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:Re.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}let r=e;return t&&!ke.isNormalToken(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:Re.default.Singleton})}resolve(e,t=new fl.default){this.ensureNotDisposed();let r=this.getRegistration(e);if(!r&&ke.isNormalToken(e))throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`);if(this.executePreResolutionInterceptor(e,"Single"),r){let i=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}if(ci.isConstructorToken(e)){let i=this.construct(e,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")}executePreResolutionInterceptor(e,t){if(this.interceptors.preResolution.has(e)){let r=[];for(let i of this.interceptors.preResolution.getAll(e))i.options.frequency!="Once"&&r.push(i),i.callback(e,t);this.interceptors.preResolution.setAll(e,r)}}executePostResolutionInterceptor(e,t,r){if(this.interceptors.postResolution.has(e)){let i=[];for(let s of this.interceptors.postResolution.getAll(e))s.options.frequency!="Once"&&i.push(s),s.callback(e,t,r);this.interceptors.postResolution.setAll(e,i)}}resolveRegistration(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===Re.default.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);let r=e.options.lifecycle===Re.default.Singleton,i=e.options.lifecycle===Re.default.ContainerScoped,s=r||i,o;return ke.isValueProvider(e.provider)?o=e.provider.useValue:ke.isTokenProvider(e.provider)?o=s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):ke.isClassProvider(e.provider)?o=s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):ke.isFactoryProvider(e.provider)?o=e.provider.useFactory(this):o=this.construct(e.provider,t),e.options.lifecycle===Re.default.ResolutionScoped&&t.scopedResolutions.set(e,o),o}resolveAll(e,t=new fl.default){this.ensureNotDisposed();let r=this.getAllRegistrations(e);if(!r&&ke.isNormalToken(e))throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`);if(this.executePreResolutionInterceptor(e,"All"),r){let s=r.map(o=>this.resolveRegistration(o,t));return this.executePostResolutionInterceptor(e,s,"All"),s}let i=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,i,"All"),i}isRegistered(e,t=!1){return this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)}reset(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()}clearInstances(){this.ensureNotDisposed();for(let[e,t]of this._registry.entries())this._registry.setAll(e,t.filter(r=>!ke.isValueProvider(r.provider)).map(r=>(r.instance=void 0,r)))}createChildContainer(){this.ensureNotDisposed();let e=new Yn(this);for(let[t,r]of this._registry.entries())r.some(({options:i})=>i.lifecycle===Re.default.ContainerScoped)&&e._registry.setAll(t,r.map(i=>i.options.lifecycle===Re.default.ContainerScoped?{provider:i.provider,options:i.options}:i));return e}beforeResolution(e,t,r={frequency:"Always"}){this.interceptors.preResolution.set(e,{callback:t,options:r})}afterResolution(e,t,r={frequency:"Always"}){this.interceptors.postResolution.set(e,{callback:t,options:r})}dispose(){return Kf.__awaiter(this,void 0,void 0,function*(){this.disposed=!0;let e=[];this.disposables.forEach(t=>{let r=t.dispose();r&&e.push(r)}),yield Promise.all(e)})}getRegistration(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null}getAllRegistrations(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null}construct(e,t){if(e instanceof qf.DelayedConstructor)return e.createProxy(i=>this.resolve(i,t));let r=(()=>{let i=mt.typeInfo.get(e);if(!i||i.length===0){if(e.length===0)return new e;throw new Error(`TypeInfo not known for "${e.name}"`)}let s=i.map(this.resolveParams(t,e));return new e(...s)})();return Hf.isDisposable(r)&&this.disposables.add(r),r}resolveParams(e,t){return(r,i)=>{try{return ci.isTokenDescriptor(r)?ci.isTransformDescriptor(r)?r.multiple?this.resolve(r.transform).transform(this.resolveAll(r.token),...r.transformArgs):this.resolve(r.transform).transform(this.resolve(r.token,e),...r.transformArgs):r.multiple?this.resolveAll(r.token):this.resolve(r.token,e):ci.isTransformDescriptor(r)?this.resolve(r.transform,e).transform(this.resolve(r.token,e),...r.transformArgs):this.resolve(r,e)}catch(s){throw new Error(Wf.formatErrorCtor(t,i,s))}}}ensureNotDisposed(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")}};mt.instance=new Yn;mt.default=mt.instance});var dl=te(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});var Xf=Xt(),gt=Qt(),Vs=ni(),Yf=Bs();function Jf(){return function(n){let e=Xf.getParamInfo(n);return class extends n{constructor(...t){super(...t.concat(e.slice(t.length).map((r,i)=>{try{return Vs.isTokenDescriptor(r)?Vs.isTransformDescriptor(r)?r.multiple?gt.instance.resolve(r.transform).transform(gt.instance.resolveAll(r.token),...r.transformArgs):gt.instance.resolve(r.transform).transform(gt.instance.resolve(r.token),...r.transformArgs):r.multiple?gt.instance.resolveAll(r.token):gt.instance.resolve(r.token):Vs.isTransformDescriptor(r)?gt.instance.resolve(r.transform).transform(gt.instance.resolve(r.token),...r.transformArgs):gt.instance.resolve(r)}catch(s){let o=i+t.length;throw new Error(Yf.formatErrorCtor(n,o,s))}})))}}}}Ks.default=Jf});var hl=te($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});var Qf=Xt();function Zf(n){return Qf.defineInjectionTokenMetadata(n)}$s.default=Zf});var fi=te(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});var ed=Xt(),td=Qt();function nd(){return function(n){td.typeInfo.set(n,ed.getParamInfo(n))}}Us.default=nd});var pl=te(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});var rd=(Jr(),Gr(Yr)),id=Qt();function sd(n=[]){return function(e){return n.forEach(t=>{var{token:r,options:i}=t,s=rd.__rest(t,["token","options"]);return id.instance.register(r,s,i)}),e}}Ws.default=sd});var ml=te(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});var od=fi(),ad=Qt();function ld(){return function(n){od.default()(n),ad.instance.registerSingleton(n)}}qs.default=ld});var gl=te(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});var ud=Xt();function cd(n){let e={token:n,multiple:!0};return ud.defineInjectionTokenMetadata(e)}Hs.default=cd});var yl=te(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});var fd=Xt();function dd(n,e,...t){let r={token:n,multiple:!0,transform:e,transformArgs:t};return fd.defineInjectionTokenMetadata(r)}Gs.default=dd});var vl=te(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});var hd=Xt();function pd(n,e,...t){return hd.defineInjectionTokenMetadata(n,{transformToken:e,args:t})}Xs.default=pd});var _l=te(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});var md=fi(),gd=Qt();function yd(n,e){return function(t){md.default()(t),gd.instance.register(e||t,t,{lifecycle:n})}}Ys.default=yd});var bl=te(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});var vd=dl();Object.defineProperty(nt,"autoInjectable",{enumerable:!0,get:function(){return vd.default}});var _d=hl();Object.defineProperty(nt,"inject",{enumerable:!0,get:function(){return _d.default}});var bd=fi();Object.defineProperty(nt,"injectable",{enumerable:!0,get:function(){return bd.default}});var wd=pl();Object.defineProperty(nt,"registry",{enumerable:!0,get:function(){return wd.default}});var xd=ml();Object.defineProperty(nt,"singleton",{enumerable:!0,get:function(){return xd.default}});var Ed=gl();Object.defineProperty(nt,"injectAll",{enumerable:!0,get:function(){return Ed.default}});var Sd=yl();Object.defineProperty(nt,"injectAllWithTransform",{enumerable:!0,get:function(){return Sd.default}});var Ad=vl();Object.defineProperty(nt,"injectWithTransform",{enumerable:!0,get:function(){return Ad.default}});var Td=_l();Object.defineProperty(nt,"scoped",{enumerable:!0,get:function(){return Td.default}})});var wl=te(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});function Cd(n){let e;return t=>(e==null&&(e=n(t)),e)}Js.default=Cd});var xl=te(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});function Fd(n){let e=new WeakMap;return t=>{let r=e.get(t);return r==null&&(r=n(t),e.set(t,r)),r}}Qs.default=Fd});var El=te(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});function Pd(n,e,t,r=!0){let i,s;return o=>{let a=n(o);return(!r||s!==a)&&((s=a)?i=o.resolve(e):i=o.resolve(t)),i}}Zs.default=Pd});var Sl=te(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});var Id=wl();Object.defineProperty(Jn,"instanceCachingFactory",{enumerable:!0,get:function(){return Id.default}});var kd=xl();Object.defineProperty(Jn,"instancePerContainerCachingFactory",{enumerable:!0,get:function(){return kd.default}});var Md=El();Object.defineProperty(Jn,"predicateAwareClassFactory",{enumerable:!0,get:function(){return Md.default}})});var ce=te(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});var eo=(Jr(),Gr(Yr));if(typeof Reflect=="undefined"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var Dd=il();Object.defineProperty(kt,"Lifecycle",{enumerable:!0,get:function(){return Dd.Lifecycle}});eo.__exportStar(bl(),kt);eo.__exportStar(Sl(),kt);eo.__exportStar(ks(),kt);var Od=ti();Object.defineProperty(kt,"delay",{enumerable:!0,get:function(){return Od.delay}});var Rd=Qt();Object.defineProperty(kt,"container",{enumerable:!0,get:function(){return Rd.instance}})});var Im={};el(Im,{RenderMarkdownModal:()=>hs,default:()=>qn});module.exports=Gr(Im);var He=require("obsidian");var nl;(function(n){(function(e){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),r=i(n);typeof t.Reflect=="undefined"?t.Reflect=n:r=i(t.Reflect,r),e(r);function i(s,o){return function(a,l){typeof s[a]!="function"&&Object.defineProperty(s,a,{configurable:!0,writable:!0,value:l}),o&&o(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,r=typeof Symbol=="function",i=r&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",s=r&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!o&&!a,u={create:o?function(){return _s(Object.create(null))}:a?function(){return _s({__proto__:null})}:function(){return _s({})},has:l?function(v,E){return t.call(v,E)}:function(v,E){return E in v},get:l?function(v,E){return t.call(v,E)?v[E]:void 0}:function(v,E){return v[E]}},c=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Pt(),d=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:bn(),p=!h&&typeof WeakMap=="function"?WeakMap:Gt(),m=new p;function g(v,E,F,D){if(ee(F)){if(!Wr(v))throw new TypeError;if(!qr(E))throw new TypeError;return j(v,E)}else{if(!Wr(v))throw new TypeError;if(!W(E))throw new TypeError;if(!W(D)&&!ee(D)&&!P(D))throw new TypeError;return P(D)&&(D=void 0),F=Ge(F),O(v,E,F,D)}}e("decorate",g);function y(v,E){function F(D,V){if(!W(D))throw new TypeError;if(!ee(V)&&!ys(V))throw new TypeError;Z(v,E,D,V)}return F}e("metadata",y);function _(v,E,F,D){if(!W(F))throw new TypeError;return ee(D)||(D=Ge(D)),Z(v,E,F,D)}e("defineMetadata",_);function x(v,E,F){if(!W(E))throw new TypeError;return ee(F)||(F=Ge(F)),k(v,E,F)}e("hasMetadata",x);function w(v,E,F){if(!W(E))throw new TypeError;return ee(F)||(F=Ge(F)),B(v,E,F)}e("hasOwnMetadata",w);function S(v,E,F){if(!W(E))throw new TypeError;return ee(F)||(F=Ge(F)),Q(v,E,F)}e("getMetadata",S);function A(v,E,F){if(!W(E))throw new TypeError;return ee(F)||(F=Ge(F)),G(v,E,F)}e("getOwnMetadata",A);function T(v,E){if(!W(v))throw new TypeError;return ee(E)||(E=Ge(E)),ne(v,E)}e("getMetadataKeys",T);function I(v,E){if(!W(v))throw new TypeError;return ee(E)||(E=Ge(E)),he(v,E)}e("getOwnMetadataKeys",I);function M(v,E,F){if(!W(E))throw new TypeError;ee(F)||(F=Ge(F));var D=L(E,F,!1);if(ee(D)||!D.delete(v))return!1;if(D.size>0)return!0;var V=m.get(E);return V.delete(F),V.size>0||m.delete(E),!0}e("deleteMetadata",M);function j(v,E){for(var F=v.length-1;F>=0;--F){var D=v[F],V=D(E);if(!ee(V)&&!P(V)){if(!qr(V))throw new TypeError;E=V}}return E}function O(v,E,F,D){for(var V=v.length-1;V>=0;--V){var _e=v[V],H=_e(E,F,D);if(!ee(H)&&!P(H)){if(!W(H))throw new TypeError;D=H}}return D}function L(v,E,F){var D=m.get(v);if(ee(D)){if(!F)return;D=new f,m.set(v,D)}var V=D.get(E);if(ee(V)){if(!F)return;V=new f,D.set(E,V)}return V}function k(v,E,F){var D=B(v,E,F);if(D)return!0;var V=pt(E);return P(V)?!1:k(v,V,F)}function B(v,E,F){var D=L(E,F,!1);return ee(D)?!1:ut(D.has(v))}function Q(v,E,F){var D=B(v,E,F);if(D)return G(v,E,F);var V=pt(E);if(!P(V))return Q(v,V,F)}function G(v,E,F){var D=L(E,F,!1);if(!ee(D))return D.get(v)}function Z(v,E,F,D){var V=L(F,D,!0);V.set(v,E)}function ne(v,E){var F=he(v,E),D=pt(v);if(D===null)return F;var V=ne(D,E);if(V.length<=0)return F;if(F.length<=0)return V;for(var _e=new d,H=[],J=0,$=F;J<$.length;J++){var re=$[J],ie=_e.has(re);ie||(_e.add(re),H.push(re))}for(var It=0,Qa=V;It<Qa.length;It++){var re=Qa[It],ie=_e.has(re);ie||(_e.add(re),H.push(re))}return H}function he(v,E){var F=[],D=L(v,E,!1);if(ee(D))return F;for(var V=D.keys(),_e=et(V),H=0;;){var J=Hr(_e);if(!J)return F.length=H,F;var $=vs(J);try{F[H]=$}catch(re){try{Ft(_e)}finally{throw re}}H++}}function lt(v){if(v===null)return 1;switch(typeof v){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return v===null?1:6;default:return 6}}function ee(v){return v===void 0}function P(v){return v===null}function z(v){return typeof v=="symbol"}function W(v){return typeof v=="object"?v!==null:typeof v=="function"}function Oe(v,E){switch(lt(v)){case 0:return v;case 1:return v;case 2:return v;case 3:return v;case 4:return v;case 5:return v}var F=E===3?"string":E===5?"number":"default",D=_n(v,i);if(D!==void 0){var V=D.call(v,F);if(W(V))throw new TypeError;return V}return ze(v,F==="default"?"number":F)}function ze(v,E){if(E==="string"){var F=v.toString;if(Ct(F)){var D=F.call(v);if(!W(D))return D}var V=v.valueOf;if(Ct(V)){var D=V.call(v);if(!W(D))return D}}else{var V=v.valueOf;if(Ct(V)){var D=V.call(v);if(!W(D))return D}var _e=v.toString;if(Ct(_e)){var D=_e.call(v);if(!W(D))return D}}throw new TypeError}function ut(v){return!!v}function Ve(v){return""+v}function Ge(v){var E=Oe(v,3);return z(E)?E:Ve(E)}function Wr(v){return Array.isArray?Array.isArray(v):v instanceof Object?v instanceof Array:Object.prototype.toString.call(v)==="[object Array]"}function Ct(v){return typeof v=="function"}function qr(v){return typeof v=="function"}function ys(v){switch(lt(v)){case 3:return!0;case 4:return!0;default:return!1}}function _n(v,E){var F=v[E];if(F!=null){if(!Ct(F))throw new TypeError;return F}}function et(v){var E=_n(v,s);if(!Ct(E))throw new TypeError;var F=E.call(v);if(!W(F))throw new TypeError;return F}function vs(v){return v.value}function Hr(v){var E=v.next();return E.done?!1:E}function Ft(v){var E=v.return;E&&E.call(v)}function pt(v){var E=Object.getPrototypeOf(v);if(typeof v!="function"||v===c||E!==c)return E;var F=v.prototype,D=F&&Object.getPrototypeOf(F);if(D==null||D===Object.prototype)return E;var V=D.constructor;return typeof V!="function"||V===v?E:V}function Pt(){var v={},E=[],F=function(){function H(J,$,re){this._index=0,this._keys=J,this._values=$,this._selector=re}return H.prototype["@@iterator"]=function(){return this},H.prototype[s]=function(){return this},H.prototype.next=function(){var J=this._index;if(J>=0&&J<this._keys.length){var $=this._selector(this._keys[J],this._values[J]);return J+1>=this._keys.length?(this._index=-1,this._keys=E,this._values=E):this._index++,{value:$,done:!1}}return{value:void 0,done:!0}},H.prototype.throw=function(J){throw this._index>=0&&(this._index=-1,this._keys=E,this._values=E),J},H.prototype.return=function(J){return this._index>=0&&(this._index=-1,this._keys=E,this._values=E),{value:J,done:!0}},H}();return function(){function H(){this._keys=[],this._values=[],this._cacheKey=v,this._cacheIndex=-2}return Object.defineProperty(H.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),H.prototype.has=function(J){return this._find(J,!1)>=0},H.prototype.get=function(J){var $=this._find(J,!1);return $>=0?this._values[$]:void 0},H.prototype.set=function(J,$){var re=this._find(J,!0);return this._values[re]=$,this},H.prototype.delete=function(J){var $=this._find(J,!1);if($>=0){for(var re=this._keys.length,ie=$+1;ie<re;ie++)this._keys[ie-1]=this._keys[ie],this._values[ie-1]=this._values[ie];return this._keys.length--,this._values.length--,J===this._cacheKey&&(this._cacheKey=v,this._cacheIndex=-2),!0}return!1},H.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=v,this._cacheIndex=-2},H.prototype.keys=function(){return new F(this._keys,this._values,D)},H.prototype.values=function(){return new F(this._keys,this._values,V)},H.prototype.entries=function(){return new F(this._keys,this._values,_e)},H.prototype["@@iterator"]=function(){return this.entries()},H.prototype[s]=function(){return this.entries()},H.prototype._find=function(J,$){return this._cacheKey!==J&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=J)),this._cacheIndex<0&&$&&(this._cacheIndex=this._keys.length,this._keys.push(J),this._values.push(void 0)),this._cacheIndex},H}();function D(H,J){return H}function V(H,J){return J}function _e(H,J){return[H,J]}}function bn(){return function(){function v(){this._map=new f}return Object.defineProperty(v.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),v.prototype.has=function(E){return this._map.has(E)},v.prototype.add=function(E){return this._map.set(E,E),this},v.prototype.delete=function(E){return this._map.delete(E)},v.prototype.clear=function(){this._map.clear()},v.prototype.keys=function(){return this._map.keys()},v.prototype.values=function(){return this._map.values()},v.prototype.entries=function(){return this._map.entries()},v.prototype["@@iterator"]=function(){return this.keys()},v.prototype[s]=function(){return this.keys()},v}()}function Gt(){var v=16,E=u.create(),F=D();return function(){function $(){this._key=D()}return $.prototype.has=function(re){var ie=V(re,!1);return ie!==void 0?u.has(ie,this._key):!1},$.prototype.get=function(re){var ie=V(re,!1);return ie!==void 0?u.get(ie,this._key):void 0},$.prototype.set=function(re,ie){var It=V(re,!0);return It[this._key]=ie,this},$.prototype.delete=function(re){var ie=V(re,!1);return ie!==void 0?delete ie[this._key]:!1},$.prototype.clear=function(){this._key=D()},$}();function D(){var $;do $="@@WeakMap@@"+J();while(u.has(E,$));return E[$]=!0,$}function V($,re){if(!t.call($,F)){if(!re)return;Object.defineProperty($,F,{value:u.create()})}return $[F]}function _e($,re){for(var ie=0;ie<re;++ie)$[ie]=Math.random()*255|0;return $}function H($){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array($)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array($)):_e(new Uint8Array($),$):_e(new Array($),$)}function J(){var $=H(v);$[6]=$[6]&79|64,$[8]=$[8]&191|128;for(var re="",ie=0;ie<v;++ie){var It=$[ie];(ie===4||ie===6||ie===8)&&(re+="-"),It<16&&(re+="0"),re+=It.toString(16).toLowerCase()}return re}}function _s(v){return v.__=void 0,delete v.__,v}})})(nl||(nl={}));var gs=ae(ce());var rt="CleverSearch",to='"\u25B6"',no='"\u25BC"';var ro="&nbsp;&nbsp;&nbsp;&nbsp;";var Vd={},Ee,Al=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Al.decode();var di=null;function mi(){return(di===null||di.buffer!==Ee.memory.buffer)&&(di=new Uint8Array(Ee.memory.buffer)),di}function io(n,e){return Al.decode(mi().subarray(n,n+e))}var yt=new Array(32).fill(void 0);yt.push(void 0,null,!0,!1);var er=yt.length;function Qn(n){er===yt.length&&yt.push(yt.length+1);let e=er;return er=yt[e],yt[e]=n,e}function gi(n){return yt[n]}function Ld(n){n<36||(yt[n]=er,er=n)}function Zn(n){let e=gi(n);return Ld(n),e}function so(n){let e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){let i=n.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){let i=n.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(n)){let i=n.length,s="[";i>0&&(s+=so(n[0]));for(let o=1;o<i;o++)s+=", "+so(n[o]);return s+="]",s}let t=/\[object ([^\]]+)\]/.exec(toString.call(n)),r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch(i){return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}var vi=0,yi=new TextEncoder("utf-8"),Nd=typeof yi.encodeInto=="function"?function(n,e){return yi.encodeInto(n,e)}:function(n,e){let t=yi.encode(n);return e.set(t),{read:n.length,written:t.length}};function Tl(n,e,t){if(t===void 0){let a=yi.encode(n),l=e(a.length);return mi().subarray(l,l+a.length).set(a),vi=a.length,l}let r=n.length,i=e(r),s=mi(),o=0;for(;o<r;o++){let a=n.charCodeAt(o);if(a>127)break;s[i+o]=a}if(o!==r){o!==0&&(n=n.slice(o)),i=t(i,r,r=o+n.length*3);let a=mi().subarray(i+o,i+r),l=Nd(n,a);o+=l.written}return vi=o,i}var hi=null;function _i(){return(hi===null||hi.buffer!==Ee.memory.buffer)&&(hi=new Int32Array(Ee.memory.buffer)),hi}var pi=null;function jd(){return(pi===null||pi.buffer!==Ee.memory.buffer)&&(pi=new Uint32Array(Ee.memory.buffer)),pi}function Bd(n,e){let r=jd().subarray(n/4,n/4+e),i=[];for(let s=0;s<r.length;s++)i.push(Zn(r[s]));return i}function oo(n,e){try{let a=Ee.__wbindgen_add_to_stack_pointer(-16);var t=Tl(n,Ee.__wbindgen_malloc,Ee.__wbindgen_realloc),r=vi;Ee.cut_for_search(a,t,r,e);var i=_i()[a/4+0],s=_i()[a/4+1],o=Bd(i,s).slice();return Ee.__wbindgen_free(i,s*4),o}finally{Ee.__wbindgen_add_to_stack_pointer(16)}}async function zd(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{let t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}async function Cl(n){typeof n=="undefined"&&(n=new URL("jieba_rs_wasm_bg.wasm",Vd.url));let e={};e.wbg={},e.wbg.__wbindgen_string_new=function(i,s){var o=io(i,s);return Qn(o)},e.wbg.__wbindgen_object_drop_ref=function(i){Zn(i)},e.wbg.__wbg_new_68adb0d58759a4ed=function(){var i=new Object;return Qn(i)},e.wbg.__wbindgen_number_new=function(i){var s=i;return Qn(s)},e.wbg.__wbg_set_2e79e744454afade=function(i,s,o){gi(i)[Zn(s)]=Zn(o)},e.wbg.__wbindgen_object_clone_ref=function(i){var s=gi(i);return Qn(s)},e.wbg.__wbg_new_7031805939a80203=function(i,s){var o=new Error(io(i,s));return Qn(o)},e.wbg.__wbindgen_debug_string=function(i,s){var o=so(gi(s)),a=Tl(o,Ee.__wbindgen_malloc,Ee.__wbindgen_realloc),l=vi;_i()[i/4+1]=l,_i()[i/4+0]=a},e.wbg.__wbindgen_throw=function(i,s){throw new Error(io(i,s))},e.wbg.__wbindgen_rethrow=function(i){throw Zn(i)},(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));let{instance:t,module:r}=await zd(await n,e);return Ee=t.exports,Cl.__wbindgen_wasm_module=r,Ee}var Fl=Cl;var tr=(r=>(r.other="Other Language",r.en="English",r.zh="\u7B80\u4F53\u4E2D\u6587",r))(tr||{});var Pl=ae(ce());var nr={traceLog:!1,loadIndexFromDatabase:!0};var ao=class{constructor(){this.logLevel="debug";this.levelWeights={trace:1,debug:2,info:3,warn:4,error:5,none:6}}getLevel(){return this.logLevel}setLevel(e){this.logLevel=e}trace(...e){this.shouldLog("trace")&&(nr.traceLog?(console.groupCollapsed(`%c[trace] ${this.getCallerName()}
`,"color: #5f6368;font-weight: 400;",...e),console.trace(),console.groupEnd()):console.log(`%c[trace] ${this.getCallerName()}
`,"color: #5f6368;",...e))}debug(...e){this.shouldLog("debug")&&(nr.traceLog?(console.groupCollapsed(`%c[debug] ${this.getCallerName()}
`,"color: #379237;font-weight: 400;",...e),console.trace(),console.groupEnd()):console.debug(`%c[debug] ${this.getCallerName()}
`,"color: #379237",...e))}info(...e){this.shouldLog("info")&&console.info(`%c[info] ${this.getCallerName()}
`,"color: blue;",...e)}warn(...e){this.shouldLog("warn")&&console.warn(`%c[warn] ${this.getCallerName()}
`,"color: orange;",...e)}error(...e){this.shouldLog("error")&&console.error(`%c[error] ${this.getCallerName()}
`,"color: red;",...e)}getCallerName(){var i;let e=(i=new Error().stack)==null?void 0:i.split(`
`),t=e==null?void 0:e.slice(3).find(s=>!s.includes("eval")&&!s.includes("Array.map"));if(t!=null&&t.startsWith("    at blob:"))return"child-thread";let r=t==null?void 0:t.match(/at (\S+)/);return r?`<${r[1]}> `:"failed to parse caller"}shouldLog(e){return this.levelWeights[e]>=this.levelWeights[this.logLevel]}},C=new ao;var Zt=!1,xn="This branch hasn't been implemented",bi="this branch shouldn't be reached by design",uo=/Mac|iPod|iPhone|iPad/.test(navigator.userAgent)?"Mod":"Ctrl",ft=class{static extractDomainFromHttpsUrl(e){if(e.startsWith("http://"))return C.error("Only support https, current url starts with http"),"";let t=/^(https?:\/\/)?([\w.-]+)(?:\/|$)/,r=e.match(t);return r&&r[2]?r[2]:""}static append(e,t){for(let r of t)e.push(r);return e}static mergeDeep(e,...t){if(!t.length)return e;let r=t.shift();if(lo(e)&&lo(r))for(let i in r)lo(r[i])?(e[i]||Object.assign(e,{[i]:{}}),ft.mergeDeep(e[i],r[i])):Object.assign(e,{[i]:r[i]});return ft.mergeDeep(e,...t)}static getCurrLanguage(){let e=window.localStorage.getItem("language")||"en";return e in tr?tr[e]:"Other Language"}static sleep(e){return new Promise(t=>setTimeout(t,e))}};async function Il(n,...e){let t=Date.now();await n(...e);let r=Date.now(),i=kl(r-t);C.debug(`<${n.name.replace(/^bound /,"")}> Execution time: ${i}`)}function Se(n,e,t){let r=t.value;return t.value=function(...i){let s=Date.now(),o=r.apply(this,i),a=()=>{let l=Date.now();C.trace(`<${n.constructor.name}-${e}> Execution time: ${kl(l-s)}`)};return o instanceof Promise?o.then(l=>(a(),l)):(a(),o)},t}function kl(n){if(n<1e3)return`${n} ms`;if(n<6e4){let e=Math.floor(n/1e3),t=n%1e3;return`${e} s ${t} ms`}else{let e=Math.floor(n/6e4),t=Math.floor(n%6e4/1e3),r=n%1e3;return`${e} min ${t} s ${r} ms`}}function b(n){try{return Pl.container.resolve(n)}catch(e){let t=`CleverSearch for developer:
There might be wrong usages for tsyringe:
1. Inject an instance for static field
2. Cycle dependencies without delay
3. Unknown error`;return C.warn(t),C.error(e),alert(t),-1}}function lo(n){return n&&typeof n=="object"&&!Array.isArray(n)}var se=class{},Ml=window.localStorage.getItem("language")==="zh",Dl={customExtensions:{plaintext:["md"]},followObsidianExcludedFiles:!0,excludedPaths:[],logLevel:Zt?"trace":"info",enableStopWordsEn:!0,enableChinesePatch:!!Ml,enableStopWordsZh:!!Ml,apiProvider1:{domain:"",key:""},apiProvider2:{domain:"",key:""},ui:{openInNewPane:!0,maxItemResults:30,floatingWindowForInFile:!0,showedExtension:"except md",collapseDevSettingByDefault:!Zt,inFileFloatingWindowTop:"2.7em",inFileFloatingWindowLeft:"2.5em"},semantic:{isEnabled:!1,serverType:"local"}},Ol={search:{fuzzyProportion:.2,minTermLengthForPrefixSearch:2,weightFilename:3,weightFolder:2,weightTagText:1.15,weightHeading:1.27}};var Nl=ae(ce());var Kd=ae(require("fs")),$d=ae(require("path")),Rl=ae(ce());var En=Kd,Ae=$d,le=class{static getBasename(e){return Ae.basename(e,Ae.extname(e))}static getExtension(e){return Ae.extname(e).slice(1)}static getFolderPath(e){let t=Ae.dirname(e);return t==="."||t===Ae.sep||t==="/"?"./":t.replace(new RegExp("\\"+Ae.sep,"g"),"/")+"/"}static countFileByExtensions(e){let t=new Map;e.forEach(i=>{let s=i.extension||"no_extension";t.set(s,(t.get(s)||0)+1)});let r=Object.fromEntries(t);return C.trace(r),r}};le.SPLIT_EOL=`
`,le.JOIN_EOL=`
`,le=N([(0,Rl.singleton)()],le);var Ll=require("electron"),Ud=(Ll.app||Ll.remote.app).getPath("userData"),wi=Ae.join(Ud,"clever-search"),Wd="https://bitbucket.org/alexclifton37/obsidian-clever-search/raw/dev/assets/for-program/",qd="https://raw.githubusercontent.com/yan42685/obsidian-clever-search/dev/assets/for-program/",Hd="https://unpkg.com/",Ig=Hd+"@dqbd/tiktoken@1.0.7/tiktoken_bg.wasm",kg=Ae.join(wi,"tiktoken_bg.wasm"),xi=Ae.join(wi,"stop-words-en.txt"),co="jieba_rs_wasm_bg.wasm",fo="stop-words-en.txt",ho="stop-words-zh.txt",Ke=class{constructor(){this.setting=b(se);this._assets=Gd}get assets(){return this._assets}async initAsync(){C.trace("preparing assets..."),C.trace(`target dir: ${wi}`);try{await this.initHelper(Wd)}catch(e){try{await this.initHelper(qd),C.info("download successfully")}catch(t){throw C.warn("failed to download assets"),t}}}async initHelper(e){this.setting.enableChinesePatch&&(await this.downloadFile(this.targetPath(co),e+co),await this.downloadFile(this.targetPath(ho),e+ho),this._assets.jiebaBinary=En.promises.readFile(this.targetPath(co)),this._assets.stopWordsZh=await this.readLinesAsSet(this.targetPath(ho))),await this.downloadFile(this.targetPath(fo),e+fo),this._assets.stopWordsEn=await this.readLinesAsSet(this.targetPath(fo))}targetPath(e){return Ae.join(wi,e)}async readLinesAsSet(e){return new Set((await En.promises.readFile(e,{encoding:"utf-8"})).split(le.SPLIT_EOL))}async downloadFile(e,t){try{await En.promises.access(e),C.trace("file exists:",e);return}catch(s){if(s.code!=="ENOENT")throw s}let r=Ae.dirname(e);await En.promises.mkdir(r,{recursive:!0}).catch(s=>{if(s.code!=="EEXIST")throw s});let i=await fetch(t);if(!i.ok)throw new Error(`unexpected response ${i.statusText}`);try{await En.promises.writeFile(e,Buffer.from(await i.arrayBuffer()),"utf-8"),C.info(`successfully download from ${t}`)}catch(s){throw C.error(`failed to download ${t}`),s}}};Ke=N([(0,Nl.singleton)()],Ke);var Gd={stopWordsZh:null,stopWordsEn:null,jiebaBinary:new Promise(()=>null)};var jl=ae(ce());var it=class{constructor(){this.isReady=!1;this.reportedError=!1}async initAsync(){if(b(se).enableChinesePatch){let e=b(Ke).assets.jiebaBinary;await Fl(e),oo("",!1),this.isReady=!0}}cut(e,t){return!this.isReady&&!this.reportedError?(C.error("jieba segmenter isn't ready"),this.reportedError=!0,[e]):oo(e,t)}};it=N([(0,jl.singleton)()],it);var fe=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,me=Object.keys,Ce=Array.isArray;typeof Promise!="undefined"&&!fe.Promise&&(fe.Promise=Promise);function De(n,e){return typeof e!="object"||me(e).forEach(function(t){n[t]=e[t]}),n}var lr=Object.getPrototypeOf,Xd={}.hasOwnProperty;function Ue(n,e){return Xd.call(n,e)}function Fn(n,e){typeof e=="function"&&(e=e(lr(n))),(typeof Reflect=="undefined"?me:Reflect.ownKeys)(e).forEach(t=>{Et(n,t,e[t])})}var Jl=Object.defineProperty;function Et(n,e,t,r){Jl(n,e,De(t&&Ue(t,"get")&&typeof t.get=="function"?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function Pn(n){return{from:function(e){return n.prototype=Object.create(e.prototype),Et(n.prototype,"constructor",n),{extend:Fn.bind(null,n.prototype)}}}}var Yd=Object.getOwnPropertyDescriptor;function Go(n,e){let t=Yd(n,e),r;return t||(r=lr(n))&&Go(r,e)}var Jd=[].slice;function Ui(n,e,t){return Jd.call(n,e,t)}function Ql(n,e){return e(n)}function rr(n){if(!n)throw new Error("Assertion Failed")}function Zl(n){fe.setImmediate?setImmediate(n):setTimeout(n,0)}function eu(n,e){return n.reduce((t,r,i)=>{var s=e(r,i);return s&&(t[s[0]]=s[1]),t},{})}function Qd(n,e,t){try{n.apply(null,t)}catch(r){e&&e(r)}}function xt(n,e){if(Ue(n,e))return n[e];if(!e)return n;if(typeof e!="string"){for(var t=[],r=0,i=e.length;r<i;++r){var s=xt(n,e[r]);t.push(s)}return t}var o=e.indexOf(".");if(o!==-1){var a=n[e.substr(0,o)];return a===void 0?void 0:xt(a,e.substr(o+1))}}function st(n,e,t){if(!(!n||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof e!="string"&&"length"in e){rr(typeof t!="string"&&"length"in t);for(var r=0,i=e.length;r<i;++r)st(n,e[r],t[r])}else{var s=e.indexOf(".");if(s!==-1){var o=e.substr(0,s),a=e.substr(s+1);if(a==="")t===void 0?Ce(n)&&!isNaN(parseInt(o))?n.splice(o,1):delete n[o]:n[o]=t;else{var l=n[o];(!l||!Ue(n,o))&&(l=n[o]={}),st(l,a,t)}}else t===void 0?Ce(n)&&!isNaN(parseInt(e))?n.splice(e,1):delete n[e]:n[e]=t}}function Zd(n,e){typeof e=="string"?st(n,e,void 0):"length"in e&&[].map.call(e,function(t){st(n,t,void 0)})}function tu(n){var e={};for(var t in n)Ue(n,t)&&(e[t]=n[t]);return e}var eh=[].concat;function nu(n){return eh.apply([],n)}var ru="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(nu([8,16,32,64].map(n=>["Int","Uint","Float"].map(e=>e+n+"Array")))).filter(n=>fe[n]),th=ru.map(n=>fe[n]);eu(ru,n=>[n,!0]);var Dt=null;function mr(n){Dt=typeof WeakMap!="undefined"&&new WeakMap;let e=bo(n);return Dt=null,e}function bo(n){if(!n||typeof n!="object")return n;let e=Dt&&Dt.get(n);if(e)return e;if(Ce(n)){e=[],Dt&&Dt.set(n,e);for(var t=0,r=n.length;t<r;++t)e.push(bo(n[t]))}else if(th.indexOf(n.constructor)>=0)e=n;else{let s=lr(n);e=s===Object.prototype?{}:Object.create(s),Dt&&Dt.set(n,e);for(var i in n)Ue(n,i)&&(e[i]=bo(n[i]))}return e}var{toString:nh}={};function wo(n){return nh.call(n).slice(8,-1)}var xo=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",rh=typeof xo=="symbol"?function(n){var e;return n!=null&&(e=n[xo])&&e.apply(n)}:function(){return null},Tn={};function bt(n){var e,t,r,i;if(arguments.length===1){if(Ce(n))return n.slice();if(this===Tn&&typeof n=="string")return[n];if(i=rh(n)){for(t=[];r=i.next(),!r.done;)t.push(r.value);return t}if(n==null)return[n];if(e=n.length,typeof e=="number"){for(t=new Array(e);e--;)t[e]=n[e];return t}return[n]}for(e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return t}var Xo=typeof Symbol!="undefined"?n=>n[Symbol.toStringTag]==="AsyncFunction":()=>!1,ht=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function iu(n,e){ht=n,su=e}var su=()=>!0,ih=!new Error("").stack;function an(){if(ih)try{throw an.arguments,new Error}catch(n){return n}return new Error}function Eo(n,e){var t=n.stack;return t?(e=e||0,t.indexOf(n.name)===0&&(e+=(n.name+n.message).split(`
`).length),t.split(`
`).slice(e).filter(su).map(r=>`
`+r).join("")):""}var sh=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],ou=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yo=sh.concat(ou),oh={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function In(n,e){this._e=an(),this.name=n,this.message=e}Pn(In).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Eo(this._e,2))}},toString:function(){return this.name+": "+this.message}});function au(n,e){return n+". Errors: "+Object.keys(e).map(t=>e[t].toString()).filter((t,r,i)=>i.indexOf(t)===r).join(`
`)}function Oi(n,e,t,r){this._e=an(),this.failures=e,this.failedKeys=r,this.successCount=t,this.message=au(n,e)}Pn(Oi).from(In);function sr(n,e){this._e=an(),this.name="BulkError",this.failures=Object.keys(e).map(t=>e[t]),this.failuresByPos=e,this.message=au(n,e)}Pn(sr).from(In);var Jo=Yo.reduce((n,e)=>(n[e]=e+"Error",n),{}),ah=In,U=Yo.reduce((n,e)=>{var t=e+"Error";function r(i,s){this._e=an(),this.name=t,i?typeof i=="string"?(this.message=`${i}${s?`
 `+s:""}`,this.inner=s||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=oh[e]||t,this.inner=null)}return Pn(r).from(ah),n[e]=r,n},{});U.Syntax=SyntaxError;U.Type=TypeError;U.Range=RangeError;var Bl=ou.reduce((n,e)=>(n[e+"Error"]=U[e],n),{});function lh(n,e){if(!n||n instanceof In||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Bl[n.name])return n;var t=new Bl[n.name](e||n.message,n);return"stack"in n&&Et(t,"stack",{get:function(){return this.inner.stack}}),t}var Wi=Yo.reduce((n,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(n[e+"Error"]=U[e]),n),{});Wi.ModifyError=Oi;Wi.DexieError=In;Wi.BulkError=sr;function oe(){}function gr(n){return n}function uh(n,e){return n==null||n===gr?e:function(t){return e(n(t))}}function sn(n,e){return function(){n.apply(this,arguments),e.apply(this,arguments)}}function ch(n,e){return n===oe?e:function(){var t=n.apply(this,arguments);t!==void 0&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?sn(r,this.onsuccess):r),i&&(this.onerror=this.onerror?sn(i,this.onerror):i),s!==void 0?s:t}}function fh(n,e){return n===oe?e:function(){n.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?sn(t,this.onsuccess):t),r&&(this.onerror=this.onerror?sn(r,this.onerror):r)}}function dh(n,e){return n===oe?e:function(t){var r=n.apply(this,arguments);De(t,r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?sn(i,this.onsuccess):i),s&&(this.onerror=this.onerror?sn(s,this.onerror):s),r===void 0?o===void 0?void 0:o:De(r,o)}}function hh(n,e){return n===oe?e:function(){return e.apply(this,arguments)===!1?!1:n.apply(this,arguments)}}function Qo(n,e){return n===oe?e:function(){var t=n.apply(this,arguments);if(t&&typeof t.then=="function"){for(var r=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return t.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}var ur={},ph=100,mh=20,lu=100,[So,Ri,Ao]=typeof Promise=="undefined"?[]:(()=>{let n=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[n,lr(n),n];let e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,lr(e),n]})(),uu=Ri&&Ri.then,Fi=So&&So.constructor,Zo=!!Ao,To=!1,gh=Ao?()=>{Ao.then(Ei)}:fe.setImmediate?setImmediate.bind(null,Ei):fe.MutationObserver?()=>{var n=document.createElement("div");new MutationObserver(()=>{Ei(),n=null}).observe(n,{attributes:!0}),n.setAttribute("i","1")}:()=>{setTimeout(Ei,0)},cr=function(n,e){ir.push([n,e]),Li&&(gh(),Li=!1)},Co=!0,Li=!0,nn=[],Pi=[],Fo=null,Po=gr,Cn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Kl,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(n=>{try{Kl(n[0],n[1])}catch(e){}})}},K=Cn,ir=[],rn=0,Ii=[];function R(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=oe,this._lib=!1;var e=this._PSD=K;if(ht&&(this._stackHolder=an(),this._prev=null,this._numPrev=0),typeof n!="function"){if(n!==ur)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&ko(this,this._value);return}this._state=null,this._value=null,++e.ref,fu(this,n)}var Io={get:function(){var n=K,e=Ni;function t(r,i){var s=!n.global&&(n!==K||e!==Ni);let o=s&&!St();var a=new R((l,u)=>{ea(this,new cu(Bi(r,n,s,o),Bi(i,n,s,o),l,u,n))});return ht&&pu(a,this),a}return t.prototype=ur,t},set:function(n){Et(this,"then",n&&n.prototype===ur?Io:{get:function(){return n},set:Io.set})}};Fn(R.prototype,{then:Io,_then:function(n,e){ea(this,new cu(null,null,n,e,K))},catch:function(n){if(arguments.length===1)return this.then(null,n);var e=arguments[0],t=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?t(r):ki(r)):this.then(null,r=>r&&r.name===e?t(r):ki(r))},finally:function(n){return this.then(e=>(n(),e),e=>(n(),ki(e)))},stack:{get:function(){if(this._stack)return this._stack;try{To=!0;var n=hu(this,[],mh),e=n.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{To=!1}}},timeout:function(n,e){return n<1/0?new R((t,r)=>{var i=setTimeout(()=>r(new U.Timeout(e)),n);this.then(t,r).finally(clearTimeout.bind(null,i))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&Et(R.prototype,Symbol.toStringTag,"Dexie.Promise");Cn.env=mu();function cu(n,e,t,r,i){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof e=="function"?e:null,this.resolve=t,this.reject=r,this.psd=i}Fn(R,{all:function(){var n=bt.apply(null,arguments).map(ji);return new R(function(e,t){n.length===0&&e([]);var r=n.length;n.forEach((i,s)=>R.resolve(i).then(o=>{n[s]=o,--r||e(n)},t))})},resolve:n=>{if(n instanceof R)return n;if(n&&typeof n.then=="function")return new R((t,r)=>{n.then(t,r)});var e=new R(ur,!0,n);return pu(e,Fo),e},reject:ki,race:function(){var n=bt.apply(null,arguments).map(ji);return new R((e,t)=>{n.map(r=>R.resolve(r).then(e,t))})},PSD:{get:()=>K,set:n=>K=n},totalEchoes:{get:()=>Ni},newPSD:Rt,usePSD:Mn,scheduler:{get:()=>cr,set:n=>{cr=n}},rejectionMapper:{get:()=>Po,set:n=>{Po=n}},follow:(n,e)=>new R((t,r)=>Rt((i,s)=>{var o=K;o.unhandleds=[],o.onunhandled=s,o.finalize=sn(function(){vh(()=>{this.unhandleds.length===0?i():s(this.unhandleds[0])})},o.finalize),n()},e,t,r))});Fi&&(Fi.allSettled&&Et(R,"allSettled",function(){let n=bt.apply(null,arguments).map(ji);return new R(e=>{n.length===0&&e([]);let t=n.length,r=new Array(t);n.forEach((i,s)=>R.resolve(i).then(o=>r[s]={status:"fulfilled",value:o},o=>r[s]={status:"rejected",reason:o}).then(()=>--t||e(r)))})}),Fi.any&&typeof AggregateError!="undefined"&&Et(R,"any",function(){let n=bt.apply(null,arguments).map(ji);return new R((e,t)=>{n.length===0&&t(new AggregateError([]));let r=n.length,i=new Array(r);n.forEach((s,o)=>R.resolve(s).then(a=>e(a),a=>{i[o]=a,--r||t(new AggregateError(i))}))})}));function fu(n,e){try{e(t=>{if(n._state===null){if(t===n)throw new TypeError("A promise cannot be resolved with itself.");var r=n._lib&&yr();t&&typeof t.then=="function"?fu(n,(i,s)=>{t instanceof R?t._then(i,s):t.then(i,s)}):(n._state=!0,n._value=t,du(n)),r&&vr()}},ko.bind(null,n))}catch(t){ko(n,t)}}function ko(n,e){if(Pi.push(e),n._state===null){var t=n._lib&&yr();e=Po(e),n._state=!1,n._value=e,ht&&e!==null&&typeof e=="object"&&!e._promise&&Qd(()=>{var r=Go(e,"stack");e._promise=n,Et(e,"stack",{get:()=>To?r&&(r.get?r.get.apply(e):r.value):n.stack})}),_h(n),du(n),t&&vr()}}function du(n){var e=n._listeners;n._listeners=[];for(var t=0,r=e.length;t<r;++t)ea(n,e[t]);var i=n._PSD;--i.ref||i.finalize(),rn===0&&(++rn,cr(()=>{--rn===0&&ta()},[]))}function ea(n,e){if(n._state===null){n._listeners.push(e);return}var t=n._state?e.onFulfilled:e.onRejected;if(t===null)return(n._state?e.resolve:e.reject)(n._value);++e.psd.ref,++rn,cr(yh,[t,n,e])}function yh(n,e,t){try{Fo=e;var r,i=e._value;e._state?r=n(i):(Pi.length&&(Pi=[]),r=n(i),Pi.indexOf(i)===-1&&bh(e)),t.resolve(r)}catch(s){t.reject(s)}finally{Fo=null,--rn===0&&ta(),--t.psd.ref||t.psd.finalize()}}function hu(n,e,t){if(e.length===t)return e;var r="";if(n._state===!1){var i=n._value,s,o;i!=null?(s=i.name||"Error",o=i.message||i,r=Eo(i,0)):(s=i,o=""),e.push(s+(o?": "+o:"")+r)}return ht&&(r=Eo(n._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),n._prev&&hu(n._prev,e,t)),e}function pu(n,e){var t=e?e._numPrev+1:0;t<ph&&(n._prev=e,n._numPrev=t)}function Ei(){yr()&&vr()}function yr(){var n=Co;return Co=!1,Li=!1,n}function vr(){var n,e,t;do for(;ir.length>0;)for(n=ir,ir=[],t=n.length,e=0;e<t;++e){var r=n[e];r[0].apply(null,r[1])}while(ir.length>0);Co=!0,Li=!0}function ta(){var n=nn;nn=[],n.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=Ii.slice(0),t=e.length;t;)e[--t]()}function vh(n){function e(){n(),Ii.splice(Ii.indexOf(e),1)}Ii.push(e),++rn,cr(()=>{--rn===0&&ta()},[])}function _h(n){nn.some(e=>e._value===n._value)||nn.push(n)}function bh(n){for(var e=nn.length;e;)if(nn[--e]._value===n._value){nn.splice(e,1);return}}function ki(n){return new R(ur,!1,n)}function de(n,e){var t=K;return function(){var r=yr(),i=K;try{return Lt(t,!0),n.apply(this,arguments)}catch(s){e&&e(s)}finally{Lt(i,!1),r&&vr()}}}var Te={awaits:0,echoes:0,id:0},wh=0,Mi=[],po=0,Ni=0,xh=0;function Rt(n,e,t,r){var i=K,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++xh;var o=Cn.env;s.env=Zo?{Promise:R,PromiseProp:{value:R,configurable:!0,writable:!0},all:R.all,race:R.race,allSettled:R.allSettled,any:R.any,resolve:R.resolve,reject:R.reject,nthen:zl(o.nthen,s),gthen:zl(o.gthen,s)}:{},e&&De(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Mn(s,n,t,r);return s.ref===0&&s.finalize(),a}function kn(){return Te.id||(Te.id=++wh),++Te.awaits,Te.echoes+=lu,Te.id}function St(){return Te.awaits?(--Te.awaits===0&&(Te.id=0),Te.echoes=Te.awaits*lu,!0):!1}(""+uu).indexOf("[native code]")===-1&&(kn=St=oe);function ji(n){return Te.echoes&&n&&n.constructor===Fi?(kn(),n.then(e=>(St(),e),e=>(St(),ve(e)))):n}function Eh(n){++Ni,(!Te.echoes||--Te.echoes===0)&&(Te.echoes=Te.id=0),Mi.push(K),Lt(n,!0)}function Sh(){var n=Mi[Mi.length-1];Mi.pop(),Lt(n,!1)}function Lt(n,e){var t=K;if((e?Te.echoes&&(!po++||n!==K):po&&(!--po||n!==K))&&gu(e?Eh.bind(null,n):Sh),n!==K&&(K=n,t===Cn&&(Cn.env=mu()),Zo)){var r=Cn.env.Promise,i=n.env;Ri.then=i.nthen,r.prototype.then=i.gthen,(t.global||n.global)&&(Object.defineProperty(fe,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function mu(){var n=fe.Promise;return Zo?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(fe,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject,nthen:Ri.then,gthen:n.prototype.then}:{}}function Mn(n,e,t,r,i){var s=K;try{return Lt(n,!0),e(t,r,i)}finally{Lt(s,!1)}}function gu(n){uu.call(So,n)}function Bi(n,e,t,r){return typeof n!="function"?n:function(){var i=K;t&&kn(),Lt(e,!0);try{return n.apply(this,arguments)}finally{Lt(i,!1),r&&gu(St)}}}function zl(n,e){return function(t,r){return n.call(this,Bi(t,e),Bi(r,e))}}var Vl="unhandledrejection";function Kl(n,e){var t;try{t=e.onuncatched(n)}catch(s){}if(t!==!1)try{var r,i={promise:e,reason:n};if(fe.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Vl,!0,!0),De(r,i)):fe.CustomEvent&&(r=new CustomEvent(Vl,{detail:i}),De(r,i)),r&&fe.dispatchEvent&&(dispatchEvent(r),!fe.PromiseRejectionEvent&&fe.onunhandledrejection))try{fe.onunhandledrejection(r)}catch(s){}ht&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${n.stack||n}`)}catch(s){}}var ve=R.reject;function Mo(n,e,t,r){if(!n.idbdb||!n._state.openComplete&&!K.letThrough&&!n._vip){if(n._state.openComplete)return ve(new U.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen)return ve(new U.DatabaseClosed);n.open().catch(oe)}return n._state.dbReadyPromise.then(()=>Mo(n,e,t,r))}else{var i=n._createTransaction(e,t,n._dbSchema);try{i.create(),n._state.PR1398_maxLoop=3}catch(s){return s.name===Jo.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n._close(),n.open().then(()=>Mo(n,e,t,r))):ve(s)}return i._promise(e,(s,o)=>Rt(()=>(K.trans=i,r(s,o,i)))).then(s=>i._completion.then(()=>s))}}var $l="3.2.4",tn=String.fromCharCode(65535),Do=-1/0,vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yu="String expected.",or=[],qi=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ah=qi,Th=qi,vu=n=>!/(dexie\.js|dexie\.min\.js)/.test(n),Hi="__dbnames",mo="readonly",go="readwrite";function on(n,e){return n?e?function(){return n.apply(this,arguments)&&e.apply(this,arguments)}:n:e}var _u={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Si(n){return typeof n=="string"&&!/\./.test(n)?e=>(e[n]===void 0&&n in e&&(e=mr(e),delete e[n]),e):e=>e}var Oo=class{_trans(e,t,r){let i=this._tx||K.trans,s=this.name;function o(l,u,c){if(!c.schema[s])throw new U.NotFound("Table "+s+" not part of transaction");return t(c.idbtrans,c)}let a=yr();try{return i&&i.db===this.db?i===K.trans?i._promise(e,o,r):Rt(()=>i._promise(e,o,r),{trans:i,transless:K.transless||K}):Mo(this.db,e,[this.name],o)}finally{a&&vr()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(i=>this.hook.reading.fire(i))).then(t)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Ce(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);let t=me(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);let r=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&t.every(c=>u.keyPath.indexOf(c)>=0)&&u.keyPath.every(c=>t.indexOf(c)>=0))[0];if(r&&this.db._maxKey!==tn)return this.where(r.name).equals(r.keyPath.map(u=>e[u]));!r&&ht&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);let{idxByName:i}=this.schema,s=this.db._deps.indexedDB;function o(u,c){try{return s.cmp(u,c)===0}catch(h){return!1}}let[a,l]=t.reduce(([u,c],h)=>{let f=i[h],d=e[h];return[u||f,u||!f?on(c,f&&f.multi?p=>{let m=xt(p,h);return Ce(m)&&m.some(g=>o(d,g))}:p=>o(d,xt(p,h))):c]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Ce(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;let t=r=>{if(!r)return r;let i=Object.create(e.prototype);for(var s in r)if(Ue(r,s))try{i[s]=r[s]}catch(o){}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){function e(t){De(this,t)}return this.mapToClass(e)}add(e,t){let{auto:r,keyPath:i}=this.schema.primKey,s=e;return i&&r&&(s=Si(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:t!=null?[t]:null,values:[s]})).then(o=>o.numFailures?R.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{st(e,i,o)}catch(a){}return o})}update(e,t){if(typeof e=="object"&&!Ce(e)){let r=xt(e,this.schema.primKey.keyPath);if(r===void 0)return ve(new U.InvalidArgument("Given object does not contain its primary key"));try{typeof t!="function"?me(t).forEach(i=>{st(e,i,t[i])}):t(e,{value:e,primKey:r})}catch(i){}return this.where(":id").equals(r).modify(t)}else return this.where(":id").equals(e).modify(t)}put(e,t){let{auto:r,keyPath:i}=this.schema.primKey,s=e;return i&&r&&(s=Si(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[s],keys:t!=null?[t]:null})).then(o=>o.numFailures?R.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{st(e,i,o)}catch(a){}return o})}delete(e){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"delete",keys:[e]})).then(t=>t.numFailures?R.reject(t.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:_u})).then(e=>e.numFailures?R.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",t=>this.core.getMany({keys:e,trans:t}).then(r=>r.map(i=>this.hook.reading.fire(i))))}bulkAdd(e,t,r){let i=Array.isArray(t)?t:void 0;r=r||(i?void 0:t);let s=r?r.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:a,keyPath:l}=this.schema.primKey;if(l&&i)throw new U.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");let u=e.length,c=l&&a?e.map(Si(l)):e;return this.core.mutate({trans:o,type:"add",keys:i,values:c,wantResults:s}).then(({numFailures:h,results:f,lastResult:d,failures:p})=>{let m=s?f:d;if(h===0)return m;throw new sr(`${this.name}.bulkAdd(): ${h} of ${u} operations failed`,p)})})}bulkPut(e,t,r){let i=Array.isArray(t)?t:void 0;r=r||(i?void 0:t);let s=r?r.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:a,keyPath:l}=this.schema.primKey;if(l&&i)throw new U.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");let u=e.length,c=l&&a?e.map(Si(l)):e;return this.core.mutate({trans:o,type:"put",keys:i,values:c,wantResults:s}).then(({numFailures:h,results:f,lastResult:d,failures:p})=>{let m=s?f:d;if(h===0)return m;throw new sr(`${this.name}.bulkPut(): ${h} of ${u} operations failed`,p)})})}bulkDelete(e){let t=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:i,failures:s})=>{if(r===0)return i;throw new sr(`${this.name}.bulkDelete(): ${r} of ${t} operations failed`,s)})}};function _r(n){var e={},t=function(a,l){if(l){for(var u=arguments.length,c=new Array(u-1);--u;)c[u-1]=arguments[u];return e[a].subscribe.apply(null,c),n}else if(typeof a=="string")return e[a]};t.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return t;function s(a,l,u){if(typeof a=="object")return o(a);l||(l=hh),u||(u=oe);var c={subscribers:[],fire:u,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=l(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(f){return f!==h}),c.fire=c.subscribers.reduce(l,u)}};return e[a]=t[a]=c,c}function o(a){me(a).forEach(function(l){var u=a[l];if(Ce(u))s(l,a[l][0],a[l][1]);else if(u==="asap")var c=s(l,gr,function(){for(var f=arguments.length,d=new Array(f);f--;)d[f]=arguments[f];c.subscribers.forEach(function(p){Zl(function(){p.apply(null,d)})})});else throw new U.InvalidArgument("Invalid event config")})}}function br(n,e){return Pn(e).from({prototype:n}),e}function Ch(n){return br(Oo.prototype,function(t,r,i){this.db=n,this._tx=i,this.name=t,this.schema=r,this.hook=n._allTables[t]?n._allTables[t].hook:_r(null,{creating:[ch,oe],reading:[uh,gr],updating:[dh,oe],deleting:[fh,oe]})})}function Sn(n,e){return!(n.filter||n.algorithm||n.or)&&(e?n.justLimit:!n.replayFilter)}function yo(n,e){n.filter=on(n.filter,e)}function vo(n,e,t){var r=n.replayFilter;n.replayFilter=r?()=>on(r(),e()):e,n.justLimit=t&&!r}function Fh(n,e){n.isMatch=on(n.isMatch,e)}function Di(n,e){if(n.isPrimKey)return e.primaryKey;let t=e.getIndexByKeyPath(n.index);if(!t)throw new U.Schema("KeyPath "+n.index+" on object store "+e.name+" is not indexed");return t}function Ul(n,e,t){let r=Di(n,e.schema);return e.openCursor({trans:t,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:r,range:n.range}})}function Ai(n,e,t,r){let i=n.replayFilter?on(n.filter,n.replayFilter()):n.filter;if(n.or){let s={},o=(a,l,u)=>{if(!i||i(l,u,f=>l.stop(f),f=>l.fail(f))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),Ue(s,h)||(s[h]=!0,e(a,l,u))}};return Promise.all([n.or._iterate(o,t),Wl(Ul(n,r,t),n.algorithm,o,!n.keysOnly&&n.valueMapper)])}else return Wl(Ul(n,r,t),on(n.algorithm,i),e,!n.keysOnly&&n.valueMapper)}function Wl(n,e,t,r){var i=r?(o,a,l)=>t(r(o),a,l):t,s=de(i);return n.then(o=>{if(o)return o.start(()=>{var a=()=>o.continue();(!e||e(o,l=>a=l,l=>{o.stop(l),a=oe},l=>{o.fail(l),a=oe}))&&s(o.value,o,l=>a=l),a()})})}function Me(n,e){try{let t=ql(n),r=ql(e);if(t!==r)return t==="Array"?1:r==="Array"?-1:t==="binary"?1:r==="binary"?-1:t==="string"?1:r==="string"?-1:t==="Date"?1:r!=="Date"?NaN:-1;switch(t){case"number":case"Date":case"string":return n>e?1:n<e?-1:0;case"binary":return Ih(Hl(n),Hl(e));case"Array":return Ph(n,e)}}catch(t){}return NaN}function Ph(n,e){let t=n.length,r=e.length,i=t<r?t:r;for(let s=0;s<i;++s){let o=Me(n[s],e[s]);if(o!==0)return o}return t===r?0:t<r?-1:1}function Ih(n,e){let t=n.length,r=e.length,i=t<r?t:r;for(let s=0;s<i;++s)if(n[s]!==e[s])return n[s]<e[s]?-1:1;return t===r?0:t<r?-1:1}function ql(n){let e=typeof n;if(e!=="object")return e;if(ArrayBuffer.isView(n))return"binary";let t=wo(n);return t==="ArrayBuffer"?"binary":t}function Hl(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var Ro=class{_read(e,t){var r=this._ctx;return r.error?r.table._trans(null,ve.bind(null,r.error)):r.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,ve.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=on(t.algorithm,e)}_iterate(e,t){return Ai(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&De(r,e),t._ctx=r,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read(r=>Ai(t,e,r,t.table.core))}count(e){return this._read(t=>{let r=this._ctx,i=r.table.core;if(Sn(r,!0))return i.count({trans:t,query:{index:Di(r,i.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var s=0;return Ai(r,()=>(++s,!1),t,i).then(()=>s)}).then(e)}sortBy(e,t){let r=e.split(".").reverse(),i=r[0],s=r.length-1;function o(u,c){return c?o(u[r[c]],c-1):u[i]}var a=this._ctx.dir==="next"?1:-1;function l(u,c){var h=o(u,s),f=o(c,s);return h<f?-a:h>f?a:0}return this.toArray(function(u){return u.sort(l)}).then(t)}toArray(e){return this._read(t=>{var r=this._ctx;if(r.dir==="next"&&Sn(r,!0)&&r.limit>0){let{valueMapper:i}=r,s=Di(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:o})=>i?o.map(i):o)}else{let i=[];return Ai(r,s=>i.push(s),t,r.table.core).then(()=>i)}},e)}offset(e){var t=this._ctx;return e<=0?this:(t.offset+=e,Sn(t)?vo(t,()=>{var r=e;return(i,s)=>r===0?!0:r===1?(--r,!1):(s(()=>{i.advance(r),r=0}),!1)}):vo(t,()=>{var r=e;return()=>--r<0}),this)}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),vo(this._ctx,()=>{var t=e;return function(r,i,s){return--t<=0&&i(s),t>=0}},!0),this}until(e,t){return yo(this._ctx,function(r,i,s){return e(r.value)?(i(s),t):!0}),this}first(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){return yo(this._ctx,function(t){return e(t.value)}),Fh(this._ctx,e),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.key,i)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){e(i.primaryKey,i)})}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var t=this._ctx;if(t.dir==="next"&&Sn(t,!0)&&t.limit>0)return this._read(i=>{var s=Di(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(({result:i})=>i).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(t){return t[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var r={};return yo(this._ctx,function(i){var s=i.primaryKey.toString(),o=Ue(r,s);return r[s]=!0,!o}),this}modify(e){var t=this._ctx;return this._write(r=>{var i;if(typeof e=="function")i=e;else{var s=me(e),o=s.length;i=function(m){for(var g=!1,y=0;y<o;++y){var _=s[y],x=e[_];xt(m,_)!==x&&(st(m,_,x),g=!0)}return g}}let a=t.table.core,{outbound:l,extractKey:u}=a.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[],f=0,d=[],p=(m,g)=>{let{failures:y,numFailures:_}=g;f+=m-_;for(let x of me(y))h.push(y[x])};return this.clone().primaryKeys().then(m=>{let g=y=>{let _=Math.min(c,m.length-y);return a.getMany({trans:r,keys:m.slice(y,y+_),cache:"immutable"}).then(x=>{let w=[],S=[],A=l?[]:null,T=[];for(let M=0;M<_;++M){let j=x[M],O={value:mr(j),primKey:m[y+M]};i.call(O,O.value,O)!==!1&&(O.value==null?T.push(m[y+M]):!l&&Me(u(j),u(O.value))!==0?(T.push(m[y+M]),w.push(O.value)):(S.push(O.value),l&&A.push(m[y+M])))}let I=Sn(t)&&t.limit===1/0&&(typeof e!="function"||e===_o)&&{index:t.index,range:t.range};return Promise.resolve(w.length>0&&a.mutate({trans:r,type:"add",values:w}).then(M=>{for(let j in M.failures)T.splice(parseInt(j),1);p(w.length,M)})).then(()=>(S.length>0||I&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:A,values:S,criteria:I,changeSpec:typeof e!="function"&&e}).then(M=>p(S.length,M))).then(()=>(T.length>0||I&&e===_o)&&a.mutate({trans:r,type:"delete",keys:T,criteria:I}).then(M=>p(T.length,M))).then(()=>m.length>y+_&&g(y+c))})};return g(0).then(()=>{if(h.length>0)throw new Oi("Error modifying one or more objects",h,f,d);return m.length})})})}delete(){var e=this._ctx,t=e.range;return Sn(e)&&(e.isPrimKey&&!Th||t.type===3)?this._write(r=>{let{primaryKey:i}=e.table.core.schema,s=t;return e.table.core.count({trans:r,query:{index:i,range:s}}).then(o=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:a,lastResult:l,results:u,numFailures:c})=>{if(c)throw new Oi("Could not delete some values",Object.keys(a).map(h=>a[h]),o-c);return o-c}))}):this.modify(_o)}},_o=(n,e)=>e.value=null;function kh(n){return br(Ro.prototype,function(t,r){this.db=n;let i=_u,s=null;if(r)try{i=r()}catch(u){s=u}let o=t._ctx,a=o.table,l=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:o.or,valueMapper:l!==gr?l:null}})}function Mh(n,e){return n<e?-1:n===e?0:1}function Dh(n,e){return n>e?-1:n===e?0:1}function $e(n,e,t){var r=n instanceof zi?new n.Collection(n):n;return r._ctx.error=t?new t(e):new TypeError(e),r}function An(n){return new n.Collection(n,()=>bu("")).limit(0)}function Oh(n){return n==="next"?e=>e.toUpperCase():e=>e.toLowerCase()}function Rh(n){return n==="next"?e=>e.toLowerCase():e=>e.toUpperCase()}function Lh(n,e,t,r,i,s){for(var o=Math.min(n.length,r.length),a=-1,l=0;l<o;++l){var u=e[l];if(u!==r[l])return i(n[l],t[l])<0?n.substr(0,l)+t[l]+t.substr(l+1):i(n[l],r[l])<0?n.substr(0,l)+r[l]+t.substr(l+1):a>=0?n.substr(0,a)+e[a]+t.substr(a+1):null;i(n[l],u)<0&&(a=l)}return o<r.length&&s==="next"?n+t.substr(n.length):o<n.length&&s==="prev"?n.substr(0,t.length):a<0?null:n.substr(0,a)+r[a]+t.substr(a+1)}function Ti(n,e,t,r){var i,s,o,a,l,u,c,h=t.length;if(!t.every(m=>typeof m=="string"))return $e(n,yu);function f(m){i=Oh(m),s=Rh(m),o=m==="next"?Mh:Dh;var g=t.map(function(y){return{lower:s(y),upper:i(y)}}).sort(function(y,_){return o(y.lower,_.lower)});a=g.map(function(y){return y.upper}),l=g.map(function(y){return y.lower}),u=m,c=m==="next"?"":r}f("next");var d=new n.Collection(n,()=>Mt(a[0],l[h-1]+r));d._ondirectionchange=function(m){f(m)};var p=0;return d._addAlgorithm(function(m,g,y){var _=m.key;if(typeof _!="string")return!1;var x=s(_);if(e(x,l,p))return!0;for(var w=null,S=p;S<h;++S){var A=Lh(_,x,a[S],l[S],o,u);A===null&&w===null?p=S+1:(w===null||o(w,A)>0)&&(w=A)}return g(w!==null?function(){m.continue(w+c)}:y),!1}),d}function Mt(n,e,t,r){return{type:2,lower:n,upper:e,lowerOpen:t,upperOpen:r}}function bu(n){return{type:1,lower:n,upper:n}}var zi=class{get Collection(){return this._ctx.table.db.Collection}between(e,t,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,t)>0||this._cmp(e,t)===0&&(r||i)&&!(r&&i)?An(this):new this.Collection(this,()=>Mt(e,t,!r,!i))}catch(s){return $e(this,vt)}}equals(e){return e==null?$e(this,vt):new this.Collection(this,()=>bu(e))}above(e){return e==null?$e(this,vt):new this.Collection(this,()=>Mt(e,void 0,!0))}aboveOrEqual(e){return e==null?$e(this,vt):new this.Collection(this,()=>Mt(e,void 0,!1))}below(e){return e==null?$e(this,vt):new this.Collection(this,()=>Mt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?$e(this,vt):new this.Collection(this,()=>Mt(void 0,e))}startsWith(e){return typeof e!="string"?$e(this,yu):this.between(e,e+tn,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Ti(this,(t,r)=>t.indexOf(r[0])===0,[e],tn)}equalsIgnoreCase(e){return Ti(this,(t,r)=>t===r[0],[e],"")}anyOfIgnoreCase(){var e=bt.apply(Tn,arguments);return e.length===0?An(this):Ti(this,(t,r)=>r.indexOf(t)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=bt.apply(Tn,arguments);return e.length===0?An(this):Ti(this,(t,r)=>r.some(i=>t.indexOf(i)===0),e,tn)}anyOf(){let e=bt.apply(Tn,arguments),t=this._cmp;try{e.sort(t)}catch(s){return $e(this,vt)}if(e.length===0)return An(this);let r=new this.Collection(this,()=>Mt(e[0],e[e.length-1]));r._ondirectionchange=s=>{t=s==="next"?this._ascending:this._descending,e.sort(t)};let i=0;return r._addAlgorithm((s,o,a)=>{let l=s.key;for(;t(l,e[i])>0;)if(++i,i===e.length)return o(a),!1;return t(l,e[i])===0?!0:(o(()=>{s.continue(e[i])}),!1)}),r}notEqual(e){return this.inAnyRange([[Do,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){let e=bt.apply(Tn,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch(r){return $e(this,vt)}let t=e.reduce((r,i)=>r?r.concat([[r[r.length-1][1],i]]):[[Do,i]],null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){let r=this._cmp,i=this._ascending,s=this._descending,o=this._min,a=this._max;if(e.length===0)return An(this);if(!e.every(w=>w[0]!==void 0&&w[1]!==void 0&&i(w[0],w[1])<=0))return $e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",U.InvalidArgument);let l=!t||t.includeLowers!==!1,u=t&&t.includeUppers===!0;function c(w,S){let A=0,T=w.length;for(;A<T;++A){let I=w[A];if(r(S[0],I[1])<0&&r(S[1],I[0])>0){I[0]=o(I[0],S[0]),I[1]=a(I[1],S[1]);break}}return A===T&&w.push(S),w}let h=i;function f(w,S){return h(w[0],S[0])}let d;try{d=e.reduce(c,[]),d.sort(f)}catch(w){return $e(this,vt)}let p=0,m=u?w=>i(w,d[p][1])>0:w=>i(w,d[p][1])>=0,g=l?w=>s(w,d[p][0])>0:w=>s(w,d[p][0])>=0;function y(w){return!m(w)&&!g(w)}let _=m,x=new this.Collection(this,()=>Mt(d[0][0],d[d.length-1][1],!l,!u));return x._ondirectionchange=w=>{w==="next"?(_=m,h=i):(_=g,h=s),d.sort(f)},x._addAlgorithm((w,S,A)=>{for(var T=w.key;_(T);)if(++p,p===d.length)return S(A),!1;return y(T)?!0:(this._cmp(T,d[p][1])===0||this._cmp(T,d[p][0])===0||S(()=>{h===i?w.continue(d[p][0]):w.continue(d[p][1])}),!1)}),x}startsWithAnyOf(){let e=bt.apply(Tn,arguments);return e.every(t=>typeof t=="string")?e.length===0?An(this):this.inAnyRange(e.map(t=>[t,t+tn])):$e(this,"startsWithAnyOf() only works with strings")}};function Nh(n){return br(zi.prototype,function(t,r,i){this.db=n,this._ctx={table:t,index:r===":id"?null:r,or:i};let s=n._deps.indexedDB;if(!s)throw new U.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=(o,a)=>s.cmp(a,o),this._max=(o,a)=>s.cmp(o,a)>0?o:a,this._min=(o,a)=>s.cmp(o,a)<0?o:a,this._IDBKeyRange=n._deps.IDBKeyRange})}function dt(n){return de(function(e){return fr(e),n(e.target.error),!1})}function fr(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var dr="storagemutated",Ot="x-storagemutated-1",Nt=_r(null,dr),Lo=class{_lock(){return rr(!K.global),++this._reculock,this._reculock===1&&!K.global&&(K.lockOwnerFor=this),this}_unlock(){if(rr(!K.global),--this._reculock===0)for(K.global||(K.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Mn(e[1],e[0])}catch(t){}}return this}_locked(){return this._reculock&&K.lockOwnerFor!==this}create(e){if(!this.mode)return this;let t=this.db.idbdb,r=this.db._state.dbOpenError;if(rr(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new U.DatabaseClosed(r);case"MissingAPIError":throw new U.MissingAPI(r.message,r);default:throw new U.OpenFailed(r)}if(!this.active)throw new U.TransactionInactive;return rr(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=de(i=>{fr(i),this._reject(e.error)}),e.onabort=de(i=>{fr(i),this.active&&this._reject(new U.Abort(e.error)),this.active=!1,this.on("abort").fire(i)}),e.oncomplete=de(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Nt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,t,r){if(e==="readwrite"&&this.mode!=="readwrite")return ve(new U.ReadOnly("Transaction is readonly"));if(!this.active)return ve(new U.TransactionInactive);if(this._locked())return new R((s,o)=>{this._blockedFuncs.push([()=>{this._promise(e,t,r).then(s,o)},K])});if(r)return Rt(()=>{var s=new R((o,a)=>{this._lock();let l=t(o,a,this);l&&l.then&&l.then(o,a)});return s.finally(()=>this._unlock()),s._lib=!0,s});var i=new R((s,o)=>{var a=t(s,o,this);a&&a.then&&a.then(s,o)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();let r=R.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(()=>r);else{t._waitingFor=r,t._waitingQueue=[];var i=t.idbtrans.objectStore(t.storeNames[0]);(function o(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var s=t._waitingFor;return new R((o,a)=>{r.then(l=>t._waitingQueue.push(de(o.bind(null,l))),l=>t._waitingQueue.push(de(a.bind(null,l)))).finally(()=>{t._waitingFor===s&&(t._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new U.Abort))}table(e){let t=this._memoizedTables||(this._memoizedTables={});if(Ue(t,e))return t[e];let r=this.schema[e];if(!r)throw new U.NotFound("Table "+e+" not part of transaction");let i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),t[e]=i,i}};function jh(n){return br(Lo.prototype,function(t,r,i,s,o){this.db=n,this.mode=t,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=_r(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new R((a,l)=>{this._resolve=a,this._reject=l}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},a=>{var l=this.active;return this.active=!1,this.on.error.fire(a),this.parent?this.parent._reject(a):l&&this.idbtrans&&this.idbtrans.abort(),ve(a)})})}function No(n,e,t,r,i,s,o){return{name:n,keyPath:e,unique:t,multi:r,auto:i,compound:s,src:(t&&!o?"&":"")+(r?"*":"")+(i?"++":"")+wu(e)}}function wu(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function xu(n,e,t){return{name:n,primKey:e,indexes:t,mappedClass:null,idxByName:eu(t,r=>[r.name,r])}}function Bh(n){return n.length===1?n[0]:n}var hr=n=>{try{return n.only([[]]),hr=()=>[[]],[[]]}catch(e){return hr=()=>tn,tn}};function jo(n){return n==null?()=>{}:typeof n=="string"?zh(n):e=>xt(e,n)}function zh(n){return n.split(".").length===1?t=>t[n]:t=>xt(t,n)}function Gl(n){return[].slice.call(n)}var Vh=0;function ar(n){return n==null?":id":typeof n=="string"?n:`[${n.join("+")}]`}function Kh(n,e,t){function r(c,h){let f=Gl(c.objectStoreNames);return{schema:{name:c.name,tables:f.map(d=>h.objectStore(d)).map(d=>{let{keyPath:p,autoIncrement:m}=d,g=Ce(p),y=p==null,_={},x={name:d.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y,compound:g,keyPath:p,autoIncrement:m,unique:!0,extractKey:jo(p)},indexes:Gl(d.indexNames).map(w=>d.index(w)).map(w=>{let{name:S,unique:A,multiEntry:T,keyPath:I}=w,M=Ce(I),j={name:S,compound:M,keyPath:I,unique:A,multiEntry:T,extractKey:jo(I)};return _[ar(I)]=j,j}),getIndexByKeyPath:w=>_[ar(w)]};return _[":id"]=x.primaryKey,p!=null&&(_[ar(p)]=x.primaryKey),x})},hasGetAll:f.length>0&&"getAll"in h.objectStore(f[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");let{lower:h,upper:f,lowerOpen:d,upperOpen:p}=c;return h===void 0?f===void 0?null:e.upperBound(f,!!p):f===void 0?e.lowerBound(h,!!d):e.bound(h,f,!!d,!!p)}function s(c){let h=c.name;function f({trans:m,type:g,keys:y,values:_,range:x}){return new Promise((w,S)=>{w=de(w);let A=m.objectStore(h),T=A.keyPath==null,I=g==="put"||g==="add";if(!I&&g!=="delete"&&g!=="deleteRange")throw new Error("Invalid operation type: "+g);let{length:M}=y||_||{length:1};if(y&&_&&y.length!==_.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let j,O=[],L=[],k=0,B=G=>{++k,fr(G)};if(g==="deleteRange"){if(x.type===4)return w({numFailures:k,failures:L,results:[],lastResult:void 0});x.type===3?O.push(j=A.clear()):O.push(j=A.delete(i(x)))}else{let[G,Z]=I?T?[_,y]:[_,null]:[y,null];if(I)for(let ne=0;ne<M;++ne)O.push(j=Z&&Z[ne]!==void 0?A[g](G[ne],Z[ne]):A[g](G[ne])),j.onerror=B;else for(let ne=0;ne<M;++ne)O.push(j=A[g](G[ne])),j.onerror=B}let Q=G=>{let Z=G.target.result;O.forEach((ne,he)=>ne.error!=null&&(L[he]=ne.error)),w({numFailures:k,failures:L,results:g==="delete"?y:O.map(ne=>ne.result),lastResult:Z})};j.onerror=G=>{B(G),Q(G)},j.onsuccess=Q})}function d({trans:m,values:g,query:y,reverse:_,unique:x}){return new Promise((w,S)=>{w=de(w);let{index:A,range:T}=y,I=m.objectStore(h),M=A.isPrimaryKey?I:I.index(A.name),j=_?x?"prevunique":"prev":x?"nextunique":"next",O=g||!("openKeyCursor"in M)?M.openCursor(i(T),j):M.openKeyCursor(i(T),j);O.onerror=dt(S),O.onsuccess=de(L=>{let k=O.result;if(!k){w(null);return}k.___id=++Vh,k.done=!1;let B=k.continue.bind(k),Q=k.continuePrimaryKey;Q&&(Q=Q.bind(k));let G=k.advance.bind(k),Z=()=>{throw new Error("Cursor not started")},ne=()=>{throw new Error("Cursor not stopped")};k.trans=m,k.stop=k.continue=k.continuePrimaryKey=k.advance=Z,k.fail=de(S),k.next=function(){let he=1;return this.start(()=>he--?this.continue():this.stop()).then(()=>this)},k.start=he=>{let lt=new Promise((P,z)=>{P=de(P),O.onerror=dt(z),k.fail=z,k.stop=W=>{k.stop=k.continue=k.continuePrimaryKey=k.advance=ne,P(W)}}),ee=()=>{if(O.result)try{he()}catch(P){k.fail(P)}else k.done=!0,k.start=()=>{throw new Error("Cursor behind last entry")},k.stop()};return O.onsuccess=de(P=>{O.onsuccess=ee,ee()}),k.continue=B,k.continuePrimaryKey=Q,k.advance=G,ee(),lt},w(k)},S)})}function p(m){return g=>new Promise((y,_)=>{y=de(y);let{trans:x,values:w,limit:S,query:A}=g,T=S===1/0?void 0:S,{index:I,range:M}=A,j=x.objectStore(h),O=I.isPrimaryKey?j:j.index(I.name),L=i(M);if(S===0)return y({result:[]});if(m){let k=w?O.getAll(L,T):O.getAllKeys(L,T);k.onsuccess=B=>y({result:B.target.result}),k.onerror=dt(_)}else{let k=0,B=w||!("openKeyCursor"in O)?O.openCursor(L):O.openKeyCursor(L),Q=[];B.onsuccess=G=>{let Z=B.result;if(!Z)return y({result:Q});if(Q.push(w?Z.value:Z.primaryKey),++k===S)return y({result:Q});Z.continue()},B.onerror=dt(_)}})}return{name:h,schema:c,mutate:f,getMany({trans:m,keys:g}){return new Promise((y,_)=>{y=de(y);let x=m.objectStore(h),w=g.length,S=new Array(w),A=0,T=0,I,M=O=>{let L=O.target;(S[L._pos]=L.result)!=null,++T===A&&y(S)},j=dt(_);for(let O=0;O<w;++O)g[O]!=null&&(I=x.get(g[O]),I._pos=O,I.onsuccess=M,I.onerror=j,++A);A===0&&y(S)})},get({trans:m,key:g}){return new Promise((y,_)=>{y=de(y);let w=m.objectStore(h).get(g);w.onsuccess=S=>y(S.target.result),w.onerror=dt(_)})},query:p(a),openCursor:d,count({query:m,trans:g}){let{index:y,range:_}=m;return new Promise((x,w)=>{let S=g.objectStore(h),A=y.isPrimaryKey?S:S.index(y.name),T=i(_),I=T?A.count(T):A.count();I.onsuccess=de(M=>x(M.target.result)),I.onerror=dt(w)})}}}let{schema:o,hasGetAll:a}=r(n,t),l=o.tables.map(c=>s(c)),u={};return l.forEach(c=>u[c.name]=c),{stack:"dbcore",transaction:n.transaction.bind(n),table(c){if(!u[c])throw new Error(`Table '${c}' not found`);return u[c]},MIN_KEY:-1/0,MAX_KEY:hr(e),schema:o}}function $h(n,e){return e.reduce((t,{create:r})=>({...t,...r(t)}),n)}function Uh(n,e,{IDBKeyRange:t,indexedDB:r},i){return{dbcore:$h(Kh(e,t,i),n.dbcore)}}function na({_novip:n},e){let t=e.db,r=Uh(n._middlewares,t,n._deps,e);n.core=r.dbcore,n.tables.forEach(i=>{let s=i.name;n.core.schema.tables.some(o=>o.name===s)&&(i.core=n.core.table(s),n[s]instanceof n.Table&&(n[s].core=i.core))})}function Vi({_novip:n},e,t,r){t.forEach(i=>{let s=r[i];e.forEach(o=>{let a=Go(o,i);(!a||"value"in a&&a.value===void 0)&&(o===n.Transaction.prototype||o instanceof n.Transaction?Et(o,i,{get(){return this.table(i)},set(l){Jl(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new n.Table(i,s))})})}function Bo({_novip:n},e){e.forEach(t=>{for(let r in t)t[r]instanceof n.Table&&delete t[r]})}function Wh(n,e){return n._cfg.version-e._cfg.version}function qh(n,e,t,r){let i=n._dbSchema,s=n._createTransaction("readwrite",n._storeNames,i);s.create(t),s._completion.catch(r);let o=s._reject.bind(s),a=K.transless||K;Rt(()=>{K.trans=s,K.transless=a,e===0?(me(i).forEach(l=>{ra(t,l,i[l].primKey,i[l].indexes)}),na(n,t),R.follow(()=>n.on.populate.fire(s)).catch(o)):Hh(n,e,s,t).catch(o)})}function Hh({_novip:n},e,t,r){let i=[],s=n._versions,o=n._dbSchema=ia(n,n.idbdb,r),a=!1;s.filter(c=>c._cfg.version>=e).forEach(c=>{i.push(()=>{let h=o,f=c._cfg.dbschema;Vo(n,h,r),Vo(n,f,r),o=n._dbSchema=f;let d=Eu(h,f);d.add.forEach(m=>{ra(r,m[0],m[1].primKey,m[1].indexes)}),d.change.forEach(m=>{if(m.recreate)throw new U.Upgrade("Not yet support for changing primary key");{let g=r.objectStore(m.name);m.add.forEach(y=>zo(g,y)),m.change.forEach(y=>{g.deleteIndex(y.name),zo(g,y)}),m.del.forEach(y=>g.deleteIndex(y))}});let p=c._cfg.contentUpgrade;if(p&&c._cfg.version>e){na(n,r),t._memoizedTables={},a=!0;let m=tu(f);d.del.forEach(x=>{m[x]=h[x]}),Bo(n,[n.Transaction.prototype]),Vi(n,[n.Transaction.prototype],me(m),m),t.schema=m;let g=Xo(p);g&&kn();let y,_=R.follow(()=>{if(y=p(t),y&&g){var x=St.bind(null,null);y.then(x,x)}});return y&&typeof y.then=="function"?R.resolve(y):_.then(()=>y)}}),i.push(h=>{if(!a||!Ah){let f=c._cfg.dbschema;Xh(f,h)}Bo(n,[n.Transaction.prototype]),Vi(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),t.schema=n._dbSchema})});function u(){return i.length?R.resolve(i.shift()(t.idbtrans)).then(u):R.resolve()}return u().then(()=>{Gh(o,r)})}function Eu(n,e){let t={del:[],add:[],change:[]},r;for(r in n)e[r]||t.del.push(r);for(r in e){let i=n[r],s=e[r];if(!i)t.add.push([r,s]);else{let o={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!qi)o.recreate=!0,t.change.push(o);else{let a=i.idxByName,l=s.idxByName,u;for(u in a)l[u]||o.del.push(u);for(u in l){let c=a[u],h=l[u];c?c.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&t.change.push(o)}}}return t}function ra(n,e,t,r){let i=n.db.createObjectStore(e,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach(s=>zo(i,s)),i}function Gh(n,e){me(n).forEach(t=>{e.db.objectStoreNames.contains(t)||ra(e,t,n[t].primKey,n[t].indexes)})}function Xh(n,e){[].slice.call(e.db.objectStoreNames).forEach(t=>n[t]==null&&e.db.deleteObjectStore(t))}function zo(n,e){n.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ia(n,e,t){let r={};return Ui(e.objectStoreNames,0).forEach(s=>{let o=t.objectStore(s),a=o.keyPath,l=No(wu(a),a||"",!1,!1,!!o.autoIncrement,a&&typeof a!="string",!0),u=[];for(let h=0;h<o.indexNames.length;++h){let f=o.index(o.indexNames[h]);a=f.keyPath;var c=No(f.name,a,!!f.unique,!!f.multiEntry,!1,a&&typeof a!="string",!1);u.push(c)}r[s]=xu(s,l,u)}),r}function Yh({_novip:n},e,t){n.verno=e.version/10;let r=n._dbSchema=ia(n,e,t);n._storeNames=Ui(e.objectStoreNames,0),Vi(n,[n._allTables],me(r),r)}function Jh(n,e){let t=ia(n,n.idbdb,e),r=Eu(t,n._dbSchema);return!(r.add.length||r.change.some(i=>i.add.length||i.change.length))}function Vo({_novip:n},e,t){let r=t.db.objectStoreNames;for(let i=0;i<r.length;++i){let s=r[i],o=t.objectStore(s);n._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){let l=o.indexNames[a],u=o.index(l).keyPath,c=typeof u=="string"?u:"["+Ui(u).join("+")+"]";if(e[s]){let h=e[s].idxByName[c];h&&(h.name=l,delete e[s].idxByName[c],e[s].idxByName[l]=h)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&fe.WorkerGlobalScope&&fe instanceof fe.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Qh(n){return n.split(",").map((e,t)=>{e=e.trim();let r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return No(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Ce(i),t===0)})}var Ko=class{_parseStoresSpec(e,t){me(e).forEach(r=>{if(e[r]!==null){var i=Qh(e[r]),s=i.shift();if(s.multi)throw new U.Schema("Primary key cannot be multi-valued");i.forEach(o=>{if(o.auto)throw new U.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new U.Schema("Index must have a name and cannot be an empty string")}),t[r]=xu(r,s,i)}})}stores(e){let t=this.db;this._cfg.storesSource=this._cfg.storesSource?De(this._cfg.storesSource,e):e;let r=t._versions,i={},s={};return r.forEach(o=>{De(i,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(i,s)}),t._dbSchema=s,Bo(t,[t._allTables,t,t.Transaction.prototype]),Vi(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],me(s),s),t._storeNames=me(s),this}upgrade(e){return this._cfg.contentUpgrade=Qo(this._cfg.contentUpgrade||oe,e),this}};function Zh(n){return br(Ko.prototype,function(t){this.db=n,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function sa(n,e){let t=n._dbNamesDB;return t||(t=n._dbNamesDB=new Xe(Hi,{addons:[],indexedDB:n,IDBKeyRange:e}),t.version(1).stores({dbnames:"name"})),t.table("dbnames")}function oa(n){return n&&typeof n.databases=="function"}function ep({indexedDB:n,IDBKeyRange:e}){return oa(n)?Promise.resolve(n.databases()).then(t=>t.map(r=>r.name).filter(r=>r!==Hi)):sa(n,e).toCollection().primaryKeys()}function tp({indexedDB:n,IDBKeyRange:e},t){!oa(n)&&t!==Hi&&sa(n,e).put({name:t}).catch(oe)}function np({indexedDB:n,IDBKeyRange:e},t){!oa(n)&&t!==Hi&&sa(n,e).delete(t).catch(oe)}function $o(n){return Rt(function(){return K.letThrough=!0,n()})}function rp(){var n=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!n||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function ip(n){let e=n._state,{indexedDB:t}=n._deps;if(e.isBeingOpened||n.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?ve(e.dbOpenError):n);ht&&(e.openCanceller._stackHolder=an()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;let r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new U.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,o=null,a=!1;return R.race([r,(typeof navigator=="undefined"?R.resolve():rp()).then(()=>new R((l,u)=>{if(i(),!t)throw new U.MissingAPI;let c=n.name,h=e.autoSchema?t.open(c):t.open(c,Math.round(n.verno*10));if(!h)throw new U.MissingAPI;h.onerror=dt(u),h.onblocked=de(n._fireOnBlocked),h.onupgradeneeded=de(f=>{if(o=h.transaction,e.autoSchema&&!n._options.allowEmptyDB){h.onerror=fr,o.abort(),h.result.close();let p=t.deleteDatabase(c);p.onsuccess=p.onerror=de(()=>{u(new U.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{o.onerror=dt(u);var d=f.oldVersion>Math.pow(2,62)?0:f.oldVersion;a=d<1,n._novip.idbdb=h.result,qh(n,d/10,o,u)}},u),h.onsuccess=de(()=>{o=null;let f=n._novip.idbdb=h.result,d=Ui(f.objectStoreNames);if(d.length>0)try{let p=f.transaction(Bh(d),"readonly");e.autoSchema?Yh(n,f,p):(Vo(n,n._dbSchema,p),Jh(n,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),na(n,p)}catch(p){}or.push(n),f.onversionchange=de(p=>{e.vcFired=!0,n.on("versionchange").fire(p)}),f.onclose=de(p=>{n.on("close").fire(p)}),a&&tp(n._deps,c),l()},u)}))]).then(()=>(i(),e.onReadyBeingFired=[],R.resolve($o(()=>n.on.ready.fire(n.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(Qo,oe);return e.onReadyBeingFired=[],R.resolve($o(()=>u(n.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>n).catch(l=>{e.dbOpenError=l;try{o&&o.abort()}catch(u){}return r===e.openCanceller&&n._close(),ve(l)}).finally(()=>{e.openComplete=!0,s()})}function Uo(n){var e=o=>n.next(o),t=o=>n.throw(o),r=s(e),i=s(t);function s(o){return a=>{var l=o(a),u=l.value;return l.done?u:!u||typeof u.then!="function"?Ce(u)?Promise.all(u).then(r,i):r(u):u.then(r,i)}}return s(e)()}function sp(n,e,t){var r=arguments.length;if(r<2)throw new U.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];t=i.pop();var s=nu(i);return[n,s,t]}function Su(n,e,t,r,i){return R.resolve().then(()=>{let s=K.transless||K,o=n._createTransaction(e,t,n._dbSchema,r),a={trans:o,transless:s};if(r)o.idbtrans=r.idbtrans;else try{o.create(),n._state.PR1398_maxLoop=3}catch(h){return h.name===Jo.InvalidState&&n.isOpen()&&--n._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),n._close(),n.open().then(()=>Su(n,e,t,null,i))):ve(h)}let l=Xo(i);l&&kn();let u,c=R.follow(()=>{if(u=i.call(o,o),u)if(l){var h=St.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=Uo(u))},a);return(u&&typeof u.then=="function"?R.resolve(u).then(h=>o.active?h:ve(new U.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(h=>(r&&o._resolve(),o._completion.then(()=>h))).catch(h=>(o._reject(h),ve(h)))})}function Ci(n,e,t){let r=Ce(n)?n.slice():[n];for(let i=0;i<t;++i)r.push(e);return r}function op(n){return{...n,table(e){let t=n.table(e),{schema:r}=t,i={},s=[];function o(f,d,p){let m=ar(f),g=i[m]=i[m]||[],y=f==null?0:typeof f=="string"?1:f.length,_=d>0,x={...p,isVirtual:_,keyTail:d,keyLength:y,extractKey:jo(f),unique:!_&&p.unique};if(g.push(x),x.isPrimaryKey||s.push(x),y>1){let w=y===2?f[0]:f.slice(0,y-1);o(w,d+1,p)}return g.sort((w,S)=>w.keyTail-S.keyTail),x}let a=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(let f of r.indexes)o(f.keyPath,0,f);function l(f){let d=i[ar(f)];return d&&d[0]}function u(f,d){return{type:f.type===1?2:f.type,lower:Ci(f.lower,f.lowerOpen?n.MAX_KEY:n.MIN_KEY,d),lowerOpen:!0,upper:Ci(f.upper,f.upperOpen?n.MIN_KEY:n.MAX_KEY,d),upperOpen:!0}}function c(f){let d=f.query.index;return d.isVirtual?{...f,query:{index:d,range:u(f.query.range,d.keyTail)}}:f}return{...t,schema:{...r,primaryKey:a,indexes:s,getIndexByKeyPath:l},count(f){return t.count(c(f))},query(f){return t.query(c(f))},openCursor(f){let{keyTail:d,isVirtual:p,keyLength:m}=f.query.index;if(!p)return t.openCursor(f);function g(y){function _(w){w!=null?y.continue(Ci(w,f.reverse?n.MAX_KEY:n.MIN_KEY,d)):f.unique?y.continue(y.key.slice(0,m).concat(f.reverse?n.MIN_KEY:n.MAX_KEY,d)):y.continue()}return Object.create(y,{continue:{value:_},continuePrimaryKey:{value(w,S){y.continuePrimaryKey(Ci(w,n.MAX_KEY,d),S)}},primaryKey:{get(){return y.primaryKey}},key:{get(){let w=y.key;return m===1?w[0]:w.slice(0,m)}},value:{get(){return y.value}}})}return t.openCursor(c(f)).then(y=>y&&g(y))}}}}}var ap={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:op};function aa(n,e,t,r){return t=t||{},r=r||"",me(n).forEach(i=>{if(!Ue(e,i))t[r+i]=void 0;else{var s=n[i],o=e[i];if(typeof s=="object"&&typeof o=="object"&&s&&o){let a=wo(s),l=wo(o);a!==l?t[r+i]=e[i]:a==="Object"?aa(s,o,t,r+i+"."):s!==o&&(t[r+i]=e[i])}else s!==o&&(t[r+i]=e[i])}}),me(e).forEach(i=>{Ue(n,i)||(t[r+i]=e[i])}),t}function lp(n,e){return e.type==="delete"?e.keys:e.keys||e.values.map(n.extractKey)}var up={stack:"dbcore",name:"HooksMiddleware",level:2,create:n=>({...n,table(e){let t=n.table(e),{primaryKey:r}=t.schema;return{...t,mutate(s){let o=K.trans,{deleting:a,creating:l,updating:u}=o.table(e).hook;switch(s.type){case"add":if(l.fire===oe)break;return o._promise("readwrite",()=>c(s),!0);case"put":if(l.fire===oe&&u.fire===oe)break;return o._promise("readwrite",()=>c(s),!0);case"delete":if(a.fire===oe)break;return o._promise("readwrite",()=>c(s),!0);case"deleteRange":if(a.fire===oe)break;return o._promise("readwrite",()=>h(s),!0)}return t.mutate(s);function c(d){let p=K.trans,m=d.keys||lp(r,d);if(!m)throw new Error("Keys missing");return d=d.type==="add"||d.type==="put"?{...d,keys:m}:{...d},d.type!=="delete"&&(d.values=[...d.values]),d.keys&&(d.keys=[...d.keys]),cp(t,d,m).then(g=>{let y=m.map((_,x)=>{let w=g[x],S={onerror:null,onsuccess:null};if(d.type==="delete")a.fire.call(S,_,w,p);else if(d.type==="add"||w===void 0){let A=l.fire.call(S,_,d.values[x],p);_==null&&A!=null&&(_=A,d.keys[x]=_,r.outbound||st(d.values[x],r.keyPath,_))}else{let A=aa(w,d.values[x]),T=u.fire.call(S,A,_,w,p);if(T){let I=d.values[x];Object.keys(T).forEach(M=>{Ue(I,M)?I[M]=T[M]:st(I,M,T[M])})}}return S});return t.mutate(d).then(({failures:_,results:x,numFailures:w,lastResult:S})=>{for(let A=0;A<m.length;++A){let T=x?x[A]:m[A],I=y[A];T==null?I.onerror&&I.onerror(_[A]):I.onsuccess&&I.onsuccess(d.type==="put"&&g[A]?d.values[A]:T)}return{failures:_,results:x,numFailures:w,lastResult:S}}).catch(_=>(y.forEach(x=>x.onerror&&x.onerror(_)),Promise.reject(_)))})}function h(d){return f(d.trans,d.range,1e4)}function f(d,p,m){return t.query({trans:d,values:!1,query:{index:r,range:p},limit:m}).then(({result:g})=>c({type:"delete",keys:g,trans:d}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):g.length<m?{failures:[],numFailures:0,lastResult:void 0}:f(d,{...p,lower:g[g.length-1],lowerOpen:!0},m)))}}}}})};function cp(n,e,t){return e.type==="add"?Promise.resolve([]):n.getMany({trans:e.trans,keys:t,cache:"immutable"})}function Au(n,e,t){try{if(!e||e.keys.length<n.length)return null;let r=[];for(let i=0,s=0;i<e.keys.length&&s<n.length;++i)Me(e.keys[i],n[s])===0&&(r.push(t?mr(e.values[i]):e.values[i]),++s);return r.length===n.length?r:null}catch(r){return null}}var fp={stack:"dbcore",level:-1,create:n=>({table:e=>{let t=n.table(e);return{...t,getMany:r=>{if(!r.cache)return t.getMany(r);let i=Au(r.keys,r.trans._cache,r.cache==="clone");return i?R.resolve(i):t.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?mr(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),t.mutate(r))}}})};function la(n){return!("from"in n)}var _t=function(n,e){if(this)De(this,arguments.length?{d:1,from:n,to:arguments.length>1?e:n}:{d:0});else{let t=new _t;return n&&"d"in n&&De(t,n),t}};Fn(_t.prototype,{add(n){return Ki(this,n),this},addKey(n){return pr(this,n,n),this},addKeys(n){return n.forEach(e=>pr(this,e,e)),this},[xo](){return Wo(this)}});function pr(n,e,t){let r=Me(e,t);if(isNaN(r))return;if(r>0)throw RangeError();if(la(n))return De(n,{from:e,to:t,d:1});let i=n.l,s=n.r;if(Me(t,n.from)<0)return i?pr(i,e,t):n.l={from:e,to:t,d:1,l:null,r:null},Xl(n);if(Me(e,n.to)>0)return s?pr(s,e,t):n.r={from:e,to:t,d:1,l:null,r:null},Xl(n);Me(e,n.from)<0&&(n.from=e,n.l=null,n.d=s?s.d+1:1),Me(t,n.to)>0&&(n.to=t,n.r=null,n.d=n.l?n.l.d+1:1);let o=!n.r;i&&!n.l&&Ki(n,i),s&&o&&Ki(n,s)}function Ki(n,e){function t(r,{from:i,to:s,l:o,r:a}){pr(r,i,s),o&&t(r,o),a&&t(r,a)}la(e)||t(n,e)}function dp(n,e){let t=Wo(e),r=t.next();if(r.done)return!1;let i=r.value,s=Wo(n),o=s.next(i.from),a=o.value;for(;!r.done&&!o.done;){if(Me(a.from,i.to)<=0&&Me(a.to,i.from)>=0)return!0;Me(i.from,a.from)<0?i=(r=t.next(a.from)).value:a=(o=s.next(i.from)).value}return!1}function Wo(n){let e=la(n)?null:{s:0,n};return{next(t){let r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&Me(t,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||Me(t,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Xl(n){var e,t;let r=(((e=n.r)===null||e===void 0?void 0:e.d)||0)-(((t=n.l)===null||t===void 0?void 0:t.d)||0),i=r>1?"r":r<-1?"l":"";if(i){let s=i==="r"?"l":"r",o={...n},a=n[i];n.from=a.from,n.to=a.to,n[i]=a[i],o[i]=a[s],n[s]=o,o.d=Yl(o)}n.d=Yl(n)}function Yl({r:n,l:e}){return(n?e?Math.max(n.d,e.d):n.d:e?e.d:0)+1}var hp={stack:"dbcore",level:0,create:n=>{let e=n.schema.name,t=new _t(n.MIN_KEY,n.MAX_KEY);return{...n,table:r=>{let i=n.table(r),{schema:s}=i,{primaryKey:o}=s,{extractKey:a,outbound:l}=o,u={...i,mutate:f=>{let d=f.trans,p=d.mutatedParts||(d.mutatedParts={}),m=A=>{let T=`idb://${e}/${r}/${A}`;return p[T]||(p[T]=new _t)},g=m(""),y=m(":dels"),{type:_}=f,[x,w]=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[[],f.values]:[],S=f.trans._cache;return i.mutate(f).then(A=>{if(Ce(x)){_!=="delete"&&(x=A.results),g.addKeys(x);let T=Au(x,S);!T&&_!=="add"&&y.addKeys(x),(T||w)&&pp(m,s,T,w)}else if(x){let T={from:x.lower,to:x.upper};y.add(T),g.add(T)}else g.add(t),y.add(t),s.indexes.forEach(T=>m(T.name).add(t));return A})}},c=({query:{index:f,range:d}})=>{var p,m;return[f,new _t((p=d.lower)!==null&&p!==void 0?p:n.MIN_KEY,(m=d.upper)!==null&&m!==void 0?m:n.MAX_KEY)]},h={get:f=>[o,new _t(f.key)],getMany:f=>[o,new _t().addKeys(f.keys)],count:c,query:c,openCursor:c};return me(h).forEach(f=>{u[f]=function(d){let{subscr:p}=K;if(p){let m=w=>{let S=`idb://${e}/${r}/${w}`;return p[S]||(p[S]=new _t)},g=m(""),y=m(":dels"),[_,x]=h[f](d);if(m(_.name||"").add(x),!_.isPrimaryKey)if(f==="count")y.add(t);else{let w=f==="query"&&l&&d.values&&i.query({...d,values:!1});return i[f].apply(this,arguments).then(S=>{if(f==="query"){if(l&&d.values)return w.then(({result:T})=>(g.addKeys(T),S));let A=d.values?S.result.map(a):S.result;d.values?g.addKeys(A):y.addKeys(A)}else if(f==="openCursor"){let A=S,T=d.values;return A&&Object.create(A,{key:{get(){return y.addKey(A.primaryKey),A.key}},primaryKey:{get(){let I=A.primaryKey;return y.addKey(I),I}},value:{get(){return T&&g.addKey(A.primaryKey),A.value}}})}return S})}}return i[f].apply(this,arguments)}}),u}}}};function pp(n,e,t,r){function i(s){let o=n(s.name||"");function a(u){return u!=null?s.extractKey(u):null}let l=u=>s.multiEntry&&Ce(u)?u.forEach(c=>o.addKey(c)):o.addKey(u);(t||r).forEach((u,c)=>{let h=t&&a(t[c]),f=r&&a(r[c]);Me(h,f)!==0&&(h!=null&&l(h),f!=null&&l(f))})}e.indexes.forEach(i)}var Xe=class{constructor(e,t){this._middlewares={},this.verno=0;let r=Xe.dependencies;this._options=t={addons:Xe.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};let{addons:i}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;let s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new R(o=>{s.dbReadyResolve=o}),s.openCanceller=new R((o,a)=>{s.cancelOpen=a}),this._state=s,this.name=e,this.on=_r(this,"populate","blocked","versionchange","close",{ready:[Qo,oe]}),this.on.ready.subscribe=Ql(this.on.ready.subscribe,o=>(a,l)=>{Xe.vip(()=>{let u=this._state;if(u.openComplete)u.dbOpenError||R.resolve().then(a),l&&o(a);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(a),l&&o(a);else{o(a);let c=this;l||o(function h(){c.on.ready.unsubscribe(a),c.on.ready.unsubscribe(h)})}})}),this.Collection=kh(this),this.Table=Ch(this),this.Transaction=jh(this),this.Version=Zh(this),this.WhereClause=Nh(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=hr(t.IDBKeyRange),this._createTransaction=(o,a,l,u)=>new this.Transaction(o,a,l,this._options.chromeTransactionDurability,u),this._fireOnBlocked=o=>{this.on("blocked").fire(o),or.filter(a=>a.name===this.name&&a!==this&&!a._state.vcFired).map(a=>a.on("versionchange").fire(o))},this.use(ap),this.use(up),this.use(hp),this.use(fp),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(o=>o(this))}version(e){if(isNaN(e)||e<.1)throw new U.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new U.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);let t=this._versions;var r=t.filter(i=>i._cfg.version===e)[0];return r||(r=new this.Version(e),t.push(r),t.sort(Wh),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||K.letThrough||this._vip)?e():new R((t,r)=>{if(this._state.openComplete)return r(new U.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen){r(new U.DatabaseClosed);return}this.open().catch(oe)}this._state.dbReadyPromise.then(t,r)}).then(e)}use({stack:e,create:t,level:r,name:i}){i&&this.unuse({stack:e,name:i});let s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:t,level:r==null?10:r,name:i}),s.sort((o,a)=>o.level-a.level),this}unuse({stack:e,name:t,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(i=>r?i.create!==r:t?i.name!==t:!1)),this}open(){return ip(this)}_close(){let e=this._state,t=or.indexOf(this);if(t>=0&&or.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(r){}this._novip.idbdb=null}e.dbReadyPromise=new R(r=>{e.dbReadyResolve=r}),e.openCanceller=new R((r,i)=>{e.cancelOpen=i})}close(){this._close();let e=this._state;this._options.autoOpen=!1,e.dbOpenError=new U.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){let e=arguments.length>0,t=this._state;return new R((r,i)=>{let s=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=de(()=>{np(this._deps,this.name),r()}),o.onerror=dt(i),o.onblocked=this._fireOnBlocked};if(e)throw new U.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){let e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return me(this._allTables).map(e=>this._allTables[e])}transaction(){let e=sp.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,r){let i=K.trans;(!i||i.db!==this||e.indexOf("!")!==-1)&&(i=null);let s=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");let o,a;try{if(a=t.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===mo)o=mo;else if(e=="rw"||e==go)o=go;else throw new U.InvalidArgument("Invalid transaction mode: "+e);if(i){if(i.mode===mo&&o===go)if(s)i=null;else throw new U.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i&&a.forEach(u=>{if(i&&i.storeNames.indexOf(u)===-1)if(s)i=null;else throw new U.SubTransaction("Table "+u+" not included in parent transaction.")}),s&&i&&!i.active&&(i=null)}}catch(u){return i?i._promise(null,(c,h)=>{h(u)}):ve(u)}let l=Su.bind(null,this,o,a,i,r);return i?i._promise(o,l,"lock"):K.trans?Mn(K.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Ue(this._allTables,e))throw new U.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}},mp=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",qo=class{constructor(e){this._subscribe=e}subscribe(e,t,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:t,complete:r}:e)}[mp](){return this}};function Tu(n,e){return me(e).forEach(t=>{let r=n[t]||(n[t]=new _t);Ki(r,e[t])}),n}function gp(n){let e=!1,t,r=new qo(i=>{let s=Xo(n);function o(g){s&&kn();let y=()=>Rt(n,{subscr:g,trans:null}),_=K.trans?Mn(K.transless,y):y();return s&&_.then(St,St),_}let a=!1,l={},u={},c={get closed(){return a},unsubscribe:()=>{a=!0,Nt.storagemutated.unsubscribe(p)}};i.start&&i.start(c);let h=!1,f=!1;function d(){return me(u).some(g=>l[g]&&dp(l[g],u[g]))}let p=g=>{Tu(l,g),d()&&m()},m=()=>{if(h||a)return;l={};let g={},y=o(g);f||(Nt(dr,p),f=!0),h=!0,Promise.resolve(y).then(_=>{e=!0,t=_,h=!1,!a&&(d()?m():(l={},u=g,i.next&&i.next(_)))},_=>{h=!1,e=!1,i.error&&i.error(_),c.unsubscribe()})};return m(),c});return r.hasValue=()=>e,r.getValue=()=>t,r}var Ho;try{Ho={indexedDB:fe.indexedDB||fe.mozIndexedDB||fe.webkitIndexedDB||fe.msIndexedDB,IDBKeyRange:fe.IDBKeyRange||fe.webkitIDBKeyRange}}catch(n){Ho={indexedDB:null,IDBKeyRange:null}}var en=Xe;Fn(en,{...Wi,delete(n){return new en(n,{addons:[]}).delete()},exists(n){return new en(n,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1)},getDatabaseNames(n){try{return ep(en.dependencies).then(n)}catch(e){return ve(new U.MissingAPI)}},defineClass(){function n(e){De(this,e)}return n},ignoreTransaction(n){return K.trans?Mn(K.transless,n):n()},vip:$o,async:function(n){return function(){try{var e=Uo(n.apply(this,arguments));return!e||typeof e.then!="function"?R.resolve(e):e}catch(t){return ve(t)}}},spawn:function(n,e,t){try{var r=Uo(n.apply(t,e||[]));return!r||typeof r.then!="function"?R.resolve(r):r}catch(i){return ve(i)}},currentTransaction:{get:()=>K.trans||null},waitFor:function(n,e){let t=R.resolve(typeof n=="function"?en.ignoreTransaction(n):n).timeout(e||6e4);return K.trans?K.trans.waitFor(t):t},Promise:R,debug:{get:()=>ht,set:n=>{iu(n,n==="dexie"?()=>!0:vu)}},derive:Pn,extend:De,props:Fn,override:Ql,Events:_r,on:Nt,liveQuery:gp,extendObservabilitySet:Tu,getByKeyPath:xt,setByKeyPath:st,delByKeyPath:Zd,shallowClone:tu,deepClone:mr,getObjectDiff:aa,cmp:Me,asap:Zl,minKey:Do,addons:[],connections:or,errnames:Jo,dependencies:Ho,semVer:$l,version:$l.split(".").map(n=>parseInt(n)).reduce((n,e,t)=>n+e/Math.pow(10,t*2))});en.maxKey=hr(en.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(Nt(dr,n=>{if(!wt){let e;qi?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ot,!0,!0,n)):e=new CustomEvent(Ot,{detail:n}),wt=!0,dispatchEvent(e),wt=!1}}),addEventListener(Ot,({detail:n})=>{wt||$i(n)}));function $i(n){let e=wt;try{wt=!0,Nt.storagemutated.fire(n)}finally{wt=e}}var wt=!1;if(typeof BroadcastChannel!="undefined"){let n=new BroadcastChannel(Ot);typeof n.unref=="function"&&n.unref(),Nt(dr,e=>{wt||n.postMessage(e)}),n.onmessage=e=>{e.data&&$i(e.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){Nt(dr,e=>{try{wt||(typeof localStorage!="undefined"&&localStorage.setItem(Ot,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(t=>t.postMessage({type:Ot,changedParts:e})))}catch(t){}}),typeof addEventListener!="undefined"&&addEventListener("storage",e=>{if(e.key===Ot){let t=JSON.parse(e.newValue);t&&$i(t.changedParts)}});let n=self.document&&navigator.serviceWorker;n&&n.addEventListener("message",yp)}function yp({data:n}){n&&n.type===Ot&&$i(n.changedParts)}R.rejectionMapper=lh;iu(ht,vu);var Mu=require("obsidian");var Cu=require("obsidian");var Fu=ae(ce());var Fe=class{constructor(){this.app=b(Cu.App);this.plugin=b(rt);this.obsidianFs=this.app.vault.adapter}getVaultAbsolutePath(){return this.obsidianFs.getBasePath().replace(/\\/g,"/")+"/"}getAbsolutePath(e){return Ae.join(this.getVaultAbsolutePath(),e)}getFileBacklinks(e){this.app.metadataCache.getBacklinksForFile(e)}getAppId(){return this.app.appId}executeCommandById(e){this.app.commands.executeCommandById(e)}isNotObsidianExcludedPath(e){return!(this.app.metadataCache.isUserIgnored&&this.app.metadataCache.isUserIgnored(e))}};Fe=N([(0,Fu.singleton)()],Fe);var Dn=require("obsidian");var be=class extends Dn.Notice{constructor(e,t=0){super(e+`
(clever-search)`,t)}},Gi=class extends Dn.AbstractInputSuggest{constructor(t,r,i){super(b(Dn.App),t);this.inputEl=t;this.onSelectCb=i;this.content=r}getSuggestions(t){return[...this.content].filter(r=>r.toLowerCase().contains(t.toLowerCase()))}renderSuggestion(t,r){r.setText(t)}selectSuggestion(t,r){this.onSelectCb(t),this.inputEl.value="",this.close()}},ua=class{},Xg=new ua;var ku=require("obsidian");var ca={"Reindexing...":"Reindexing...","Indexing finished":"Indexing finished","files need to be indexed. Obsidian may freeze for a while":"files need to be indexed. Obsidian may freeze for a while","Omnisearch isn't installed":"Omnisearch isn't installed","Omnisearch is installed but not enabled":"Omnisearch is installed but not enabled","Database has been updated, a reindex is required":"Database has been updated, a reindex is required","Semantic init time":"The local model indexes at a speed of approximately 100-500 words per second. During this time, please do not close Obsidian.","Semantic init finished":"Semantic engine is ready","Max items count":"Max items count","Max items count desc":"Due to renderer's limited capabilities, this plugin can find thousands of results, but cannot display them all at once","Floating window for in-file search":"Floating window for in-file search","Floating window for in-file search desc":"Execute 'in-file search' command again will close the existing floating window. Disable this option to use classic modal UI","English word blacklist":"English word blacklist","English word blacklist desc":`Exclude some meaningless English words like "do", "and", "them" from indexing, enhancing search and indexing speed. Modify the file at ${xi} to tailor the list to your needs.`,"Chinese patch":"Chinese patch","Chinese patch desc":"Better search result for Chinese","Chinese word blacklist":"Chinese word blacklist","Chinese word blacklist desc":`Activates only if the Chinese Patch is enabled. This excludes some meaningless Chinese words like "\u7684", "\u6240\u4EE5", "\u5C3D\u7BA1" listed in 'stop-words-zh.txt', improving search efficiency and speed. More details are listed in "English word blacklist" option`,Advanced:"Advanced","Advanced.desc":"The previous settings cover most needs. For further customization, adjust the following options","Excluded files":"Excluded files",Manage:"Manage","Follow Obsidian Excluded Files":"Follow Obsidian Excluded Files","Enter path...":"Enter path...",Add:"Add","Customize extensions":"Customize extensions","extensionModal.desc":"Customize the file extensions you would like to index. By default, file types not natively supported by Obsidian, such as 'txt', will be opened with an external program. To open these files within Obsidian, you may need to install plugins like 'obsidian-custom-file-extension-plugin' or 'obsidian-vscode-editor'.","extensionModal.plaintextName":"Plaintext","extensionModal.plaintextDesc":"Extensions should be separated by a space or a newline character. Please do not include binary filetypes like 'pdf', 'jpg', 'mp4', etc, that can't be opened with notepad. Including them might cause indexing issues. Additionally, the indexing and searching of HTML files may be slower because they require conversion to clean Markdown format first. Furthermore, due to the extremely limited API, it seems impossible to automatically scroll to specific locations within HTML files.","For Development":"For Development","Collapse development setting by default":"Collapse development setting by default","Reindex the vault":"Reindex the vault",Reindex:"Reindex","Log level":"Log level","Reset floating window position":"Reset floating window position","Reset floating window position desc":"In case the window is moved outside the visible area","Reset position":"Reset position","Support the Project":"Support the Project","Support the Project desc":"Enjoying this plugin? Show your support with a star on GitHub!","Visit GitHub":"Visit GitHub"};var Pu={"Reindexing...":"\u91CD\u5EFA\u7D22\u5F15\u4E2D...","Indexing finished":"\u7D22\u5F15\u5B8C\u6210","files need to be indexed. Obsidian may freeze for a while":"\u6587\u4EF6\u9700\u8981\u88AB\u7D22\u5F15, Obsidian \u53EF\u80FD\u4F1A\u5361\u987F\u4E00\u4F1A\u513F","Omnisearch isn't installed":"\u672A\u5B89\u88C5 Omnisearch","Omnisearch is installed but not enabled":"\u5B89\u88C5\u4E86 Omnisearch \u4F46\u662F\u6CA1\u6709\u542F\u7528","Database has been updated, a reindex is required":"\u6570\u636E\u5E93\u5DF2\u66F4\u65B0\uFF0C\u9700\u8981\u91CD\u5EFA\u7D22\u5F15","Semantic init time":"\u672C\u5730\u6A21\u578B\u7D22\u5F15\u901F\u5EA6\u5927\u7EA6\u662F 200-800 \u5B57\u6BCF\u79D2\uFF0C\u5728\u6B64\u671F\u95F4\u8BF7\u4E0D\u8981\u5173\u95ED Obsidian","Semantic init finished":"\u8BED\u4E49\u5F15\u64CE\u5DF2\u5C31\u7EEA","Max items count":"\u6700\u5927\u5019\u9009\u9879\u6570","Max items count desc":"\u867D\u7136\u672C\u63D2\u4EF6\u53EF\u4EE5\u641C\u7D22\u5230\u6210\u5343\u4E0A\u4E07\u4E2A\u7ED3\u679C\uFF0C\u4F46\u7531\u4E8E\u5E95\u5C42\u6E32\u67D3\u5668\u6027\u80FD\u9650\u5236\uFF0C\u4E0D\u80FD\u5373\u65F6\u6E32\u67D3\u6240\u6709\u7ED3\u679C","Floating window for in-file search":"\u6587\u4EF6\u5185\u641C\u7D22\u4F7F\u7528\u60AC\u6D6E\u7A97\u53E3 UI","Floating window for in-file search desc":"\u518D\u6B21\u6267\u884C '\u6587\u4EF6\u5185\u641C\u7D22' \u547D\u4EE4\u4F1A\u5173\u95ED\u5DF2\u6709\u7684\u60AC\u6D6E\u7A97\u53E3\u3002\u5173\u95ED\u8FD9\u4E2A\u9009\u9879\u5C06\u4F7F\u7528\u6A21\u6001\u6846 UI","English word blacklist":"\u82F1\u6587\u5355\u8BCD\u9ED1\u540D\u5355","English word blacklist desc":`\u5EFA\u7ACB\u7D22\u5F15\u65F6\uFF0C\u5FFD\u7565\u4E00\u4E9B\u542B\u4E49\u6A21\u7CCA\u7684\u5355\u8BCD\uFF0C\u6BD4\u5982 "do", "and", "them", \u53EF\u4EE5\u52A0\u5FEB\u7D22\u5F15\u548C\u641C\u7D22\u901F\u5EA6\uFF0C\u4F46\u662F\u8FD9\u4E9B\u5355\u8BCD\u4E0D\u4F1A\u88AB\u641C\u7D22\u5230. \u53EF\u4EE5\u5728 ${xi} \u6309\u9700\u4FEE\u6539\u5355\u8BCD\u9ED1\u540D\u5355`,"Chinese patch":"\u4E2D\u6587\u641C\u7D22\u4F18\u5316","Chinese patch desc":"\u66F4\u597D\u7684\u4E2D\u6587\u641C\u7D22\u7ED3\u679C","Chinese word blacklist":"\u4E2D\u6587\u8BCD\u8BED\u9ED1\u540D\u5355","Chinese word blacklist desc":'\u53EA\u5728\u5F00\u542F\u4E2D\u6587\u641C\u7D22\u4F18\u5316\u65F6\u751F\u6548\u3002\u5FFD\u7565 "\u7684", "\u6240\u4EE5", "\u5C3D\u7BA1" \u7B49\u8BCD\u8BED\uFF0C\u8BE6\u7EC6\u5217\u8868\u5728 "stop-words-zh.txt"\u3002\u8BE6\u89C1 "\u82F1\u6587\u5355\u8BCD\u9ED1\u540D\u5355" \u9009\u9879',Advanced:"\u8FDB\u9636\u8BBE\u7F6E","Advanced.desc":"\u4E4B\u524D\u7684\u8BBE\u7F6E\u901A\u5E38\u80FD\u6EE1\u8DB3\u5927\u591A\u6570\u4F7F\u7528\u573A\u666F\uFF0C\u5982\u679C\u4F60\u60F3\u6709\u66F4\u4E2A\u6027\u5316\u7684\u8BBE\u7F6E\uFF0C\u53EF\u4EE5\u8C03\u6574\u4E0B\u9762\u7684\u9009\u9879","Excluded files":"\u5FFD\u7565\u6587\u4EF6",Manage:"\u7BA1\u7406","Follow Obsidian Excluded Files":"\u8DDF\u968F Obsidian \u5FFD\u7565\u6587\u4EF6\u8BBE\u7F6E","Enter path...":"\u8BF7\u8F93\u5165\u8DEF\u5F84...",Add:"\u6DFB\u52A0","Customize extensions":"\u81EA\u5B9A\u4E49\u540E\u7F00\u540D","extensionModal.desc":"\u81EA\u5B9A\u4E49\u5E0C\u671B\u7D22\u5F15\u7684\u6587\u4EF6\u540E\u7F00\u540D\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B Obsidian \u4E0D\u539F\u751F\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF0C\u5982 'txt'\uFF0C\u5C06\u901A\u8FC7\u5916\u90E8\u7A0B\u5E8F\u6253\u5F00\u3002\u8981\u5728 Obsidian \u5185\u6253\u5F00\u8FD9\u4E9B\u6587\u4EF6\uFF0C\u53EF\u80FD\u9700\u8981\u5B89\u88C5\u63D2\u4EF6\uFF0C\u5982 'obsidian-custom-file-extension-plugin' \u6216 'obsidian-vscode-editor'\u3002","extensionModal.plaintextName":"\u7EAF\u6587\u672C","extensionModal.plaintextDesc":"\u540E\u7F00\u540D\u4F7F\u7528\u7A7A\u683C\u6216\u6362\u884C\u7B26\u5206\u9694\u3002\u8BF7\u4E0D\u8981\u5728\u6B64\u5904\u5305\u542B 'pdf'\u3001'jpg'\u3001'mp4' \u7B49\u65E0\u6CD5\u7528\u8BB0\u4E8B\u672C\u6253\u5F00\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u5426\u5219\u53EF\u80FD\u4F1A\u5BFC\u81F4\u7D22\u5F15\u95EE\u9898\u3002\u53E6\u5916\uFF0C\u7D22\u5F15\u548C\u641C\u7D22 HTML \u6587\u4EF6\u53EF\u80FD\u4F1A\u66F4\u6162\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u9996\u5148\u9700\u8981\u8F6C\u6362\u4E3A\u5E72\u51C0\u7684 Markdown \u683C\u5F0F\u3002\u6B64\u5916\uFF0C\u53D7 API \u9650\u5236, \u81EA\u52A8\u6EDA\u52A8\u5230 HTML \u6587\u4EF6\u4E2D\u7684\u7279\u5B9A\u4F4D\u7F6E\u4F3C\u4E4E\u4E0D\u53EF\u884C\u3002","For Development":"\u5F00\u53D1\u8BBE\u7F6E","Collapse development setting by default":"\u9ED8\u8BA4\u6298\u53E0\u5F00\u53D1\u8BBE\u7F6E","Reindex the vault":"\u91CD\u65B0\u7D22\u5F15\u5168\u5E93",Reindex:"\u91CD\u65B0\u7D22\u5F15","Log level":"\u65E5\u5FD7\u7B49\u7EA7","Reset floating window position":"\u91CD\u7F6E\u60AC\u6D6E\u7A97\u53E3\u4F4D\u7F6E","Reset floating window position desc":"\u5982\u679C\u7A97\u53E3\u88AB\u62D6\u5230\u770B\u4E0D\u89C1\u7684\u4F4D\u7F6E, \u53EF\u4EE5\u70B9\u6B64\u6309\u94AE\u91CD\u7F6E","Reset position":"\u91CD\u7F6E\u4F4D\u7F6E","Support the Project":"\u652F\u6301\u8FD9\u4E2A\u9879\u76EE","Support the Project desc":"\u5982\u679C\u89C9\u5F97\u672C\u63D2\u4EF6\u5BF9\u4F60\u6709\u5E2E\u52A9\uFF0C\u5E0C\u671B\u80FD\u5230 GitHub \u70B9\u4E2A star","Visit GitHub":"\u8BBF\u95EE GitHub"};var vp={en:ca,"zh-cn":Pu},Iu=vp[ku.moment.locale()];function q(n){return Iu&&Iu[n]||ca[n]}var Du=ae(ce());var ot=class{constructor(){this.app=b(Mu.App);this.privateApi=b(Fe)}async initAsync(){if(this.app.plugins.plugins.omnisearch){let e="omnisearch/cache/"+this.privateApi.getAppId(),t=new Xe(e);t.version(ot.DB_VERSION).stores({searchHistory:"++id",minisearch:"date"}),this.db=t}}async getLastQuery(){let e="";if(this.checkOmnisearchStatus()){let t=await this.db.searchHistory.toArray();e=t.length!==0?t[t.length-1].query:""}return e}checkOmnisearchStatus(){let e=this.app.plugins.plugins.omnisearch,t=!0;return e?e._loaded||(new be(q("Omnisearch is installed but not enabled")),t=!1):(new be(q("Omnisearch isn't installed")),t=!1),t}};ot.DB_VERSION=8,ot=N([(0,Du.singleton)()],ot);var Y=require("obsidian");var pn=ae(ce());var Ou=ae(ce());var Pe=class{constructor(){this.setting=b(se);this.extensionViewMap=new Map;this.plugin=b(rt)}init(){this.fillMap(this.setting.customExtensions.plaintext,ln.MARKDOWN);try{}catch(e){}}viewTypeByPath(e){let t=this.extensionViewMap.get(le.getExtension(e));return t===void 0?ln.UNSUPPORTED:t}refreshAll(){this.extensionViewMap.clear(),this.init()}fillMap(e,t){for(let r of e)this.extensionViewMap.set(r,t)}};Pe=N([(0,Ou.singleton)()],Pe);var ln=(a=>(a.UNSUPPORTED="unsupported",a.MARKDOWN="markdown",a.PDF="pdf",a.CANVAS="canvas",a.IMAGE="image",a.AUDIO="audio",a.VIDEO="video",a))(ln||{});var On=class{constructor(e,t){this.text=e,this.row=t}},At=class{constructor(e,t){this.sourcePath=e,this.items=t}};var wr=class{},jt=class extends wr{constructor(t,r){super();this.line=t,this.context=r}},Bt=class extends wr{constructor(t,r,i,s,o,a){super();this.engineType=t,this.path=r,this.queryTerms=i,this.matchedTerms=s,this.subItems=o,this.previewContent=a}get viewType(){return b(Pe).viewTypeByPath(this.path)}get basename(){return le.getBasename(this.path)}get extension(){return le.getExtension(this.path)}get folderPath(){return le.getFolderPath(this.path)}},Xi=class extends wr{constructor(t,r,i){super();this.text=t,this.row=r,this.col=i}};var Ru=require("obsidian");var Yi=class{constructor(e){this.option=e}async get(e,t){return this.request("GET",e,t,void 0)}async post(e,t,r){return this.request("POST",e,t,r)}async put(e,t,r){return this.request("PUT",e,t,r)}async delete(e,t){return this.request("DELETE",e,t,void 0)}async request(e,t,r,i){return t=this.buildUrlWithParams(t,r),this.option.responseProcessor(await(0,Ru.requestUrl)({url:t,method:e,contentType:"application/json",body:i?JSON.stringify(i):void 0,headers:this.option.headers}))}buildUrlWithParams(e,t){e=`${this.option.protocol}://${this.option.baseUrl}/${e}`;let r=t?this.serializeParams(t):"";return r?`${e}?${r}`:e}serializeParams(e){return Object.keys(e).map(t=>{let r=e[t];return`${encodeURIComponent(t)}=${encodeURIComponent(this.stringifyParam(r))}`}).join("&")}stringifyParam(e){return typeof e=="object"?JSON.stringify(e):String(e)}};var fa=ae(ce());var Le=class{constructor(){this.request=b(xr);this.viewRegistry=b(Pe);this._status="stopped"}get status(){return this._status}async testConnection(){await this.request.testConnection()?new be("Connected",5e3):new be("Failed to connect",5e3)}async doesCollectionExist(){try{let e=await this.request.doesCollectionExist();return this._status="ready",e}catch(e){return this._status="stopped",C.warn("Semantic search is enabled but failed to connect to server"),C.error(e),null}}async reindexAll(e){this._status="indexing";let t=this.convertToDocuments(e);try{await this.request.reindexAll(t),this._status="ready"}catch(r){C.error(r),this._status="stopped"}}async addDocuments(e){this._status="indexing";let t=this.convertToDocuments(e);try{let r=await this.request.addDocuments(t);return this._status="ready",r}catch(r){return C.error(r),this._status="stopped",!1}}async deleteDocuments(e){this._status="indexing";try{let t=await this.request.deleteDocuments(e);return this._status="ready",t}catch(t){return C.error(t),this._status="stopped",!1}}async search(e,t){try{let r=await this.request.search(e,t);return this._status="ready",r.map(i=>{let s=i.subItems.map(o=>new Xi(o.text,o.row,o.col));return new Bt(i.engineType,i.path,i.queryTerms,i.matchedTerms,s,i.previewContent)})}catch(r){return C.error(r),this._status="stopped",[]}}async docsCount(){return this.request.docsCount()}convertToDocuments(e){return e.map(t=>({path:t.path,view_type:this.viewRegistry.viewTypeByPath(t.path),content:t.content}))}};Le=N([(0,fa.singleton)()],Le);var xr=class{constructor(){this.responseProcessor=e=>{if(e.status===200){let t=e.json;if(t.code===0)return t.data;if(t.code===-1)return C.error(`KnownException: ${t.message}`),null;if(t.code===-2)return C.error(`UnknownException: ${t.message}`),null;throw Error(bi)}else return C.error(e.text),null};this.client=new Yi({baseUrl:"localhost:19528/api",protocol:"http",responseProcessor:this.responseProcessor,headers:{"X-vaultId":b(Fe).getAppId()}})}async testConnection(){try{return!!await this.client.get("testConnection")}catch(e){return C.error(e),!1}}async doesCollectionExist(){return await this.client.get("doesCollectionExist",void 0)}async reindexAll(e){await this.client.post("reindexAll",void 0,e)}async docsCount(){try{return await this.client.get("docsCount")}catch(e){return C.error(e),null}}async addDocuments(e){return await this.client.post("addDocuments",void 0,e)}async deleteDocuments(e){return await this.client.post("deleteDocuments",void 0,e)}async search(e,t){return await this.client.get("search",{queryText:e,viewType:t})}};xr=N([(0,fa.singleton)()],xr);var hc=require("obsidian");var Er=ae(ce());var zt=class{constructor(){this.db=b(Ye)}async deleteMinisearchData(){this.db.minisearch.clear()}async setMiniSearchData(e){this.db.transaction("rw",this.db.minisearch,async()=>{await this.db.minisearch.clear(),await this.db.minisearch.add({data:e}),C.trace("minisearch data saved")})}async getMiniSearchData(){var e;return((e=(await this.db.minisearch.toArray())[0])==null?void 0:e.data)||null}async setLexicalDocRefs(e){this.db.transaction("rw",this.db.lexicalDocRefs,async()=>{await this.db.lexicalDocRefs.clear(),await this.db.lexicalDocRefs.bulkAdd(e)})}async getLexicalDocRefs(){return await this.db.lexicalDocRefs.toArray()||null}async setSemanticDocRefs(e){this.db.transaction("rw",this.db.semanticDocRefs,async()=>{await this.db.semanticDocRefs.clear(),await this.db.semanticDocRefs.bulkAdd(e)})}async getSemanticDocRefs(){return await this.db.semanticDocRefs.toArray()||null}async setPluginSetting(e){try{return await this.db.transaction("rw",this.db.pluginSetting,()=>{this.db.pluginSetting.clear(),this.db.pluginSetting.add({data:e})}),C.trace("settings have been saved to database"),!0}catch(t){return C.trace(`settings failed to be saved: ${t}`),!1}}async deleteOldDatabases(){let e=(await indexedDB.databases()).filter(t=>t.name===this.db.dbName&&t.version!==this.db.dbVersion*10);if(e.length){C.info("Old version databases will be deleted");for(let t of e)t.name&&indexedDB.deleteDatabase(t.name)}}};N([Se],zt.prototype,"getMiniSearchData",1),N([Se],zt.prototype,"getLexicalDocRefs",1),zt=N([(0,Er.singleton)()],zt);var Ye=class extends Xe{constructor(t){super(Ye.dbNamePrefix+t.getAppId());this.privateApi=t,this.version(Ye._dbVersion).stores({pluginSetting:"++id",minisearch:"++id",lexicalDocRefs:"++id",semanticDocRefs:"++id"})}get dbVersion(){return Ye._dbVersion}get dbName(){return Ye.dbNamePrefix+this.privateApi.getAppId()}};Ye._dbVersion=2,Ye.dbNamePrefix="clever-search/",Ye=N([(0,Er.singleton)(),Xr(0,(0,Er.inject)(Fe))],Ye);var ga={216:"O",223:"s",248:"o",273:"d",295:"h",305:"i",320:"l",322:"l",359:"t",383:"s",384:"b",385:"B",387:"b",390:"O",392:"c",393:"D",394:"D",396:"d",398:"E",400:"E",402:"f",403:"G",407:"I",409:"k",410:"l",412:"M",413:"N",414:"n",415:"O",421:"p",427:"t",429:"t",430:"T",434:"V",436:"y",438:"z",477:"e",485:"g",544:"N",545:"d",549:"z",564:"l",565:"n",566:"t",567:"j",570:"A",571:"C",572:"c",573:"L",574:"T",575:"s",576:"z",579:"B",580:"U",581:"V",582:"E",583:"e",584:"J",585:"j",586:"Q",587:"q",588:"R",589:"r",590:"Y",591:"y",592:"a",593:"a",595:"b",596:"o",597:"c",598:"d",599:"d",600:"e",603:"e",604:"e",605:"e",606:"e",607:"j",608:"g",609:"g",610:"G",613:"h",614:"h",616:"i",618:"I",619:"l",620:"l",621:"l",623:"m",624:"m",625:"m",626:"n",627:"n",628:"N",629:"o",633:"r",634:"r",635:"r",636:"r",637:"r",638:"r",639:"r",640:"R",641:"R",642:"s",647:"t",648:"t",649:"u",651:"v",652:"v",653:"w",654:"y",655:"Y",656:"z",657:"z",663:"c",665:"B",666:"e",667:"G",668:"H",669:"j",670:"k",671:"L",672:"q",686:"h",867:"a",868:"e",869:"i",870:"o",871:"u",872:"c",873:"d",874:"h",875:"m",876:"r",877:"t",878:"v",879:"x",7424:"A",7427:"B",7428:"C",7429:"D",7431:"E",7432:"e",7433:"i",7434:"J",7435:"K",7436:"L",7437:"M",7438:"N",7439:"O",7440:"O",7441:"o",7442:"o",7443:"o",7446:"o",7447:"o",7448:"P",7449:"R",7450:"R",7451:"T",7452:"U",7453:"u",7454:"u",7455:"m",7456:"V",7457:"W",7458:"Z",7522:"i",7523:"r",7524:"u",7525:"v",7834:"a",7835:"s",8305:"i",8341:"h",8342:"k",8343:"l",8344:"m",8345:"n",8346:"p",8347:"s",8348:"t",8580:"c"};for(let n="\u0300".codePointAt(0);n<="\u036F".codePointAt(0);++n){let e=String.fromCodePoint(n);for(let t of"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"){let i=(t+e).normalize().codePointAt(0);i>126&&(ga[i]=t)}}var da={a:[7844,7863],e:[7870,7879],o:[7888,7907],u:[7912,7921]};for(let n of Object.keys(da)){let e=n.toUpperCase();for(let t=da[n][0];t<=da[n][1];++t)ga[t]=t%2===0?e:n}function Pr(n){if(n<192||n>8580)return n;let e=ga[n];return e!==void 0?e.codePointAt(0):n}function Vt(n,e){return n>e?n:e}var ju=n=>n.split("").map(e=>e.codePointAt(0));var _p=new Set(` \f
\r	\v\xA0\u1680\u2028\u2029\u202F\u205F\u3000\uFEFF`.split("").map(n=>n.codePointAt(0)));for(let n="\u2000".codePointAt(0);n<="\u200A".codePointAt(0);n++)_p.add(n);var Ln="\x7F".codePointAt(0),Ar="A".codePointAt(0),Tr="Z".codePointAt(0),Bu="a".codePointAt(0),zu="z".codePointAt(0),bp="0".codePointAt(0),wp="9".codePointAt(0);function Rn(n,e,t){return t?n:e-n-1}var Cr=16,Ji=-3,Fr=-1,un=Cr/2,xp=Cr/2,Ep=un+Fr,Vu=-(Ji+Fr),Ku=2;function ha(n){return n?new Set:null}function Sr(n,e,t){if(e!==null&&e.i16.length>n+t){let r=e.i16.subarray(n,n+t);return[n+t,r]}return[n,new Int16Array(t)]}function Lu(n,e,t){if(e!==null&&e.i32.length>n+t){let r=e.i32.subarray(n,n+t);return[n+t,r]}return[n,new Int32Array(t)]}function $u(n){return n>=Bu&&n<=zu?1:n>=Ar&&n<=Tr?2:n>=bp&&n<=wp?4:0}function Uu(n){let e=String.fromCodePoint(n);return e!==e.toUpperCase()?1:e!==e.toLowerCase()?2:e.match(/\p{Number}/gu)!==null?4:e.match(/\p{Letter}/gu)!==null?3:0}function Qi(n){return n<=Ln?$u(n):Uu(n)}function ya(n,e){return n===0&&e!==0?un:n===1&&e===2||n!==4&&e===4?Ep:e===0?xp:0}function Sp(n,e){return e===0?un:ya(Qi(n[e-1]),Qi(n[e]))}function Ap(n,e,t,r){let i=n.slice(r),s=i.indexOf(t);if(s===0)return r;if(!e&&t>=Bu&&t<=zu){s>0&&(i=i.slice(0,s));let o=i.indexOf(t-32);o>=0&&(s=o)}return s<0?-1:r+s}function Nu(n){for(let e of n)if(e>=128)return!1;return!0}function va(n,e,t){if(!Nu(n))return 0;if(!Nu(e))return-1;let r=0,i=0;for(let s=0;s<e.length;s++){if(i=Ap(n,t,e[s],i),i<0)return-1;s===0&&i>0&&(r=i-1),i++}return r}var Tp=(n,e,t,r,i,s,o)=>{let a=i.length;if(a===0)return[{start:0,end:0,score:0},ha(s)];let l=r.length;if(o!==null&&l*a>o.i16.length)return qu(n,e,t,r,i,s);let u=va(r,i,n);if(u<0)return[{start:-1,end:-1,score:0},null];let c=0,h=0,f=null,d=null,p=null,m=null;[c,f]=Sr(c,o,l),[c,d]=Sr(c,o,l),[c,p]=Sr(c,o,l),[h,m]=Lu(h,o,a);let[,g]=Lu(h,o,l);for(let P=0;P<g.length;P++)g[P]=r[P];let y=0,_=0,x=0,w=0,S=i[0],A=i[0],T=0,I=0,M=!1,j=g.subarray(u),O=f.subarray(u).subarray(0,j.length),L=d.subarray(u).subarray(0,j.length),k=p.subarray(u).subarray(0,j.length);for(let[P,z]of j.entries()){let W=null;z<=Ln?(W=$u(z),!n&&W===2&&(z+=32)):(W=Uu(z),!n&&W===2&&(z=String.fromCodePoint(z).toLowerCase().codePointAt(0)),e&&(z=Pr(z))),j[P]=z;let Oe=ya(I,W);if(k[P]=Oe,I=W,z===A&&(x<a&&(m[x]=u+P,x++,A=i[Math.min(x,a-1)]),w=u+P),z===S){let ze=Cr+Oe*Ku;if(O[P]=ze,L[P]=1,a===1&&(t&&ze>y||!t&&ze>=y)&&(y=ze,_=u+P,t&&Oe===un))break;M=!1}else M?O[P]=Vt(T+Fr,0):O[P]=Vt(T+Ji,0),L[P]=0,M=!0;T=O[P]}if(x!==a)return[{start:-1,end:-1,score:0},null];if(a===1){let P={start:_,end:_+1,score:y};if(!s)return[P,null];let z=new Set;return z.add(_),[P,z]}let B=m[0],Q=w-B+1,G=null;[c,G]=Sr(c,o,Q*a);{let P=f.subarray(B,w+1);for(let[z,W]of P.entries())G[z]=W}let[,Z]=Sr(c,o,Q*a);{let P=d.subarray(B,w+1);for(let[z,W]of P.entries())Z[z]=W}let ne=m.subarray(1),he=i.slice(1).slice(0,ne.length);for(let[P,z]of ne.entries()){let W=!1,Oe=he[P],ze=P+1,ut=ze*Q,Ve=g.subarray(z,w+1),Ge=p.subarray(z).subarray(0,Ve.length),Wr=Z.subarray(ut+z-B).subarray(0,Ve.length),Ct=Z.subarray(ut+z-B-1-Q).subarray(0,Ve.length),qr=G.subarray(ut+z-B).subarray(0,Ve.length),ys=G.subarray(ut+z-B-1-Q).subarray(0,Ve.length),_n=G.subarray(ut+z-B-1).subarray(0,Ve.length);_n[0]=0;for(let[et,vs]of Ve.entries()){let Hr=et+z,Ft=0,pt=0,Pt=0;if(W?pt=_n[et]+Fr:pt=_n[et]+Ji,Oe===vs){Ft=ys[et]+Cr;let Gt=Ge[et];Pt=Ct[et]+1,Gt===un?Pt=1:Pt>1&&(Gt=Vt(Gt,Vt(Vu,p[Hr-Pt+1]))),Ft+Gt<pt?(Ft+=Ge[et],Pt=0):Ft+=Gt}Wr[et]=Pt,W=Ft<pt;let bn=Vt(Vt(Ft,pt),0);ze===a-1&&(t&&bn>y||!t&&bn>=y)&&(y=bn,_=Hr),qr[et]=bn}}let lt=ha(s),ee=B;if(s&&lt!==null){let P=a-1;ee=_;let z=!0;for(;;){let W=P*Q,Oe=ee-B,ze=G[W+Oe],ut=0,Ve=0;if(P>0&&ee>=m[P]&&(ut=G[W-Q+Oe-1]),ee>m[P]&&(Ve=G[W+Oe-1]),ze>ut&&(ze>Ve||ze===Ve&&z)){if(lt.add(ee),P===0)break;P--}z=Z[W+Oe]>1||W+Q+Oe+1<Z.length&&Z[W+Q+Oe+1]>0,ee--}}return[{start:ee,end:_+1,score:y},lt]};function Wu(n,e,t,r,i,s,o){let a=0,l=0,u=!1,c=0,h=0,f=ha(o),d=0;i>0&&(d=Qi(t[i-1]));for(let p=i;p<s;p++){let m=t[p],g=Qi(m);if(n||(m>=Ar&&m<=Tr?m+=32:m>Ln&&(m=String.fromCodePoint(m).toLowerCase().codePointAt(0))),e&&(m=Pr(m)),m===r[a]){o&&f!==null&&f.add(p),l+=Cr;let y=ya(d,g);c===0?h=y:(y===un&&(h=y),y=Vt(Vt(y,h),Vu)),a===0?l+=y*Ku:l+=y,u=!1,c++,a++}else u?l+=Fr:l+=Ji,u=!0,c=0,h=0;d=g}return[l,f]}var qu=(n,e,t,r,i,s,o)=>{if(i.length===0)return[{start:0,end:0,score:0},null];if(va(r,i,n)<0)return[{start:-1,end:-1,score:0},null];let a=0,l=-1,u=-1,c=r.length,h=i.length;for(let f=0;f<c;f++){let d=r[Rn(f,c,t)];n||(d>=Ar&&d<=Tr?d+=32:d>Ln&&(d=String.fromCodePoint(d).toLowerCase().codePointAt(0))),e&&(d=Pr(d));let p=i[Rn(a,h,t)];if(d===p&&(l<0&&(l=f),a++,a===h)){u=f+1;break}}if(l>=0&&u>=0){a--;for(let p=u-1;p>=l;p--){let m=Rn(p,c,t),g=r[m];n||(g>=Ar&&g<=Tr?g+=32:g>Ln&&(g=String.fromCodePoint(g).toLowerCase().codePointAt(0)));let y=Rn(a,h,t),_=i[y];if(g===_&&(a--,a<0)){l=p;break}}if(!t){let p=l;l=c-u,u=c-p}let[f,d]=Wu(n,e,r,i,l,u,s);return[{start:l,end:u,score:f},d]}return[{start:-1,end:-1,score:0},null]},Cp=(n,e,t,r,i,s,o)=>{if(i.length===0)return[{start:0,end:0,score:0},null];let a=r.length,l=i.length;if(a<l)return[{start:-1,end:-1,score:0},null];if(va(r,i,n)<0)return[{start:-1,end:-1,score:0},null];let u=0,c=-1,h=0,f=-1;for(let d=0;d<a;d++){let p=Rn(d,a,t),m=r[p];n||(m>=Ar&&m<=Tr?m+=32:m>Ln&&(m=String.fromCodePoint(m).toLowerCase().codePointAt(0))),e&&(m=Pr(m));let g=Rn(u,l,t);if(i[g]===m){if(g===0&&(h=Sp(r,p)),u++,u===l){if(h>f&&(c=d,f=h),h===un)break;d-=u-1,u=0,h=0}}else d-=u,u=0,h=0}if(c>=0){let d=0,p=0;t?(d=c-l+1,p=c+1):(d=a-(c+1),p=a-(c-l+1));let[m]=Wu(n,e,r,i,d,p,!1);return[{start:d,end:p,score:m},null]}return[{start:-1,end:-1,score:0},null]};var Fp=100*1024,Pp=2048;function Ip(n,e){return{i16:new Int16Array(n),i32:new Int32Array(e)}}var kp=Ip(Fp,Pp);var Hu=(n,e,t)=>{let r=!1;switch(e){case"smart-case":n.toLowerCase()!==n&&(r=!0);break;case"case-sensitive":r=!0;break;case"case-insensitive":n=n.toLowerCase(),r=!1;break}let i=ju(n);return t&&(i=i.map(Pr)),{queryRunes:i,caseSensitive:r}};function Gu(n,e){let t=Object.keys(n).map(i=>parseInt(i,10)).sort((i,s)=>s-i),r=[];for(let i of t)if(r=r.concat(n[i]),r.length>=e)break;return r}function Xu(n,e,t){return r=>{let i=this.runesList[r];if(e.length>i.length)return;let[s,o]=this.algoFn(t,this.opts.normalize,this.opts.forward,i,e,!0,kp);if(s.start===-1)return;if(this.opts.fuzzy===!1){o=new Set;for(let l=s.start;l<s.end;++l)o.add(l)}let a=this.opts.sort?s.score:0;n[a]===void 0&&(n[a]=[]),n[a].push({item:this.items[r],...s,positions:o!=null?o:new Set})}}function Mp(n){let{queryRunes:e,caseSensitive:t}=Hu(n,this.opts.casing,this.opts.normalize),r={},i=Xu.bind(this)(r,e,t);for(let s=0,o=this.runesList.length;s<o;++s)i(s);return Gu(r,this.opts.limit)}var Dp=typeof require!="undefined"&&typeof window=="undefined";function Op(n,e,t,r){return new Promise((i,s)=>{let a=0,l=Math.min(1e3,e),u=()=>{if(n.cancelled)return s("search cancelled");for(;a<l;++a)t(a);l<e?(l=Math.min(l+1e3,e),Dp?setImmediate(u):setTimeout(u)):i(r())};u()})}function Rp(n,e){let{queryRunes:t,caseSensitive:r}=Hu(n,this.opts.casing,this.opts.normalize),i={};return Op(e,this.runesList.length,Xu.bind(this)(i,t,r),()=>Gu(i,this.opts.limit))}var _a={limit:1/0,selector:n=>n,casing:"smart-case",normalize:!0,fuzzy:"v2",tiebreakers:[],sort:!0,forward:!0},pa=class{constructor(e,...t){switch(this.opts={..._a,...t[0]},this.items=e,this.runesList=e.map(r=>ju(this.opts.selector(r).normalize())),this.algoFn=Cp,this.opts.fuzzy){case"v2":this.algoFn=Tp;break;case"v1":this.algoFn=qu;break}}},jy={..._a,match:Mp};var Lp={..._a,match:Rp},ma=class extends pa{constructor(e,...t){super(e,...t),this.opts={...Lp,...t[0]},this.token={cancelled:!1}}async find(e){if(this.token.cancelled=!0,this.token={cancelled:!1},e.length===0||this.items.length===0)return this.items.slice(0,this.opts.limit).map(Np);e=e.normalize();let t=await this.opts.match.bind(this)(e,this.token);return jp(t,this.opts)}},Np=n=>({item:n,start:-1,end:-1,score:0,positions:new Set});function jp(n,e){if(e.sort){let{selector:t}=e;n.sort((r,i)=>{if(r.score===i.score)for(let s of e.tiebreakers){let o=s(r,i,t);if(o!==0)return o}return 0})}return Number.isFinite(e.limit)&&n.splice(e.limit),n}var Zi=class{constructor(e,...t){this.finder=new ma(e,...t),this.find=this.finder.find.bind(this.finder)}};var ue=function(){return ue=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ue.apply(this,arguments)};function Bp(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}function zp(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(t=0)),t;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function X(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pe(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return s}var Vp="ENTRIES",ec="KEYS",tc="VALUES",we="",ba=function(){function n(e,t){var r=e._tree,i=Array.from(r.keys());this.set=e,this._type=t,this._path=i.length>0?[{node:r,keys:i}]:[]}return n.prototype.next=function(){var e=this.dive();return this.backtrack(),e},n.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=Nn(this._path),t=e.node,r=e.keys;if(Nn(r)===we)return{done:!1,value:this.result()};var i=t.get(Nn(r));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},n.prototype.backtrack=function(){if(this._path.length!==0){var e=Nn(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},n.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var t=e.keys;return Nn(t)}).filter(function(e){return e!==we}).join("")},n.prototype.value=function(){return Nn(this._path).node.get(we)},n.prototype.result=function(){switch(this._type){case tc:return this.value();case ec:return this.key();default:return[this.key(),this.value()]}},n.prototype[Symbol.iterator]=function(){return this},n}(),Nn=function(n){return n[n.length-1]},Kp=function(n,e,t){var r=new Map;if(e===void 0)return r;for(var i=e.length+1,s=i+t,o=new Uint8Array(s*i).fill(t+1),a=0;a<i;++a)o[a]=a;for(var l=1;l<s;++l)o[l*i]=l;return nc(n,e,t,r,o,1,i,""),r},nc=function(n,e,t,r,i,s,o,a){var l,u,c=s*o;try{e:for(var h=X(n.keys()),f=h.next();!f.done;f=h.next()){var d=f.value;if(d===we){var p=i[c-1];p<=t&&r.set(a,[n.get(d),p])}else{for(var m=s,g=0;g<d.length;++g,++m){for(var y=d[g],_=o*m,x=_-o,w=i[_],S=Math.max(0,m-t-1),A=Math.min(o-1,m+t),T=S;T<A;++T){var I=y!==e[T],M=i[x+T]+ +I,j=i[x+T+1]+1,O=i[_+T]+1,L=i[_+T+1]=Math.min(M,j,O);L<w&&(w=L)}if(w>t)continue e}nc(n.get(d),e,t,r,i,m,o,a+d)}}}catch(k){l={error:k}}finally{try{f&&!f.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}},wa=function(){function n(e,t){e===void 0&&(e=new Map),t===void 0&&(t=""),this._size=void 0,this._tree=e,this._prefix=t}return n.prototype.atPrefix=function(e){var t,r;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=pe(ts(this._tree,e.slice(this._prefix.length)),2),s=i[0],o=i[1];if(s===void 0){var a=pe(Pa(o),2),l=a[0],u=a[1];try{for(var c=X(l.keys()),h=c.next();!h.done;h=c.next()){var f=h.value;if(f!==we&&f.startsWith(u)){var d=new Map;return d.set(f.slice(u.length),l.get(f)),new n(d,e)}}}catch(p){t={error:p}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}}return new n(s,e)},n.prototype.clear=function(){this._size=void 0,this._tree.clear()},n.prototype.delete=function(e){return this._size=void 0,$p(this._tree,e)},n.prototype.entries=function(){return new ba(this,Vp)},n.prototype.forEach=function(e){var t,r;try{for(var i=X(this),s=i.next();!s.done;s=i.next()){var o=pe(s.value,2),a=o[0],l=o[1];e(a,l,this)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},n.prototype.fuzzyGet=function(e,t){return Kp(this._tree,e,t)},n.prototype.get=function(e){var t=Ta(this._tree,e);return t!==void 0?t.get(we):void 0},n.prototype.has=function(e){var t=Ta(this._tree,e);return t!==void 0&&t.has(we)},n.prototype.keys=function(){return new ba(this,ec)},n.prototype.set=function(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=xa(this._tree,e);return r.set(we,t),this},Object.defineProperty(n.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),n.prototype.update=function(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=xa(this._tree,e);return r.set(we,t(r.get(we))),this},n.prototype.fetch=function(e,t){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=xa(this._tree,e),i=r.get(we);return i===void 0&&r.set(we,i=t()),i},n.prototype.values=function(){return new ba(this,tc)},n.prototype[Symbol.iterator]=function(){return this.entries()},n.from=function(e){var t,r,i=new n;try{for(var s=X(e),o=s.next();!o.done;o=s.next()){var a=pe(o.value,2),l=a[0],u=a[1];i.set(l,u)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i},n.fromObject=function(e){return n.from(Object.entries(e))},n}(),ts=function(n,e,t){var r,i;if(t===void 0&&(t=[]),e.length===0||n==null)return[n,t];try{for(var s=X(n.keys()),o=s.next();!o.done;o=s.next()){var a=o.value;if(a!==we&&e.startsWith(a))return t.push([n,a]),ts(n.get(a),e.slice(a.length),t)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return t.push([n,e]),ts(void 0,"",t)},Ta=function(n,e){var t,r;if(e.length===0||n==null)return n;try{for(var i=X(n.keys()),s=i.next();!s.done;s=i.next()){var o=s.value;if(o!==we&&e.startsWith(o))return Ta(n.get(o),e.slice(o.length))}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},xa=function(n,e){var t,r,i=e.length;e:for(var s=0;n&&s<i;){try{for(var o=(t=void 0,X(n.keys())),a=o.next();!a.done;a=o.next()){var l=a.value;if(l!==we&&e[s]===l[0]){for(var u=Math.min(i-s,l.length),c=1;c<u&&e[s+c]===l[c];)++c;var h=n.get(l);if(c===l.length)n=h;else{var f=new Map;f.set(l.slice(c),h),n.set(e.slice(s,s+c),f),n.delete(l),n=f}s+=c;continue e}}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}var d=new Map;return n.set(e.slice(s),d),d}return n},$p=function(n,e){var t=pe(ts(n,e),2),r=t[0],i=t[1];if(r!==void 0){if(r.delete(we),r.size===0)rc(i);else if(r.size===1){var s=pe(r.entries().next().value,2),o=s[0],a=s[1];ic(i,o,a)}}},rc=function(n){if(n.length!==0){var e=pe(Pa(n),2),t=e[0],r=e[1];if(t.delete(r),t.size===0)rc(n.slice(0,-1));else if(t.size===1){var i=pe(t.entries().next().value,2),s=i[0],o=i[1];s!==we&&ic(n.slice(0,-1),s,o)}}},ic=function(n,e,t){if(n.length!==0){var r=pe(Pa(n),2),i=r[0],s=r[1];i.set(s+e,t),i.delete(s)}},Pa=function(n){return n[n.length-1]},Ir,Ia="or",sc="and",Up="and_not",ns=function(){function n(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');var t=e.autoVacuum==null||e.autoVacuum===!0?Aa:e.autoVacuum;this._options=ue(ue(ue({},Sa),e),{autoVacuum:t,searchOptions:ue(ue({},Yu),e.searchOptions||{}),autoSuggestOptions:ue(ue({},Xp),e.autoSuggestOptions||{})}),this._index=new wa,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Fa,this.addFields(this._options.fields)}return n.prototype.add=function(e){var t,r,i,s,o,a,l=this._options,u=l.extractField,c=l.tokenize,h=l.processTerm,f=l.fields,d=l.idField,p=u(e,d);if(p==null)throw new Error('MiniSearch: document does not have ID field "'.concat(d,'"'));if(this._idToShortId.has(p))throw new Error("MiniSearch: duplicate ID ".concat(p));var m=this.addDocumentId(p);this.saveStoredFields(m,e);try{for(var g=X(f),y=g.next();!y.done;y=g.next()){var _=y.value,x=u(e,_);if(x!=null){var w=c(x.toString(),_),S=this._fieldIds[_],A=new Set(w).size;this.addFieldLength(m,S,this._documentCount-1,A);try{for(var T=(i=void 0,X(w)),I=T.next();!I.done;I=T.next()){var M=I.value,j=h(M,_);if(Array.isArray(j))try{for(var O=(o=void 0,X(j)),L=O.next();!L.done;L=O.next()){var k=L.value;this.addTerm(S,m,k)}}catch(B){o={error:B}}finally{try{L&&!L.done&&(a=O.return)&&a.call(O)}finally{if(o)throw o.error}}else j&&this.addTerm(S,m,j)}}catch(B){i={error:B}}finally{try{I&&!I.done&&(s=T.return)&&s.call(T)}finally{if(i)throw i.error}}}}}catch(B){t={error:B}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}},n.prototype.addAll=function(e){var t,r;try{for(var i=X(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.add(o)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},n.prototype.addAllAsync=function(e,t){var r=this;t===void 0&&(t={});var i=t.chunkSize,s=i===void 0?10:i,o={chunk:[],promise:Promise.resolve()},a=e.reduce(function(c,h,f){var d=c.chunk,p=c.promise;return d.push(h),(f+1)%s===0?{chunk:[],promise:p.then(function(){return new Promise(function(m){return setTimeout(m,0)})}).then(function(){return r.addAll(d)})}:{chunk:d,promise:p}},o),l=a.chunk,u=a.promise;return u.then(function(){return r.addAll(l)})},n.prototype.remove=function(e){var t,r,i,s,o,a,l=this._options,u=l.tokenize,c=l.processTerm,h=l.extractField,f=l.fields,d=l.idField,p=h(e,d);if(p==null)throw new Error('MiniSearch: document does not have ID field "'.concat(d,'"'));var m=this._idToShortId.get(p);if(m==null)throw new Error("MiniSearch: cannot remove document with ID ".concat(p,": it is not in the index"));try{for(var g=X(f),y=g.next();!y.done;y=g.next()){var _=y.value,x=h(e,_);if(x!=null){var w=u(x.toString(),_),S=this._fieldIds[_],A=new Set(w).size;this.removeFieldLength(m,S,this._documentCount,A);try{for(var T=(i=void 0,X(w)),I=T.next();!I.done;I=T.next()){var M=I.value,j=c(M,_);if(Array.isArray(j))try{for(var O=(o=void 0,X(j)),L=O.next();!L.done;L=O.next()){var k=L.value;this.removeTerm(S,m,k)}}catch(B){o={error:B}}finally{try{L&&!L.done&&(a=O.return)&&a.call(O)}finally{if(o)throw o.error}}else j&&this.removeTerm(S,m,j)}}catch(B){i={error:B}}finally{try{I&&!I.done&&(s=T.return)&&s.call(T)}finally{if(i)throw i.error}}}}}catch(B){t={error:B}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}this._storedFields.delete(m),this._documentIds.delete(m),this._idToShortId.delete(p),this._fieldLength.delete(m),this._documentCount-=1},n.prototype.removeAll=function(e){var t,r;if(e)try{for(var i=X(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.remove(o)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new wa,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},n.prototype.discard=function(e){var t=this,r=this._idToShortId.get(e);if(r==null)throw new Error("MiniSearch: cannot discard document with ID ".concat(e,": it is not in the index"));this._idToShortId.delete(e),this._documentIds.delete(r),this._storedFields.delete(r),(this._fieldLength.get(r)||[]).forEach(function(i,s){t.removeFieldLength(r,s,t._documentCount,i)}),this._fieldLength.delete(r),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()},n.prototype.maybeAutoVacuum=function(){if(this._options.autoVacuum!==!1){var e=this._options.autoVacuum,t=e.minDirtFactor,r=e.minDirtCount,i=e.batchSize,s=e.batchWait;this.conditionalVacuum({batchSize:i,batchWait:s},{minDirtCount:r,minDirtFactor:t})}},n.prototype.discardAll=function(e){var t,r,i=this._options.autoVacuum;try{this._options.autoVacuum=!1;try{for(var s=X(e),o=s.next();!o.done;o=s.next()){var a=o.value;this.discard(a)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}}finally{this._options.autoVacuum=i}this.maybeAutoVacuum()},n.prototype.replace=function(e){var t=this._options,r=t.idField,i=t.extractField,s=i(e,r);this.discard(s),this.add(e)},n.prototype.vacuum=function(e){return e===void 0&&(e={}),this.conditionalVacuum(e)},n.prototype.conditionalVacuum=function(e,t){var r=this;return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&t,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(function(){var i=r._enqueuedVacuumConditions;return r._enqueuedVacuumConditions=Fa,r.performVacuuming(e,i)}),this._enqueuedVacuum)):this.vacuumConditionsMet(t)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)},n.prototype.performVacuuming=function(e,t){return Bp(this,void 0,void 0,function(){var r,i,s,o,a,l,u,c,h,f,d,p,m,g,y,_,x,w,S,A,T,I,M,j,O;return zp(this,function(L){switch(L.label){case 0:if(r=this._dirtCount,!this.vacuumConditionsMet(t))return[3,10];i=e.batchSize||Ca.batchSize,s=e.batchWait||Ca.batchWait,o=1,L.label=1;case 1:L.trys.push([1,7,8,9]),a=X(this._index),l=a.next(),L.label=2;case 2:if(l.done)return[3,6];u=pe(l.value,2),c=u[0],h=u[1];try{for(f=(I=void 0,X(h)),d=f.next();!d.done;d=f.next()){p=pe(d.value,2),m=p[0],g=p[1];try{for(y=(j=void 0,X(g)),_=y.next();!_.done;_=y.next())x=pe(_.value,1),w=x[0],!this._documentIds.has(w)&&(g.size<=1?h.delete(m):g.delete(w))}catch(k){j={error:k}}finally{try{_&&!_.done&&(O=y.return)&&O.call(y)}finally{if(j)throw j.error}}}}catch(k){I={error:k}}finally{try{d&&!d.done&&(M=f.return)&&M.call(f)}finally{if(I)throw I.error}}return this._index.get(c).size===0&&this._index.delete(c),o%i!==0?[3,4]:[4,new Promise(function(k){return setTimeout(k,s)})];case 3:L.sent(),L.label=4;case 4:o+=1,L.label=5;case 5:return l=a.next(),[3,2];case 6:return[3,9];case 7:return S=L.sent(),A={error:S},[3,9];case 8:try{l&&!l.done&&(T=a.return)&&T.call(a)}finally{if(A)throw A.error}return[7];case 9:this._dirtCount-=r,L.label=10;case 10:return[4,null];case 11:return L.sent(),this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null,[2]}})})},n.prototype.vacuumConditionsMet=function(e){if(e==null)return!0;var t=e.minDirtCount,r=e.minDirtFactor;return t=t||Aa.minDirtCount,r=r||Aa.minDirtFactor,this.dirtCount>=t&&this.dirtFactor>=r},Object.defineProperty(n.prototype,"isVacuuming",{get:function(){return this._currentVacuum!=null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dirtCount",{get:function(){return this._dirtCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dirtFactor",{get:function(){return this._dirtCount/(1+this._documentCount+this._dirtCount)},enumerable:!1,configurable:!0}),n.prototype.has=function(e){return this._idToShortId.has(e)},n.prototype.getStoredFields=function(e){var t=this._idToShortId.get(e);if(t!=null)return this._storedFields.get(t)},n.prototype.search=function(e,t){var r,i;t===void 0&&(t={});var s=this.executeQuery(e,t),o=[];try{for(var a=X(s),l=a.next();!l.done;l=a.next()){var u=pe(l.value,2),c=u[0],h=u[1],f=h.score,d=h.terms,p=h.match,m=d.length||1,g={id:this._documentIds.get(c),score:f*m,terms:Object.keys(p),queryTerms:d,match:p};Object.assign(g,this._storedFields.get(c)),(t.filter==null||t.filter(g))&&o.push(g)}}catch(y){r={error:y}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return e===n.wildcard&&t.boostDocument==null&&this._options.searchOptions.boostDocument==null||o.sort(Qu),o},n.prototype.autoSuggest=function(e,t){var r,i,s,o;t===void 0&&(t={}),t=ue(ue({},this._options.autoSuggestOptions),t);var a=new Map;try{for(var l=X(this.search(e,t)),u=l.next();!u.done;u=l.next()){var c=u.value,h=c.score,f=c.terms,d=f.join(" "),p=a.get(d);p!=null?(p.score+=h,p.count+=1):a.set(d,{score:h,terms:f,count:1})}}catch(S){r={error:S}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}var m=[];try{for(var g=X(a),y=g.next();!y.done;y=g.next()){var _=pe(y.value,2),p=_[0],x=_[1],h=x.score,f=x.terms,w=x.count;m.push({suggestion:p,terms:f,score:h/w})}}catch(S){s={error:S}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(s)throw s.error}}return m.sort(Qu),m},Object.defineProperty(n.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"termCount",{get:function(){return this._index.size},enumerable:!1,configurable:!0}),n.loadJSON=function(e,t){if(t==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),t)},n.getDefault=function(e){if(Sa.hasOwnProperty(e))return Ea(Sa,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},n.loadJS=function(e,t){var r,i,s,o,a,l,u=e.index,c=e.documentCount,h=e.nextId,f=e.documentIds,d=e.fieldIds,p=e.fieldLength,m=e.averageFieldLength,g=e.storedFields,y=e.dirtCount,_=e.serializationVersion;if(_!==1&&_!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var x=new n(t);x._documentCount=c,x._nextId=h,x._documentIds=es(f),x._idToShortId=new Map,x._fieldIds=d,x._fieldLength=es(p),x._avgFieldLength=m,x._storedFields=es(g),x._dirtCount=y||0,x._index=new wa;try{for(var w=X(x._documentIds),S=w.next();!S.done;S=w.next()){var A=pe(S.value,2),T=A[0],I=A[1];x._idToShortId.set(I,T)}}catch(he){r={error:he}}finally{try{S&&!S.done&&(i=w.return)&&i.call(w)}finally{if(r)throw r.error}}try{for(var M=X(u),j=M.next();!j.done;j=M.next()){var O=pe(j.value,2),L=O[0],k=O[1],B=new Map;try{for(var Q=(a=void 0,X(Object.keys(k))),G=Q.next();!G.done;G=Q.next()){var Z=G.value,ne=k[Z];_===1&&(ne=ne.ds),B.set(parseInt(Z,10),es(ne))}}catch(he){a={error:he}}finally{try{G&&!G.done&&(l=Q.return)&&l.call(Q)}finally{if(a)throw a.error}}x._index.set(L,B)}}catch(he){s={error:he}}finally{try{j&&!j.done&&(o=M.return)&&o.call(M)}finally{if(s)throw s.error}}return x},n.prototype.executeQuery=function(e,t){var r=this;if(t===void 0&&(t={}),e===n.wildcard)return this.executeWildcardQuery(t);if(typeof e!="string"){var i=ue(ue(ue({},t),e),{queries:void 0}),s=e.queries.map(function(g){return r.executeQuery(g,i)});return this.combineResults(s,i.combineWith)}var o=this._options,a=o.tokenize,l=o.processTerm,u=o.searchOptions,c=ue(ue({tokenize:a,processTerm:l},u),t),h=c.tokenize,f=c.processTerm,d=h(e).flatMap(function(g){return f(g)}).filter(function(g){return!!g}),p=d.map(Gp(c)),m=p.map(function(g){return r.executeQuerySpec(g,c)});return this.combineResults(m,c.combineWith)},n.prototype.executeQuerySpec=function(e,t){var r,i,s,o,a=ue(ue({},this._options.searchOptions),t),l=(a.fields||this._options.fields).reduce(function(Z,ne){var he;return ue(ue({},Z),(he={},he[ne]=Ea(a.boost,ne)||1,he))},{}),u=a.boostDocument,c=a.weights,h=a.maxFuzzy,f=a.bm25,d=ue(ue({},Yu.weights),c),p=d.fuzzy,m=d.prefix,g=this._index.get(e.term),y=this.termResults(e.term,e.term,1,g,l,u,f),_,x;if(e.prefix&&(_=this._index.atPrefix(e.term)),e.fuzzy){var w=e.fuzzy===!0?.2:e.fuzzy,S=w<1?Math.min(h,Math.round(e.term.length*w)):w;S&&(x=this._index.fuzzyGet(e.term,S))}if(_)try{for(var A=X(_),T=A.next();!T.done;T=A.next()){var I=pe(T.value,2),M=I[0],j=I[1],O=M.length-e.term.length;if(O){x==null||x.delete(M);var L=m*M.length/(M.length+.3*O);this.termResults(e.term,M,L,j,l,u,f,y)}}}catch(Z){r={error:Z}}finally{try{T&&!T.done&&(i=A.return)&&i.call(A)}finally{if(r)throw r.error}}if(x)try{for(var k=X(x.keys()),B=k.next();!B.done;B=k.next()){var M=B.value,Q=pe(x.get(M),2),G=Q[0],O=Q[1];if(O){var L=p*M.length/(M.length+O);this.termResults(e.term,M,L,G,l,u,f,y)}}}catch(Z){s={error:Z}}finally{try{B&&!B.done&&(o=k.return)&&o.call(k)}finally{if(s)throw s.error}}return y},n.prototype.executeWildcardQuery=function(e){var t,r,i=new Map,s=ue(ue({},this._options.searchOptions),e);try{for(var o=X(this._documentIds),a=o.next();!a.done;a=o.next()){var l=pe(a.value,2),u=l[0],c=l[1],h=s.boostDocument?s.boostDocument(c,"",this._storedFields.get(u)):1;i.set(u,{score:h,terms:[],match:{}})}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return i},n.prototype.combineResults=function(e,t){if(t===void 0&&(t=Ia),e.length===0)return new Map;var r=t.toLowerCase();return e.reduce(Wp[r])||new Map},n.prototype.toJSON=function(){var e,t,r,i,s=[];try{for(var o=X(this._index),a=o.next();!a.done;a=o.next()){var l=pe(a.value,2),u=l[0],c=l[1],h={};try{for(var f=(r=void 0,X(c)),d=f.next();!d.done;d=f.next()){var p=pe(d.value,2),m=p[0],g=p[1];h[m]=Object.fromEntries(g)}}catch(y){r={error:y}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}s.push([u,h])}}catch(y){e={error:y}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:s,serializationVersion:2}},n.prototype.termResults=function(e,t,r,i,s,o,a,l){var u,c,h,f,d;if(l===void 0&&(l=new Map),i==null)return l;try{for(var p=X(Object.keys(s)),m=p.next();!m.done;m=p.next()){var g=m.value,y=s[g],_=this._fieldIds[g],x=i.get(_);if(x!=null){var w=x.size,S=this._avgFieldLength[_];try{for(var A=(h=void 0,X(x.keys())),T=A.next();!T.done;T=A.next()){var I=T.value;if(!this._documentIds.has(I)){this.removeTerm(_,I,t),w-=1;continue}var M=o?o(this._documentIds.get(I),t,this._storedFields.get(I)):1;if(M){var j=x.get(I),O=this._fieldLength.get(I)[_],L=Hp(j,w,this._documentCount,O,S,a),k=r*y*M*L,B=l.get(I);if(B){B.score+=k,Yp(B.terms,e);var Q=Ea(B.match,t);Q?Q.push(g):B.match[t]=[g]}else l.set(I,{score:k,terms:[e],match:(d={},d[t]=[g],d)})}}}catch(G){h={error:G}}finally{try{T&&!T.done&&(f=A.return)&&f.call(A)}finally{if(h)throw h.error}}}}}catch(G){u={error:G}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return l},n.prototype.addTerm=function(e,t,r){var i=this._index.fetch(r,Zu),s=i.get(e);if(s==null)s=new Map,s.set(t,1),i.set(e,s);else{var o=s.get(t);s.set(t,(o||0)+1)}},n.prototype.removeTerm=function(e,t,r){if(!this._index.has(r)){this.warnDocumentChanged(t,e,r);return}var i=this._index.fetch(r,Zu),s=i.get(e);s==null||s.get(t)==null?this.warnDocumentChanged(t,e,r):s.get(t)<=1?s.size<=1?i.delete(e):s.delete(t):s.set(t,s.get(t)-1),this._index.get(r).size===0&&this._index.delete(r)},n.prototype.warnDocumentChanged=function(e,t,r){var i,s;try{for(var o=X(Object.keys(this._fieldIds)),a=o.next();!a.done;a=o.next()){var l=a.value;if(this._fieldIds[l]===t){this._options.logger("warn","MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(r,'" was not present in field "').concat(l,'". Removing a document after it has changed can corrupt the index!'),"version_conflict");return}}}catch(u){i={error:u}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}},n.prototype.addDocumentId=function(e){var t=this._nextId;return this._idToShortId.set(e,t),this._documentIds.set(t,e),this._documentCount+=1,this._nextId+=1,t},n.prototype.addFields=function(e){for(var t=0;t<e.length;t++)this._fieldIds[e[t]]=t},n.prototype.addFieldLength=function(e,t,r,i){var s=this._fieldLength.get(e);s==null&&this._fieldLength.set(e,s=[]),s[t]=i;var o=this._avgFieldLength[t]||0,a=o*r+i;this._avgFieldLength[t]=a/(r+1)},n.prototype.removeFieldLength=function(e,t,r,i){if(r===1){this._avgFieldLength[t]=0;return}var s=this._avgFieldLength[t]*r-i;this._avgFieldLength[t]=s/(r-1)},n.prototype.saveStoredFields=function(e,t){var r,i,s=this._options,o=s.storeFields,a=s.extractField;if(!(o==null||o.length===0)){var l=this._storedFields.get(e);l==null&&this._storedFields.set(e,l={});try{for(var u=X(o),c=u.next();!c.done;c=u.next()){var h=c.value,f=a(t,h);f!==void 0&&(l[h]=f)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}},n.wildcard=Symbol("*"),n}(),Ea=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0},Wp=(Ir={},Ir[Ia]=function(n,e){var t,r;try{for(var i=X(e.keys()),s=i.next();!s.done;s=i.next()){var o=s.value,a=n.get(o);if(a==null)n.set(o,e.get(o));else{var l=e.get(o),u=l.score,c=l.terms,h=l.match;a.score=a.score+u,a.match=Object.assign(a.match,h),Ju(a.terms,c)}}}catch(f){t={error:f}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},Ir[sc]=function(n,e){var t,r,i=new Map;try{for(var s=X(e.keys()),o=s.next();!o.done;o=s.next()){var a=o.value,l=n.get(a);if(l!=null){var u=e.get(a),c=u.score,h=u.terms,f=u.match;Ju(l.terms,h),i.set(a,{score:l.score+c,terms:l.terms,match:Object.assign(l.match,f)})}}}catch(d){t={error:d}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return i},Ir[Up]=function(n,e){var t,r;try{for(var i=X(e.keys()),s=i.next();!s.done;s=i.next()){var o=s.value;n.delete(o)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},Ir),qp={k:1.2,b:.7,d:.5},Hp=function(n,e,t,r,i,s){var o=s.k,a=s.b,l=s.d,u=Math.log(1+(t-e+.5)/(e+.5));return u*(l+n*(o+1)/(n+o*(1-a+a*r/i)))},Gp=function(n){return function(e,t,r){var i=typeof n.fuzzy=="function"?n.fuzzy(e,t,r):n.fuzzy||!1,s=typeof n.prefix=="function"?n.prefix(e,t,r):n.prefix===!0;return{term:e,fuzzy:i,prefix:s}}},Sa={idField:"id",extractField:function(n,e){return n[e]},tokenize:function(n){return n.split(Jp)},processTerm:function(n){return n.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[],logger:function(n,e){typeof(console==null?void 0:console[n])=="function"&&console[n](e)},autoVacuum:!0},Yu={combineWith:Ia,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:qp},Xp={combineWith:sc,prefix:function(n,e,t){return e===t.length-1}},Ca={batchSize:1e3,batchWait:10},Fa={minDirtFactor:.1,minDirtCount:20},Aa=ue(ue({},Ca),Fa),Yp=function(n,e){n.includes(e)||n.push(e)},Ju=function(n,e){var t,r;try{for(var i=X(e),s=i.next();!s.done;s=i.next()){var o=s.value;n.includes(o)||n.push(o)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},Qu=function(n,e){var t=n.score,r=e.score;return r-t},Zu=function(){return new Map},es=function(n){var e,t,r=new Map;try{for(var i=X(Object.keys(n)),s=i.next();!s.done;s=i.next()){var o=s.value;r.set(parseInt(o,10),n[o])}}catch(a){e={error:a}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},Jp=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;function kr(n,e,t){var r=t||{},i=r.noTrailing,s=i===void 0?!1:i,o=r.noLeading,a=o===void 0?!1:o,l=r.debounceMode,u=l===void 0?void 0:l,c,h=!1,f=0;function d(){c&&clearTimeout(c)}function p(g){var y=g||{},_=y.upcomingOnly,x=_===void 0?!1:_;d(),h=!x}function m(){for(var g=arguments.length,y=new Array(g),_=0;_<g;_++)y[_]=arguments[_];var x=this,w=Date.now()-f;if(h)return;function S(){f=Date.now(),e.apply(x,y)}function A(){c=void 0}!a&&u&&!c&&S(),d(),u===void 0&&w>n?a?(f=Date.now(),s||(c=setTimeout(u?A:S,n))):S():s!==!0&&(c=setTimeout(u?A:S,u===void 0?n-w:n))}return m.cancel=p,m}function oc(n,e,t){var r=t||{},i=r.atBegin,s=i===void 0?!1:i;return kr(n,e,{debounceMode:s!==!1})}var Mr=class{static minInSet(e){let t=Number.MAX_VALUE;for(let r of e)r<t&&(t=r);return t}},rs=class{constructor(e,t,r){this.flushThrottled=kr(1e4,()=>this.forceFlush());this.elementsMap=new Map,this.handler=e,this.identifier=t,this.autoFlushThreshold=r}add(e){let t=this.identifier(e);this.elementsMap.set(t,e),this.elementsMap.size>=this.autoFlushThreshold&&this.flushThrottled()}async forceFlush(){if(this.elementsMap.size===0)return;let e=Array.from(this.elementsMap.values());this.elementsMap.clear(),await this.handler(e),C.debug("flushed")}},is=class{constructor(e,t=Number.MAX_VALUE){this.heap=[],this.compare=e,this.capacity=t}values(){return this.heap}push(e){this.size()<this.capacity?(this.heap.push(e),this.heapifyUp()):this.compare(e,this.heap[0])>0&&(this.heap[0]=e,this.heapifyDown())}clear(){this.heap=[]}pop(){if(this.isEmpty())return;let e=this.heap[0];return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.heapifyDown(),e}peek(){return this.heap[0]}isEmpty(){return this.heap.length===0}size(){return this.heap.length}getLeftChildIndex(e){return 2*e+1}getRightChildIndex(e){return 2*e+2}getParentIndex(e){return Math.floor((e-1)/2)}swap(e,t){[this.heap[e],this.heap[t]]=[this.heap[t],this.heap[e]]}heapifyUp(){let e=this.heap.length-1;for(;this.getParentIndex(e)>=0&&this.compare(this.heap[this.getParentIndex(e)],this.heap[e])>0;)this.swap(this.getParentIndex(e),e),e=this.getParentIndex(e)}heapifyDown(){let e=0;for(;this.getLeftChildIndex(e)<this.heap.length;){let t=this.getLeftChildIndex(e);if(this.getRightChildIndex(e)<this.heap.length&&this.compare(this.heap[this.getRightChildIndex(e)],this.heap[t])<0&&(t=this.getRightChildIndex(e)),this.compare(this.heap[e],this.heap[t])<0)break;this.swap(e,t),e=t}}};var ka=ae(ce());var ss=class{constructor(e){this.text=e}};var Qp=/[\u4e00-\u9fa5]/,ac=/[\u4e00-\u9fa5]/g,lc=/[\u4e00-\u9fa5]/,os=class{static isLargeCharset(e){return(e.match(ac)||[]).length>=Math.ceil(e.length*.35)}static testWideChar(e){return Qp.test(e)}static wideCharProportion(e){return(e.match(ac)||[]).length/e.length}};var uc=ae(ce());var Zp=/[\[\]{}()<>\s]+/u,em=/[\^=#%\/\*,\.`:;\?@\s\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u,tm=/[-_]|([a-z](?=[A-Z]))/g,Kt=class{constructor(){this.setting=b(se);this.chsSegmenter=b(it);this.logThrottled=kr(300,e=>C.info(e));this.assetsProvider=b(Ke);this.stopWordsZh=this.assetsProvider.assets.stopWordsZh;this.stopWordsEn=this.assetsProvider.assets.stopWordsEn}tokenize(e,t){var s,o;let r=new Set,i=e.split(Zp);for(let a of i)if(a)if(this.setting.enableChinesePatch&&lc.test(a)){let l=this.chsSegmenter.cut(a,!0);for(let u of l){if(this.setting.enableStopWordsZh&&((s=this.stopWordsZh)!=null&&s.has(u))){t==="search"&&u.length>1&&C.debug(`excluded: ${u}`);continue}r.add(u)}}else{let l=a.split(em);for(let u of l)if(!(u.length<2||this.setting.enableStopWordsEn&&((o=this.stopWordsEn)!=null&&o.has(u)))&&(r.add(u),u.length>3)){let c=u.replace(tm,"$1 ").split(" ");for(let h of c)h.length>1&&r.add(h)}}return Array.from(r)}};Kt=N([(0,uc.singleton)()],Kt);var cn=class{static forType(e,t){return t&&os.testWideChar(t)?this.limitsByLanguage["\u7B80\u4F53\u4E2D\u6587"][e]:this.limitsByLanguage["English"][e]}},Je=cn;Je.default={line:{maxPreLines:0,maxPostLines:0,maxPreChars:30,maxPostChars:230,boundaryLineMinChars:4},paragraph:{maxPreLines:4,maxPostLines:7,maxPreChars:220,maxPostChars:600,boundaryLineMinChars:4},subItem:{maxPreLines:3,maxPostLines:3,maxPreChars:180,maxPostChars:200,boundaryLineMinChars:4}},Je.limitsByLanguage={["Other Language"]:cn.default,["English"]:cn.default,["\u7B80\u4F53\u4E2D\u6587"]:{line:{...cn.default.line,maxPreChars:30,maxPostChars:230},paragraph:{...cn.default.paragraph,maxPreChars:220,maxPostChars:600},subItem:{...cn.default.subItem,maxPreChars:60,maxPostChars:80}}};var We=class{constructor(){this.option=b(Dr);this.pluginSetting=b(se);this.filesIndex=new ns(this.option.fileIndexOption);this.linesIndex=new ns(this.option.lineIndexOption);this.tokenizer=b(Kt);this._isReady=!1}async reIndexAll(e){if(this._isReady=!1,this.filesIndex.removeAll(),Array.isArray(e))C.trace("Indexing all documents..."),await this.addDocuments(e);else{C.trace("Loading indexed data...");try{this.filesIndex=ns.loadJS(e,this.option.fileIndexOption)}catch(t){return C.error(t),!1}}return this._isReady=!0,C.trace(this.filesIndex),!0}get isReady(){return this._isReady}async addDocuments(e){let t=e.filter(r=>!this.filesIndex.has(r.path));await this.filesIndex.addAllAsync(t,{chunkSize:this.option.documentChunkSize}),C.debug(`added ${t.length}`)}deleteDocuments(e){let t=e.filter(r=>this.filesIndex.has(r));this.filesIndex.discardAll(t),C.debug(`deleted ${t.length}`)}async fzfMatch(e,t){return(await new Zi(t,{selector:i=>i.text}).find(e)).slice(0,this.pluginSetting.ui.maxItemResults).map(i=>({text:i.item.text,row:i.item.row,positions:i.positions}))}async searchFiles(e){let t="and",r=new ss(e),i=this.filesIndex.search(r.text,this.option.getFileSearchOption(t));return C.debug(`maxFileItems: ${this.pluginSetting.ui.maxItemResults}`),i.slice(0,this.pluginSetting.ui.maxItemResults).map(s=>({path:s.id,queryTerms:s.queryTerms,matchedTerms:s.terms}))}async searchLinesByFileItem(e,t,r,i,s){C.debug(i.queryTerms),C.debug(i.matchedTerms);let o=50;return C.debug(`max subItems: ${o}`),new Or(e,t,r,i.queryTerms,i.matchedTerms,s).parse()}async searchLinesForSmallCharset(e,t,r){this.linesIndex.removeAll(),this.linesIndex.addAll(e);let i=this.linesIndex.search(t,this.option.getLineSearchOption());return C.debug(`matched lines count: ${i.length}`),C.debug(`only parse top ${r} matched lines per file`),i.slice(0,r).map(s=>{let o=e[s.id].text;return{text:o,row:s.id,positions:this.findAllTermPositions(o,s.terms)}})}findAllTermPositions(e,t){let r=new RegExp(t.join("|"),"gi"),i=new Set,s,o=-1;for(;(s=r.exec(e))!==null;){if(s.index===o||s[0].length===0){r.lastIndex++;continue}for(let a=0;a<s[0].length;a++)i.add(s.index+a);o=s.index}return i}};N([Se],We.prototype,"reIndexAll",1),N([Se],We.prototype,"searchFiles",1),N([Se],We.prototype,"searchLinesForSmallCharset",1),We=N([(0,ka.singleton)()],We);var Dr=class{constructor(){this.inSetting=Ol.search;this.tokenizer=b(Kt);this.tokenizeIndex=e=>this.tokenizer.tokenize(e,"index");this.tokenizeSearch=e=>this.tokenizer.tokenize(e,"search");this.fileIndexOption={tokenize:this.tokenizeIndex,idField:"path",fields:["basename","aliases","folder","headings","content"],storeFields:["tags"]};this.lineIndexOption={tokenize:this.tokenizeIndex,idField:"row",fields:["text"]}}getFileSearchOption(e){return{tokenize:this.tokenizeSearch,prefix:t=>t.length>=this.inSetting.minTermLengthForPrefixSearch,fuzzy:t=>t.length<=3?0:this.inSetting.fuzzyProportion,boost:{basename:this.inSetting.weightFilename,aliases:this.inSetting.weightFilename,folder:this.inSetting.weightFolder,tags:this.inSetting.weightTagText,headings:this.inSetting.weightHeading},combineWith:e}}getLineSearchOption(){return{prefix:e=>e.length>=this.inSetting.minTermLengthForPrefixSearch,fuzzy:e=>e.length<=3?0:this.inSetting.fuzzyProportion,combineWith:"or"}}};Dr=N([(0,ka.singleton)()],Dr);var Or=class{constructor(e,t,r,i,s,o){this.lines=e,this.matchedTerms=this.filterMatchedTerms(i,s),this.maxParsedLines=o;let a=Je.forType(t,r);this.preChars=a.maxPreChars,this.postChars=a.maxPostChars,C.debug(`doc matchedTerms: ${this.matchedTerms.join(" ")}`)}parse(){return this.highlightLines(this.getTopRelevantLines(this.lines,this.maxParsedLines))}filterMatchedTerms(e,t){let r=e.filter(s=>!e.some(o=>o.length>s.length&&o.includes(s))&&t.includes(s)),i;if(r.length===0)i=t.filter(s=>!t.some(o=>o.length>s.length&&o.includes(s)));else{i=r;for(let s of t)!r.includes(s)&&!this.isSubstringOrSuperString(s,t)&&i.push(s)}return i}isSubstringOrSuperString(e,t){return t.some(r=>r.length>e.length&&r.includes(e)||e.length>r.length&&e.includes(r))}getTopRelevantLines(e,t){let r=new RegExp(this.matchedTerms.join("|"),"i"),i=this.matchedTerms.map(l=>new RegExp(l,"gi")),s=new is((l,u)=>l-u,t);s.push(0);let o=new Map,a=new Map;for(let l of e){if(!r.test(l.text))continue;a.clear();let u=0;for(let c of i){c.lastIndex=0;let h;for(;(h=c.exec(l.text))!==null;){let f=h[0],d=(a.get(f)||0)+1;a.set(f,d),u+=d===1?f.length:.01}}u>s.peek()&&(s.push(u),o.set(l,u))}return Array.from(o.entries()).sort((l,u)=>u[1]-l[1]).slice(0,t).map(l=>l[0])}highlightLines(e){let t=new Map;for(let r of this.matchedTerms)t.set(r,new RegExp(r,"gi"));return e.map(r=>{let i=new Set,s=-1,o=-1;for(let a=this.matchedTerms.length-1;a>=0;a--){let l=this.matchedTerms[a],u=r.text.search(t.get(l));if(u!==-1){s=Math.max(0,u-this.preChars),o=Math.min(r.text.length,u+l.length+this.postChars);break}}if(s!==-1&&o!==-1){let a=r.text.slice(s,o);for(let l of this.matchedTerms){let u=t.get(l),c;for(;(c=u.exec(a))!==null;){let h=c.index+s,f=h+c[0].length;for(let d=h;d<f;d++)i.add(d)}}}return{text:r.text,row:r.row,positions:i}})}};N([Se],Or.prototype,"getTopRelevantLines",1),N([Se],Or.prototype,"highlightLines",1);var Ma=class{constructor(){this.listeners=new Map}on(e,t){var r;this.listeners.has(e)||this.listeners.set(e,[]),(r=this.listeners.get(e))==null||r.push(t)}off(e,t){let r=this.listeners.get(e);if(r){let i=r.indexOf(t);i>-1&&r.splice(i,1)}}emit(e,...t){var r;(r=this.listeners.get(e))==null||r.forEach(i=>{i(...t)})}},$t=new Ma;var pc=ae(ce());var Qe=require("obsidian");var Da=ae(ce());var Ie=class{constructor(){this.vault=b(Qe.Vault);this.app=b(Qe.App);this.setting=b(se);this.privateApi=b(Fe);this.viewRegistry=b(Pe);this.htmlParser=b(Rr);this.init()}init(){this.excludedPaths=new Set(this.setting.excludedPaths),this.supportedExtensions=new Set(this.setting.customExtensions.plaintext)}async generateAllIndexedDocuments(e){return Promise.all(e.map(async t=>{if(this.isContentIndexable(t)){let r=this.app.metadataCache.getFileCache(t);if(this.viewRegistry.viewTypeByPath(t.path)==="markdown")return{path:t.path,basename:t.basename,folder:le.getFolderPath(t.path),aliases:this.parseAliases(r),tags:this.parseTags(r),headings:this.parseHeadings(r),content:await this.readPlainText(t)};throw new Error(xn)}else return{path:t.path,basename:t.basename,folder:le.getFolderPath(t.path)}}))}allFilesToBeIndexed(){let e=this.vault.getFiles();C.debug(`all files: ${e.length}`),le.countFileByExtensions(e);let t=e.filter(r=>this.isIndexable(r));return C.debug(`indexable files: ${t.length}`),le.countFileByExtensions(t),t}isIndexable(e){if(e instanceof Qe.TFolder)return!1;let t;return typeof e=="string"?t=e:t=e.path,this.supportedExtensions.has(le.getExtension(t))&&t.lastIndexOf("excalidraw.md")===-1&&(this.setting.followObsidianExcludedFiles?this.privateApi.isNotObsidianExcludedPath(t):!0)&&(this.excludedPaths.size===0?!0:this.isNotCustomExcludedPath(t))}async readPlainText(e){let t=typeof e=="string"?this.vault.getAbstractFileByPath(e):e;if(t instanceof Qe.TFile)if(this.viewRegistry.viewTypeByPath(t.path)==="markdown"){let r=await this.vault.cachedRead(t);return t.extension==="html"?this.htmlParser.toMarkdown(r):r}else throw Error(`unsupported file extension as plain text to read, path: ${t.path}`);else return""}async readPlainTextLines(e){return(await this.readPlainText(e)).split(le.SPLIT_EOL)}parseAliases(e){return((0,Qe.parseFrontMatterAliases)(e==null?void 0:e.frontmatter)||[]).join(" ")}parseTags(e){var t;return((t=e==null?void 0:e.tags)==null?void 0:t.map(r=>r.tag.slice(1)).join(" "))||""}parseHeadings(e){var t;return((t=e==null?void 0:e.headings)==null?void 0:t.map(r=>r.heading).join(" "))||""}isContentIndexable(e){return Ie.contentIndexableViewTypes.has(this.viewRegistry.viewTypeByPath(e.path))}isNotCustomExcludedPath(e){let t=e.split("/"),r="";for(let i of t)if(r+=(r?"/":"")+i,this.excludedPaths.has(r))return!1;return!0}};Ie.contentIndexableViewTypes=new Set(["markdown"]),Ie=N([(0,Da.singleton)()],Ie);var Rr=class{constructor(){this.MARKDOWN_LINK_REGEX=/\[([^[\]]+)\]\([^()]*\)/g;this.MARKDOWN_ASTERISK_REGEX=/\*\*(.*?)\*\*/g;this.MARKDOWN_BACKTICK_REGEX=/`(.*?)`/g}toMarkdown(e){let t=(0,Qe.htmlToMarkdown)(e);return t=t.replace(this.MARKDOWN_LINK_REGEX,"$1"),t=t.replace(this.MARKDOWN_ASTERISK_REGEX,"$1"),t=t.replace(this.MARKDOWN_BACKTICK_REGEX,"$1"),t}};Rr=N([(0,Da.singleton)()],Rr);var cc=require("obsidian");var fc=ae(ce());var fn=class{constructor(){this.dataManager=b(Ne);this.app=b(cc.App);this.onCreate=e=>{C.debug(`created: ${e.path}`),this.dataManager.receiveDocOperation(new dn(e))};this.onDelete=e=>{C.debug(`deleted: ${e.path}`),this.dataManager.receiveDocOperation(new hn(e.path))};this.onRename=(e,t)=>{C.debug(`renamed: ${t} => ${e.path}`),this.dataManager.receiveDocOperation(new hn(t)),this.dataManager.receiveDocOperation(new dn(e))};this.onModify=e=>{C.debug(`modified: ${e.path}`),this.dataManager.receiveDocOperation(new hn(e.path)),this.dataManager.receiveDocOperation(new dn(e))}}start(){this.stop(),this.app.vault.on("create",this.onCreate),this.app.vault.on("delete",this.onDelete),this.app.vault.on("rename",this.onRename),this.app.vault.on("modify",this.onModify),C.trace("FileWatcher started")}stop(){this.app.vault.off("create",this.onCreate),this.app.vault.off("delete",this.onDelete),this.app.vault.off("rename",this.onRename),this.app.vault.off("modify",this.onModify)}};fn=N([(0,fc.singleton)()],fn);var Ne=class{constructor(){this.database=b(zt);this.dataProvider=b(Ie);this.lexicalEngine=b(We);this.semanticEngine=b(Le);this.semanticConfig=b(se).semantic;this.shouldForceRefresh=!1;this.isLexicalEngineUpToDate=!1;this.isSemanticEngineUpToDate=!1;this.docOperationsHandler=async e=>{e.sort((t,r)=>t.time-r.time);for(let t of e)if(t instanceof dn)await this.addDocuments([t.file]);else if(t instanceof hn)await this.deleteDocuments([t.path]);else throw Error(bi)};this.docOperationsBuffer=new rs(this.docOperationsHandler,e=>e.path+e.type,3)}async initAsync(){await this.database.deleteOldDatabases(),await this.initLexicalEngine(),await this.initSemanticEngine(),this.shouldForceRefresh||($t.on(9,()=>this.docOperationsBuffer.forceFlush()),b(fn).start())}onunload(){b(fn).stop()}receiveDocOperation(e){this.docOperationsBuffer.add(e)}async refreshAllAsync(){let e=new be(q("Reindexing..."));this.shouldForceRefresh=!0,await this.initAsync(),e.hide(),new be(q("Indexing finished"),5e3),this.shouldForceRefresh=!1}async addDocuments(e,t=!1){if(e.length>0){let r=[];for(let s of e)s instanceof hc.TFile&&r.push(s);let i=await this.dataProvider.generateAllIndexedDocuments(r.filter(s=>this.dataProvider.isIndexable(s)));t?this.semanticConfig.isEnabled&&await this.semanticEngine.addDocuments(i):await this.lexicalEngine.addDocuments(i)}}async deleteDocuments(e,t=!1){if(e.length>0){let r=e.filter(i=>this.dataProvider.isIndexable(i));t?this.semanticConfig.isEnabled&&await this.semanticEngine.deleteDocuments(r):this.lexicalEngine.deleteDocuments(r)}}async initLexicalEngine(){C.trace("Init lexical engine...");let e;!nr.loadIndexFromDatabase||this.shouldForceRefresh?e=null:e=await this.database.getMiniSearchData(),e?(this.database.deleteMinisearchData(),C.trace("Previous minisearch data is found."),await this.lexicalEngine.reIndexAll(e)||(new be(q("Database has been updated, a reindex is required"),7e3),await this.reindexLexicalEngineWithCurrFiles())):await this.reindexLexicalEngineWithCurrFiles(),this.isLexicalEngineUpToDate||await this.updateDocRefByMtime(!1),C.trace("Lexical engine is ready"),await this.database.setMiniSearchData(this.lexicalEngine.filesIndex.toJSON())}async reindexLexicalEngineWithCurrFiles(){C.trace("Indexing the whole vault...");let e=this.dataProvider.allFilesToBeIndexed(),t=0;for(let i of e)t+=i.stat.size;if(t/=1024,t>2e3){let i=(t/1024).toFixed(2)+" MB";new be(`${i} ${q("files need to be indexed. Obsidian may freeze for a while")}`,7e3)}let r=await this.dataProvider.generateAllIndexedDocuments(e);await this.lexicalEngine.reIndexAll(r),this.isLexicalEngineUpToDate=!0}async updateDocRefByMtime(e){let t=new Map(this.dataProvider.allFilesToBeIndexed().map(l=>[l.path,l])),r=e?await this.database.getSemanticDocRefs():await this.database.getLexicalDocRefs(),i=new Map(r==null?void 0:r.map(l=>[l.path,l])),s=[],o=[];for(let[l,u]of t){let c=i.get(l);c?u.stat.mtime>c.updateTime&&(o.push(u.path),s.push(u)):s.push(u)}for(let l of i.keys())t.has(l)||o.push(l);C.trace(`docs to delete: ${o.length}`),C.trace(`docs to add: ${s.length}`),await this.deleteDocuments(o,e),await this.addDocuments(s,e);let a=Array.from(t.values()).map(l=>({path:l.path,updateTime:l.stat.mtime}));e?(await this.database.setSemanticDocRefs(a),C.trace(`${a.length} semantic refs updated`)):(await this.database.setLexicalDocRefs(a),C.trace(`${a.length} lexical refs updated`))}async initSemanticEngine(){if(this.semanticConfig.isEnabled){if(await this.semanticEngine.doesCollectionExist()===!1||this.shouldForceRefresh){let e=null;this.semanticConfig.serverType==="local"&&(e=new be(q("Semantic init time"),0));let t=this.dataProvider.allFilesToBeIndexed(),r=await this.dataProvider.generateAllIndexedDocuments(t);await this.semanticEngine.reindexAll(r),e&&e.hide(),new be(q("Semantic init finished"),5e3),this.isSemanticEngineUpToDate=!0}this.isSemanticEngineUpToDate||await this.updateDocRefByMtime(!0),C.trace("Semantic engine is ready")}}};N([Se],Ne.prototype,"initAsync",1),Ne=N([(0,pc.singleton)()],Ne);var as=class{constructor(e,t){this.time=performance.now();this.type=e,typeof t=="string"?this.path=t:this.path=t.path}},dn=class extends as{constructor(t){super("add",t);this.file=t}},hn=class extends as{constructor(e){super("delete",e)}};var Ze=class{constructor(){this.plugin=b(rt);this.shouldReload=!1}async initAsync(){await this.loadSettings(),pn.container.register(se,{useValue:this.setting}),this.plugin.addSettingTab(b(Lr))}async saveSettings(){await this.plugin.saveData(this.setting)}async postSettingUpdated(){this.saveSettings(),this.shouldReload&&(this.shouldReload=!1,await this.downloadAndRefresh())}async loadSettings(){this.setting=ft.mergeDeep(Dl,await this.plugin.loadData()),C.setLevel(this.setting.logLevel)}async downloadAndRefresh(){b(Pe).refreshAll(),await b(Ke).initAsync(),await b(it).initAsync(),b(Ie).init(),await b(Ne).refreshAllAsync()}};Ze=N([(0,pn.singleton)()],Ze);var Lr=class extends Y.PluginSettingTab{constructor(t){super(t.app,t);this.settingManager=b(Ze);this.setting=b(se)}hide(){this.settingManager.postSettingUpdated()}display(){let{containerEl:t}=this;t.empty(),new Y.Setting(t).setName(q("Max items count")).setDesc(q("Max items count desc")).addSlider(a=>a.setLimits(1,300,1).setValue(this.setting.ui.maxItemResults).setDynamicTooltip().onChange(l=>{this.setting.ui.maxItemResults=l})),new Y.Setting(t).setName(q("Floating window for in-file search")).setDesc(q("Floating window for in-file search desc")).addToggle(a=>a.setValue(this.setting.ui.floatingWindowForInFile).onChange(l=>this.setting.ui.floatingWindowForInFile=l)),new Y.Setting(t).setName(q("English word blacklist")).setDesc(q("English word blacklist desc")).addToggle(a=>a.setValue(this.setting.enableStopWordsEn).onChange(l=>{this.setting.enableStopWordsEn=l,this.settingManager.shouldReload=!0})),new Y.Setting(t).setName(q("Chinese patch")).setDesc(q("Chinese patch desc")).addToggle(a=>a.setValue(this.setting.enableChinesePatch).onChange(async l=>{this.setting.enableChinesePatch=l,C.info(`enable chinese: ${b(se).enableChinesePatch}`),this.settingManager.shouldReload=!0})),new Y.Setting(t).setName(q("Chinese word blacklist")).setDesc(q("Chinese word blacklist desc")).addToggle(a=>a.setValue(this.setting.enableStopWordsZh).onChange(async l=>{this.setting.enableStopWordsZh=l,this.settingManager.shouldReload=!0})),new Y.Setting(t).setName(q("Advanced")).setDesc(q("Advanced.desc")),new Y.Setting(t).setName("Semantic search").addButton(a=>a.setButtonText(q("Manage")).onClick(()=>new La(b(Y.App)).open())),new Y.Setting(t).setName(q("Excluded files")).addButton(a=>a.setButtonText(q("Manage")).onClick(()=>{new Oa(b(Y.App)).open()})),new Y.Setting(t).setName(q("Customize extensions")).addButton(a=>a.setButtonText(q("Manage")).onClick(()=>new Ra(b(Y.App)).open()));let r=t.createDiv("cs-dev-setting-group");r.style.marginTop="1.5em";let i=r.createDiv({cls:"cs-setting-group-dev-title",text:q("For Development")}),s=r.createDiv({cls:"cs-setting-group-dev-content"}),o=this.setting.ui.collapseDevSettingByDefault;s.style.display=o?"none":"block",i.style.setProperty("--cs-dev-collapse-icon",o?to:no),i.onclick=()=>{let a=s.style.display==="none";s.style.display=a?"block":"none",i.style.setProperty("--cs-dev-collapse-icon",a?no:to)},new Y.Setting(s).setName(q("Collapse development setting by default")).addToggle(a=>a.setValue(this.setting.ui.collapseDevSettingByDefault).onChange(l=>{this.setting.ui.collapseDevSettingByDefault=l})),new Y.Setting(s).setName(q("Reindex the vault")).addButton(a=>{a.setButtonText(q("Reindex")).onClick(async()=>{await b(Ne).refreshAllAsync()})}),new Y.Setting(s).setName(q("Log level")).addDropdown(a=>a.addOptions({trace:"trace",debug:"debug",info:"info",warn:"warn",error:"error",none:"none"}).setValue(this.setting.logLevel.toLowerCase()).onChange(async l=>{let u=l;C.setLevel(u),this.setting.logLevel=u})),new Y.Setting(s).setName(q("Reset floating window position")).setDesc(q("Reset floating window position desc")).addButton(a=>a.setButtonText(q("Reset position")).onClick(l=>{b(je).resetAllPositions()})),new Y.Setting(s).setName(q("Support the Project")).setDesc(q("Support the Project desc")).addButton(a=>{a.setButtonText(q("Visit GitHub")).onClick(()=>{window.open("https://github.com/yan42685/obsidian-clever-search","_blank")})}),new Y.Setting(s).setName("API provider1").setDesc("domain and key").addText(a=>a.setPlaceholder("api.openai.com").setValue(this.setting.apiProvider1.domain).onChange(l=>{this.setting.apiProvider1.domain=l,this.settingManager.saveSettings()})).addText(a=>a.setPlaceholder("API key").setValue(this.setting.apiProvider1.key).onChange(l=>{this.setting.apiProvider1.key=l})),new Y.Setting(s).setName("API provider2").setDesc("description").addText(a=>a.setPlaceholder("api.openai.com").setValue(this.setting.apiProvider2.domain).onChange(l=>{this.setting.apiProvider2.domain=l})).addText(a=>a.setPlaceholder("API key").setValue(this.setting.apiProvider2.key).onChange(l=>{this.setting.apiProvider2.key=l}))}};Lr=N([(0,pn.singleton)(),Xr(0,(0,pn.inject)(rt))],Lr);var Oa=class extends Y.Modal{constructor(t){super(t);this.settingManager=b(Ze);this.setting=b(se);this.excludedPaths=this.setting.excludedPaths;this.allPaths=new Set;this.allFolders=new Set;let r=b(Y.Vault).getAllLoadedFiles();for(let i of r)this.allPaths.add(i.path),i instanceof Y.TFolder&&this.allFolders.add(i.path)}onOpen(){var r;this.modalEl.style.width="48vw",this.modalEl.style.marginBottom="5em",(r=this.modalEl.querySelector(".modal-close-button"))==null||r.remove();let t=this.contentEl;new Y.Setting(t).setName(q("Follow Obsidian Excluded Files")).addToggle(i=>i.setValue(this.setting.followObsidianExcludedFiles).onChange(s=>{this.setting.followObsidianExcludedFiles=s,this.settingManager.shouldReload=!0})),t.createEl("h2",{text:q("Excluded files")}),this.excludesEl=t.createDiv(),this.renderExcludedList(this.excludesEl),new Y.Setting(t).addText(i=>{this.inputEl=i.inputEl,i.setPlaceholder(q("Enter path...")).onChange(s=>{this.suggester.close(),this.suggester.open()})}).addButton(i=>{i.setButtonText(q("Add")).onClick(()=>{this.addPath(this.inputEl.value)})}),this.suggester=new Gi(this.inputEl,this.allFolders,i=>{this.addPath(i)}),setTimeout(()=>{this.inputEl.focus()},1)}renderExcludedList(t){t.empty(),this.excludedPaths.forEach((r,i)=>{let s=t.createDiv();s.style.overflow="auto",s.style.display="flex",s.style.margin="0.7em 0 0.7em 0",s.style.justifyContent="space-between";let o=s.createSpan();o.setText(r),o.style.width="90%",o.style.overflow="auto";let a=s.createSpan();a.setText("\u2715"),a.style.cursor="pointer",a.onClickEvent(()=>{this.excludedPaths.splice(i,1),this.settingManager.shouldReload=!0,this.renderExcludedList(t)})})}addPath(t){t&&!this.excludedPaths.includes(t)&&(this.allPaths.has(t)?(this.excludedPaths.push(t),this.settingManager.shouldReload=!0,this.renderExcludedList(this.excludesEl)):new be(`Path doesn't exist: ${t}`,5e3))}},Ra=class extends Y.Modal{constructor(){super(...arguments);this.setting=b(se);this.settingManager=b(Ze)}onOpen(){var r;this.modalEl.style.width="60vw",(r=this.modalEl.querySelector(".modal-close-button"))==null||r.remove();let t=this.contentEl;new Y.Setting(t).setDesc(q("extensionModal.desc")),new Y.Setting(t).setName(q("extensionModal.plaintextName")).setDesc(q("extensionModal.plaintextDesc")).addTextArea(i=>{i.inputEl.style.minWidth="20vw",i.inputEl.style.minHeight="20vh",i.setValue(this.setting.customExtensions.plaintext.join(" ")),i.onChange(s=>{let o=s.split(/[\s\n]+/).map(a=>a.startsWith(".")?a.substring(1):a).filter(a=>a.length>0);this.setting.customExtensions.plaintext=o,this.settingManager.shouldReload=!0})}),new Y.Setting(t).setName("Image").setDesc("Todo")}},La=class extends Y.Modal{constructor(){super(...arguments);this.semanticEngine=b(Le);this.setting=b(se).semantic;this.settingManager=b(Ze);this.needInitSemanticEngine=!1}onOpen(){var r;this.modalEl.style.width="50vw",this.modalEl.style.height="40vh",(r=this.modalEl.querySelector(".modal-close-button"))==null||r.remove();let t=this.contentEl;new Y.Setting(t).setName("Enable").addToggle(i=>i.setValue(this.setting.isEnabled).onChange(s=>{this.setting.isEnabled=s,s===!0&&(this.needInitSemanticEngine=!0)})),new Y.Setting(t).setName("Server type").setDesc("For local server, Clever Search AI Helper needs to run in the background. For remote server, it has not been implemented yet.").addDropdown(i=>i.addOptions({local:"local"}).setValue(this.setting.serverType).onChange(s=>this.setting.serverType=s)),new Y.Setting(t).setName("Utilities").addButton(i=>i.setButtonText("Test connection").onClick(()=>this.semanticEngine.testConnection()))}onClose(){this.needInitSemanticEngine&&(this.needInitSemanticEngine=!1,b(Ne).initSemanticEngine())}};var Ga=ae(ce());function Ut(){}function za(n){return n()}function mc(){return Object.create(null)}function Tt(n){n.forEach(za)}function ls(n){return typeof n=="function"}function yc(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function vc(n){return Object.keys(n).length===0}var _c=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global,jr=class{constructor(e){this.options=e,this._listeners="WeakMap"in _c?new WeakMap:void 0}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!==null&&e!==void 0?e:this._observer=new ResizeObserver(t=>{var r;for(let i of t)jr.entries.set(i.target,i),(r=this._listeners.get(i.target))===null||r===void 0||r(i)})}};jr.entries="WeakMap"in _c?new WeakMap:void 0;var bc=!1;function nm(){bc=!0}function rm(){bc=!1}function xe(n,e){n.appendChild(e)}function wc(n,e,t){let r=im(n);if(!r.getElementById(e)){let i=ge("style");i.id=e,i.textContent=t,sm(r,i)}}function im(n){if(!n)return document;let e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function sm(n,e){return xe(n.head||n,e),e.sheet}function qe(n,e,t){n.insertBefore(e,t||null)}function Be(n){n.parentNode&&n.parentNode.removeChild(n)}function Va(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function ge(n){return document.createElement(n)}function om(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Vr(n){return document.createTextNode(n)}function Vn(){return Vr(" ")}function Ka(){return Vr("")}function Wt(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function ye(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function am(n){return Array.from(n.childNodes)}function $a(n,e){e=""+e,n.data!==e&&(n.data=e)}function Ua(n,e){n.value=e==null?"":e}function Kr(n,e,t){n.classList[t?"add":"remove"](e)}var us=class{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,r=null){this.e||(this.is_svg?this.e=om(t.nodeName):this.e=ge(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)qe(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Be)}};var Br;function Nr(n){Br=n}function lm(){if(!Br)throw new Error("Function called outside component initialization");return Br}function fs(n){lm().$$.on_destroy.push(n)}var Bn=[];var zr=[],zn=[],gc=[],xc=Promise.resolve(),ja=!1;function Ec(){ja||(ja=!0,xc.then(Sc))}function $r(){return Ec(),xc}function Ba(n){zn.push(n)}var Na=new Set,jn=0;function Sc(){if(jn!==0)return;let n=Br;do{try{for(;jn<Bn.length;){let e=Bn[jn];jn++,Nr(e),um(e.$$)}}catch(e){throw Bn.length=0,jn=0,e}for(Nr(null),Bn.length=0,jn=0;zr.length;)zr.pop()();for(let e=0;e<zn.length;e+=1){let t=zn[e];Na.has(t)||(Na.add(t),t())}zn.length=0}while(Bn.length);for(;gc.length;)gc.pop()();ja=!1,Na.clear(),Nr(n)}function um(n){if(n.fragment!==null){n.update(),Tt(n.before_update);let e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ba)}}function cm(n){let e=[],t=[];zn.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),zn=e}var fm=new Set;function dm(n,e){n&&n.i&&(fm.delete(n),n.i(e))}var hm=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],u_=new Set([...hm]);function pm(n,e,t,r){let{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),r||Ba(()=>{let o=n.$$.on_mount.map(za).filter(ls);n.$$.on_destroy?n.$$.on_destroy.push(...o):Tt(o),n.$$.on_mount=[]}),s.forEach(Ba)}function Ac(n,e){let t=n.$$;t.fragment!==null&&(cm(t.after_update),Tt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function mm(n,e){n.$$.dirty[0]===-1&&(Bn.push(n),Ec(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Tc(n,e,t,r,i,s,o,a=[-1]){let l=Br;Nr(n);let u=n.$$={fragment:null,ctx:[],props:s,update:Ut,not_equal:i,bound:mc(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:mc(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(h,f,...d)=>{let p=d.length?d[0]:f;return u.ctx&&i(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&mm(n,h)),f}):[],u.update(),c=!0,Tt(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){nm();let h=am(e.target);u.fragment&&u.fragment.l(h),h.forEach(Be)}else u.fragment&&u.fragment.c();e.intro&&dm(n.$$.fragment),pm(n,e.target,e.anchor,e.customElement),rm(),Sc()}Nr(l)}var gm;typeof HTMLElement=="function"&&(gm=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:n}=this.$$;this.$$.on_disconnect=n.map(za).filter(ls);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(n,e,t){this[n]=t}disconnectedCallback(){Tt(this.$$.on_disconnect)}$destroy(){Ac(this,1),this.$destroy=Ut}$on(n,e){if(!ls(e))return Ut;let t=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return t.push(e),()=>{let r=t.indexOf(e);r!==-1&&t.splice(r,1)}}$set(n){this.$$set&&!vc(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}});var cs=class{$destroy(){Ac(this,1),this.$destroy=Ut}$on(e,t){if(!ls(t))return Ut;let r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!vc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};function mn(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}var Fc=require("obsidian");var Pc=ae(ce());var Cc=ae(ce());var Kn=class{constructor(){this.lexicalEngine=b(We)}parseAll(e,t,r,i){return t.map(s=>{let o=Mr.minInSet(s.positions),a=s.row,l=this.getTruncatedContext(e,a,o,r),u=l.matchedLineText,c=s.positions;s.row===l.lines[0].row&&(c=this.adjustPositionsByStartCol(c,l.firstLineStartCol));let h=this.highlightMatchedLine(u,c,i),f=l.lines.map(d=>d.row===a?h:d.text).join(le.JOIN_EOL);return{row:s.row,col:o,text:f}})}parse(e,t,r,i){return this.parseAll(e,[t],r,i)[0]}async parseLineItems(e,t){let r=t.replace(/\s/g,""),i=[],s=await this.lexicalEngine.fzfMatch(r,e);for(let o of s){let a=o.row,l=Mr.minInSet(o.positions),u=e[a].text,c=Math.max(l-30,0),h=Math.min(c+200,u.length),f=u.substring(c,h),d=this.adjustPositionsByStartCol(o.positions,c),p=this.highlightLineByCharPositions(f,d),m=await this.getLineHighlightedContext(e,a,l,t);i.push(new jt({text:p,row:a,col:l},m))}return i}highlightMatchedLine(e,t,r){return r?`<span class="matched-line highlight-bg">${this.highlightLineByCharPositions(e,t)}</span>`:`<span class="matched-line">${this.highlightLineByCharPositions(e,t)}</span>`}highlightContextLine(e,t){let r=new RegExp(t,"gi");return e.replace(r,i=>`<mark>${i}</mark>`)}highlightLineByCharPositions(e,t){return e.split("").map((r,i)=>t.has(i)?`<mark>${r}</mark>`:r).join("")}adjustPositionsByStartCol(e,t){let r=new Set;return e.forEach(i=>{i>=t&&r.add(i-t)}),r}getTruncatedContext(e,t,r,i){if(e.length===0)return{lines:[],firstLineStartCol:0,matchedLineText:""};let s=i,o,a=0,l=0,u=e[t].text;if(r<s.maxPreChars){let c=this.extendContextAbove(e,t-1,s.maxPreChars-r,s.maxPreLines,s.boundaryLineMinChars);o=c.lines,a=c.firstLineStartCol;let h=Math.min(u.length-1,r+s.maxPostChars);h<u.length-1?(u=u.substring(0,h+1),o.push({text:u,row:t})):o.push(e[t]),l+=h-r}else{let c=r-s.maxPreChars;a=c;let h=Math.min(u.length-1,r+s.maxPostChars);h<u.length-1?u=u.substring(c,h+1):u=u.substring(c),o=[{text:u,row:t}],l+=h-r}return ft.append(o,this.extendContextBelow(e,t+1,s.maxPostChars-l,s.maxPostLines,s.boundaryLineMinChars)),{lines:o,firstLineStartCol:a,matchedLineText:u}}extendContextAbove(e,t,r,i,s){let o=0,a=t,l=0,u=[];for(;a>=0&&t-a<i;){let c=e[a].text;if(l+c.length<r)u.unshift(e[a]),l+=c.length,--a;else if(l+c.length==r){u.unshift(e[a]);break}else{let h=l+c.length-r;o=h;let f=e[a].text.substring(h);u.unshift({text:f,row:a});break}}return u.length>0&&u[0].text.length<s&&(o=0,u.shift()),{lines:u,firstLineStartCol:o}}extendContextBelow(e,t,r,i,s){let o=t,a=0,l=[];for(;o<=e.length-1&&o-t<i;){let u=e[o].text;if(a+u.length<r)l.push(e[o]),a+=u.length,++o;else if(a+u.length==r){l.push(e[o]);break}else{let c=u.length-(a+u.length-r)-1,h=e[o].text.substring(0,c+1);l.push({text:h,row:o});break}}return l.length>0&&l[0].text.length<s&&l.pop(),l}async getLineHighlightedContext(e,t,r,i){let s=ft.getCurrLanguage(),o=this.getTruncatedContext(e,t,r,Je.forType("paragraph")),a=o.lines;return(await Promise.all(a.map(async(u,c)=>{if(u.row===t){let h=await this.lexicalEngine.fzfMatch(i,[u]);try{let d=h[0].positions;return c===0&&(d=this.adjustPositionsByStartCol(d,o.firstLineStartCol)),this.highlightMatchedLine(u.text,d,!0)}catch(f){C.warn("There might be inconsistency with previous search step, which lead to a missed match to target line"),C.error(f)}}else return this.highlightContextLine(u.text,i)}))).join(le.JOIN_EOL)}};Kn=N([(0,Cc.singleton)()],Kn);var at=class{constructor(){this.app=b(Fc.App);this.dataProvider=b(Ie);this.lexicalEngine=b(We);this.semanticEngine=b(Le);this.lineHighlighter=b(Kn);this.viewRegistry=b(Pe)}async searchInVault(e){var o;let t=new At("no result",[]);if(e.length===0)return t;let r=((o=this.app.workspace.getActiveFile())==null?void 0:o.path)||"no source path",i=await this.lexicalEngine.searchFiles(e),s=[];return i.length!==0?{sourcePath:r,items:i.map(a=>new Bt(0,a.path,a.queryTerms,a.matchedTerms,[],"nothing"))}:(C.trace("lexical matched files count is 0"),t)}async searchInVaultSemantic(e){var r;let t=new At("no result",[]);return e.length===0?t:{sourcePath:((r=this.app.workspace.getActiveFile())==null?void 0:r.path)||"no source path",items:await this.semanticEngine.search(e,"markdown")}}async getFileSubItems(e,t){let r=t.path;if(this.viewRegistry.viewTypeByPath(r)!=="markdown")return C.warn(`view type for path "${r}" is not supported for sub-items.`),[];let s=(await this.dataProvider.readPlainText(r)).split(le.SPLIT_EOL).map((l,u)=>new On(l,u));C.debug("target file lines count: ",s.length);let o=await this.lexicalEngine.searchLinesByFileItem(s,"subItem",e,t,30);return this.lineHighlighter.parseAll(s,o,Je.forType("subItem",e),!1).map(l=>({text:l.text,row:l.row,col:l.col}))}async searchInFile(e){let t=new At("",[]),r=this.app.workspace.getActiveFile();if(!e||!r)return t;if(this.viewRegistry.viewTypeByPath(r.path)!=="markdown")return C.trace("Current file isn't PLAINT_TEXT"),t;let i=(await this.dataProvider.readPlainTextLines(r.path)).map((l,u)=>new On(l,u)),s=e.replace(/\s/g,""),a=(await this.lexicalEngine.fzfMatch(s,i)).map(l=>{let u=this.lineHighlighter.parse(i,l,Je.forType("line"),!1),c=this.lineHighlighter.parse(i,l,Je.forType("paragraph"),!0);return new jt(u,c.text)});return{sourcePath:r.path,items:a}}async deprecatedSearchInFile(e){let t=new At("",[]),r=this.app.workspace.getActiveFile();if(!e||!r||this.viewRegistry.viewTypeByPath(r.path)!=="markdown")return t;let i=r.path,s=(await this.dataProvider.readPlainTextLines(i)).map((a,l)=>new On(a,l)),o=await this.lineHighlighter.parseLineItems(s,e);return{sourcePath:i,items:o}}};N([Se],at.prototype,"searchInVault",1),N([Se],at.prototype,"getFileSubItems",1),N([Se],at.prototype,"searchInFile",1),N([Se],at.prototype,"deprecatedSearchInFile",1),at=N([(0,Pc.singleton)()],at);var Ur=require("obsidian");var Ic=ae(ce());var $n=class{constructor(){this.app=b(Ur.App);this.privateApi=b(Fe);this.setting=b(se)}updateSubItemIndex(e,t,r){let i=e[t],s=e.length-1;return this.scrollTo("center",i,"auto"),r==="next"?t<s?t+1:t:t>0?t-1:t}async handleConfirmAsync(e,t,r,i,s){if(e(),i)if(r===1){let o=i;await this.jumpInVaultAsync(t,o.line.row,o.line.col)}else if(r===2){let o=i,a=o.viewType;if(s!==-1){let l=o.subItems[s];if(a==="markdown")await this.jumpInVaultAsync(o.path,l.row,l.col);else throw Error("unsupported viewType to jump")}else await this.jumpInVaultAsync(o.path,0,0)}else throw Error(`unsupported search type to jump ${r}`)}scrollTo(e,t,r){setTimeout(()=>{t&&t.element&&t.element.scrollIntoView({behavior:r,block:e})},0)}focusInput(){setTimeout(()=>{let e=document.getElementById("cs-search-input");e==null||e.focus()},0)}showNoResult(e){if(e){if(!this.setting.semantic.isEnabled)return"Semantic search need to be enabled at the setting tab";let t=b(Le).status;return t==="ready"?"No matched content":`Semantic engine is ${t}`}else return"No matched content"}async jumpInVaultAsync(e,t,r){let i=!1;this.app.workspace.iterateAllLeaves(s=>{var o;s.view instanceof Ur.MarkdownView&&((o=s.getViewState().state)==null?void 0:o.file)===e&&(this.app.workspace.setActiveLeaf(s,{focus:!0}),i=!0)}),i?this.scrollIntoViewForExistingView(t,r):(await this.app.workspace.openLinkText(e,"",this.setting.ui.openInNewPane),this.app.workspace.onLayoutReady(()=>this.scrollIntoViewForExistingView(t,r)))}scrollIntoViewForExistingView(e,t){this.privateApi.executeCommandById("editor:focus");let r=this.app.workspace.getActiveViewOfType(Ur.MarkdownView),i={line:e,ch:t};if(r){let s=r.getState();s.mode="source",r.setState(s,{history:!1}),r.editor.setCursor(i),r.editor.scrollIntoView({from:i,to:i},!0),this.privateApi.executeCommandById("editor:focus")}else C.info("No markdown view to jump")}};$n=N([(0,Ic.singleton)()],$n);function ym(n){wc(n,"svelte-1k7yxfd",`div.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd,button.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{user-select:text}.search-container.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{display:flex;white-space:pre-wrap;overflow-wrap:break-word}.search-container mark{background-color:var(--cs-highlight-bgc, rgba(219, 204, 149, 0.9));color:var(--cs-highlight-char-color, #111)}.left-pane.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{display:flex;flex-direction:column;align-items:left;width:27.5vw}.search-bar.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{position:sticky;top:-0.2em;left:0;width:97%;height:30px}.search-bar.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd::after{content:attr(data-match-count);position:absolute;right:0.6em;top:1.4em;font-size:0.8em;transform:translateY(-50%);color:var(--cs-hint-char-color, grey)}.search-bar.svelte-1k7yxfd input.svelte-1k7yxfd.svelte-1k7yxfd{width:100%;padding:8px 12px;border:none;border-radius:10px;background-color:var(--cs-search-bar-bgc, #20202066);box-shadow:0 2px 4px rgba(0, 0, 0, 0.07),\r
			0 2px 3px rgba(0, 0, 0, 0.1)}.result-items.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{display:flex;flex-direction:column;height:70vh;margin-top:0.15em}.result-items.svelte-1k7yxfd ul.svelte-1k7yxfd.svelte-1k7yxfd{padding:0 0.5em 0 0;margin-bottom:0;width:97%;overflow-x:hidden}.result-items.svelte-1k7yxfd ul.svelte-1k7yxfd button.svelte-1k7yxfd{align-items:center;justify-content:left;padding:0.65em;margin:0.5em 0 0 0.15em;width:25.35vw;height:fit-content;text-align:left;background-color:var(--cs-pane-bgc, #20202066);border-radius:4px;cursor:pointer}.result-items.svelte-1k7yxfd ul.svelte-1k7yxfd button.svelte-1k7yxfd:hover,.result-items.svelte-1k7yxfd ul.svelte-1k7yxfd button.selected.svelte-1k7yxfd{background-color:var(--cs-item-selected-color, rgba(85, 85, 85, 0.35))}.result-items.svelte-1k7yxfd ul button .line-item.svelte-1k7yxfd.svelte-1k7yxfd,.result-items.svelte-1k7yxfd ul button .file-item.svelte-1k7yxfd.svelte-1k7yxfd{text-wrap:wrap;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.result-items.svelte-1k7yxfd ul button .file-item.svelte-1k7yxfd.svelte-1k7yxfd{-webkit-line-clamp:6}.result-items.svelte-1k7yxfd ul button .file-item span.filename.svelte-1k7yxfd.svelte-1k7yxfd{margin-top:-0.2em;display:block}.result-items.svelte-1k7yxfd ul button .file-item span.file-folder-path.svelte-1k7yxfd.svelte-1k7yxfd{color:var(--cs-secondary-font-color, #a29c9c);display:block}.right-pane.svelte-1k7yxfd.svelte-1k7yxfd.svelte-1k7yxfd{background-color:var(--cs-pane-bgc, #20202066);border-radius:6px;height:73.97vh;width:60%}.right-pane.svelte-1k7yxfd button.svelte-1k7yxfd.svelte-1k7yxfd{white-space:pre-wrap}.right-pane.svelte-1k7yxfd .preview-container.svelte-1k7yxfd.svelte-1k7yxfd{margin:0.7em 0 0 0.7em;height:72.5vh;overflow-y:auto}.right-pane.svelte-1k7yxfd .preview-container p.svelte-1k7yxfd.svelte-1k7yxfd,.right-pane.svelte-1k7yxfd .preview-container ul.svelte-1k7yxfd.svelte-1k7yxfd{margin:0;padding:0;overflow-x:hidden}.right-pane.svelte-1k7yxfd .preview-container p.svelte-1k7yxfd.svelte-1k7yxfd{width:39.7vw}.right-pane.svelte-1k7yxfd .preview-container ul button.file-sub-item.svelte-1k7yxfd.svelte-1k7yxfd{text-wrap:wrap;display:block;text-overflow:ellipsis;justify-content:left;margin-bottom:1em;height:fit-content;width:39.2vw;text-align:left;background-color:var(--cs-pane-bgc, #20202066);border-radius:4px;font-size:medium}.right-pane.svelte-1k7yxfd .preview-container ul button.file-sub-item.selected.svelte-1k7yxfd.svelte-1k7yxfd{background-color:var(--cs-item-selected-color, rgba(85, 85, 85, 0.35))}.right-pane.svelte-1k7yxfd .preview-container.svelte-1k7yxfd span.matched-line{display:inline-block;width:100%}.right-pane.svelte-1k7yxfd .preview-container.svelte-1k7yxfd span.matched-line.highlight-bg{background-color:var(--cs-hint-char-color, #468eeb33)}`)}function kc(n,e,t){let r=n.slice();return r[35]=e[t],r[36]=e,r[37]=t,r}function Mc(n,e,t){let r=n.slice();return r[38]=e[t],r[39]=e,r[37]=t,r}function vm(n){let e,t,r=n[38].basename+ro+(n[38].extension==="md"?"":n[38].extension)+"",i,s,o=n[38].folderPath+"",a;return{c(){e=ge("span"),t=ge("span"),i=Vn(),s=ge("span"),a=Vr(o),ye(t,"class","filename svelte-1k7yxfd"),ye(s,"class","file-folder-path svelte-1k7yxfd"),ye(e,"class","file-item svelte-1k7yxfd")},m(l,u){qe(l,e,u),xe(e,t),t.innerHTML=r,xe(e,i),xe(e,s),xe(s,a)},p(l,u){u[0]&16&&r!==(r=l[38].basename+ro+(l[38].extension==="md"?"":l[38].extension)+"")&&(t.innerHTML=r),u[0]&16&&o!==(o=l[38].folderPath+"")&&$a(a,o)},d(l){l&&Be(e)}}}function _m(n){let e,t=n[38].line.text+"";return{c(){e=ge("span"),ye(e,"class","line-item svelte-1k7yxfd")},m(r,i){qe(r,e,i),e.innerHTML=t},p(r,i){i[0]&16&&t!==(t=r[38].line.text+"")&&(e.innerHTML=t)},d(r){r&&Be(e)}}}function Dc(n){let e,t,r=n[39],i=n[37],s,o;function a(p,m){if(p[38]instanceof jt)return _m;if(p[38]instanceof Bt)return vm}let l=a(n,[-1,-1]),u=l&&l(n),c=()=>n[18](e,r,i),h=()=>n[18](null,r,i);function f(...p){return n[19](n[37],...p)}function d(...p){return n[20](n[37],...p)}return{c(){e=ge("button"),u&&u.c(),t=Vn(),ye(e,"class","svelte-1k7yxfd"),Kr(e,"selected",n[37]===n[5])},m(p,m){qe(p,e,m),u&&u.m(e,null),xe(e,t),c(),s||(o=[Wt(e,"click",f),Wt(e,"contextmenu",d)],s=!0)},p(p,m){n=p,l===(l=a(n,m))&&u?u.p(n,m):(u&&u.d(1),u=l&&l(n),u&&(u.c(),u.m(e,t))),(r!==n[39]||i!==n[37])&&(h(),r=n[39],i=n[37],c()),m[0]&32&&Kr(e,"selected",n[37]===n[5])},d(p){p&&Be(e),u&&u.d(),h(),s=!1,Tt(o)}}}function Oc(n){let e,t;function r(o,a){if(o[2]===1)return wm;if(o[2]===2)return bm}let i=r(n,[-1,-1]),s=i&&i(n);return{c(){e=ge("div"),t=ge("div"),s&&s.c(),ye(t,"class","preview-container svelte-1k7yxfd"),ye(e,"class","right-pane svelte-1k7yxfd")},m(o,a){qe(o,e,a),xe(e,t),s&&s.m(t,null)},p(o,a){i===(i=r(o,a))&&s?s.p(o,a):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(t,null)))},d(o){o&&Be(e),s&&s.d()}}}function bm(n){let e;function t(s,o){return s[7]&&s[7].viewType==="markdown"?Em:xm}let r=t(n,[-1,-1]),i=r(n);return{c(){i.c(),e=Ka()},m(s,o){i.m(s,o),qe(s,e,o)},p(s,o){r===(r=t(s,o))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&Be(e)}}}function wm(n){let e,t=n[6]&&Lc(n);return{c(){t&&t.c(),e=Ka()},m(r,i){t&&t.m(r,i),qe(r,e,i)},p(r,i){r[6]?t?t.p(r,i):(t=Lc(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){t&&t.d(r),r&&Be(e)}}}function xm(n){let e,t=n[11].showNoResult(n[3])+"",r;return{c(){e=ge("span"),r=Vr(t)},m(i,s){qe(i,e,s),xe(e,r)},p(i,s){s[0]&8&&t!==(t=i[11].showNoResult(i[3])+"")&&$a(r,t)},d(i){i&&Be(e)}}}function Em(n){let e,t=n[8],r=[];for(let i=0;i<t.length;i+=1)r[i]=Rc(kc(n,t,i));return{c(){e=ge("ul");for(let i=0;i<r.length;i+=1)r[i].c();ye(e,"class","svelte-1k7yxfd")},m(i,s){qe(i,e,s);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(i,s){if(s[0]&49920){t=i[8];let o;for(o=0;o<t.length;o+=1){let a=kc(i,t,o);r[o]?r[o].p(a,s):(r[o]=Rc(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=t.length}},d(i){i&&Be(e),Va(r,i)}}}function Rc(n){let e,t,r=n[35].text+"",i,s=n[36],o=n[37],a,l;function u(...d){return n[22](n[37],...d)}function c(...d){return n[23](n[37],...d)}let h=()=>n[24](e,s,o),f=()=>n[24](null,s,o);return{c(){e=ge("button"),t=new us(!1),i=Vn(),t.a=i,ye(e,"class","file-sub-item svelte-1k7yxfd"),Kr(e,"selected",n[37]===n[9])},m(d,p){qe(d,e,p),t.m(r,e),xe(e,i),h(),a||(l=[Wt(e,"click",u),Wt(e,"contextmenu",c)],a=!0)},p(d,p){n=d,p[0]&256&&r!==(r=n[35].text+"")&&t.p(r),(s!==n[36]||o!==n[37])&&(f(),s=n[36],o=n[37],h()),p[0]&512&&Kr(e,"selected",n[37]===n[9])},d(d){d&&Be(e),f(),a=!1,Tt(l)}}}function Lc(n){let e,t,r;return{c(){e=ge("p"),ye(e,"class","svelte-1k7yxfd")},m(i,s){qe(i,e,s),e.innerHTML=n[6],t||(r=Wt(e,"contextmenu",n[21]),t=!0)},p(i,s){s[0]&64&&(e.innerHTML=i[6])},d(i){i&&Be(e),t=!1,r()}}}function Sm(n){let e,t,r,i,s,o,a,l,u,c,h=n[4].items,f=[];for(let p=0;p<h.length;p+=1)f[p]=Dc(Mc(n,h,p));let d=n[1]!=="floatingWindow"&&Oc(n);return{c(){e=ge("div"),t=ge("div"),r=ge("div"),i=ge("input"),s=Vn(),o=ge("div"),a=ge("ul");for(let p=0;p<f.length;p+=1)f[p].c();l=Vn(),d&&d.c(),ye(i,"id","cs-search-input"),ye(i,"class","svelte-1k7yxfd"),ye(r,"class","search-bar svelte-1k7yxfd"),ye(r,"data-match-count",n[10]),ye(a,"class","svelte-1k7yxfd"),ye(o,"class","result-items svelte-1k7yxfd"),ye(t,"class","left-pane svelte-1k7yxfd"),ye(e,"class","search-container svelte-1k7yxfd")},m(p,m){qe(p,e,m),xe(e,t),xe(t,r),xe(r,i),Ua(i,n[0]),xe(t,s),xe(t,o),xe(o,a);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(a,null);xe(e,l),d&&d.m(e,null),u||(c=[Wt(i,"input",n[17]),Wt(i,"input",n[12])],u=!0)},p(p,m){if(m[0]&1&&i.value!==p[0]&&Ua(i,p[0]),m[0]&1024&&ye(r,"data-match-count",p[10]),m[0]&41010){h=p[4].items;let g;for(g=0;g<h.length;g+=1){let y=Mc(p,h,g);f[g]?f[g].p(y,m):(f[g]=Dc(y),f[g].c(),f[g].m(a,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=h.length}p[1]!=="floatingWindow"?d?d.p(p,m):(d=Oc(p),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i:Ut,o:Ut,d(p){p&&Be(e),Va(f,p),d&&d.d(),u=!1,Tt(c)}}}function Am(n,e,t){let r,i=b(at),s=b($n),{uiType:o}=e,{onConfirmExternal:a}=e,{searchType:l}=e,{isSemantic:u}=e,{queryText:c}=e,h=new Map,f=new At("",[]),d=-1,p="",m=null,g=[],y,_=-1;function x(P){return mn(this,void 0,void 0,function*(){yield $r();let z=f.items;if(P>=0&&P<z.length){if(t(5,d=P),l===1){let W=z[P];t(6,p=W.context)}else if(l===2)t(7,m=z[P]),u||t(7,m.subItems=yield i.getFileSubItems(c,m),m),t(8,g=m.subItems),t(9,_=g.length>0?0:-1),yield $r(),s.scrollTo("start",g[_],"instant");else throw Error(`unsupported search type: ${l}`);yield $r(),s.scrollTo("center",z[P],"smooth")}else t(6,p=""),t(7,m=null),t(8,g=[]),t(5,d=-1),t(9,_=-1)})}let w=oc(100,()=>S());function S(){return mn(this,void 0,void 0,function*(){if(h.has(c)){t(4,f=h.get(c)),yield x(0);return}if(l===1)t(4,f=yield i.searchInFile(c));else if(l===2)t(4,f=u?yield i.searchInVaultSemantic(c):yield i.searchInVault(c)),C.info(f);else throw Error(xn);h.set(c,f),yield x(0)})}function A(P){return mn(this,void 0,void 0,function*(){yield x(P)})}function T(){return mn(this,void 0,void 0,function*(){yield x(Math.min(d+1,f.items.length-1)),o==="floatingWindow"&&L(null)})}function I(){return mn(this,void 0,void 0,function*(){yield x(Math.max(d-1,0)),o==="floatingWindow"&&L(null)})}function M(P){t(9,_=P)}function j(){t(9,_=s.updateSubItemIndex(g,_,"next"))}function O(){t(9,_=s.updateSubItemIndex(g,_,"prev"))}function L(P){return mn(this,void 0,void 0,function*(){P==null||P.preventDefault();let z=f.items[d];yield s.handleConfirmAsync(a,f.sourcePath,l,z,_)})}fs(()=>{C.trace("mounted element has been destroyed.")});function k(P,z){$t.on(P,z),fs(()=>{$t.off(P,z)})}o==="floatingWindow"?(k(3,T),k(6,I)):(k(2,T),k(5,I),k(4,j),k(7,O),k(8,L)),s.focusInput(),S();function B(){c=this.value,t(0,c)}function Q(P,z,W){zr[P?"unshift":"push"](()=>{z[W].element=P,t(4,f)})}let G=(P,z)=>{A(P),o==="floatingWindow"&&L(null)},Z=async(P,z)=>{await A(P),await L(z)},ne=P=>L(P),he=(P,z)=>M(P),lt=(P,z)=>{t(9,_=P),L(z)};function ee(P,z,W){zr[P?"unshift":"push"](()=>{z[W].element=P,t(8,g)})}return n.$$set=P=>{"uiType"in P&&t(1,o=P.uiType),"onConfirmExternal"in P&&t(16,a=P.onConfirmExternal),"searchType"in P&&t(2,l=P.searchType),"isSemantic"in P&&t(3,u=P.isSemantic),"queryText"in P&&t(0,c=P.queryText)},n.$$.update=()=>{if(n.$$.dirty[0]&48){e:t(10,r=`${d+1} / ${f.items.length}`)}},[c,o,l,u,f,d,p,m,g,_,r,s,w,A,M,L,a,B,Q,G,Z,ne,he,lt,ee]}var qa=class extends cs{constructor(e){super(),Tc(this,e,Am,Sm,yc,{uiType:1,onConfirmExternal:16,searchType:2,isSemantic:3,queryText:0},ym,[-1,-1])}},ds=qa;var je=class{toggle(e){if(e==="inFile")b(Un).toggle();else throw Error(xn)}resetAllPositions(){let e=b(se).ui;e.inFileFloatingWindowLeft="2.7em",e.inFileFloatingWindowTop="2.5em",b(je).toggle("inFile"),b(je).toggle("inFile")}onunload(){b(Un).onClose()}};je=N([(0,Ga.singleton)()],je);var Ha=class{constructor(){this.isDragging=!1;this.dragStartX=0;this.dragStartY=0;this.uiSetting=b(se).ui;this.mountedElement=null;this.onClose=()=>{var e,t;document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),(e=this.mountedElement)==null||e.$destroy(),this.mountedElement=null,(t=this.containerEl)==null||t.remove()};this.handleMouseDown=e=>{this.isDragging=!0,this.containerEl.style.opacity="0.75",this.dragStartX=e.pageX-this.containerEl.offsetLeft,this.dragStartY=e.pageY-this.containerEl.offsetTop,e.preventDefault()};this.handleMouseMove=e=>{this.isDragging&&(this.containerEl.style.left=`${e.pageX-this.dragStartX}px`,this.containerEl.style.top=`${e.pageY-this.dragStartY}px`)};this.handleMouseUp=()=>{this.isDragging=!1,this.containerEl.style.opacity="1",this.saveContainerElStates(),b(Ze).postSettingUpdated()}}toggle(){if(this.mountedElement!==null)return this.onClose(),this;this.containerEl=document.body.createDiv(),this.frameEl=this.containerEl.createDiv(),this.contentEl=this.containerEl.createDiv(),this.frameEl.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),this.containerEl.addClass("cs-floating-window-container"),this.containerEl.style.position="fixed",this.loadContainerElStates(),this.containerEl.style.zIndex="20",this.containerEl.style.border="1px solid #454545",this.containerEl.style.borderRadius="10px",this.containerEl.style.overflow="hidden",this.containerEl.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)",this.frameEl.style.width="100%",this.frameEl.style.height="20px",this.frameEl.style.backgroundColor="#333",this.frameEl.style.cursor="move",this.frameEl.style.color="#fff",this.frameEl.style.display="flex",this.frameEl.style.alignItems="center",this.frameEl.style.justifyContent="right",this.frameEl.style.padding="10px 0 10px 10px";let e=this.frameEl.createSpan();return e.innerText="\u2716",e.style.cursor="pointer",e.style.fontSize="13px",e.style.margin="5px",e.addEventListener("click",this.onClose),this.contentEl.style.padding="10px 0 10px 10px",this.mountComponent(),this}},Un=class extends Ha{mountComponent(){this.mountedElement=new ds({target:this.contentEl,props:{uiType:"floatingWindow",onConfirmExternal:()=>{},searchType:1,isSemantic:!1,queryText:""}})}loadContainerElStates(){this.containerEl.style.top=this.uiSetting.inFileFloatingWindowTop,this.containerEl.style.left=this.uiSetting.inFileFloatingWindowLeft}saveContainerElStates(){this.uiSetting.inFileFloatingWindowLeft=this.containerEl.style.left,this.uiSetting.inFileFloatingWindowTop=this.containerEl.style.top}};Un=N([(0,Ga.singleton)()],Un);var Nc=require("obsidian");var jc=ae(ce());var Wn=class{async createChildThreads(){if(Zt)C.warn("web worker only enabled on dev environment now");else return;C.debug("init child threads...");let e=b(Fe).obsidianFs,t=b(Nc.Vault).configDir,r=Ae.join(t,"plugins/clever-search/dist/cs-search-worker.js");try{let i=await e.readBinary(r);C.debug(`worker script size (6x bigger than in production build): ${(i.byteLength/1e3).toFixed(2)} KB`);let s=new Blob([i],{type:"text/javascript"}),o=URL.createObjectURL(s);this.worker=new Worker(o),this.worker.addEventListener("message",a=>{console.log(`Received from worker:
`,a.data)})}catch(i){console.error("Error initializing worker:",i)}}async testImageSearch(){var e;(e=this.worker)==null||e.postMessage({type:"image-search"})}};Wn=N([(0,jc.singleton)()],Wn);var Kc=ae(ce());var Bc=ae(ce());var qt=class{constructor(){this.privacyModeEnabled=!1;this.plugin=b(qn)}togglePrivacyMode(){this.privacyModeEnabled=!this.privacyModeEnabled,this.privacyModeEnabled?document.body.classList.add("cs-privacy-blur"):document.body.classList.remove("cs-privacy-blur")}init(){this.watchSelectionAndAutoCopy()}watchSelectionAndAutoCopy(){this.plugin.registerDomEvent(document,"mousedown",e=>{Tm(e,["cs-modal","cs-floating-window-container"])&&document.addEventListener("mouseup",()=>{Cm()},{once:!0})})}};qt=N([(0,Bc.singleton)()],qt);function Tm(n,e){let t=n.target;for(;t;){if(e.some(r=>t==null?void 0:t.classList.contains(r)))return!0;t=t.parentElement}return!1}function Cm(){let n=window.getSelection();if(n&&n.rangeCount>0){let t=n.getRangeAt(0).toString();t&&navigator.clipboard.writeText(t).then(()=>C.debug(`selection copied: ${t}`))}}var Ya=require("obsidian");var Xa=require("obsidian");async function Fm(){let n=b(Ie).allFilesToBeIndexed().filter(t=>t.basename.includes("Mysql")||t.basename.includes("Breath")),e=await b(Ie).generateAllIndexedDocuments(n);b(Le).reindexAll(e)}async function zc(){let n=b(se);Il(()=>Fm())}var Vc=require("obsidian");var yn=class extends Vc.Modal{constructor(t,r,i,s){var l;super(t);let o=((l=window.getSelection())==null?void 0:l.toString())||"",a=s||o;this.modalEl.replaceChildren(),this.modalEl.addClass("cs-modal"),this.mountedElement=new ds({target:this.modalEl,props:{uiType:"modal",onConfirmExternal:()=>this.close(),searchType:r,isSemantic:i,queryText:a||""}}),new ps(this.scope).registerAll()}onOpen(){}onClose(){this.mountedElement.$destroy()}};var Ja=ae(ce());var Ht=class{constructor(){this.plugin=b(rt);this.setting=b(se);this.app=b(Ya.App);b(Hn).registerAll()}addDevCommands(){Zt&&(this.addCommand({id:"cs-in-file-search-floating-window",name:"In file search - floating window",callback:()=>b(je).toggle("inFile")}),this.addCommand({id:"clever-search-triggerTest",name:"clever-search-triggerTest",callback:async()=>await zc()}))}addCommandsWithoutDependency(){this.addCommand({id:"clever-search-in-file",name:"Search in file",callback:()=>{this.setting.ui.floatingWindowForInFile?b(je).toggle("inFile"):new yn(this.app,1,!1).open()}}),this.addCommand({id:"cs-toggle-privacy-mode",name:"Toggle privacy mode",callback:()=>b(qt).togglePrivacyMode()})}addInVaultCommands(){this.addCommand({id:"clever-search-in-vault",name:"Search in Vault",callback:()=>{$t.emit(9),new yn(this.app,2,!1).open()}}),this.addCommand({id:"cs-in-file-search-with-omnisearch-query",name:"Search in file with last Omnisearch query",callback:async()=>{new yn(this.app,1,!1,await b(ot).getLastQuery()).open()}}),this.addCommand({id:"clever-search-in-vault-semantic",name:"Search in vault semantically",callback:async()=>new yn(this.app,2,!0).open()})}onunload(){b(Hn).unregisterAll()}addCommand(e){this.plugin.addCommand(e)}};Ht=N([(0,Ja.singleton)()],Ht);function Pm(n){return e=>{e.preventDefault(),$t.emit(n),console.log("emit...")}}var ms=class{constructor(e){this.handlers=[];this.scope=e}unregisterAll(){this.handlers.forEach(e=>{this.scope.unregister(e)}),this.handlers=[]}register(e,t,r){this.handlers.push(this.scope.register(e,t,Pm(r)))}},Hn=class extends ms{constructor(){super(b(Ya.App).scope)}registerAll(){let e=uo;this.handlers=[],this.register([e],"J",3),this.register([e],"K",6)}};Hn=N([(0,Ja.singleton)()],Hn);var ps=class extends ms{constructor(e){super(e)}registerAll(){let e=uo;this.register([e],"J",2),this.register([e],"K",5),this.register([],"ArrowDown",2),this.register([],"ArrowUp",5),this.register([],"Enter",8),this.register([e],"N",4),this.register([e],"P",7)}};var vn=class{async onload(){await b(Ze).initAsync(),b(Pe).init(),b(Ht).addCommandsWithoutDependency(),await b(Ke).initAsync(),await b(it).initAsync(),await b(Wn).createChildThreads(),b(qt).init()}async onLayoutReady(){await b(Ne).initAsync(),await b(ot).initAsync();let e=b(Ht);e.addInVaultCommands(),e.addDevCommands()}onunload(){b(Ht).onunload(),b(Ne).onunload(),b(je).onunload()}onAppQuit(){}};vn=N([(0,Kc.singleton)()],vn);var qn=class extends He.Plugin{async onload(){gs.container.register(rt,{useValue:this}),gs.container.register(He.App,{useValue:this.app}),gs.container.register(He.Vault,{useValue:this.app.vault});let e=b(vn);await e.onload(),this.app.workspace.onLayoutReady(()=>{e.onLayoutReady()}),this.registerEvent(this.app.workspace.on("quit",()=>e.onAppQuit(),this))}onunload(){document.body.classList.remove("cs-privacy-blur"),b(vn).onunload()}exampleCode(){this.registerDomEvent(document,"click",e=>{console.log("click",e)}),this.registerInterval(window.setInterval(()=>console.log("setInterval"),5*60*1e3))}},hs=class extends He.Modal{constructor(t,r){super(t);this.mdContent=r}onOpen(){this.containerEl.empty(),this.containerEl.style.display="block",this.containerEl.style.overflow="auto",this.containerEl.style.backgroundColor="black",He.MarkdownRenderer.render(b(He.App),this.mdContent,this.containerEl,"",new He.Component)}onClose(){}};0&&(module.exports={RenderMarkdownModal});
/*! Bundled license information:

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

fzf/dist/fzf.es.js:
  (** @license
   * fzf v0.5.2
   * Copyright (c) 2021 Ajit
   * Licensed under BSD 3-Clause
   *)
*/
