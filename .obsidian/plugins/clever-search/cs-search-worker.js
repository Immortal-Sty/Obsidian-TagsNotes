/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Q=Object.create;var C=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,ee=Object.prototype.hasOwnProperty;var O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var te=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Y(e))!ee.call(t,i)&&i!==r&&C(t,i,{get:()=>e[i],enumerable:!(o=X(e,i))||o.enumerable});return t};var ne=(t,e,r)=>(r=t!=null?Q(Z(t)):{},te(e||!t||!t.__esModule?C(r,"default",{value:t,enumerable:!0}):r,t));var J=O((we,d)=>{var n;d.exports.__wbg_set_wasm=function(t){n=t};var p=new Array(128).fill(void 0);p.push(void 0,null,!0,!1);function M(t){return p[t]}var v=p.length;function re(t){t<132||(p[t]=v,v=t)}function w(t){let e=M(t);return re(t),e}var l=0,E=null;function k(){return(E===null||E.byteLength===0)&&(E=new Uint8Array(n.memory.buffer)),E}var oe=typeof TextEncoder=="undefined"?(0,d.require)("util").TextEncoder:TextEncoder,W=new oe("utf-8"),ie=typeof W.encodeInto=="function"?function(t,e){return W.encodeInto(t,e)}:function(t,e){let r=W.encode(t);return e.set(r),{read:t.length,written:r.length}};function f(t,e,r){if(r===void 0){let s=W.encode(t),u=e(s.length,1)>>>0;return k().subarray(u,u+s.length).set(s),l=s.length,u}let o=t.length,i=e(o,1)>>>0,_=k(),a=0;for(;a<o;a++){let s=t.charCodeAt(a);if(s>127)break;_[i+a]=s}if(a!==o){a!==0&&(t=t.slice(a)),i=r(i,o,o=a+t.length*3,1)>>>0;let s=k().subarray(i+a,i+o),u=ie(t,s);a+=u.written}return l=a,i}function _e(t){return t==null}var L=null;function c(){return(L===null||L.byteLength===0)&&(L=new Int32Array(n.memory.buffer)),L}var se=typeof TextDecoder=="undefined"?(0,d.require)("util").TextDecoder:TextDecoder,I=new se("utf-8",{ignoreBOM:!0,fatal:!0});I.decode();function T(t,e){return t=t>>>0,I.decode(k().subarray(t,t+e))}function g(t){v===p.length&&p.push(p.length+1);let e=v;return v=p[e],p[e]=t,e}var A=null;function U(){return(A===null||A.byteLength===0)&&(A=new Uint32Array(n.memory.buffer)),A}function D(t,e){return t=t>>>0,U().subarray(t/4,t/4+e)}function ae(t,e){let r=e(t.length*1,1)>>>0;return k().set(t,r/1),l=t.length,r}function ce(t,e){let r=e(t.length*4,4)>>>0;return U().set(t,r/4),l=t.length,r}function $(t,e){return t=t>>>0,k().subarray(t/1,t/1+e)}d.exports.get_encoding=function(t,e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let _=n.__wbindgen_add_to_stack_pointer(-16),a=f(t,n.__wbindgen_export_0,n.__wbindgen_export_1),s=l;n.get_encoding(_,a,s,g(e));var r=c()[_/4+0],o=c()[_/4+1],i=c()[_/4+2];if(i)throw w(o);return h.__wrap(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}};d.exports.encoding_for_model=function(t,e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let _=n.__wbindgen_add_to_stack_pointer(-16),a=f(t,n.__wbindgen_export_0,n.__wbindgen_export_1),s=l;n.encoding_for_model(_,a,s,g(e));var r=c()[_/4+0],o=c()[_/4+1],i=c()[_/4+2];if(i)throw w(o);return h.__wrap(r)}finally{n.__wbindgen_add_to_stack_pointer(16)}};function q(t,e){try{return t.apply(this,e)}catch(r){n.__wbindgen_export_3(g(r))}}var F=new FinalizationRegistry(t=>n.__wbg_tiktoken_free(t>>>0)),h=class{constructor(e,r,o){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let i=f(e,n.__wbindgen_export_0,n.__wbindgen_export_1),_=l,a=f(o,n.__wbindgen_export_0,n.__wbindgen_export_1),s=l,u=n.tiktoken_new(i,_,g(r),a,s);return this.__wbg_ptr=u>>>0,this}get name(){try{let o=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_name(o,this.__wbg_ptr);var e=c()[o/4+0],r=c()[o/4+1];let i;return e!==0&&(i=T(e,r).slice(),n.__wbindgen_export_2(e,r*1,1)),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}static __wrap(e){e=e>>>0;let r=Object.create(h.prototype);return r.__wbg_ptr=e,F.register(r,r.__wbg_ptr,r),r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,F.unregister(this),e}free(){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let e=this.__destroy_into_raw();n.__wbg_tiktoken_free(e)}encode(e,r,o){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let b=n.__wbindgen_add_to_stack_pointer(-16),K=f(e,n.__wbindgen_export_0,n.__wbindgen_export_1),P=l;n.tiktoken_encode(b,this.__wbg_ptr,K,P,g(r),g(o));var i=c()[b/4+0],_=c()[b/4+1],a=c()[b/4+2],s=c()[b/4+3];if(s)throw w(a);var u=D(i,_).slice();return n.__wbindgen_export_2(i,_*4,4),u}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_ordinary(e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let _=n.__wbindgen_add_to_stack_pointer(-16),a=f(e,n.__wbindgen_export_0,n.__wbindgen_export_1),s=l;n.tiktoken_encode_ordinary(_,this.__wbg_ptr,a,s);var r=c()[_/4+0],o=c()[_/4+1],i=D(r,o).slice();return n.__wbindgen_export_2(r,o*4,4),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_with_unstable(e,r,o){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let s=n.__wbindgen_add_to_stack_pointer(-16),u=f(e,n.__wbindgen_export_0,n.__wbindgen_export_1),b=l;n.tiktoken_encode_with_unstable(s,this.__wbg_ptr,u,b,g(r),g(o));var i=c()[s/4+0],_=c()[s/4+1],a=c()[s/4+2];if(a)throw w(_);return w(i)}finally{n.__wbindgen_add_to_stack_pointer(16)}}encode_single_token(e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let r=ae(e,n.__wbindgen_export_0),o=l;return n.tiktoken_encode_single_token(this.__wbg_ptr,r,o)>>>0}decode(e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let _=n.__wbindgen_add_to_stack_pointer(-16),a=ce(e,n.__wbindgen_export_0),s=l;n.tiktoken_decode(_,this.__wbg_ptr,a,s);var r=c()[_/4+0],o=c()[_/4+1],i=$(r,o).slice();return n.__wbindgen_export_2(r,o*1,1),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}decode_single_token_bytes(e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");try{let _=n.__wbindgen_add_to_stack_pointer(-16);n.tiktoken_decode_single_token_bytes(_,this.__wbg_ptr,e);var r=c()[_/4+0],o=c()[_/4+1],i=$(r,o).slice();return n.__wbindgen_export_2(r,o*1,1),i}finally{n.__wbindgen_add_to_stack_pointer(16)}}token_byte_values(){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let e=n.tiktoken_token_byte_values(this.__wbg_ptr);return w(e)}};d.exports.Tiktoken=h;d.exports.__wbindgen_object_drop_ref=function(t){w(t)};d.exports.__wbindgen_is_undefined=function(t){return M(t)===void 0};d.exports.__wbg_stringify_4039297315a25b00=function(){return q(function(t){let e=JSON.stringify(M(t));return g(e)},arguments)};d.exports.__wbindgen_string_get=function(t,e){if(n==null)throw new Error("tiktoken: WASM binary has not been propery initialized.");let r=M(e),o=typeof r=="string"?r:void 0;var i=_e(o)?0:f(o,n.__wbindgen_export_0,n.__wbindgen_export_1),_=l;c()[t/4+1]=_,c()[t/4+0]=i};d.exports.__wbindgen_error_new=function(t,e){let r=new Error(T(t,e));return g(r)};d.exports.__wbg_parse_3f0cb48976ca4123=function(){return q(function(t,e){let r=JSON.parse(T(t,e));return g(r)},arguments)};d.exports.__wbindgen_throw=function(t,e){throw new Error(T(t,e))}});var B=O(S=>{var x=J(),R={};R["./tiktoken_bg.js"]=x;var y=require("path"),le=require("fs"),V=__dirname.split(y.sep).reduce((t,e,r,o)=>{let i=o.slice(0,r+1).join(y.sep)+y.sep;return i.includes("node_modules"+y.sep)||t.unshift(y.join(i,"node_modules","tiktoken","","./tiktoken_bg.wasm")),t},[]);V.unshift(y.join(__dirname,"./tiktoken_bg.wasm"));var j=null;for(let t of V)try{j=le.readFileSync(t);break}catch(e){}if(j==null)throw new Error("Missing tiktoken_bg.wasm");var de=new WebAssembly.Module(j),ue=new WebAssembly.Instance(de,R);x.__wbg_set_wasm(ue.exports);S.get_encoding=x.get_encoding;S.encoding_for_model=x.encoding_for_model;S.Tiktoken=x.Tiktoken});var z={traceLog:!1,loadIndexFromDatabase:!0};var N=class{constructor(){this.logLevel="debug";this.levelWeights={trace:1,debug:2,info:3,warn:4,error:5,none:6}}getLevel(){return this.logLevel}setLevel(e){this.logLevel=e}trace(...e){this.shouldLog("trace")&&(z.traceLog?(console.groupCollapsed(`%c[trace] ${this.getCallerName()}
`,"color: #5f6368;font-weight: 400;",...e),console.trace(),console.groupEnd()):console.log(`%c[trace] ${this.getCallerName()}
`,"color: #5f6368;",...e))}debug(...e){this.shouldLog("debug")&&(z.traceLog?(console.groupCollapsed(`%c[debug] ${this.getCallerName()}
`,"color: #379237;font-weight: 400;",...e),console.trace(),console.groupEnd()):console.debug(`%c[debug] ${this.getCallerName()}
`,"color: #379237",...e))}info(...e){this.shouldLog("info")&&console.info(`%c[info] ${this.getCallerName()}
`,"color: blue;",...e)}warn(...e){this.shouldLog("warn")&&console.warn(`%c[warn] ${this.getCallerName()}
`,"color: orange;",...e)}error(...e){this.shouldLog("error")&&console.error(`%c[error] ${this.getCallerName()}
`,"color: red;",...e)}getCallerName(){var i;let e=(i=new Error().stack)==null?void 0:i.split(`
`),r=e==null?void 0:e.slice(3).find(_=>!_.includes("eval")&&!_.includes("Array.map"));if(r!=null&&r.startsWith("    at blob:"))return"child-thread";let o=r==null?void 0:r.match(/at (\S+)/);return o?`<${o[1]}> `:"failed to parse caller"}shouldLog(e){return this.levelWeights[e]>=this.levelWeights[this.logLevel]}},m=new N;var H=ne(B());function G(){let t=(0,H.encoding_for_model)("gpt-3.5-turbo"),e=t.encode("hello world");m.info(`encoded ${e}`);let r=new TextDecoder().decode(t.decode(e));return m.info(`decoded ${r}`),"this is a test"}self.addEventListener("message",t=>{t.data==="tikToken"?self.postMessage("tikToken server: "+G()):m.debug("message isn't for tiktoken")});
