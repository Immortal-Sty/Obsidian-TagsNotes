/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD!
If you want to view the source, please visit https://github.com/omeyenburg/obsidian-scrolling.
*/
var N=Object.defineProperty;var Y=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var X=(a,e)=>{for(var t in e)N(a,t,{get:e[t],enumerable:!0})},j=(a,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of B(e))!G.call(a,i)&&i!==t&&N(a,i,{get:()=>e[i],enumerable:!(s=Y(e,i))||s.enumerable});return a};var J=a=>j(N({},"__esModule",{value:!0}),a);var $={};X($,{default:()=>V});module.exports=J($);var W=require("obsidian");var U=require("obsidian"),_=require("@codemirror/view"),q=require("@codemirror/state"),y=class y{constructor(e){this.recentEdit=!1;this.recentMouseUp=!1;this.scrollIntensity=0;this.scrollLast=0;this.lastLine=0;this.plugin=e;let t=e.app.workspace.on("editor-change",()=>{e.app.workspace.offref(t),e.registerEvent(e.app.workspace.on("editor-change",this.editHandler.bind(this)))});e.registerEvent(t),e.registerDomEvent(document,"mouseup",this.mouseUpHandler.bind(this)),e.registerDomEvent(document,"keydown",this.keyHandler.bind(this)),e.registerEditorExtension(_.EditorView.updateListener.of(this.cursorHandler.bind(this)))}keyHandler(){this.recentMouseUp=!1}mouseUpHandler(){this.recentMouseUp=!0,window.setTimeout(()=>{this.recentMouseUp=!1},100)}getScrollDirection(e){let t=this.lastLine;return this.lastLine=e.getCursor().line,t<this.lastLine?1:t>this.lastLine?-1:0}editHandler(e){this.recentEdit=!0;let t=this.getScrollDirection(e);this.invokeScroll(e,t)}cursorHandler(e){for(let i of e.transactions)if(i.annotation(q.Transaction.userEvent)==="select.pointer")return;if(this.recentEdit){this.recentEdit=!1;return}if(!e.selectionSet)return;let t=this.plugin.app.workspace.getActiveViewOfType(U.MarkdownView);if(!(t!=null&&t.editor))return;this.plugin.settings.restoreScrollCursor&&t.file&&this.plugin.restoreScroll.storeStateDebounced(t.file);let s=this.getScrollDirection(t.editor);!this.plugin.settings.followCursorEnableSelection&&t.editor.somethingSelected()||this.recentMouseUp&&!this.plugin.settings.followCursorEnableMouse||this.invokeScroll(t.editor,s)}calculateScrollIntensity(){let e=performance.now(),t=e-this.scrollLast;this.scrollLast=e,this.scrollIntensity=Math.max(0,this.scrollIntensity-t*y.INTENSITY_DECAY_RATE)+1}invokeScroll(e,t){if(!this.plugin.settings.followCursorEnabled)return;let s=this.plugin.settings.followCursorRadius,i=this.plugin.settings.followCursorSmoothness,l=this.plugin.settings.followCursorDynamicAnimation;!this.recentEdit&&l?this.calculateScrollIntensity():this.scrollIntensity=0;let r=e.cm.scrollDOM.querySelector(".cm-active.cm-line");if(!r)return;let c=r.getBoundingClientRect(),n=e.cm.defaultLineHeight,h=e.cm.scrollDOM.getBoundingClientRect().top,d=c.top+n-h,p=e.getScrollInfo(),g=p.top,w=p.height/2*s/100,C=p.height/2,u=d-C,M,v;if(u<-w)M=g+u+w,v=u+w;else if(u>w)M=g+u-w,v=u-w;else return;if(Math.abs(v)<1)return;window.cancelAnimationFrame(this.animationFrame),l&&this.recentEdit&&this.calculateScrollIntensity();let L=Math.max(1,Math.ceil(2*(i/100)*Math.sqrt(Math.abs(v))));(this.scrollIntensity>y.INTENSITY_THRESHOLD||Math.abs(v)>p.height)&&(L=Math.ceil(Math.sqrt(L)));let k=(R,P,x,O)=>{O<=0||(R.scrollTo(null,P-x*(O-1)),this.animationFrame=window.requestAnimationFrame(()=>k(R,P,x,O-1)))};k(e,M,v/L,L)}};y.INTENSITY_DECAY_RATE=.01,y.INTENSITY_THRESHOLD=3;var D=y;var m=class m{constructor(e){this.touchpadLastUse=0;this.touchpadFriction=0;this.touchpadVelocity=0;this.touchpadScrolling=!1;this.mouseLastUse=0;this.plugin=e,e.registerDomEvent(document,"wheel",this.wheelHandler.bind(this),{passive:!1})}async activeLeafChangeHandler(){this.touchpadVelocity=0}async wheelHandler(e){if(!this.plugin.settings.mouseEnabled||!e.deltaY)return;let t=e.target;for(;t&&t!=document.body;){let{overflowY:s}=getComputedStyle(t);if((s==="auto"||s==="scroll")&&t.scrollHeight>t.clientHeight){let l=e.deltaMode==e.DOM_DELTA_LINE?e.deltaY*20:e.deltaY;this.plugin.settings.touchpadEnabled&&this.isTouchpad(e)?this.scrollWithTouchpad(t,l):this.scrollWithMouse(t,l),e.preventDefault();return}t=t.parentElement}}isTouchpad(e){if(e.deltaMode!==WheelEvent.DOM_DELTA_PIXEL)return this.touchpadLastUse=0,!1;for(let s of m.COMMON_MOUSE_DELTAS)if(e.deltaY/s%1==0)return this.touchpadLastUse=0,!1;let t=performance.now();return e.deltaX!==0&&e.deltaY!==0?(this.touchpadLastUse=t,!0):e.deltaY%1!==0&&Math.abs(e.deltaY)<m.TOUCHPAD_DELTA_THRESHOLD?(this.touchpadLastUse=t,!0):t-this.touchpadLastUse<m.TOUCHPAD_GRACE_PERIOD?(this.touchpadLastUse=t,!0):!1}scrollWithMouse(e,t){if(!e)return;window.cancelAnimationFrame(this.mouseAnimationFrame);let s=this.plugin.settings.mouseSmoothness*2,i=this.plugin.settings.mouseSpeed/50,l=this.plugin.settings.mouseInvert?-1:1,r=t*i*l,c=performance.now();this.mouseTarget&&this.mouseLastUse&&c-this.mouseLastUse<s&&(e.scrollTop=this.mouseTarget),this.mouseLastUse=c;let n=e.scrollTop;this.mouseTarget=n+r;let h=p=>1-(1-p)**2,d=p=>{p=performance.now();let g=Math.min(1,(p-c)/s);g=h(g),e.scrollTop=n+r*g,g<1?this.mouseAnimationFrame=window.requestAnimationFrame(d):e.scrollTop=n+r};this.mouseAnimationFrame=window.requestAnimationFrame(d)}scrollWithTouchpad(e,t){let s=this.plugin.settings.touchpadSmoothness/100,i=this.plugin.settings.touchpadSpeed/200,l=this.plugin.settings.touchpadFrictionThreshold,r=this.plugin.settings.mouseInvert?-1:1;this.touchpadVelocity*t<0&&(this.touchpadScrolling=!1),this.touchpadVelocity+=t*i*r;let c=()=>{Math.abs(this.touchpadVelocity)>m.MIN_VELOCITY?(e.scrollTop+=this.touchpadVelocity,this.touchpadVelocity*=this.touchpadFriction,this.touchpadFriction=Math.max(0,Math.min(m.MAX_FRICTION,this.touchpadFriction+.05)),window.requestAnimationFrame(c)):(this.touchpadScrolling=!1,this.touchpadVelocity=0)};this.touchpadFriction=Math.min(1,(Math.abs(t)/l)**3)*s,this.touchpadScrolling||(this.touchpadScrolling=!0,c())}};m.MAX_FRICTION=.98,m.MIN_VELOCITY=.1,m.COMMON_MOUSE_DELTAS=[120,197.18010794176823],m.TOUCHPAD_GRACE_PERIOD=1e3,m.TOUCHPAD_DELTA_THRESHOLD=50;var H=m;var T=require("obsidian"),E=class E{constructor(e){this.scrollEventSkip=!1;this.currentFileTreeHorizontal=!1;this.scrollTimeouts=new Map;this.plugin=e,this.updateStyle(),this.boundScrollHandler=this.scrollHandler.bind(this)}async activeLeafChangeHandler(){var t;let e=this.plugin.app.workspace.getActiveViewOfType(T.FileView);if(!(!e||!e.file)){if(this.scrollEventSkip=!0,window.setTimeout(()=>{this.scrollEventSkip=!1},E.FILE_OPEN_SCROLL_EVENT_DELAY),e.file.extension==="md"){let s=e.contentEl.querySelector(".cm-scroller"),i=e.contentEl.querySelector(".markdown-preview-view");if(!s||!i)return;s.classList.add("scrolling-transparent"),i.classList.add("scrolling-transparent"),s.removeEventListener("scroll",this.boundScrollHandler),i.removeEventListener("scroll",this.boundScrollHandler),this.plugin.registerDomEvent(s,"scroll",this.boundScrollHandler),this.plugin.registerDomEvent(i,"scroll",this.boundScrollHandler)}else if(e.file.extension==="pdf"){let s=e.contentEl.querySelector(".pdf-viewer-container");if(!s)return;s.classList.add("scrolling-transparent"),s.removeEventListener("scroll",this.boundScrollHandler),s.addEventListener("scroll",this.boundScrollHandler),this.plugin.register(()=>s.removeEventListener("scroll",this.boundScrollHandler))}else if(E.IMAGE_EXTENSIONS.has(e.file.extension.toLowerCase())){let s=(t=e.contentEl.querySelector(".image-container"))==null?void 0:t.parentElement;if(!s)return;s.classList.add("scrolling-transparent"),s.removeEventListener("scroll",this.boundScrollHandler),s.addEventListener("scroll",this.boundScrollHandler),this.plugin.register(()=>s.removeEventListener("scroll",this.boundScrollHandler))}}}async scrollHandler(e){if(this.scrollEventSkip)return;let t=this.plugin.app.workspace.getActiveFile();if(t&&this.plugin.restoreScroll.storeStateDebounced(t),T.Platform.isMacOS||this.plugin.settings.scrollbarVisibility!="scroll")return;let s=e.currentTarget;if(!s)return;s.classList.remove("scrolling-transparent");let i=this.scrollTimeouts.get(s);i&&window.clearTimeout(i);let l=window.setTimeout(()=>{s.classList.add("scrolling-transparent"),this.scrollTimeouts.delete(s)},E.SCROLLBAR_IDLE_TIMEOUT);this.scrollTimeouts.set(s,l)}async updateStyle(){if(T.Platform.isMacOS){let i=this.plugin.settings.scrollbarFileTreeHorizontal;if(this.currentFileTreeHorizontal==i)return;this.currentFileTreeHorizontal=i,i?document.body.addClass("scrolling-filetree-horizontal"):document.body.removeClass("scrolling-filetree-horizontal");return}let e=this.plugin.settings.scrollbarVisibility,t=T.Platform.isLinux?this.plugin.settings.scrollbarWidth:-1,s=this.plugin.settings.scrollbarFileTreeHorizontal;this.currentWidth==t&&this.currentVisibility==e&&this.currentFileTreeHorizontal==s||(this.currentWidth=t,this.currentVisibility=e,this.currentFileTreeHorizontal=s,this.removeStyle(),s&&document.body.addClass("scrolling-filetree-horizontal"),e==="hide"?document.body.addClass("scrolling-visibility-hide"):e==="scroll"&&document.body.addClass("scrolling-visibility-scroll"),t>=0&&(document.body.addClass("scrolling-scrollbar-width"),document.body.style.setProperty("--scrolling-scrollbar-width",`${t}px`)))}removeStyle(){document.body.removeClasses(["scrolling-scrollbar-width","scrolling-visibility-hide","scrolling-visibility-scroll","scrolling-filetree-horizontal"]),document.body.style.removeProperty("--scrolling-scrollbar-width")}};E.SCROLLBAR_IDLE_TIMEOUT=500,E.FILE_OPEN_SCROLL_EVENT_DELAY=500,E.IMAGE_EXTENSIONS=new Set(["png","jpg","jpeg","gif","svg","webp","bmp","ico","apng","avif"]);var A=E;var f=require("obsidian");function z(a,e){let t=Object.keys(e).map(s=>K(a,s,e[s]));return t.length===1?t[0]:function(){t.forEach(s=>s())}}function K(a,e,t){let s=a[e],i=a.hasOwnProperty(e),l=i?s:function(){return Object.getPrototypeOf(a)[e].apply(this,arguments)},r=t(l);return s&&Object.setPrototypeOf(r,s),Object.setPrototypeOf(c,r),a[e]=c,n;function c(...h){return r===l&&a[e]===c&&n(),r.apply(this,h)}function n(){a[e]===c&&(i?a[e]=l:delete a[e]),r!==l&&(r=l,Object.setPrototypeOf(c,s||Function))}}var b=class b{constructor(e){this.ephemeralStates={};this.plugin=e,e.registerEvent(e.app.vault.on("rename",this.renameFileCallback.bind(this))),e.registerEvent(e.app.vault.on("delete",this.deleteFileCallback.bind(this))),e.registerEvent(e.app.workspace.on("quit",this.saveData.bind(this))),this.storeStateDebounced=(0,f.debounce)(this.storeState.bind(this),b.STORE_INTERVAL,!1);let t=(0,f.debounce)(this.saveData.bind(this),b.FILE_SAVE_INTERVAL,!0),s=this;e.register(z(f.WorkspaceLeaf.prototype,{setViewState(i){return async function(...l){t();let r=await i.apply(this,l),c=e.app.workspace.containerEl.querySelector("span.is-flashing"),n=e.app.workspace.getActiveViewOfType(f.FileView);if(c||!n||!n.file||!e.settings.restoreScrollEnabled)return r;let h=s.ephemeralStates[n.file.path];if(!h)return r;let{cursor:d,scroll:p,scrollTop:g}=h,w=n.getViewType();return n instanceof f.MarkdownView&&n.getMode()==="source"&&(p||d&&e.settings.restoreScrollCursor)?(console.log("restore",d,p),d&&e.settings.restoreScrollCursor?(n.setEphemeralState({cursor:d}),n.editor.scrollIntoView(d,!0)):n.setEphemeralState({scroll:p})):g&&e.settings.restoreScrollAllFiles&&window.requestAnimationFrame(()=>{var C;if(w==="markdown"){let u=n.containerEl.querySelector(".markdown-preview-view");u&&(u.scrollTop=g)}else if(w==="pdf"){let u=n.containerEl.querySelector(".pdf-viewer-container");u&&(u.scrollTop=g)}else if(w==="image"){let u=(C=n.containerEl.querySelector(".image-container"))==null?void 0:C.parentElement;u&&(u.scrollTop=g)}}),r}}}))}async deleteFileCallback(e){delete this.ephemeralStates[e.path]}async renameFileCallback(e,t){this.ephemeralStates[e.path]=this.ephemeralStates[t],delete this.ephemeralStates[t]}async saveData(){let e=JSON.stringify(this.ephemeralStates);this.plugin.app.vault.adapter.write(b.CACHE_FILE,e)}async loadData(){if(await this.plugin.app.vault.adapter.exists(b.CACHE_FILE)){let t=await this.plugin.app.vault.adapter.read(b.CACHE_FILE);try{this.ephemeralStates=JSON.parse(t)}catch(s){this.ephemeralStates={}}}}async storeState(e){var l,r,c,n;if(!this.plugin.settings.restoreScrollEnabled)return;let t=this.plugin.app.workspace.getActiveViewOfType(f.FileView);if(!t||!t.file||this.plugin.app.workspace.getActiveFile()!=t.file||t.file!=e)return;let s,i=Date.now();if(t instanceof f.MarkdownView&&t.getMode()=="source"){console.log("store s"),s=t.editor.getScrollInfo().top;let{cursor:h,scroll:d}=t.getEphemeralState();this.ephemeralStates[t.file.path]={timestamp:i,cursor:h,scroll:d,scrollTop:s}}else if(this.plugin.settings.restoreScrollAllFiles){console.log("store");let h=t.getViewType();h==="markdown"?s=(l=t.containerEl.querySelector(".markdown-preview-view"))==null?void 0:l.scrollTop:h==="pdf"?s=(r=t.containerEl.querySelector(".pdf-viewer-container"))==null?void 0:r.scrollTop:h==="image"&&(s=(n=(c=t.containerEl.querySelector(".image-container"))==null?void 0:c.parentElement)==null?void 0:n.scrollTop),this.ephemeralStates[t.file.path]={timestamp:i,scrollTop:s}}}};b.STORE_INTERVAL=50,b.FILE_SAVE_INTERVAL=50,b.CACHE_FILE=".obsidian/plugins/obsidian-scrolling/ephemeral-states.json";var I=b;var o=require("obsidian"),S={followCursorEnabled:!0,followCursorRadius:75,followCursorSmoothness:25,followCursorDynamicAnimation:!0,followCursorEnableMouse:!1,followCursorEnableSelection:!1,restoreScrollEnabled:!1,restoreScrollCursor:!1,restoreScrollAllFiles:!1,scrollbarVisibility:"show",scrollbarWidth:12,scrollbarFileTreeHorizontal:!1,mouseEnabled:!0,mouseInvert:!1,mouseSpeed:50,mouseSmoothness:75,touchpadEnabled:!0,touchpadSmoothness:75,touchpadFrictionThreshold:20,touchpadSpeed:50},F=class extends o.PluginSettingTab{constructor(e){super(e.app,e),this.plugin=e}display(){let e=this.containerEl;e.empty(),new o.Setting(e).setName("Follow Cursor").setHeading(),new o.Setting(e).setName("Enabled").setDesc("Keep the cursor near the center.").addToggle(t=>t.setValue(this.plugin.settings.followCursorEnabled).onChange(async s=>{this.plugin.settings.followCursorEnabled=s,this.display(),await this.plugin.saveSettings()})),this.plugin.settings.followCursorEnabled&&(new o.Setting(e).setName("Trigger distance").setDesc(createFragment(t=>{let s=t.createDiv();s.createEl("span",{text:"How far the cursor can move from the center before scrolling."}),s.createEl("br"),s.createEl("span",{text:"0% keeps the cursor perfectly centered."})})).addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.followCursorRadius=S.followCursorRadius,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.followCursorRadius).setLimits(0,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.followCursorRadius=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Animation duration").setDesc("Length of the scrolling animation.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.followCursorSmoothness=S.followCursorSmoothness,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.followCursorSmoothness).setLimits(0,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.followCursorSmoothness=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Dynamic animations").setDesc("If many scroll events happen quickly, skip animation frames to improve responsiveness.").addToggle(t=>t.setValue(this.plugin.settings.followCursorDynamicAnimation).onChange(async s=>{this.plugin.settings.followCursorDynamicAnimation=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Trigger on mouse interactions").setDesc("Update when the cursor is moved using the mouse.").addToggle(t=>t.setValue(this.plugin.settings.followCursorEnableMouse).onChange(async s=>{this.plugin.settings.followCursorEnableMouse=s,this.display(),await this.plugin.saveSettings()})),this.plugin.settings.followCursorEnableMouse&&new o.Setting(e).setName("Trigger on mouse selection").setDesc("Also update when text is selected using the mouse.").addToggle(t=>t.setValue(this.plugin.settings.followCursorEnableSelection).onChange(async s=>{this.plugin.settings.followCursorEnableSelection=s,await this.plugin.saveSettings()}))),e.createEl("br"),new o.Setting(e).setName("Remember scroll position").setHeading(),new o.Setting(e).setName("Enabled").setDesc("Save scroll position before closing a file and restore it when opening the file again.").addToggle(t=>t.setValue(this.plugin.settings.restoreScrollEnabled).onChange(async s=>{this.plugin.settings.restoreScrollEnabled=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Restore cursor position instead").setDesc("Try to restore cursor position first and use scroll position only as fallback.").addToggle(t=>t.setValue(this.plugin.settings.restoreScrollCursor).onChange(async s=>{this.plugin.settings.restoreScrollCursor=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Restore in other files").setDesc("Save and restore scroll position in markdown preview, image and pdf files.").addToggle(t=>t.setValue(this.plugin.settings.restoreScrollAllFiles).onChange(async s=>{this.plugin.settings.restoreScrollAllFiles=s,await this.plugin.saveSettings()})),e.createEl("br"),new o.Setting(e).setName("Scrollbar appearance").setHeading(),new o.Setting(e).setName("Show horizontal scrollbar in file tree").setDesc("Allow horizontal scrolling in the file tree and add a horizontal scrollbar.").addToggle(t=>t.setValue(this.plugin.settings.scrollbarFileTreeHorizontal).onChange(async s=>{this.plugin.settings.scrollbarFileTreeHorizontal=s,this.plugin.scrollbar.updateStyle(),await this.plugin.saveSettings()})),o.Platform.isMacOS||(new o.Setting(e).setName("Scrollbar visibility").setDesc("When to show the scrollbar in markdown/pdf files.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.scrollbarVisibility=S.scrollbarVisibility,this.plugin.scrollbar.updateStyle(),await this.plugin.saveSettings()})}).addDropdown(t=>t.addOption("hide","Always hide scrollbar").addOption("scroll","Show scrollbar while scrolling").addOption("show","Always show scrollbar").setValue(this.plugin.settings.scrollbarVisibility).onChange(async s=>{this.plugin.settings.scrollbarVisibility=s,this.plugin.scrollbar.updateStyle(),this.display(),await this.plugin.saveSettings()})),o.Platform.isLinux&&this.plugin.settings.scrollbarVisibility!=="hide"&&new o.Setting(e).setName("Scrollbar thickness").setDesc("Width of scrollbars in pixels.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.scrollbarWidth=S.scrollbarWidth,this.plugin.scrollbar.updateStyle(),this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.scrollbarWidth).setLimits(0,30,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.scrollbarWidth=s,this.plugin.scrollbar.updateStyle(),await this.plugin.saveSettings()}))),e.createEl("br"),new o.Setting(e).setName("Mouse/Touchpad scrolling (Experimental)").setHeading(),new o.Setting(e).setName("Enabled").setDesc("Enable custom mouse/touchpad scrolling behavior.").addToggle(t=>t.setValue(this.plugin.settings.mouseEnabled).onChange(async s=>{this.plugin.settings.mouseEnabled=s,this.display(),await this.plugin.saveSettings()})),this.plugin.settings.mouseEnabled&&(new o.Setting(e).setName("Invert scroll direction").setDesc("Reverse the scroll direction for mouse wheel and touchpad input.").addToggle(t=>t.setValue(this.plugin.settings.mouseInvert).onChange(async s=>{this.plugin.settings.mouseInvert=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Scroll speed").setDesc("How far the page scrolls per mouse wheel movement.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.mouseSpeed=S.mouseSpeed,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.mouseSpeed).setLimits(1,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.mouseSpeed=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Scroll smoothness").setDesc("Duration of the scrolling animation.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.mouseSmoothness=S.mouseSmoothness,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.mouseSmoothness).setLimits(0,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.mouseSmoothness=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Touchpad detection").setDesc(createFragment(t=>{let s=t.createDiv();s.createEl("span",{text:"Detect touchpad input and apply dedicated scrolling behavior."}),s.createEl("br"),s.createEl("span",{text:"Detection works reliably on most devices but may occasionally misidentify input type."})})).addToggle(t=>t.setValue(this.plugin.settings.touchpadEnabled).onChange(async s=>{this.plugin.settings.touchpadEnabled=s,this.display(),await this.plugin.saveSettings()})),this.plugin.settings.touchpadEnabled&&this.plugin.settings.mouseEnabled&&(new o.Setting(e).setName("Touchpad scroll speed").setDesc("How fast the page scrolls on touchpad movement.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.touchpadSpeed=S.touchpadSpeed,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.touchpadSpeed).setLimits(1,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.touchpadSpeed=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Touchpad scroll smoothness").setDesc("Scroll smoothness when using a touchpad.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.touchpadSmoothness=S.touchpadSmoothness,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.touchpadSmoothness).setLimits(0,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.touchpadSmoothness=s,await this.plugin.saveSettings()})),new o.Setting(e).setName("Touchpad friction threshold").setDesc("Threshold between precise and smooth scrolling. Defines how much finger movement is needed before scrolling decelerates and stops.").addExtraButton(t=>{t.setIcon("reset").setTooltip("Restore default").onClick(async()=>{this.plugin.settings.touchpadFrictionThreshold=S.touchpadFrictionThreshold,this.display(),await this.plugin.saveSettings()})}).addSlider(t=>t.setValue(this.plugin.settings.touchpadFrictionThreshold).setLimits(1,100,1).setDynamicTooltip().onChange(async s=>{this.plugin.settings.touchpadFrictionThreshold=s,await this.plugin.saveSettings()}))))}};var V=class extends W.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new F(this)),this.restoreScroll=new I(this),this.followcursor=new D(this),this.mousescroll=new H(this),this.scrollbar=new A(this),this.restoreScroll.loadData(),this.registerEvent(this.app.workspace.on("active-leaf-change",this.activeLeafChangeHandler.bind(this))),console.log("ScrollingPlugin loaded")}async activeLeafChangeHandler(){this.scrollbar.activeLeafChangeHandler(),this.mousescroll.activeLeafChangeHandler()}async onunload(){var e;(e=this.scrollbar)==null||e.removeStyle(),console.log("ScrollingPlugin unloaded")}async loadSettings(){this.settings=Object.assign({},S,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */