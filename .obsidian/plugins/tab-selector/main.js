/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var R=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.prototype.hasOwnProperty;var se=(h,a)=>{for(var e in a)R(h,e,{get:a[e],enumerable:!0})},oe=(h,a,e,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let t of ee(a))!te.call(h,t)&&t!==e&&R(h,t,{get:()=>a[t],enumerable:!(o=Z(a,t))||o.enumerable});return h};var ie=h=>oe(R({},"__esModule",{value:!0}),h);var pe={};se(pe,{default:()=>F});module.exports=ie(pe);var x=require("obsidian");var c=require("obsidian");var V=require("obsidian");var P=class h extends Error{constructor(a,e){super(a),Error.captureStackTrace&&Error.captureStackTrace(this,h),this.name="KeySettingsError",console.warn(e)}};var z="tab-selector-styles",M={notOnlyOneHotkey:"Not only one hotkey.",mismatchMainModifierKey:"Mismatch main modifier key.",mismatchActionKey:"Mismatch action key.",mismatchSubModifierKey:"Mismatch sub modifier key.",useDuplicateModifierKey:"Use duplicate modifier key.",useDuplicateActionKey:"Use duplicate action key."},N=(h,a,e=!0)=>{var u;let o=(u=h.hotkeyManager)==null?void 0:u.customKeys,t=o&&o["tab-selector:go-to-previous-tab"]||[],s=o&&o["tab-selector:go-to-next-tab"]||[],i={settings:a,toPrevHotkeys:t,toNextHotkeys:s};if(!t[0]||!s[0]||t.length>1||s.length>1){if(e)throw new P(`Invalid settings: ${M.notOnlyOneHotkey}`,i);return!1}let n=t[0],l=s[0],{mainModifierKey:r,subModifierKey:p,actionKey:d,reverseActionKey:f,howToNextTab:b}=a,T=b===v.useSubModifierKey,m="";if(G(n.modifiers[0])!==r&&(m=m||M.mismatchMainModifierKey),T?((n.key!==d||l.key!==d)&&(m=m||M.mismatchActionKey),l.modifiers.filter(K=>G(K)===p).length!==1&&(m=m||M.mismatchSubModifierKey),r===p&&(m=m||M.useDuplicateModifierKey)):(n.key!==d||l.key!==f)&&(m=m||M.useDuplicateActionKey),m&&e)throw new P(`Invalid settings: ${m}`,i);return!m},G=h=>{switch(h){case"Mod":return V.Platform.isMacOS||V.Platform.isIosApp?g.meta:g.ctrl;case"Ctrl":return g.ctrl;case"Meta":case"Shift":case"Alt":default:return h}},j=()=>{let h=document.getElementById(z);h&&document.getElementsByTagName("HEAD")[0].removeChild(h)},U=h=>{let a=document.createElement("style");ae(a,{type:"text/css",id:z}),document.getElementsByTagName("HEAD")[0].appendChild(a),h.forEach(({selector:o,property:t,value:s})=>{ne(o,`${t}: ${s}`,a)})},ae=(h,a)=>{for(let e in a)h.setAttribute(e,a[e])},ne=(h,a,e)=>{e.textContent+=h+`{${a}}`};var g={ctrl:"Control",alt:"Alt",meta:"Meta",shift:"Shift"},D=c.Platform.isMacOS||c.Platform.isIosApp,L={ctrl:D?"^":"Ctrl",alt:D?"\u2325":"Alt",meta:D?"\u2318":"Win",shift:D?"\u21E7":"Shift"},w={tab:"Tab",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"},k={tab:"Tab",arrowUp:"\u2191",arrowDown:"\u2193",arrowLeft:"\u2190",arrowRight:"\u2192"},v={useSubModifierKey:"useSubModifierKey",useReverseActionKey:"useReverseActionKey"},re={useSubModifierKey:"Sub modifier key",useReverseActionKey:"Reverse action key"},S={goToPreviousNextTab:"goToPreviousNextTab",openTabSelector:"openTabSelector",showTabShortcuts:"showTabShortcuts",searchTab:"searchTab"},y={[S.goToPreviousNextTab]:{enableMultiWIndow:!1,focusColor:"#00b4e0",mainModifierKey:g.ctrl,subModifierKey:g.shift,actionKey:w.tab,reverseActionKey:w.arrowLeft,howToNextTab:v.useSubModifierKey},[S.openTabSelector]:{enableMultiWIndow:!1,showAliases:!1,replaceToAliases:!1,showPaths:!1,showPaginationButtons:!0,showLegends:!0,focusColor:"#00b4e0",characters:"asdfghjkl;",enableClose:!0},[S.showTabShortcuts]:{enableMultiWIndow:!1,characters:"asdfghjkl;qwertyuiopzxcvbnm,./"},[S.searchTab]:{enableMultiWIndow:!1,showAliases:!1,includeAliases:!1,showPaths:!1,includePaths:!1,showLegends:!0,focusColor:"#00b4e0"}},I={min:4,max:10},W=class extends c.PluginSettingTab{constructor(e,o){super(e,o);this.isOpen={firstDetails:!1,secondDetails:!1,thirdDetails:!1,fourthDetails:!1};this.plugin=o}display(){let{containerEl:e}=this;e.empty(),e.addClass("ts-settings");{let o=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Go to previous/next tab" command')})});this.isOpen.firstDetails&&o.setAttr("open",!0),o.addEventListener("toggle",()=>this.isOpen.firstDetails=o.open),this.setForGoToPrevNextTabCommands(o)}{let o=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Open tab selector" command')})});this.isOpen.secondDetails&&o.setAttr("open",!0),o.addEventListener("toggle",()=>this.isOpen.secondDetails=o.open),this.setForOpenTabSelectorCommand(o)}if(c.Platform.isDesktop||c.Platform.isTablet){let o=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Show tab shortcuts" command')})});this.isOpen.thirdDetails&&o.setAttr("open",!0),o.addEventListener("toggle",()=>this.isOpen.thirdDetails=o.open),this.setForShowTabShortcutCommand(o)}{let o=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Search tabs" command')})});this.isOpen.fourthDetails&&o.setAttr("open",!0),o.addEventListener("toggle",()=>this.isOpen.fourthDetails=o.open),this.setForSearchTabCommand(o)}}updateStyleSheet(e=!1){if(j(),e)return;let{goToPreviousNextTab:o,openTabSelector:t,searchTab:s}=this.plugin.settings,{focusColor:i}=t,{focusColor:n}=o,{focusColor:l}=s;U([{selector:".ts-leaf-name-btn:focus",property:"outline",value:`2px solid ${i}`},{selector:".th-leaf-name-btn.is-focus",property:"outline",value:`2px solid ${n}`},{selector:".tab-search-modal .suggestion-item.is-selected",property:"outline",value:`2px solid ${l}`}])}setForGoToPrevNextTabCommands(e){let o=S.goToPreviousNextTab,t=this.plugin.settings[o];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async i=>{t.enableMultiWIndow=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choose your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async i=>{t.focusColor=i,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let i=()=>t.focusColor=y[o].focusColor;this.addResetButton(s,i)}),new c.Setting(e).setName("Main modifier key").setDesc("Holding this key down keeps the modal open. When this key is released, it switches to the focused tab.").addDropdown(s=>s.addOptions(Object.keys(g).reduce((i,n)=>(i[n]=L[n],i),{})).setValue(this.convertToKey(t.mainModifierKey,g)).onChange(async i=>{t.mainModifierKey=this.convertToSettingValue(i,g,L),await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let i=()=>t.mainModifierKey=y[o].mainModifierKey;this.addResetButton(s,i)}),new c.Setting(e).setName("Action key").setDesc("Press this key while holding down the Main modifier key moves to the previous tab.").addDropdown(s=>s.addOptions(Object.keys(w).reduce((i,n)=>(i[n]=k[n],i),{})).setValue(this.convertToKey(t.actionKey,w)).onChange(async i=>{t.actionKey=this.convertToSettingValue(i,w,k),await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let i=()=>t.actionKey=y[o].actionKey;this.addResetButton(s,i)}),new c.Setting(e).setName("Choose how to go to the next tab").setDesc(`
				When go to the next tab, if you want to use the same key as the Action key, choose \u201CSub modifier key\u201D.
				If you want to use a different key from the Action key, choose \u201CReverse action key".
			`).addDropdown(s=>s.addOptions(Object.keys(v).reduce((i,n)=>(i[n]=re[n],i),{})).setValue(this.convertToKey(t.howToNextTab,v)).onChange(async i=>{t.howToNextTab=i,await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let i=()=>t.howToNextTab=y[o].howToNextTab;this.addResetButton(s,i)}),new c.Setting(e).setName("Sub modifier key").setDesc("Pressing the Action key while holding this key down moves to the next tab.").addDropdown(s=>s.addOptions(Object.keys(g).reduce((i,n)=>(i[n]=L[n],i),{})).setValue(this.convertToKey(t.subModifierKey,g)).onChange(async i=>{t.subModifierKey=this.convertToSettingValue(i,g,L),await this.plugin.saveData(this.plugin.settings),this.display()})).setDisabled(t.howToNextTab!==v.useSubModifierKey).then(s=>{if(t.howToNextTab===v.useSubModifierKey){let i=()=>t.subModifierKey=y[o].subModifierKey;this.addResetButton(s,i)}}),new c.Setting(e).setName("Reverse action key").setDesc("Press this key while holding down the Main modifier key moves to the next tab.").addDropdown(s=>s.addOptions(Object.keys(w).reduce((i,n)=>(i[n]=k[n],i),{})).setValue(this.convertToKey(t.reverseActionKey,w)).onChange(async i=>{t.reverseActionKey=this.convertToSettingValue(i,w,k),await this.plugin.saveData(this.plugin.settings),this.display()})).setDisabled(t.howToNextTab!==v.useReverseActionKey).then(s=>{if(t.howToNextTab===v.useSubModifierKey){let i=()=>t.reverseActionKey=y[o].reverseActionKey;this.addResetButton(s,i)}}),e.createDiv("th-how-to-use",s=>{s.createDiv("th-settings-description",u=>{u.createSpan("th-description-title").setText("How to use"),u.createSpan("").setText("1. Configure the above settings."),u.createSpan("").setText("2. Set the hotkeys to match for the following commands.")});let{mainModifierKey:i,subModifierKey:n,actionKey:l,reverseActionKey:r,howToNextTab:p}=t,d=this.convertToDisplayText(i,g,L),f=this.convertToDisplayText(n,g,L),b=this.convertToDisplayText(l,w,k),T=this.convertToDisplayText(r,w,k),m=p===v.useSubModifierKey;s.createDiv("th-hotkey-preview",u=>{u.createSpan("th-hotkey-preview-label").setText('"Tab Selector: Go to next tab": '),u.createSpan("th-hotkey-preview-value").setText((m?[d,f,b]:[d,T]).join(D?"":" + "))}),s.createDiv("th-hotkey-preview",u=>{u.createSpan("th-hotkey-preview-label").setText('"Tab Selector: Go to previous tab": '),u.createSpan("th-hotkey-preview-value").setText([d,b].join(D?"":" + "))}),s.createDiv("th-match-state",u=>{let K=N(this.app,t,!1);u.addClass(K?"is-match":"is-mismatch"),u.createSpan("th-match-icon",J=>(0,c.setIcon)(J,K?"check":"x")),u.createSpan("").setText(`Currently hotkeys ${K?"match":"mismatch"} the above commands.`)}),s.createDiv("th-settings-caution",u=>{u.createSpan("th-settings-caution-title").setText("Caution"),u.createSpan("").setText(`
					Don't use shortcut keys reserved by the OS.
					OS shortcut keys take precedence and don't work properly.
				`)})})}setForOpenTabSelectorCommand(e){let o=S.openTabSelector,t=this.plugin.settings[o];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async i=>{t.enableMultiWIndow=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show aliases").setDesc("When enabled, show file's aliases on button.").addToggle(s=>s.setValue(t.showAliases).onChange(async i=>{t.showAliases=i,t.replaceToAliases=!1,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet(),this.display()})),new c.Setting(e).setName("Replace the filename to aliases").setDesc("When enabled, if aliases is set the file, replace the filename to aliases.").addToggle(s=>s.setValue(t.replaceToAliases).onChange(async i=>{t.replaceToAliases=i,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).setDisabled(!t.showAliases),new c.Setting(e).setName("Show paths").setDesc("When enabled, show file's paths on button.").addToggle(s=>s.setValue(t.showPaths).onChange(async i=>{t.showPaths=i,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})),new c.Setting(e).setName("Show pagination buttons").setDesc("When enabled, show pagination buttons on modal.").addToggle(s=>s.setValue(t.showPaginationButtons).onChange(async i=>{t.showPaginationButtons=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(s=>s.setValue(t.showLegends).onChange(async i=>{t.showLegends=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async i=>{t.focusColor=i,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let i=()=>t.focusColor=y[o].focusColor;this.addResetButton(s,i)}),new c.Setting(e).setName("Characters used for button hints").setDesc(`Enter ${I.min}~${I.max} non-duplicate alphanumeric characters or symbols.`).addText(s=>{let i=t.characters,n=s.setPlaceholder("Enter characters").setValue(t.characters).onChange(async l=>{let{inputEl:r}=n;!this.isDuplicateChars([...l])&&r.validity.valid?(r.removeClass("ts-setting-is-invalid"),t.characters=l,i=l,await this.plugin.saveSettings()):r.addClass("ts-setting-is-invalid"),this.updateStyleSheet()});return n.inputEl.addEventListener("blur",()=>{(this.isDuplicateChars([...n.inputEl.value])||!n.inputEl.validity.valid)&&(t.characters=i)}),n.inputEl.setAttrs({maxLength:I.max,required:!0,pattern:`[!-~]{${I.min},${I.max}}`}),n}).then(s=>{let i=()=>t.characters=y[o].characters;this.addResetButton(s,i)}),new c.Setting(e).setName("Enable tabs close").setDesc("When enabled, the operation of closing tabs is enabled.").addToggle(s=>s.setValue(t.enableClose).onChange(async i=>{t.enableClose=i,await this.plugin.saveData(this.plugin.settings)}))}setForShowTabShortcutCommand(e){let o=S.showTabShortcuts,t=this.plugin.settings[o];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async i=>{t.enableMultiWIndow=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Characters used for shortcut hints").setDesc("Enter non-duplicate alphanumeric characters or symbols.").addText(s=>{let i=t.characters,n=s.setPlaceholder("Enter characters").setValue(t.characters).onChange(async l=>{let{inputEl:r}=n;!this.isDuplicateChars([...l])&&r.validity.valid?(r.removeClass("ts-setting-is-invalid"),t.characters=l,i=l,await this.plugin.saveSettings()):r.addClass("ts-setting-is-invalid"),this.updateStyleSheet()});return n.inputEl.addEventListener("blur",()=>{(this.isDuplicateChars([...n.inputEl.value])||!n.inputEl.validity.valid)&&(t.characters=i)}),n.inputEl.setAttrs({required:!0,pattern:"[!-~]{1,}"}),n}).then(s=>{let i=()=>t.characters=y[o].characters;this.addResetButton(s,i)})}setForSearchTabCommand(e){let o=S.searchTab,t=this.plugin.settings[o];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async i=>{t.enableMultiWIndow=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show aliases").setDesc("When enabled, show file's aliases on list item.").addToggle(s=>s.setValue(t.showAliases).onChange(async i=>{t.showAliases=i,await this.plugin.saveData(this.plugin.settings),this.display()})),new c.Setting(e).setDisabled(!t.showAliases).setName("Include aliases in the search").setDesc('When enabled, include aliases in the search. This setting is valid when "Show aliases" is enabled.').addToggle(s=>s.setValue(t.includeAliases).onChange(async i=>{t.includeAliases=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show paths").setDesc("When enabled, show file's paths on list item.").addToggle(s=>s.setValue(t.showPaths).onChange(async i=>{t.showPaths=i,await this.plugin.saveData(this.plugin.settings),this.display()})),new c.Setting(e).setDisabled(!t.showPaths).setName("Include paths in the search").setDesc('When enabled, include paths in the search. This setting is valid when "Show paths" is enabled.').addToggle(s=>s.setValue(t.includePaths).onChange(async i=>{t.includePaths=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(s=>s.setValue(t.showLegends).onChange(async i=>{t.showLegends=i,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async i=>{t.focusColor=i,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let i=()=>t.focusColor=y[o].focusColor;this.addResetButton(s,i)})}isDuplicateChars(e){return e.some((o,t)=>e.slice(t+1).includes(o))}convertToKey(e,o){let t=Object.entries(o).find(([,s])=>s===e);return t?t[0]:""}convertToSettingValue(e,o,t){let s=Object.keys(t).find(i=>i===e);return s?o[s]:""}convertToDisplayText(e,o,t){return t[this.convertToKey(e,o)]}addResetButton(e,o,t=!0){e.addExtraButton(s=>s.setIcon("reset").setTooltip("Reset to default").onClick(async()=>{o(),await this.plugin.saveSettings(),this.updateStyleSheet(),t&&this.display()}))}};var E=require("obsidian"),X="ArrowUp",q="ArrowDown",Y="ArrowLeft",$="ArrowRight",le="Backspace",ce="Delete",he=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"\u2190 | \u2192",description:"Switch pages"},{keys:"Enter | Space",description:"Switch to focused tab"},{keys:"BS | Delete",description:"Close focused tab"},{keys:"",description:"Quickly switch tab"},{keys:"",description:"Quickly close tab",modifier:!0}],O=class extends E.Modal{constructor(e,o,t){super(e);this.leaves=[];this.chars=[];this.leafButtonMap=new Map;this.closeButtonMap=new Map;this.focusPosition=0;this.pagePosition=0;this.settings=o,this.leaves=t.map(s=>{var p,d;s.name=s.getDisplayText();let i=((d=(p=s.view)==null?void 0:p.metadataEditor)==null?void 0:d.properties)||[];s.aliases=i.filter(f=>f.key==="aliases").flatMap(f=>f.value).filter(f=>f!=null);let{file:n}=s.getViewState().state,r=(typeof n=="string"?n.split(s.getDisplayText())[0]||"/":"-").split("/").map(f=>f.length>20?`${f.slice(0,20)}...`:f);return s.path=r.length>3?`.../${r.at(-3)}/${r.at(-2)}/`:r.join("/"),s}),this.chars=[...this.modalSettings.characters]}get currentLeaves(){return this.leaves.slice(0+this.pagePosition*this.chars.length,this.chars.length+this.pagePosition*this.chars.length)}get modalSettings(){return this.settings.openTabSelector}onOpen(){this.modalEl.addClasses(["tab-selector-modal","ts-modal"]),this.generateHeader(this.contentEl),this.buttonsViewEl=this.contentEl.createDiv("ts-buttons-view"),this.generateContent(this.buttonsViewEl,this.currentLeaves),this.generateFooter(this.contentEl),this.eventListenerFunc=this.handlingKeyupEvent.bind(this),window.addEventListener("keyup",this.eventListenerFunc)}onClose(){window.removeEventListener("keyup",this.eventListenerFunc),this.contentEl.empty()}generateHeader(e){e.createDiv("ts-header",o=>{this.pageCounterEl=o.createSpan(""),this.updatePageCount(),o.createSpan("").setText("/"),o.createSpan("").setText(`${Math.ceil(this.leaves.length/this.chars.length)}`)})}generateContent(e,o){this.focusPosition=0,e.empty(),this.generateButtons(e,o),this.generateDummyButtons(e,o)}generateButtons(e,o){var t;o.forEach((s,i)=>{e.createDiv("ts-leaf-row",n=>{let l=n.createEl("button",{text:this.chars.at(i)});l.setAttr("tabIndex",-1),l.addClass("ts-shortcut-btn"),l.addEventListener("click",()=>this.clickLeafButton(s,l));let r=n.createEl("button");r.addClass("ts-leaf-name-btn"),r.addEventListener("click",()=>this.clickLeafButton(s,r));let p=r.createSpan("ts-leaf-name");if(p.setText(s.name||""),this.reflectOptions(s,n,r,p),this.leafButtonMap.set(s.id||"",r),this.modalSettings.enableClose){let d=n.createEl("button");(0,E.setIcon)(d,"x"),d.setAttr("tabIndex",-1),d.addClass("ts-close-btn"),d.addEventListener("click",()=>this.clickCloseLeafButton(s,n)),this.closeButtonMap.set(s.id||"",d),n.addClass("ts-leaf-row-deletable"),s.deleted&&n.addClass("deleted")}})}),this.leafButtonMap.get(((t=this.currentLeaves.at(0))==null?void 0:t.id)||"").focus(),this.updatePageCount()}generateDummyButtons(e,o){let t=this.leaves.length>this.chars.length?this.chars.length-o.length:0;for(let s=0;s<t;s++)e.createDiv("ts-leaf-row",i=>{let n=i.createEl("button");n.addClass("ts-leaf-name-btn"),n.setAttr("disabled",!0);let l=n.createSpan("ts-leaf-name");l.setText("-"),this.reflectOptions(null,i,n,l)})}reflectOptions(e,o,t,s){(this.modalSettings.showAliases&&!this.modalSettings.replaceToAliases||this.modalSettings.showPaths)&&o.addClass("ts-leaf-row-added-options"),e||o.addClass("ts-leaf-row-invisible"),this.modalSettings.showAliases&&(this.modalSettings.replaceToAliases?this.replaceLeafName((e==null?void 0:e.aliases)||[],t,s):this.addAliasesEl((e==null?void 0:e.aliases)||[],t)),this.modalSettings.showPaths&&this.addPathEl(e,t)}replaceLeafName(e,o,t){if(e.length){t.detach();let s=o.createDiv("ts-option-wrapper");(0,E.setIcon)(s,"corner-up-right"),s.createSpan("ts-leaf-alias").setText(e.join(" | "))}}addAliasesEl(e,o){let t=o.createDiv("ts-option-wrapper");(0,E.setIcon)(t,"corner-up-right"),t.createEl("small").setText(e.join(" | "))}addPathEl(e,o){let t=o.createDiv("ts-option-wrapper");(0,E.setIcon)(t,"folder-closed"),t.createEl("small").setText((e==null?void 0:e.path)||"")}generateFooter(e){e.createDiv("ts-footer",o=>{this.modalSettings.showPaginationButtons&&this.leaves.length>this.chars.length&&o.createDiv("ts-page-nav",t=>{let s=t.createEl("button",{text:"\u2190"});s.setAttr("tabIndex",-1),s.addClass("ts-nav-btn"),s.addEventListener("click",()=>this.keyupArrowKeys(Y));let i=t.createEl("button",{text:"\u2192"});i.setAttr("tabIndex",-1),i.addClass("ts-nav-btn"),i.addEventListener("click",()=>this.keyupArrowKeys($))}),this.modalSettings.showLegends&&he.forEach(t=>{t.modifier&&!this.modalSettings.enableClose||o.createDiv("ts-legends",s=>{let i=t.keys||(t.modifier?`Ctrl + ${this.chars.slice(0,2).join(" | ")} | ... | ${this.chars.slice(-2).join(" | ")}`:`${this.chars.slice(0,2).join(" | ")} | ... | ${this.chars.slice(-2).join(" | ")}`);s.createSpan("ts-keys").setText(i),s.createSpan("ts-description").setText(t.description)})})})}updatePageCount(){this.pageCounterEl.setText(`${this.pagePosition+1}`)}clickLeafButton(e,o){o.classList.contains("deleted")||(this.close(),this.app.workspace.setActiveLeaf(e,{focus:!0}))}clickCloseLeafButton(e,o){if(e.deleted)return;o.addClass("deleted"),e.deleted=!0,e.detach();let t=this.currentLeaves.findIndex(({id:s})=>s===e.id);this.focusPosition=t>=0?t:0,this.leafButtonMap.get((e==null?void 0:e.id)||"").focus()}handlingKeyupEvent(e){if(this.chars.includes(e.key)){this.keyupShortcutKeys(e.key,e.ctrlKey),e.preventDefault();return}if([le,ce].includes(e.key)){this.keyUpCloseKeys(),e.preventDefault();return}if([X,q,Y,$].includes(e.key)){this.keyupArrowKeys(e.key),e.preventDefault();return}}keyupShortcutKeys(e,o){var s,i;let t=this.chars.indexOf(e);o?this.keyUpCloseKeys(t):(i=this.leafButtonMap.get(((s=this.currentLeaves.at(t))==null?void 0:s.id)||""))==null||i.click()}keyUpCloseKeys(e){var t,s;if(e==null&&!this.leaves.some(i=>this.leafButtonMap.get(i.id||"")===document.activeElement))return;let o=e!=null?e:this.focusPosition;(s=this.closeButtonMap.get(((t=this.currentLeaves.at(o))==null?void 0:t.id)||""))==null||s.click()}keyupArrowKeys(e){var o,t;switch(e){case X:this.focusPosition===0?(this.leafButtonMap.get(((o=this.currentLeaves.at(-1))==null?void 0:o.id)||"").focus(),this.focusPosition=this.currentLeaves.length-1):(this.leafButtonMap.get(this.currentLeaves[this.focusPosition-1].id||"").focus(),this.focusPosition-=1);break;case q:this.focusPosition===this.currentLeaves.length-1?(this.leafButtonMap.get(((t=this.currentLeaves.at(0))==null?void 0:t.id)||"").focus(),this.focusPosition=0):(this.leafButtonMap.get(this.currentLeaves[this.focusPosition+1].id||"").focus(),this.focusPosition+=1);break;case Y:{let s=this.leaves.length/this.chars.length;if(Math.ceil(s)===1)break;this.pagePosition===0?this.pagePosition=this.leaves.length%this.chars.length===0?Math.floor(s)-1:Math.floor(s):this.pagePosition-=1,this.generateContent(this.buttonsViewEl,this.currentLeaves);break}case $:{let s=this.leaves.length/this.chars.length;if(Math.ceil(s)===1)break;let i=this.leaves.length%this.chars.length===0?s-1:Math.floor(s);this.pagePosition===i?this.pagePosition=0:this.pagePosition+=1,this.generateContent(this.buttonsViewEl,this.currentLeaves);break}default:break}}};var A=require("obsidian");var de=(h,a)=>h.activeTime==null||a.activeTime==null?0:h.activeTime>a.activeTime?-1:1,B=class extends A.Modal{constructor(e,o,t,s){super(e);this.leaves=[];this.leafButtonMap=new Map;this.closeButtonMap=new Map;this.focusPosition=0;this.isEnabled=!1;this.isPrevCommand=!0;this.eventListenerFunc={keydown:()=>{},keyup:()=>{}};this.settings=o;try{this.isEnabled=N(e,this.modalSettings)}catch(i){console.error(i)}this.isPrevCommand=s,this.leaves=t.map(i=>(i.name=i.getDisplayText(),i)).sort(de),this.eventListenerFunc.keydown=this.keydown.bind(this),window.addEventListener("keydown",this.eventListenerFunc.keydown),this.eventListenerFunc.keyup=this.keyup.bind(this),window.addEventListener("keyup",this.eventListenerFunc.keyup)}get modalSettings(){return this.settings.goToPreviousNextTab}onOpen(){if(!this.isEnabled){new A.Notice('"Tab Selector" plugin has incorrect settings. Please review the [For "Go to previous/next tab" command] settings.',0),this.close();return}this.modalEl.addClasses(["tab-history-modal","th-modal"]);let e=this.contentEl.createDiv("th-leaves");this.generateButtons(e,this.leaves),this.isPrevCommand?this.focusToPreviousTab():this.focusToNextTab()}onClose(){window.removeEventListener("keydown",this.eventListenerFunc.keydown),window.removeEventListener("keyup",this.eventListenerFunc.keyup),this.contentEl.empty()}generateButtons(e,o){o.forEach(t=>{e.createDiv("th-leaf-row",s=>{let i=s.createEl("button");i.addClass("th-leaf-name-btn"),i.addEventListener("mouseup",r=>(r.preventDefault(),this.switchToFocusedTab(t))),i.addEventListener("touchend",r=>(r.preventDefault(),this.switchToFocusedTab(t))),i.createSpan("th-leaf-name").setText(t.name||""),this.leafButtonMap.set(t.id||"",i);let l=i.createEl("button");(0,A.setIcon)(l,"x"),l.setAttr("tabIndex",-1),l.addClass("th-close-btn"),l.addEventListener("mouseup",r=>(r.stopPropagation(),this.clickCloseLeafButton(t,s))),l.addEventListener("touchend",r=>(r.stopPropagation(),this.clickCloseLeafButton(t,s))),this.closeButtonMap.set(t.id||"",l)})})}keydown(e){this.moveFocus(e)}keyup(e){if(e.key===this.modalSettings.mainModifierKey){let o=this.leaves[this.focusPosition];this.switchToFocusedTab(o)}}moveFocus(e){this.modalSettings.howToNextTab===v.useSubModifierKey&&e.key===this.modalSettings.actionKey&&(this.isHoldDownSubModifierKey(e,this.modalSettings.subModifierKey)?this.focusToNextTab():this.focusToPreviousTab()),this.modalSettings.howToNextTab===v.useReverseActionKey&&(e.key===this.modalSettings.reverseActionKey&&this.focusToNextTab(),e.key===this.modalSettings.actionKey&&this.focusToPreviousTab())}isHoldDownSubModifierKey(e,o){switch(o){case g.ctrl:return e.ctrlKey;case g.alt:return e.altKey;case g.meta:return e.metaKey;case g.shift:return e.shiftKey;default:return!1}}focusToNextTab(){var e;this.focusPosition===0?(this.leafButtonMap.get(((e=this.leaves.at(-1))==null?void 0:e.id)||"").focus(),this.focusPosition=this.leaves.length-1):(this.leafButtonMap.get(this.leaves[this.focusPosition-1].id||"").focus(),this.focusPosition-=1),this.addMarkOfFocus()}focusToPreviousTab(){var e;this.focusPosition===this.leaves.length-1?(this.leafButtonMap.get(((e=this.leaves.at(0))==null?void 0:e.id)||"").focus(),this.focusPosition=0):(this.leafButtonMap.get(this.leaves[this.focusPosition+1].id||"").focus(),this.focusPosition+=1),this.addMarkOfFocus()}addMarkOfFocus(){var o;this.leafButtonMap.forEach(t=>t.removeClass("is-focus")),this.leafButtonMap.get(((o=this.leaves[this.focusPosition])==null?void 0:o.id)||"").addClass("is-focus")}switchToFocusedTab(e){this.app.workspace.setActiveLeaf(e,{focus:!0}),this.close()}clickCloseLeafButton(e,o){let t=this.leaves.findIndex(({id:s})=>s===e.id);if(this.focusPosition=t<this.focusPosition?this.focusPosition-1:this.focusPosition,this.leafButtonMap.delete(e.id||""),this.leaves=this.leaves.filter(({id:s})=>s!==e.id),o.remove(),e.detach(),this.addMarkOfFocus(),!this.leaves.length){this.close();return}setTimeout(()=>{let s=this.leaves[this.focusPosition];this.leafButtonMap.get((s==null?void 0:s.id)||"").focus()},1)}};var Q=require("obsidian"),_=class extends Q.Modal{constructor(e,o,t){super(e);this.leaves=[];this.chars=[];this.tabHeaderContainers=[];this.windows=[];this.labelContainerMap=new Map;this.eventListenerFunc={keyup:()=>{},resize:()=>{},click:()=>{}};this.settings=o,this.chars=[...this.modalSettings.characters],this.leaves=t.map((s,i)=>(s.name=i<this.chars.length?this.chars[i]:"",s))}get modalSettings(){return this.settings.showTabShortcuts}onOpen(){this.modalEl.addClasses(["tab-shortcuts-modal","tsh-modal"]),this.eventListenerFunc.click=this.handlingClickEvent.bind(this),this.eventListenerFunc.keyup=this.handlingKeyupEvent.bind(this),this.eventListenerFunc.resize=this.handlingResizeEvent.bind(this),window.addEventListener("keyup",this.eventListenerFunc.keyup),window.addEventListener("resize",this.eventListenerFunc.resize),this.windows=this.generateWindows(this.leaves),this.showShortcutElements(this.windows),this.tabHeaderContainers.forEach(e=>e==null?void 0:e.addClass("tsh-header-container-inner"))}onClose(){this.windows.forEach(({window:e})=>e.removeEventListener("click",this.eventListenerFunc.click)),window.removeEventListener("keyup",this.eventListenerFunc.keyup),window.removeEventListener("resize",this.eventListenerFunc.resize),this.tabHeaderContainers.forEach(e=>e==null?void 0:e.removeClass("tsh-header-container-inner")),this.labelContainerMap.forEach(e=>e.remove()),this.contentEl.empty()}generateWindows(e){return e.reduce((o,t)=>{var i,n,l;let s=o.find(r=>{var p;return r.id===((p=t.parent)==null?void 0:p.id)||""});if(s)return s.leaves=[...s.leaves,t],o;{let r=(n=(i=t.containerEl)==null?void 0:i.ownerDocument.defaultView)!=null?n:window;return r.addEventListener("click",this.eventListenerFunc.click),[...o,{id:((l=t.parent)==null?void 0:l.id)||"",window:r,leaves:[t]}]}},[])}showShortcutElements(e){e.forEach(o=>{var n,l,r;let t=(r=(l=(n=o.leaves[0])==null?void 0:n.containerEl)==null?void 0:l.parentElement)==null?void 0:r.parentElement;this.tabHeaderContainers.push(t==null?void 0:t.querySelector(".workspace-tab-header-container-inner"));let s=t==null?void 0:t.querySelectorAll(".workspace-tab-header-container-inner .workspace-tab-header");if(!s)return;let i=createDiv("tab-shortcuts-container");o.window.document.body.append(i),this.labelContainerMap.set(o.id,i),o.leaves.forEach((p,d)=>{if(!this.chars.length)return;let f=s[d].getBoundingClientRect();createDiv("tsh-label",b=>{var T;b.setText(p.name||""),b.setCssProps({top:`${f.bottom}px`,left:`calc(${f.left}px + 0.5rem)`}),(T=this.labelContainerMap.get(o.id))==null||T.appendChild(b)})})})}handlingClickEvent(){this.close()}handlingKeyupEvent(e){if(this.chars.includes(e.key)){this.close();let o=this.leaves.find(t=>t.name===e.key);o&&this.app.workspace.setActiveLeaf(o,{focus:!0}),e.preventDefault();return}}handlingResizeEvent(){this.close()}};var C=require("obsidian"),ue=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"Enter",description:"Switch to focused tab"}],H=class extends C.FuzzySuggestModal{constructor(e,o,t){super(e);this.leaves=[];this.settings=o,this.leaves=t.map(s=>{var r,p;s.name=s.getDisplayText();let i=((p=(r=s.view)==null?void 0:r.metadataEditor)==null?void 0:p.properties)||[];s.aliases=i.filter(d=>d.key==="aliases").flatMap(d=>d.value).filter(d=>d!=null);let{file:n}=s.getViewState().state,l=typeof n=="string"?n.split(s.getDisplayText())[0]||"/":"-";return s.path=l,s}),this.setPlaceholder("Search tabs"),this.modalEl.addClasses(["tab-search-modal","tse-modal"]),this.modalSettings.showLegends&&this.generateFooter(this.modalEl)}get modalSettings(){return this.settings.searchTab}getItems(){return this.leaves}getItemText(e){return e.name||""}getSuggestions(e){return this.getItems().filter(o=>this.getReferenceStrings(o).some(t=>(0,C.prepareFuzzySearch)(e)(t))).map(o=>({item:o,match:{score:0,matches:[]}}))}onChooseItem(e){this.app.workspace.setActiveLeaf(e,{focus:!0})}renderSuggestion(e,o){return o.createDiv("tse-item-row",t=>{t.setText(e.item.name||"")}),this.modalSettings.showAliases&&o.createDiv("tse-item-row",t=>{var s;(0,C.setIcon)(t,"corner-up-right"),t.createEl("small").setText(((s=e.item.aliases)==null?void 0:s.join(" | "))||"")}),this.modalSettings.showPaths&&o.createDiv("tse-item-row",t=>{(0,C.setIcon)(t,"folder-closed"),t.createEl("small").setText(e.item.path||"")}),o}getReferenceStrings(e){var u;let o=e.name||"",{showAliases:t,includeAliases:s,showPaths:i,includePaths:n}=this.modalSettings,l=t&&s&&((u=e.aliases)==null?void 0:u.join(" "))||"",r=i&&n?e.path:"",p=`${o} ${l} ${r}`,d=`${o} ${r} ${l}`,f=`${l} ${o} ${r}`,b=`${l} ${r} ${o}`,T=`${r} ${o} ${l}`,m=`${r} ${l} ${o}`;return[p,d,f,b,T,m]}generateFooter(e){e.createDiv("tse-footer",o=>{ue.forEach(t=>{o.createDiv("tse-legends",s=>{s.createSpan("tse-keys").setText(t.keys),s.createSpan("tse-description").setText(t.description)})})})}};var F=class extends x.Plugin{async onload(){await this.loadSettings(),this.addRibbonIcon("file-check-2","Open tab selector",()=>this.openTabSelectorModal()),this.addCommand({id:"open-tab-selector",name:"Open tab selector",callback:()=>this.openTabSelectorModal()}),this.addCommand({id:"go-to-previous-tab",name:"Go to previous tab",callback:()=>this.openTabHistoryModal(!0)}),this.addCommand({id:"go-to-next-tab",name:"Go to next tab",callback:()=>this.openTabHistoryModal(!1)}),(x.Platform.isDesktop||x.Platform.isTablet)&&this.addCommand({id:"show-tab-shortcuts",name:"Show tab shortcuts",callback:()=>this.showTabShortcutsModal()}),this.addCommand({id:"search-tabs",name:"Search tabs",callback:()=>this.openTabSearchModal()}),this.settingTab=new W(this.app,this),this.addSettingTab(this.settingTab),this.settingTab.updateStyleSheet()}onunload(){this.settingTab.updateStyleSheet(!0)}async loadSettings(){this.settings=Object.assign({},y,await this.loadData()),this.migrateSettingValues()}async saveSettings(){await this.saveData(this.settings)}openTabSelectorModal(){let a=this.settings.openTabSelector.enableMultiWIndow,e=this.generateLeaves(a);new O(this.app,this.settings,e).open()}openTabHistoryModal(a){let e=this.settings.goToPreviousNextTab.enableMultiWIndow,o=this.generateLeaves(e);new B(this.app,this.settings,o,a).open()}showTabShortcutsModal(){let a=this.settings.showTabShortcuts.enableMultiWIndow,e=this.generateLeaves(a);new _(this.app,this.settings,e).open()}openTabSearchModal(){let a=this.settings.searchTab.enableMultiWIndow,e=this.generateLeaves(a);new H(this.app,this.settings,e).open()}generateLeaves(a){var t;let e=[];this.app.workspace.iterateRootLeaves(s=>{e.push((s==null?void 0:s.id)||"")});let o=[];if(x.Platform.isDesktop&&a)this.app.workspace.iterateAllLeaves(s=>{s.getRoot().containerEl.hasClass("mod-sidedock")||o.push(s)});else{let{id:s,type:i}=(t=this.app.workspace.getMostRecentLeaf())==null?void 0:t.getRoot();this.app.workspace.iterateAllLeaves(n=>{s===n.getRoot().id&&(n.id&&e.includes(n.id)||i==="floating")&&o.push(n)})}return o}async migrateSettingValues(){let a=this.settings;{let e=this.settings.openTabSelector;typeof a.showAliases=="boolean"&&(e.showAliases=a.showAliases,delete a.showAliases),typeof a.replaceToAliases=="boolean"&&(e.replaceToAliases=a.replaceToAliases,delete a.replaceToAliases),typeof a.showPaths=="boolean"&&(e.showPaths=a.showPaths,delete a.showPaths),typeof a.showPaginationButtons=="boolean"&&(e.showPaginationButtons=a.showPaginationButtons,delete a.showPaginationButtons),typeof a.showLegends=="boolean"&&(e.showLegends=a.showLegends,delete a.showLegends),typeof a.focusColor=="string"&&(e.focusColor=a.focusColor,delete a.focusColor),typeof a.characters=="string"&&(e.characters=a.characters,delete a.characters),typeof a.enableClose=="boolean"&&(e.enableClose=a.enableClose,delete a.enableClose)}{let e=this.settings.goToPreviousNextTab;typeof a.thFocusColor=="string"&&(e.focusColor=a.thFocusColor,delete a.thFocusColor),typeof a.mainModifierKey=="string"&&(e.mainModifierKey=a.mainModifierKey,delete a.mainModifierKey),typeof a.subModifierKey=="string"&&(e.subModifierKey=a.subModifierKey,delete a.subModifierKey),typeof a.actionKey=="string"&&(e.actionKey=a.actionKey,delete a.actionKey),typeof a.howToNextTab=="string"&&(e.howToNextTab=a.howToNextTab,delete a.howToNextTab),typeof a.reverseActionKey=="string"&&(e.reverseActionKey=a.reverseActionKey,delete a.reverseActionKey)}{let e=this.settings.showTabShortcuts;typeof a.tshCharacters=="string"&&(e.characters=a.tshCharacters,delete a.tshCharacters)}typeof a.backActionKey=="string"&&delete a.backActionKey,typeof a.howToPreviousTab=="string"&&delete a.howToPreviousTab,typeof a.showPaginationButton=="boolean"&&delete a.showPaginationButton,typeof a.showLegend=="boolean"&&delete a.showLegend,await this.saveSettings()}};

/* nosourcemap */