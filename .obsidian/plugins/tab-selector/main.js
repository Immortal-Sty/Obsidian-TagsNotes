/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var R=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.prototype.hasOwnProperty;var se=(h,a)=>{for(var e in a)R(h,e,{get:a[e],enumerable:!0})},ie=(h,a,e,i)=>{if(a&&typeof a=="object"||typeof a=="function")for(let t of ee(a))!te.call(h,t)&&t!==e&&R(h,t,{get:()=>a[t],enumerable:!(i=Z(a,t))||i.enumerable});return h};var oe=h=>ie(R({},"__esModule",{value:!0}),h);var pe={};se(pe,{default:()=>F});module.exports=oe(pe);var A=require("obsidian");var c=require("obsidian");var V=require("obsidian");var K=class h extends Error{constructor(a,e){super(a),Error.captureStackTrace&&Error.captureStackTrace(this,h),this.name="KeySettingsError",console.warn(e)}};var z="tab-selector-styles",C={notOnlyOneHotkey:"Not only one hotkey.",mismatchMainModifierKey:"Mismatch main modifier key.",mismatchActionKey:"Mismatch action key.",mismatchSubModifierKey:"Mismatch sub modifier key.",useDuplicateModifierKey:"Use duplicate modifier key.",useDuplicateActionKey:"Use duplicate action key."},I=(h,a,e=!0)=>{var u;let i=(u=h.hotkeyManager)==null?void 0:u.customKeys,t=i&&i["tab-selector:go-to-previous-tab"]||[],s=i&&i["tab-selector:go-to-next-tab"]||[],o={settings:a,toPrevHotkeys:t,toNextHotkeys:s};if(!t[0]||!s[0]||t.length>1||s.length>1){if(e)throw new K(`Invalid settings: ${C.notOnlyOneHotkey}`,o);return!1}let n=t[0],l=s[0],{mainModifierKey:r,subModifierKey:p,actionKey:d,reverseActionKey:f,howToNextTab:b}=a,T=b===v.useSubModifierKey,m="";if(G(n.modifiers[0])!==r&&(m=m||C.mismatchMainModifierKey),T?((n.key!==d||l.key!==d)&&(m=m||C.mismatchActionKey),l.modifiers.filter(x=>G(x)===p).length!==1&&(m=m||C.mismatchSubModifierKey),r===p&&(m=m||C.useDuplicateModifierKey)):(n.key!==d||l.key!==f)&&(m=m||C.useDuplicateActionKey),m&&e)throw new K(`Invalid settings: ${m}`,o);return!m},G=h=>{switch(h){case"Mod":return V.Platform.isMacOS||V.Platform.isIosApp?g.meta:g.ctrl;case"Ctrl":return g.ctrl;case"Meta":case"Shift":case"Alt":default:return h}},j=()=>{let h=document.getElementById(z);h&&document.getElementsByTagName("HEAD")[0].removeChild(h)},U=h=>{let a=document.createElement("style");ae(a,{type:"text/css",id:z}),document.getElementsByTagName("HEAD")[0].appendChild(a),h.forEach(({selector:i,property:t,value:s})=>{ne(i,`${t}: ${s}`,a)})},ae=(h,a)=>{for(let e in a)h.setAttribute(e,a[e])},ne=(h,a,e)=>{e.textContent+=h+`{${a}}`};var g={ctrl:"Control",alt:"Alt",meta:"Meta",shift:"Shift"},k=c.Platform.isMacOS||c.Platform.isIosApp,M={ctrl:k?"^":"Ctrl",alt:k?"\u2325":"Alt",meta:k?"\u2318":"Win",shift:k?"\u21E7":"Shift"},w={tab:"Tab",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"},L={tab:"Tab",arrowUp:"\u2191",arrowDown:"\u2193",arrowLeft:"\u2190",arrowRight:"\u2192"},v={useSubModifierKey:"useSubModifierKey",useReverseActionKey:"useReverseActionKey"},re={useSubModifierKey:"Sub modifier key",useReverseActionKey:"Reverse action key"},S={goToPreviousNextTab:"goToPreviousNextTab",openTabSelector:"openTabSelector",showTabShortcuts:"showTabShortcuts",searchTab:"searchTab"},y={[S.goToPreviousNextTab]:{enableMultiWIndow:!1,focusColor:"#00b4e0",mainModifierKey:g.ctrl,subModifierKey:g.shift,actionKey:w.tab,reverseActionKey:w.arrowLeft,howToNextTab:v.useSubModifierKey},[S.openTabSelector]:{enableMultiWIndow:!1,showAliases:!1,replaceToAliases:!1,showPaths:!1,showPaginationButtons:!0,showLegends:!0,focusColor:"#00b4e0",characters:"asdfghjkl;",enableClose:!0},[S.showTabShortcuts]:{enableMultiWIndow:!1,characters:"asdfghjkl;qwertyuiopzxcvbnm,./"},[S.searchTab]:{enableMultiWIndow:!1,showAliases:!1,includeAliases:!1,showPaths:!1,includePaths:!1,showLegends:!0,focusColor:"#00b4e0"}},P={min:4,max:10},N=class extends c.PluginSettingTab{constructor(e,i){super(e,i);this.isOpen={firstDetails:!1,secondDetails:!1,thirdDetails:!1,fourthDetails:!1};this.plugin=i}display(){let{containerEl:e}=this;e.empty(),e.addClass("ts-settings");{let i=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Go to previous/next tab" command')})});this.isOpen.firstDetails&&i.setAttr("open",!0),i.addEventListener("toggle",()=>this.isOpen.firstDetails=i.open),this.setForGoToPrevNextTabCommands(i)}{let i=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Open tab selector" command')})});this.isOpen.secondDetails&&i.setAttr("open",!0),i.addEventListener("toggle",()=>this.isOpen.secondDetails=i.open),this.setForOpenTabSelectorCommand(i)}if(c.Platform.isDesktop||c.Platform.isTablet){let i=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Show tab shortcuts" command')})});this.isOpen.thirdDetails&&i.setAttr("open",!0),i.addEventListener("toggle",()=>this.isOpen.thirdDetails=i.open),this.setForShowTabShortcutCommand(i)}{let i=e.createEl("details","",t=>{t.createEl("summary","",s=>{s.setText('For "Search tabs" command')})});this.isOpen.fourthDetails&&i.setAttr("open",!0),i.addEventListener("toggle",()=>this.isOpen.fourthDetails=i.open),this.setForSearchTabCommand(i)}}updateStyleSheet(e=!1){if(j(),e)return;let{goToPreviousNextTab:i,openTabSelector:t,searchTab:s}=this.plugin.settings,{focusColor:o}=t,{focusColor:n}=i,{focusColor:l}=s;U([{selector:".ts-leaf-name-btn:focus",property:"outline",value:`2px solid ${o}`},{selector:".th-leaf-name-btn.is-focus",property:"outline",value:`2px solid ${n}`},{selector:".tab-search-modal .suggestion-item.is-selected",property:"outline",value:`2px solid ${l}`}])}setForGoToPrevNextTabCommands(e){let i=S.goToPreviousNextTab,t=this.plugin.settings[i];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async o=>{t.enableMultiWIndow=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choose your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async o=>{t.focusColor=o,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let o=()=>t.focusColor=y[i].focusColor;this.addResetButton(s,o)}),new c.Setting(e).setName("Main modifier key").setDesc("Holding this key down keeps the modal open. When this key is released, it switches to the focused tab.").addDropdown(s=>s.addOptions(Object.keys(g).reduce((o,n)=>(o[n]=M[n],o),{})).setValue(this.convertToKey(t.mainModifierKey,g)).onChange(async o=>{t.mainModifierKey=this.convertToSettingValue(o,g,M),await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let o=()=>t.mainModifierKey=y[i].mainModifierKey;this.addResetButton(s,o)}),new c.Setting(e).setName("Action key").setDesc("Press this key while holding down the Main modifier key moves to the previous tab.").addDropdown(s=>s.addOptions(Object.keys(w).reduce((o,n)=>(o[n]=L[n],o),{})).setValue(this.convertToKey(t.actionKey,w)).onChange(async o=>{t.actionKey=this.convertToSettingValue(o,w,L),await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let o=()=>t.actionKey=y[i].actionKey;this.addResetButton(s,o)}),new c.Setting(e).setName("Choose how to go to the next tab").setDesc(`
				When go to the next tab, if you want to use the same key as the Action key, choose \u201CSub modifier key\u201D.
				If you want to use a different key from the Action key, choose \u201CReverse action key".
			`).addDropdown(s=>s.addOptions(Object.keys(v).reduce((o,n)=>(o[n]=re[n],o),{})).setValue(this.convertToKey(t.howToNextTab,v)).onChange(async o=>{t.howToNextTab=o,await this.plugin.saveData(this.plugin.settings),this.display()})).then(s=>{let o=()=>t.howToNextTab=y[i].howToNextTab;this.addResetButton(s,o)}),new c.Setting(e).setName("Sub modifier key").setDesc("Pressing the Action key while holding this key down moves to the next tab.").addDropdown(s=>s.addOptions(Object.keys(g).reduce((o,n)=>(o[n]=M[n],o),{})).setValue(this.convertToKey(t.subModifierKey,g)).onChange(async o=>{t.subModifierKey=this.convertToSettingValue(o,g,M),await this.plugin.saveData(this.plugin.settings),this.display()})).setDisabled(t.howToNextTab!==v.useSubModifierKey).then(s=>{if(t.howToNextTab===v.useSubModifierKey){let o=()=>t.subModifierKey=y[i].subModifierKey;this.addResetButton(s,o)}}),new c.Setting(e).setName("Reverse action key").setDesc("Press this key while holding down the Main modifier key moves to the next tab.").addDropdown(s=>s.addOptions(Object.keys(w).reduce((o,n)=>(o[n]=L[n],o),{})).setValue(this.convertToKey(t.reverseActionKey,w)).onChange(async o=>{t.reverseActionKey=this.convertToSettingValue(o,w,L),await this.plugin.saveData(this.plugin.settings),this.display()})).setDisabled(t.howToNextTab!==v.useReverseActionKey).then(s=>{if(t.howToNextTab===v.useSubModifierKey){let o=()=>t.reverseActionKey=y[i].reverseActionKey;this.addResetButton(s,o)}}),e.createDiv("th-how-to-use",s=>{s.createDiv("th-settings-description",u=>{u.createSpan("th-description-title").setText("How to use"),u.createSpan("").setText("1. Configure the above settings."),u.createSpan("").setText("2. Set the hotkeys to match for the following commands.")});let{mainModifierKey:o,subModifierKey:n,actionKey:l,reverseActionKey:r,howToNextTab:p}=t,d=this.convertToDisplayText(o,g,M),f=this.convertToDisplayText(n,g,M),b=this.convertToDisplayText(l,w,L),T=this.convertToDisplayText(r,w,L),m=p===v.useSubModifierKey;s.createDiv("th-hotkey-preview",u=>{u.createSpan("th-hotkey-preview-label").setText('"Tab Selector: Go to next tab": '),u.createSpan("th-hotkey-preview-value").setText((m?[d,f,b]:[d,T]).join(k?"":" + "))}),s.createDiv("th-hotkey-preview",u=>{u.createSpan("th-hotkey-preview-label").setText('"Tab Selector: Go to previous tab": '),u.createSpan("th-hotkey-preview-value").setText([d,b].join(k?"":" + "))}),s.createDiv("th-match-state",u=>{let x=I(this.app,t,!1);u.addClass(x?"is-match":"is-mismatch"),u.createSpan("th-match-icon",J=>(0,c.setIcon)(J,x?"check":"x")),u.createSpan("").setText(`Currently hotkeys ${x?"match":"mismatch"} the above commands.`)}),s.createDiv("th-settings-caution",u=>{u.createSpan("th-settings-caution-title").setText("Caution"),u.createSpan("").setText(`
					Don't use shortcut keys reserved by the OS.
					OS shortcut keys take precedence and don't work properly.
				`)})})}setForOpenTabSelectorCommand(e){let i=S.openTabSelector,t=this.plugin.settings[i];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async o=>{t.enableMultiWIndow=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show aliases").setDesc("When enabled, show file's aliases on button.").addToggle(s=>s.setValue(t.showAliases).onChange(async o=>{t.showAliases=o,t.replaceToAliases=!1,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet(),this.display()})),new c.Setting(e).setName("Replace the filename to aliases").setDesc("When enabled, if aliases is set the file, replace the filename to aliases.").addToggle(s=>s.setValue(t.replaceToAliases).onChange(async o=>{t.replaceToAliases=o,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).setDisabled(!t.showAliases),new c.Setting(e).setName("Show paths").setDesc("When enabled, show file's paths on button.").addToggle(s=>s.setValue(t.showPaths).onChange(async o=>{t.showPaths=o,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})),new c.Setting(e).setName("Show pagination buttons").setDesc("When enabled, show pagination buttons on modal.").addToggle(s=>s.setValue(t.showPaginationButtons).onChange(async o=>{t.showPaginationButtons=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(s=>s.setValue(t.showLegends).onChange(async o=>{t.showLegends=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async o=>{t.focusColor=o,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let o=()=>t.focusColor=y[i].focusColor;this.addResetButton(s,o)}),new c.Setting(e).setName("Characters used for button hints").setDesc(`Enter ${P.min}~${P.max} non-duplicate alphanumeric characters or symbols.`).addText(s=>{let o=t.characters,n=s.setPlaceholder("Enter characters").setValue(t.characters).onChange(async l=>{let{inputEl:r}=n;!this.isDuplicateChars([...l])&&r.validity.valid?(r.removeClass("ts-setting-is-invalid"),t.characters=l,o=l,await this.plugin.saveSettings()):r.addClass("ts-setting-is-invalid"),this.updateStyleSheet()});return n.inputEl.addEventListener("blur",()=>{(this.isDuplicateChars([...n.inputEl.value])||!n.inputEl.validity.valid)&&(t.characters=o)}),n.inputEl.setAttrs({maxLength:P.max,required:!0,pattern:`[!-~]{${P.min},${P.max}}`}),n}).then(s=>{let o=()=>t.characters=y[i].characters;this.addResetButton(s,o)}),new c.Setting(e).setName("Enable tabs close").setDesc("When enabled, the operation of closing tabs is enabled.").addToggle(s=>s.setValue(t.enableClose).onChange(async o=>{t.enableClose=o,await this.plugin.saveData(this.plugin.settings)}))}setForShowTabShortcutCommand(e){let i=S.showTabShortcuts,t=this.plugin.settings[i];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async o=>{t.enableMultiWIndow=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Characters used for shortcut hints").setDesc("Enter non-duplicate alphanumeric characters or symbols.").addText(s=>{let o=t.characters,n=s.setPlaceholder("Enter characters").setValue(t.characters).onChange(async l=>{let{inputEl:r}=n;!this.isDuplicateChars([...l])&&r.validity.valid?(r.removeClass("ts-setting-is-invalid"),t.characters=l,o=l,await this.plugin.saveSettings()):r.addClass("ts-setting-is-invalid"),this.updateStyleSheet()});return n.inputEl.addEventListener("blur",()=>{(this.isDuplicateChars([...n.inputEl.value])||!n.inputEl.validity.valid)&&(t.characters=o)}),n.inputEl.setAttrs({required:!0,pattern:"[!-~]{1,}"}),n}).then(s=>{let o=()=>t.characters=y[i].characters;this.addResetButton(s,o)})}setForSearchTabCommand(e){let i=S.searchTab,t=this.plugin.settings[i];c.Platform.isDesktop&&new c.Setting(e).setName("Enable multiple window").setDesc("When enabled, all window's tabs is selectable. When disabled, only active window's tabs is selectable.").addToggle(s=>s.setValue(t.enableMultiWIndow).onChange(async o=>{t.enableMultiWIndow=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show aliases").setDesc("When enabled, show file's aliases on list item.").addToggle(s=>s.setValue(t.showAliases).onChange(async o=>{t.showAliases=o,await this.plugin.saveData(this.plugin.settings),this.display()})),new c.Setting(e).setDisabled(!t.showAliases).setName("Include aliases in the search").setDesc('When enabled, include aliases in the search. This setting is valid when "Show aliases" is enabled.').addToggle(s=>s.setValue(t.includeAliases).onChange(async o=>{t.includeAliases=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show paths").setDesc("When enabled, show file's paths on list item.").addToggle(s=>s.setValue(t.showPaths).onChange(async o=>{t.showPaths=o,await this.plugin.saveData(this.plugin.settings),this.display()})),new c.Setting(e).setDisabled(!t.showPaths).setName("Include paths in the search").setDesc('When enabled, include paths in the search. This setting is valid when "Show paths" is enabled.').addToggle(s=>s.setValue(t.includePaths).onChange(async o=>{t.includePaths=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Show legends").setDesc("When enabled, show legends on modal.").addToggle(s=>s.setValue(t.showLegends).onChange(async o=>{t.showLegends=o,await this.plugin.saveData(this.plugin.settings)})),new c.Setting(e).setName("Color of button frame on focus").setDesc("Choice your favorite color.").addColorPicker(s=>s.setValue(t.focusColor).onChange(async o=>{t.focusColor=o,await this.plugin.saveData(this.plugin.settings),this.updateStyleSheet()})).then(s=>{let o=()=>t.focusColor=y[i].focusColor;this.addResetButton(s,o)})}isDuplicateChars(e){return e.some((i,t)=>e.slice(t+1).includes(i))}convertToKey(e,i){let t=Object.entries(i).find(([,s])=>s===e);return t?t[0]:""}convertToSettingValue(e,i,t){let s=Object.keys(t).find(o=>o===e);return s?i[s]:""}convertToDisplayText(e,i,t){return t[this.convertToKey(e,i)]}addResetButton(e,i,t=!0){e.addExtraButton(s=>s.setIcon("reset").setTooltip("Reset to default").onClick(async()=>{i(),await this.plugin.saveSettings(),this.updateStyleSheet(),t&&this.display()}))}};var _=require("obsidian"),X="ArrowUp",q="ArrowDown",Y="ArrowLeft",$="ArrowRight",le="Backspace",ce="Delete",he=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"\u2190 | \u2192",description:"Switch pages"},{keys:"Enter | Space",description:"Switch to focused tab"},{keys:"BS | Delete",description:"Close focused tab"},{keys:"",description:"Quickly switch tab"},{keys:"",description:"Quickly close tab",modifier:!0}],W=class extends _.Modal{constructor(e,i,t){super(e);this._settings=i;this._leaves=t;this._chars=[];this._leafButtonMap=new Map;this._closeButtonMap=new Map;this._focusPosition=0;this._pagePosition=0;this._leaves=this._leaves.map(s=>{var p,d;s.name=s.getDisplayText();let o=((d=(p=s.view)==null?void 0:p.metadataEditor)==null?void 0:d.properties)||[];s.aliases=o.filter(f=>f.key==="aliases").flatMap(f=>f.value).filter(f=>f!=null);let{file:n}=s.getViewState().state,r=(typeof n=="string"?n.split(s.getDisplayText())[0]||"/":"-").split("/").map(f=>f.length>20?`${f.slice(0,20)}...`:f);return s.path=r.length>3?`.../${r.at(-3)}/${r.at(-2)}/`:r.join("/"),s}),this._chars=[...this.modalSettings.characters]}get currentLeaves(){return this._leaves.slice(0+this._pagePosition*this._chars.length,this._chars.length+this._pagePosition*this._chars.length)}get modalSettings(){return this._settings.openTabSelector}onOpen(){this.modalEl.addClasses(["tab-selector-modal","ts-modal"]),this.generateHeader(this.contentEl),this._buttonsViewEl=this.contentEl.createDiv("ts-buttons-view"),this.generateContent(this._buttonsViewEl,this.currentLeaves),this.generateFooter(this.contentEl),this._eventListenerFunc=this.handlingKeyupEvent.bind(this),window.addEventListener("keyup",this._eventListenerFunc)}onClose(){window.removeEventListener("keyup",this._eventListenerFunc),this.contentEl.empty()}generateHeader(e){e.createDiv("ts-header",i=>{this._pageCounterEl=i.createSpan(""),this.updatePageCount(),i.createSpan("").setText("/"),i.createSpan("").setText(`${Math.ceil(this._leaves.length/this._chars.length)}`)})}generateContent(e,i){this._focusPosition=0,e.empty(),this.generateButtons(e,i),this.generateDummyButtons(e,i)}generateButtons(e,i){var t;i.forEach((s,o)=>{e.createDiv("ts-leaf-row",n=>{let l=n.createEl("button",{text:this._chars.at(o)});l.setAttr("tabIndex",-1),l.addClass("ts-shortcut-btn"),l.addEventListener("click",()=>this.clickLeafButton(s,l));let r=n.createEl("button");r.addClass("ts-leaf-name-btn"),r.addEventListener("click",()=>this.clickLeafButton(s,r));let p=r.createSpan("ts-leaf-name");if(p.setText(s.name||""),this.reflectOptions(s,n,r,p),this._leafButtonMap.set(s.id||"",r),this.modalSettings.enableClose){let d=n.createEl("button");(0,_.setIcon)(d,"x"),d.setAttr("tabIndex",-1),d.addClass("ts-close-btn"),d.addEventListener("click",()=>this.clickCloseLeafButton(s,n)),this._closeButtonMap.set(s.id||"",d),n.addClass("ts-leaf-row-deletable"),s.deleted&&n.addClass("deleted")}})}),this._leafButtonMap.get(((t=this.currentLeaves.at(0))==null?void 0:t.id)||"").focus(),this.updatePageCount()}generateDummyButtons(e,i){let t=this._leaves.length>this._chars.length?this._chars.length-i.length:0;for(let s=0;s<t;s++)e.createDiv("ts-leaf-row",o=>{let n=o.createEl("button");n.addClass("ts-leaf-name-btn"),n.setAttr("disabled",!0);let l=n.createSpan("ts-leaf-name");l.setText("-"),this.reflectOptions(null,o,n,l)})}reflectOptions(e,i,t,s){(this.modalSettings.showAliases&&!this.modalSettings.replaceToAliases||this.modalSettings.showPaths)&&i.addClass("ts-leaf-row-added-options"),e||i.addClass("ts-leaf-row-invisible"),this.modalSettings.showAliases&&(this.modalSettings.replaceToAliases?this.replaceLeafName((e==null?void 0:e.aliases)||[],t,s):this.addAliasesEl((e==null?void 0:e.aliases)||[],t)),this.modalSettings.showPaths&&this.addPathEl(e,t)}replaceLeafName(e,i,t){if(e.length){t.detach();let s=i.createDiv("ts-option-wrapper");(0,_.setIcon)(s,"corner-up-right"),s.createSpan("ts-leaf-alias").setText(e.join(" | "))}}addAliasesEl(e,i){let t=i.createDiv("ts-option-wrapper");(0,_.setIcon)(t,"corner-up-right"),t.createEl("small").setText(e.join(" | "))}addPathEl(e,i){let t=i.createDiv("ts-option-wrapper");(0,_.setIcon)(t,"folder-closed"),t.createEl("small").setText((e==null?void 0:e.path)||"")}generateFooter(e){e.createDiv("ts-footer",i=>{this.modalSettings.showPaginationButtons&&this._leaves.length>this._chars.length&&i.createDiv("ts-page-nav",t=>{let s=t.createEl("button",{text:"\u2190"});s.setAttr("tabIndex",-1),s.addClass("ts-nav-btn"),s.addEventListener("click",()=>this.keyupArrowKeys(Y));let o=t.createEl("button",{text:"\u2192"});o.setAttr("tabIndex",-1),o.addClass("ts-nav-btn"),o.addEventListener("click",()=>this.keyupArrowKeys($))}),this.modalSettings.showLegends&&he.forEach(t=>{t.modifier&&!this.modalSettings.enableClose||i.createDiv("ts-legends",s=>{let o=t.keys||(t.modifier?`Ctrl + ${this._chars.slice(0,2).join(" | ")} | ... | ${this._chars.slice(-2).join(" | ")}`:`${this._chars.slice(0,2).join(" | ")} | ... | ${this._chars.slice(-2).join(" | ")}`);s.createSpan("ts-keys").setText(o),s.createSpan("ts-description").setText(t.description)})})})}updatePageCount(){this._pageCounterEl.setText(`${this._pagePosition+1}`)}clickLeafButton(e,i){i.classList.contains("deleted")||(this.close(),this.app.workspace.setActiveLeaf(e,{focus:!0}))}clickCloseLeafButton(e,i){if(e.deleted)return;i.addClass("deleted"),e.deleted=!0,e.detach();let t=this.currentLeaves.findIndex(({id:s})=>s===e.id);this._focusPosition=t>=0?t:0,this._leafButtonMap.get((e==null?void 0:e.id)||"").focus()}handlingKeyupEvent(e){if(this._chars.includes(e.key)){this.keyupShortcutKeys(e.key,e.ctrlKey),e.preventDefault();return}if([le,ce].includes(e.key)){this.keyUpCloseKeys(),e.preventDefault();return}if([X,q,Y,$].includes(e.key)){this.keyupArrowKeys(e.key),e.preventDefault();return}}keyupShortcutKeys(e,i){var s,o;let t=this._chars.indexOf(e);i?this.keyUpCloseKeys(t):(o=this._leafButtonMap.get(((s=this.currentLeaves.at(t))==null?void 0:s.id)||""))==null||o.click()}keyUpCloseKeys(e){var t,s;if(e==null&&!this._leaves.some(o=>this._leafButtonMap.get(o.id||"")===document.activeElement))return;let i=e!=null?e:this._focusPosition;(s=this._closeButtonMap.get(((t=this.currentLeaves.at(i))==null?void 0:t.id)||""))==null||s.click()}keyupArrowKeys(e){var i,t;switch(e){case X:this._focusPosition===0?(this._leafButtonMap.get(((i=this.currentLeaves.at(-1))==null?void 0:i.id)||"").focus(),this._focusPosition=this.currentLeaves.length-1):(this._leafButtonMap.get(this.currentLeaves[this._focusPosition-1].id||"").focus(),this._focusPosition-=1);break;case q:this._focusPosition===this.currentLeaves.length-1?(this._leafButtonMap.get(((t=this.currentLeaves.at(0))==null?void 0:t.id)||"").focus(),this._focusPosition=0):(this._leafButtonMap.get(this.currentLeaves[this._focusPosition+1].id||"").focus(),this._focusPosition+=1);break;case Y:{let s=this._leaves.length/this._chars.length;if(Math.ceil(s)===1)break;this._pagePosition===0?this._pagePosition=this._leaves.length%this._chars.length===0?Math.floor(s)-1:Math.floor(s):this._pagePosition-=1,this.generateContent(this._buttonsViewEl,this.currentLeaves);break}case $:{let s=this._leaves.length/this._chars.length;if(Math.ceil(s)===1)break;let o=this._leaves.length%this._chars.length===0?s-1:Math.floor(s);this._pagePosition===o?this._pagePosition=0:this._pagePosition+=1,this.generateContent(this._buttonsViewEl,this.currentLeaves);break}default:break}}};var D=require("obsidian");var de=(h,a)=>h.activeTime==null||a.activeTime==null?0:h.activeTime>a.activeTime?-1:1,O=class extends D.Modal{constructor(e,i,t,s){super(e);this._settings=i;this._leaves=t;this._isPrevCommand=s;this._leafButtonMap=new Map;this._closeButtonMap=new Map;this._focusPosition=0;this._isEnabled=!1;this._eventListenerFunc={keydown:()=>{},keyup:()=>{}};try{this._isEnabled=I(e,this.modalSettings)}catch(o){console.error(o)}this._leaves=this._leaves.map(o=>(o.name=o.getDisplayText(),o)).sort(de),this._eventListenerFunc.keydown=this.keydown.bind(this),window.addEventListener("keydown",this._eventListenerFunc.keydown),this._eventListenerFunc.keyup=this.keyup.bind(this),window.addEventListener("keyup",this._eventListenerFunc.keyup)}get modalSettings(){return this._settings.goToPreviousNextTab}onOpen(){if(!this._isEnabled){new D.Notice('"Tab Selector" plugin has incorrect settings. Please review the [For "Go to previous/next tab" command] settings.',0),this.close();return}this.modalEl.addClasses(["tab-history-modal","th-modal"]);let e=this.contentEl.createDiv("th-leaves");this.generateButtons(e,this._leaves),this._isPrevCommand?this.focusToPreviousTab():this.focusToNextTab()}onClose(){window.removeEventListener("keydown",this._eventListenerFunc.keydown),window.removeEventListener("keyup",this._eventListenerFunc.keyup),this.contentEl.empty()}generateButtons(e,i){i.forEach(t=>{e.createDiv("th-leaf-row",s=>{let o=s.createEl("button");o.addClass("th-leaf-name-btn"),o.addEventListener("mouseup",r=>(r.preventDefault(),this.switchToFocusedTab(t))),o.addEventListener("touchend",r=>(r.preventDefault(),this.switchToFocusedTab(t))),o.createSpan("th-leaf-name").setText(t.name||""),this._leafButtonMap.set(t.id||"",o);let l=o.createEl("button");(0,D.setIcon)(l,"x"),l.setAttr("tabIndex",-1),l.addClass("th-close-btn"),l.addEventListener("mouseup",r=>(r.stopPropagation(),this.clickCloseLeafButton(t,s))),l.addEventListener("touchend",r=>(r.stopPropagation(),this.clickCloseLeafButton(t,s))),this._closeButtonMap.set(t.id||"",l)})})}keydown(e){this.moveFocus(e)}keyup(e){if(e.key===this.modalSettings.mainModifierKey){let i=this._leaves[this._focusPosition];this.switchToFocusedTab(i)}}moveFocus(e){this.modalSettings.howToNextTab===v.useSubModifierKey&&e.key===this.modalSettings.actionKey&&(this.isHoldDownSubModifierKey(e,this.modalSettings.subModifierKey)?this.focusToNextTab():this.focusToPreviousTab()),this.modalSettings.howToNextTab===v.useReverseActionKey&&(e.key===this.modalSettings.reverseActionKey&&this.focusToNextTab(),e.key===this.modalSettings.actionKey&&this.focusToPreviousTab())}isHoldDownSubModifierKey(e,i){switch(i){case g.ctrl:return e.ctrlKey;case g.alt:return e.altKey;case g.meta:return e.metaKey;case g.shift:return e.shiftKey;default:return!1}}focusToNextTab(){var e;this._focusPosition===0?(this._leafButtonMap.get(((e=this._leaves.at(-1))==null?void 0:e.id)||"").focus(),this._focusPosition=this._leaves.length-1):(this._leafButtonMap.get(this._leaves[this._focusPosition-1].id||"").focus(),this._focusPosition-=1),this.addMarkOfFocus()}focusToPreviousTab(){var e;this._focusPosition===this._leaves.length-1?(this._leafButtonMap.get(((e=this._leaves.at(0))==null?void 0:e.id)||"").focus(),this._focusPosition=0):(this._leafButtonMap.get(this._leaves[this._focusPosition+1].id||"").focus(),this._focusPosition+=1),this.addMarkOfFocus()}addMarkOfFocus(){var i;this._leafButtonMap.forEach(t=>t.removeClass("is-focus")),this._leafButtonMap.get(((i=this._leaves[this._focusPosition])==null?void 0:i.id)||"").addClass("is-focus")}switchToFocusedTab(e){this.app.workspace.setActiveLeaf(e,{focus:!0}),this.close()}clickCloseLeafButton(e,i){let t=this._leaves.findIndex(({id:s})=>s===e.id);if(this._focusPosition=t<this._focusPosition?this._focusPosition-1:this._focusPosition,this._leafButtonMap.delete(e.id||""),this._leaves=this._leaves.filter(({id:s})=>s!==e.id),i.remove(),e.detach(),this.addMarkOfFocus(),!this._leaves.length){this.close();return}setTimeout(()=>{let s=this._leaves[this._focusPosition];this._leafButtonMap.get((s==null?void 0:s.id)||"").focus()},1)}};var Q=require("obsidian"),B=class extends Q.Modal{constructor(e,i,t){super(e);this._settings=i;this._leaves=t;this._chars=[];this._tabHeaderContainers=[];this._windows=[];this._labelContainerMap=new Map;this._eventListenerFunc={keyup:()=>{},resize:()=>{},click:()=>{}};this._chars=[...this.modalSettings.characters],this._leaves=this._leaves.map((s,o)=>(s.name=o<this._chars.length?this._chars[o]:"",s))}get modalSettings(){return this._settings.showTabShortcuts}onOpen(){this.modalEl.addClasses(["tab-shortcuts-modal","tsh-modal"]),this._eventListenerFunc.click=this.handlingClickEvent.bind(this),this._eventListenerFunc.keyup=this.handlingKeyupEvent.bind(this),this._eventListenerFunc.resize=this.handlingResizeEvent.bind(this),window.addEventListener("keyup",this._eventListenerFunc.keyup),window.addEventListener("resize",this._eventListenerFunc.resize),this._windows=this.generateWindows(this._leaves),this.showShortcutElements(this._windows),this._tabHeaderContainers.forEach(e=>e==null?void 0:e.addClass("tsh-header-container-inner"))}onClose(){this._windows.forEach(({window:e})=>e.removeEventListener("click",this._eventListenerFunc.click)),window.removeEventListener("keyup",this._eventListenerFunc.keyup),window.removeEventListener("resize",this._eventListenerFunc.resize),this._tabHeaderContainers.forEach(e=>e==null?void 0:e.removeClass("tsh-header-container-inner")),this._labelContainerMap.forEach(e=>e.remove()),this.contentEl.empty()}generateWindows(e){return e.reduce((i,t)=>{var o,n,l;let s=i.find(r=>{var p;return r.id===((p=t.parent)==null?void 0:p.id)||""});if(s)return s.leaves=[...s.leaves,t],i;{let r=(n=(o=t.containerEl)==null?void 0:o.ownerDocument.defaultView)!=null?n:window;return r.addEventListener("click",this._eventListenerFunc.click),[...i,{id:((l=t.parent)==null?void 0:l.id)||"",window:r,leaves:[t]}]}},[])}showShortcutElements(e){e.forEach(i=>{var n,l,r;let t=(r=(l=(n=i.leaves[0])==null?void 0:n.containerEl)==null?void 0:l.parentElement)==null?void 0:r.parentElement;this._tabHeaderContainers.push(t==null?void 0:t.querySelector(".workspace-tab-header-container-inner"));let s=t==null?void 0:t.querySelectorAll(".workspace-tab-header-container-inner .workspace-tab-header");if(!s)return;let o=createDiv("tab-shortcuts-container");i.window.document.body.append(o),this._labelContainerMap.set(i.id,o),i.leaves.forEach((p,d)=>{if(!this._chars.length)return;let f=s[d].getBoundingClientRect();createDiv("tsh-label",b=>{var T;b.setText(p.name||""),b.setCssProps({top:`${f.bottom}px`,left:`calc(${f.left}px + 0.5rem)`}),(T=this._labelContainerMap.get(i.id))==null||T.appendChild(b)})})})}handlingClickEvent(){this.close()}handlingKeyupEvent(e){if(this._chars.includes(e.key)){this.close();let i=this._leaves.find(t=>t.name===e.key);i&&this.app.workspace.setActiveLeaf(i,{focus:!0}),e.preventDefault();return}}handlingResizeEvent(){this.close()}};var E=require("obsidian"),ue=[{keys:"\u2191 | \u2193",description:"Move focus"},{keys:"Enter",description:"Switch to focused tab"}],H=class extends E.FuzzySuggestModal{constructor(e,i,t){super(e);this._settings=i;this._leaves=t;this._leaves=this._leaves.map(s=>{var r,p;s.name=s.getDisplayText();let o=((p=(r=s.view)==null?void 0:r.metadataEditor)==null?void 0:p.properties)||[];s.aliases=o.filter(d=>d.key==="aliases").flatMap(d=>d.value).filter(d=>d!=null);let{file:n}=s.getViewState().state,l=typeof n=="string"?n.split(s.getDisplayText())[0]||"/":"-";return s.path=l,s}),this.setPlaceholder("Search tabs"),this.modalEl.addClasses(["tab-search-modal","tse-modal"]),this.modalSettings.showLegends&&this.generateFooter(this.modalEl)}get modalSettings(){return this._settings.searchTab}getItems(){return this._leaves}getItemText(e){return e.name||""}getSuggestions(e){return this.getItems().filter(i=>this.getReferenceStrings(i).some(t=>(0,E.prepareFuzzySearch)(e)(t))).map(i=>({item:i,match:{score:0,matches:[]}}))}onChooseItem(e){this.app.workspace.setActiveLeaf(e,{focus:!0})}renderSuggestion(e,i){return i.createDiv("tse-item-row",t=>{t.setText(e.item.name||"")}),this.modalSettings.showAliases&&i.createDiv("tse-item-row",t=>{var s;(0,E.setIcon)(t,"corner-up-right"),t.createEl("small").setText(((s=e.item.aliases)==null?void 0:s.join(" | "))||"")}),this.modalSettings.showPaths&&i.createDiv("tse-item-row",t=>{(0,E.setIcon)(t,"folder-closed"),t.createEl("small").setText(e.item.path||"")}),i}getReferenceStrings(e){var u;let i=e.name||"",{showAliases:t,includeAliases:s,showPaths:o,includePaths:n}=this.modalSettings,l=t&&s&&((u=e.aliases)==null?void 0:u.join(" "))||"",r=o&&n?e.path:"",p=`${i} ${l} ${r}`,d=`${i} ${r} ${l}`,f=`${l} ${i} ${r}`,b=`${l} ${r} ${i}`,T=`${r} ${i} ${l}`,m=`${r} ${l} ${i}`;return[p,d,f,b,T,m]}generateFooter(e){e.createDiv("tse-footer",i=>{ue.forEach(t=>{i.createDiv("tse-legends",s=>{s.createSpan("tse-keys").setText(t.keys),s.createSpan("tse-description").setText(t.description)})})})}};var F=class extends A.Plugin{async onload(){await this.loadSettings(),this.addRibbonIcon("file-check-2","Open tab selector",()=>this.openTabSelectorModal()),this.addCommand({id:"open-tab-selector",name:"Open tab selector",callback:()=>this.openTabSelectorModal()}),this.addCommand({id:"go-to-previous-tab",name:"Go to previous tab",callback:()=>this.openTabHistoryModal(!0)}),this.addCommand({id:"go-to-next-tab",name:"Go to next tab",callback:()=>this.openTabHistoryModal(!1)}),(A.Platform.isDesktop||A.Platform.isTablet)&&this.addCommand({id:"show-tab-shortcuts",name:"Show tab shortcuts",callback:()=>this.showTabShortcutsModal()}),this.addCommand({id:"search-tabs",name:"Search tabs",callback:()=>this.openTabSearchModal()}),this._settingTab=new N(this.app,this),this.addSettingTab(this._settingTab),this._settingTab.updateStyleSheet()}onunload(){this._settingTab.updateStyleSheet(!0)}async loadSettings(){this.settings=Object.assign({},y,await this.loadData()),this.migrateSettingValues()}async saveSettings(){await this.saveData(this.settings)}openTabSelectorModal(){let a=this.settings.openTabSelector.enableMultiWIndow,e=this.generateLeaves(a);new W(this.app,this.settings,e).open()}openTabHistoryModal(a){let e=this.settings.goToPreviousNextTab.enableMultiWIndow,i=this.generateLeaves(e);new O(this.app,this.settings,i,a).open()}showTabShortcutsModal(){let a=this.settings.showTabShortcuts.enableMultiWIndow,e=this.generateLeaves(a);new B(this.app,this.settings,e).open()}openTabSearchModal(){let a=this.settings.searchTab.enableMultiWIndow,e=this.generateLeaves(a);new H(this.app,this.settings,e).open()}generateLeaves(a){var t;let e=[];this.app.workspace.iterateRootLeaves(s=>{e.push((s==null?void 0:s.id)||"")});let i=[];if(A.Platform.isDesktop&&a)this.app.workspace.iterateAllLeaves(s=>{s.getRoot().containerEl.hasClass("mod-sidedock")||i.push(s)});else{let{id:s,type:o}=(t=this.app.workspace.getMostRecentLeaf())==null?void 0:t.getRoot();this.app.workspace.iterateAllLeaves(n=>{s===n.getRoot().id&&(n.id&&e.includes(n.id)||o==="floating")&&i.push(n)})}return i}async migrateSettingValues(){let a=this.settings;{let e=this.settings.openTabSelector;typeof a.showAliases=="boolean"&&(e.showAliases=a.showAliases,delete a.showAliases),typeof a.replaceToAliases=="boolean"&&(e.replaceToAliases=a.replaceToAliases,delete a.replaceToAliases),typeof a.showPaths=="boolean"&&(e.showPaths=a.showPaths,delete a.showPaths),typeof a.showPaginationButtons=="boolean"&&(e.showPaginationButtons=a.showPaginationButtons,delete a.showPaginationButtons),typeof a.showLegends=="boolean"&&(e.showLegends=a.showLegends,delete a.showLegends),typeof a.focusColor=="string"&&(e.focusColor=a.focusColor,delete a.focusColor),typeof a.characters=="string"&&(e.characters=a.characters,delete a.characters),typeof a.enableClose=="boolean"&&(e.enableClose=a.enableClose,delete a.enableClose)}{let e=this.settings.goToPreviousNextTab;typeof a.thFocusColor=="string"&&(e.focusColor=a.thFocusColor,delete a.thFocusColor),typeof a.mainModifierKey=="string"&&(e.mainModifierKey=a.mainModifierKey,delete a.mainModifierKey),typeof a.subModifierKey=="string"&&(e.subModifierKey=a.subModifierKey,delete a.subModifierKey),typeof a.actionKey=="string"&&(e.actionKey=a.actionKey,delete a.actionKey),typeof a.howToNextTab=="string"&&(e.howToNextTab=a.howToNextTab,delete a.howToNextTab),typeof a.reverseActionKey=="string"&&(e.reverseActionKey=a.reverseActionKey,delete a.reverseActionKey)}{let e=this.settings.showTabShortcuts;typeof a.tshCharacters=="string"&&(e.characters=a.tshCharacters,delete a.tshCharacters)}typeof a.backActionKey=="string"&&delete a.backActionKey,typeof a.howToPreviousTab=="string"&&delete a.howToPreviousTab,typeof a.showPaginationButton=="boolean"&&delete a.showPaginationButton,typeof a.showLegend=="boolean"&&delete a.showLegend,await this.saveSettings()}};

/* nosourcemap */