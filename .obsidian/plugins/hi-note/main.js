/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Pg=Object.create;var ti=Object.defineProperty;var Kg=Object.getOwnPropertyDescriptor;var Rg=Object.getOwnPropertyNames;var kg=Object.getPrototypeOf,Gg=Object.prototype.hasOwnProperty;var Og=(F,e,A)=>e in F?ti(F,e,{enumerable:!0,configurable:!0,writable:!0,value:A}):F[e]=A;var Ng=(F,e)=>()=>(e||F((e={exports:{}}).exports,e),e.exports),Vg=(F,e)=>{for(var A in e)ti(F,A,{get:e[A],enumerable:!0})},oo=(F,e,A,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Rg(e))!Gg.call(F,n)&&n!==A&&ti(F,n,{get:()=>e[n],enumerable:!(t=Kg(e,n))||t.enumerable});return F};var lo=(F,e,A)=>(A=F!=null?Pg(kg(F)):{},oo(e||!F||!F.__esModule?ti(A,"default",{value:F,enumerable:!0}):A,F)),_g=F=>oo(ti({},"__esModule",{value:!0}),F);var EA=(F,e,A)=>Og(F,typeof e!="symbol"?e+"":e,A);var tn=Ng((An,en)=>{(function(F,e){typeof An=="object"&&typeof en!="undefined"?en.exports=e():typeof define=="function"&&define.amd?define(e):(F=typeof globalThis!="undefined"?globalThis:F||self,F.html2canvas=e())})(An,function(){"use strict";var F=function(r,i){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(a[h]=s[h])},F(r,i)};function e(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");F(r,i);function a(){this.constructor=r}r.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}var A=function(){return A=Object.assign||function(i){for(var a,s=1,h=arguments.length;s<h;s++){a=arguments[s];for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(i[g]=a[g])}return i},A.apply(this,arguments)};function t(r,i,a,s){function h(g){return g instanceof a?g:new a(function(f){f(g)})}return new(a||(a=Promise))(function(g,f){function C(S){try{y(s.next(S))}catch(I){f(I)}}function w(S){try{y(s.throw(S))}catch(I){f(I)}}function y(S){S.done?g(S.value):h(S.value).then(C,w)}y((s=s.apply(r,i||[])).next())})}function n(r,i){var a={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},s,h,g,f;return f={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function C(y){return function(S){return w([y,S])}}function w(y){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,h&&(g=y[0]&2?h.return:y[0]?h.throw||((g=h.return)&&g.call(h),0):h.next)&&!(g=g.call(h,y[1])).done)return g;switch(h=0,g&&(y=[y[0]&2,g.value]),y[0]){case 0:case 1:g=y;break;case 4:return a.label++,{value:y[1],done:!1};case 5:a.label++,h=y[1],y=[0];continue;case 7:y=a.ops.pop(),a.trys.pop();continue;default:if(g=a.trys,!(g=g.length>0&&g[g.length-1])&&(y[0]===6||y[0]===2)){a=0;continue}if(y[0]===3&&(!g||y[1]>g[0]&&y[1]<g[3])){a.label=y[1];break}if(y[0]===6&&a.label<g[1]){a.label=g[1],g=y;break}if(g&&a.label<g[2]){a.label=g[2],a.ops.push(y);break}g[2]&&a.ops.pop(),a.trys.pop();continue}y=i.call(r,a)}catch(S){y=[6,S],h=0}finally{s=g=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function o(r,i,a){if(a||arguments.length===2)for(var s=0,h=i.length,g;s<h;s++)(g||!(s in i))&&(g||(g=Array.prototype.slice.call(i,0,s)),g[s]=i[s]);return r.concat(g||i)}for(var l=function(){function r(i,a,s,h){this.left=i,this.top=a,this.width=s,this.height=h}return r.prototype.add=function(i,a,s,h){return new r(this.left+i,this.top+a,this.width+s,this.height+h)},r.fromClientRect=function(i,a){return new r(a.left+i.windowBounds.left,a.top+i.windowBounds.top,a.width,a.height)},r.fromDOMRectList=function(i,a){var s=Array.from(a).find(function(h){return h.width!==0});return s?new r(s.left+i.windowBounds.left,s.top+i.windowBounds.top,s.width,s.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),c=function(r,i){return l.fromClientRect(r,i.getBoundingClientRect())},d=function(r){var i=r.body,a=r.documentElement;if(!i||!a)throw new Error("Unable to get document size");var s=Math.max(Math.max(i.scrollWidth,a.scrollWidth),Math.max(i.offsetWidth,a.offsetWidth),Math.max(i.clientWidth,a.clientWidth)),h=Math.max(Math.max(i.scrollHeight,a.scrollHeight),Math.max(i.offsetHeight,a.offsetHeight),Math.max(i.clientHeight,a.clientHeight));return new l(0,0,s,h)},u=function(r){for(var i=[],a=0,s=r.length;a<s;){var h=r.charCodeAt(a++);if(h>=55296&&h<=56319&&a<s){var g=r.charCodeAt(a++);(g&64512)===56320?i.push(((h&1023)<<10)+(g&1023)+65536):(i.push(h),a--)}else i.push(h)}return i},p=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var a=r.length;if(!a)return"";for(var s=[],h=-1,g="";++h<a;){var f=r[h];f<=65535?s.push(f):(f-=65536,s.push((f>>10)+55296,f%1024+56320)),(h+1===a||s.length>16384)&&(g+=String.fromCharCode.apply(String,s),s.length=0)}return g},B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),Q=0;Q<B.length;Q++)v[B.charCodeAt(Q)]=Q;for(var U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),H=0;H<U.length;H++)E[U.charCodeAt(H)]=H;for(var M=function(r){var i=r.length*.75,a=r.length,s,h=0,g,f,C,w;r[r.length-1]==="="&&(i--,r[r.length-2]==="="&&i--);var y=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined"&&typeof Uint8Array.prototype.slice!="undefined"?new ArrayBuffer(i):new Array(i),S=Array.isArray(y)?y:new Uint8Array(y);for(s=0;s<a;s+=4)g=E[r.charCodeAt(s)],f=E[r.charCodeAt(s+1)],C=E[r.charCodeAt(s+2)],w=E[r.charCodeAt(s+3)],S[h++]=g<<2|f>>4,S[h++]=(f&15)<<4|C>>2,S[h++]=(C&3)<<6|w&63;return y},x=function(r){for(var i=r.length,a=[],s=0;s<i;s+=2)a.push(r[s+1]<<8|r[s]);return a},D=function(r){for(var i=r.length,a=[],s=0;s<i;s+=4)a.push(r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s]);return a},N=5,O=11,J=2,j=O-N,FA=65536>>N,wA=1<<N,DA=wA-1,aA=1024>>N,tA=FA+aA,xA=tA,mA=32,JA=xA+mA,qA=65536>>O,YA=1<<j,Se=YA-1,De=function(r,i,a){return r.slice?r.slice(i,a):new Uint16Array(Array.prototype.slice.call(r,i,a))},UA=function(r,i,a){return r.slice?r.slice(i,a):new Uint32Array(Array.prototype.slice.call(r,i,a))},Pe=function(r,i){var a=M(r),s=Array.isArray(a)?D(a):new Uint32Array(a),h=Array.isArray(a)?x(a):new Uint16Array(a),g=24,f=De(h,g/2,s[4]/2),C=s[5]===2?De(h,(g+s[4])/2):UA(s,Math.ceil((g+s[4])/4));return new Ke(s[0],s[1],s[2],s[3],f,C)},Ke=function(){function r(i,a,s,h,g,f){this.initialValue=i,this.errorValue=a,this.highStart=s,this.highValueIndex=h,this.index=g,this.data=f}return r.prototype.get=function(i){var a;if(i>=0){if(i<55296||i>56319&&i<=65535)return a=this.index[i>>N],a=(a<<J)+(i&DA),this.data[a];if(i<=65535)return a=this.index[FA+(i-55296>>N)],a=(a<<J)+(i&DA),this.data[a];if(i<this.highStart)return a=JA-qA+(i>>O),a=this.index[a],a+=i>>N&Se,a=this.index[a],a=(a<<J)+(i&DA),this.data[a];if(i<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),SA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),gA=0;gA<SA.length;gA++)se[SA.charCodeAt(gA)]=gA;var PA="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",MA=50,ZA=1,CA=2,KA=3,Tt=4,BA=5,me=7,IA=8,fn=9,Re=10,jr=11,mn=12,As=13,To=14,Dt=15,es=16,mi=17,Pt=18,Do=19,Bn=20,ts=21,Kt=22,is=23,ht=24,ne=25,Rt=26,kt=27,dt=28,Po=29,tt=30,Ko=31,Bi=32,wi=33,rs=34,ss=35,ns=36,Gt=37,as=38,Ci=39,vi=40,os=41,wn=42,Ro=43,ko=[9001,65288],Cn="!",eA="\xD7",Fi="\xF7",ls=Pe(PA),Ie=[tt,ns],cs=[ZA,CA,KA,BA],vn=[Re,IA],Fn=[kt,Rt],Go=cs.concat(vn),Qn=[as,Ci,vi,rs,ss],Oo=[Dt,As],No=function(r,i){i===void 0&&(i="strict");var a=[],s=[],h=[];return r.forEach(function(g,f){var C=ls.get(g);if(C>MA?(h.push(!0),C-=MA):h.push(!1),["normal","auto","loose"].indexOf(i)!==-1&&[8208,8211,12316,12448].indexOf(g)!==-1)return s.push(f),a.push(es);if(C===Tt||C===jr){if(f===0)return s.push(f),a.push(tt);var w=a[f-1];return Go.indexOf(w)===-1?(s.push(s[f-1]),a.push(w)):(s.push(f),a.push(tt))}if(s.push(f),C===Ko)return a.push(i==="strict"?ts:Gt);if(C===wn||C===Po)return a.push(tt);if(C===Ro)return g>=131072&&g<=196605||g>=196608&&g<=262141?a.push(Gt):a.push(tt);a.push(C)}),[s,a,h]},hs=function(r,i,a,s){var h=s[a];if(Array.isArray(r)?r.indexOf(h)!==-1:r===h)for(var g=a;g<=s.length;){g++;var f=s[g];if(f===i)return!0;if(f!==Re)break}if(h===Re)for(var g=a;g>0;){g--;var C=s[g];if(Array.isArray(r)?r.indexOf(C)!==-1:r===C)for(var w=a;w<=s.length;){w++;var f=s[w];if(f===i)return!0;if(f!==Re)break}if(C!==Re)break}return!1},yn=function(r,i){for(var a=r;a>=0;){var s=i[a];if(s===Re)a--;else return s}return 0},Vo=function(r,i,a,s,h){if(a[s]===0)return eA;var g=s-1;if(Array.isArray(h)&&h[g]===!0)return eA;var f=g-1,C=g+1,w=i[g],y=f>=0?i[f]:0,S=i[C];if(w===CA&&S===KA)return eA;if(cs.indexOf(w)!==-1)return Cn;if(cs.indexOf(S)!==-1||vn.indexOf(S)!==-1)return eA;if(yn(g,i)===IA)return Fi;if(ls.get(r[g])===jr||(w===Bi||w===wi)&&ls.get(r[C])===jr||w===me||S===me||w===fn||[Re,As,Dt].indexOf(w)===-1&&S===fn||[mi,Pt,Do,ht,dt].indexOf(S)!==-1||yn(g,i)===Kt||hs(is,Kt,g,i)||hs([mi,Pt],ts,g,i)||hs(mn,mn,g,i))return eA;if(w===Re)return Fi;if(w===is||S===is)return eA;if(S===es||w===es)return Fi;if([As,Dt,ts].indexOf(S)!==-1||w===To||y===ns&&Oo.indexOf(w)!==-1||w===dt&&S===ns||S===Bn||Ie.indexOf(S)!==-1&&w===ne||Ie.indexOf(w)!==-1&&S===ne||w===kt&&[Gt,Bi,wi].indexOf(S)!==-1||[Gt,Bi,wi].indexOf(w)!==-1&&S===Rt||Ie.indexOf(w)!==-1&&Fn.indexOf(S)!==-1||Fn.indexOf(w)!==-1&&Ie.indexOf(S)!==-1||[kt,Rt].indexOf(w)!==-1&&(S===ne||[Kt,Dt].indexOf(S)!==-1&&i[C+1]===ne)||[Kt,Dt].indexOf(w)!==-1&&S===ne||w===ne&&[ne,dt,ht].indexOf(S)!==-1)return eA;if([ne,dt,ht,mi,Pt].indexOf(S)!==-1)for(var I=g;I>=0;){var b=i[I];if(b===ne)return eA;if([dt,ht].indexOf(b)!==-1)I--;else break}if([kt,Rt].indexOf(S)!==-1)for(var I=[mi,Pt].indexOf(w)!==-1?f:g;I>=0;){var b=i[I];if(b===ne)return eA;if([dt,ht].indexOf(b)!==-1)I--;else break}if(as===w&&[as,Ci,rs,ss].indexOf(S)!==-1||[Ci,rs].indexOf(w)!==-1&&[Ci,vi].indexOf(S)!==-1||[vi,ss].indexOf(w)!==-1&&S===vi||Qn.indexOf(w)!==-1&&[Bn,Rt].indexOf(S)!==-1||Qn.indexOf(S)!==-1&&w===kt||Ie.indexOf(w)!==-1&&Ie.indexOf(S)!==-1||w===ht&&Ie.indexOf(S)!==-1||Ie.concat(ne).indexOf(w)!==-1&&S===Kt&&ko.indexOf(r[C])===-1||Ie.concat(ne).indexOf(S)!==-1&&w===Pt)return eA;if(w===os&&S===os){for(var k=a[g],L=1;k>0&&(k--,i[k]===os);)L++;if(L%2!==0)return eA}return w===Bi&&S===wi?eA:Fi},_o=function(r,i){i||(i={lineBreak:"normal",wordBreak:"normal"});var a=No(r,i.lineBreak),s=a[0],h=a[1],g=a[2];(i.wordBreak==="break-all"||i.wordBreak==="break-word")&&(h=h.map(function(C){return[ne,tt,wn].indexOf(C)!==-1?Gt:C}));var f=i.wordBreak==="keep-all"?g.map(function(C,w){return C&&r[w]>=19968&&r[w]<=40959}):void 0;return[s,h,f]},Xo=function(){function r(i,a,s,h){this.codePoints=i,this.required=a===Cn,this.start=s,this.end=h}return r.prototype.slice=function(){return p.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),Jo=function(r,i){var a=u(r),s=_o(a,i),h=s[0],g=s[1],f=s[2],C=a.length,w=0,y=0;return{next:function(){if(y>=C)return{done:!0,value:null};for(var S=eA;y<C&&(S=Vo(a,g,h,++y,f))===eA;);if(S!==eA||y===C){var I=new Xo(a,S,w,y);return w=y,{value:I,done:!1}}return{done:!0,value:null}}}},Yo=1,Wo=2,Ot=4,En=8,Qi=10,Un=47,Nt=92,$o=9,qo=32,yi=34,Vt=61,Zo=35,zo=36,jo=37,Ei=39,Ui=40,_t=41,Al=95,zA=45,el=33,tl=60,il=62,rl=64,sl=91,nl=93,al=61,ol=123,Si=63,ll=125,Sn=124,cl=126,hl=128,In=65533,ds=42,it=43,dl=44,gl=58,ul=59,Xt=46,pl=0,fl=8,ml=11,Bl=14,wl=31,Cl=127,Fe=-1,Hn=48,bn=97,xn=101,vl=102,Fl=117,Ql=122,Mn=65,Ln=69,Tn=70,yl=85,El=90,VA=function(r){return r>=Hn&&r<=57},Ul=function(r){return r>=55296&&r<=57343},gt=function(r){return VA(r)||r>=Mn&&r<=Tn||r>=bn&&r<=vl},Sl=function(r){return r>=bn&&r<=Ql},Il=function(r){return r>=Mn&&r<=El},Hl=function(r){return Sl(r)||Il(r)},bl=function(r){return r>=hl},Ii=function(r){return r===Qi||r===$o||r===qo},Hi=function(r){return Hl(r)||bl(r)||r===Al},Dn=function(r){return Hi(r)||VA(r)||r===zA},xl=function(r){return r>=pl&&r<=fl||r===ml||r>=Bl&&r<=wl||r===Cl},ke=function(r,i){return r!==Nt?!1:i!==Qi},bi=function(r,i,a){return r===zA?Hi(i)||ke(i,a):Hi(r)?!0:!!(r===Nt&&ke(r,i))},gs=function(r,i,a){return r===it||r===zA?VA(i)?!0:i===Xt&&VA(a):VA(r===Xt?i:r)},Ml=function(r){var i=0,a=1;(r[i]===it||r[i]===zA)&&(r[i]===zA&&(a=-1),i++);for(var s=[];VA(r[i]);)s.push(r[i++]);var h=s.length?parseInt(p.apply(void 0,s),10):0;r[i]===Xt&&i++;for(var g=[];VA(r[i]);)g.push(r[i++]);var f=g.length,C=f?parseInt(p.apply(void 0,g),10):0;(r[i]===Ln||r[i]===xn)&&i++;var w=1;(r[i]===it||r[i]===zA)&&(r[i]===zA&&(w=-1),i++);for(var y=[];VA(r[i]);)y.push(r[i++]);var S=y.length?parseInt(p.apply(void 0,y),10):0;return a*(h+C*Math.pow(10,-f))*Math.pow(10,w*S)},Ll={type:2},Tl={type:3},Dl={type:4},Pl={type:13},Kl={type:8},Rl={type:21},kl={type:9},Gl={type:10},Ol={type:11},Nl={type:12},Vl={type:14},xi={type:23},_l={type:1},Xl={type:25},Jl={type:24},Yl={type:26},Wl={type:27},$l={type:28},ql={type:29},Zl={type:31},us={type:32},Pn=function(){function r(){this._value=[]}return r.prototype.write=function(i){this._value=this._value.concat(u(i))},r.prototype.read=function(){for(var i=[],a=this.consumeToken();a!==us;)i.push(a),a=this.consumeToken();return i},r.prototype.consumeToken=function(){var i=this.consumeCodePoint();switch(i){case yi:return this.consumeStringToken(yi);case Zo:var a=this.peekCodePoint(0),s=this.peekCodePoint(1),h=this.peekCodePoint(2);if(Dn(a)||ke(s,h)){var g=bi(a,s,h)?Wo:Yo,f=this.consumeName();return{type:5,value:f,flags:g}}break;case zo:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Pl;break;case Ei:return this.consumeStringToken(Ei);case Ui:return Ll;case _t:return Tl;case ds:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Vl;break;case it:if(gs(i,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(i),this.consumeNumericToken();break;case dl:return Dl;case zA:var C=i,w=this.peekCodePoint(0),y=this.peekCodePoint(1);if(gs(C,w,y))return this.reconsumeCodePoint(i),this.consumeNumericToken();if(bi(C,w,y))return this.reconsumeCodePoint(i),this.consumeIdentLikeToken();if(w===zA&&y===il)return this.consumeCodePoint(),this.consumeCodePoint(),Jl;break;case Xt:if(gs(i,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(i),this.consumeNumericToken();break;case Un:if(this.peekCodePoint(0)===ds)for(this.consumeCodePoint();;){var S=this.consumeCodePoint();if(S===ds&&(S=this.consumeCodePoint(),S===Un))return this.consumeToken();if(S===Fe)return this.consumeToken()}break;case gl:return Yl;case ul:return Wl;case tl:if(this.peekCodePoint(0)===el&&this.peekCodePoint(1)===zA&&this.peekCodePoint(2)===zA)return this.consumeCodePoint(),this.consumeCodePoint(),Xl;break;case rl:var I=this.peekCodePoint(0),b=this.peekCodePoint(1),k=this.peekCodePoint(2);if(bi(I,b,k)){var f=this.consumeName();return{type:7,value:f}}break;case sl:return $l;case Nt:if(ke(i,this.peekCodePoint(0)))return this.reconsumeCodePoint(i),this.consumeIdentLikeToken();break;case nl:return ql;case al:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Kl;break;case ol:return Ol;case ll:return Nl;case Fl:case yl:var L=this.peekCodePoint(0),P=this.peekCodePoint(1);return L===it&&(gt(P)||P===Si)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(i),this.consumeIdentLikeToken();case Sn:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),kl;if(this.peekCodePoint(0)===Sn)return this.consumeCodePoint(),Rl;break;case cl:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Gl;break;case Fe:return us}return Ii(i)?(this.consumeWhiteSpace(),Zl):VA(i)?(this.reconsumeCodePoint(i),this.consumeNumericToken()):Hi(i)?(this.reconsumeCodePoint(i),this.consumeIdentLikeToken()):{type:6,value:p(i)}},r.prototype.consumeCodePoint=function(){var i=this._value.shift();return typeof i=="undefined"?-1:i},r.prototype.reconsumeCodePoint=function(i){this._value.unshift(i)},r.prototype.peekCodePoint=function(i){return i>=this._value.length?-1:this._value[i]},r.prototype.consumeUnicodeRangeToken=function(){for(var i=[],a=this.consumeCodePoint();gt(a)&&i.length<6;)i.push(a),a=this.consumeCodePoint();for(var s=!1;a===Si&&i.length<6;)i.push(a),a=this.consumeCodePoint(),s=!0;if(s){var h=parseInt(p.apply(void 0,i.map(function(w){return w===Si?Hn:w})),16),g=parseInt(p.apply(void 0,i.map(function(w){return w===Si?Tn:w})),16);return{type:30,start:h,end:g}}var f=parseInt(p.apply(void 0,i),16);if(this.peekCodePoint(0)===zA&&gt(this.peekCodePoint(1))){this.consumeCodePoint(),a=this.consumeCodePoint();for(var C=[];gt(a)&&C.length<6;)C.push(a),a=this.consumeCodePoint();var g=parseInt(p.apply(void 0,C),16);return{type:30,start:f,end:g}}else return{type:30,start:f,end:f}},r.prototype.consumeIdentLikeToken=function(){var i=this.consumeName();return i.toLowerCase()==="url"&&this.peekCodePoint(0)===Ui?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ui?(this.consumeCodePoint(),{type:19,value:i}):{type:20,value:i}},r.prototype.consumeUrlToken=function(){var i=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe)return{type:22,value:""};var a=this.peekCodePoint(0);if(a===Ei||a===yi){var s=this.consumeStringToken(this.consumeCodePoint());return s.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe||this.peekCodePoint(0)===_t)?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),xi)}for(;;){var h=this.consumeCodePoint();if(h===Fe||h===_t)return{type:22,value:p.apply(void 0,i)};if(Ii(h))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe||this.peekCodePoint(0)===_t?(this.consumeCodePoint(),{type:22,value:p.apply(void 0,i)}):(this.consumeBadUrlRemnants(),xi);if(h===yi||h===Ei||h===Ui||xl(h))return this.consumeBadUrlRemnants(),xi;if(h===Nt)if(ke(h,this.peekCodePoint(0)))i.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),xi;else i.push(h)}},r.prototype.consumeWhiteSpace=function(){for(;Ii(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var i=this.consumeCodePoint();if(i===_t||i===Fe)return;ke(i,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(i){for(var a=5e4,s="";i>0;){var h=Math.min(a,i);s+=p.apply(void 0,this._value.splice(0,h)),i-=h}return this._value.shift(),s},r.prototype.consumeStringToken=function(i){var a="",s=0;do{var h=this._value[s];if(h===Fe||h===void 0||h===i)return a+=this.consumeStringSlice(s),{type:0,value:a};if(h===Qi)return this._value.splice(0,s),_l;if(h===Nt){var g=this._value[s+1];g!==Fe&&g!==void 0&&(g===Qi?(a+=this.consumeStringSlice(s),s=-1,this._value.shift()):ke(h,g)&&(a+=this.consumeStringSlice(s),a+=p(this.consumeEscapedCodePoint()),s=-1))}s++}while(!0)},r.prototype.consumeNumber=function(){var i=[],a=Ot,s=this.peekCodePoint(0);for((s===it||s===zA)&&i.push(this.consumeCodePoint());VA(this.peekCodePoint(0));)i.push(this.consumeCodePoint());s=this.peekCodePoint(0);var h=this.peekCodePoint(1);if(s===Xt&&VA(h))for(i.push(this.consumeCodePoint(),this.consumeCodePoint()),a=En;VA(this.peekCodePoint(0));)i.push(this.consumeCodePoint());s=this.peekCodePoint(0),h=this.peekCodePoint(1);var g=this.peekCodePoint(2);if((s===Ln||s===xn)&&((h===it||h===zA)&&VA(g)||VA(h)))for(i.push(this.consumeCodePoint(),this.consumeCodePoint()),a=En;VA(this.peekCodePoint(0));)i.push(this.consumeCodePoint());return[Ml(i),a]},r.prototype.consumeNumericToken=function(){var i=this.consumeNumber(),a=i[0],s=i[1],h=this.peekCodePoint(0),g=this.peekCodePoint(1),f=this.peekCodePoint(2);if(bi(h,g,f)){var C=this.consumeName();return{type:15,number:a,flags:s,unit:C}}return h===jo?(this.consumeCodePoint(),{type:16,number:a,flags:s}):{type:17,number:a,flags:s}},r.prototype.consumeEscapedCodePoint=function(){var i=this.consumeCodePoint();if(gt(i)){for(var a=p(i);gt(this.peekCodePoint(0))&&a.length<6;)a+=p(this.consumeCodePoint());Ii(this.peekCodePoint(0))&&this.consumeCodePoint();var s=parseInt(a,16);return s===0||Ul(s)||s>1114111?In:s}return i===Fe?In:i},r.prototype.consumeName=function(){for(var i="";;){var a=this.consumeCodePoint();if(Dn(a))i+=p(a);else if(ke(a,this.peekCodePoint(0)))i+=p(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(a),i}},r}(),Kn=function(){function r(i){this._tokens=i}return r.create=function(i){var a=new Pn;return a.write(i),new r(a.read())},r.parseValue=function(i){return r.create(i).parseComponentValue()},r.parseValues=function(i){return r.create(i).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var i=this.consumeToken();i.type===31;)i=this.consumeToken();if(i.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(i);var a=this.consumeComponentValue();do i=this.consumeToken();while(i.type===31);if(i.type===32)return a;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var i=[];;){var a=this.consumeComponentValue();if(a.type===32)return i;i.push(a),i.push()}},r.prototype.consumeComponentValue=function(){var i=this.consumeToken();switch(i.type){case 11:case 28:case 2:return this.consumeSimpleBlock(i.type);case 19:return this.consumeFunction(i)}return i},r.prototype.consumeSimpleBlock=function(i){for(var a={type:i,values:[]},s=this.consumeToken();;){if(s.type===32||jl(s,i))return a;this.reconsumeToken(s),a.values.push(this.consumeComponentValue()),s=this.consumeToken()}},r.prototype.consumeFunction=function(i){for(var a={name:i.value,values:[],type:18};;){var s=this.consumeToken();if(s.type===32||s.type===3)return a;this.reconsumeToken(s),a.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var i=this._tokens.shift();return typeof i=="undefined"?us:i},r.prototype.reconsumeToken=function(i){this._tokens.unshift(i)},r}(),Jt=function(r){return r.type===15},ut=function(r){return r.type===17},hA=function(r){return r.type===20},zl=function(r){return r.type===0},ps=function(r,i){return hA(r)&&r.value===i},Rn=function(r){return r.type!==31},pt=function(r){return r.type!==31&&r.type!==4},Qe=function(r){var i=[],a=[];return r.forEach(function(s){if(s.type===4){if(a.length===0)throw new Error("Error parsing function args, zero tokens for arg");i.push(a),a=[];return}s.type!==31&&a.push(s)}),a.length&&i.push(a),i},jl=function(r,i){return i===11&&r.type===12||i===28&&r.type===29?!0:i===2&&r.type===3},Ge=function(r){return r.type===17||r.type===15},QA=function(r){return r.type===16||Ge(r)},kn=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},RA={type:17,number:0,flags:Ot},fs={type:16,number:50,flags:Ot},Oe={type:16,number:100,flags:Ot},Yt=function(r,i,a){var s=r[0],h=r[1];return[uA(s,i),uA(typeof h!="undefined"?h:s,a)]},uA=function(r,i){if(r.type===16)return r.number/100*i;if(Jt(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},Gn="deg",On="grad",Nn="rad",Vn="turn",Mi={name:"angle",parse:function(r,i){if(i.type===15)switch(i.unit){case Gn:return Math.PI*i.number/180;case On:return Math.PI/200*i.number;case Nn:return i.number;case Vn:return Math.PI*2*i.number}throw new Error("Unsupported angle type")}},_n=function(r){return r.type===15&&(r.unit===Gn||r.unit===On||r.unit===Nn||r.unit===Vn)},Xn=function(r){var i=r.filter(hA).map(function(a){return a.value}).join(" ");switch(i){case"to bottom right":case"to right bottom":case"left top":case"top left":return[RA,RA];case"to top":case"bottom":return ce(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[RA,Oe];case"to right":case"left":return ce(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Oe,Oe];case"to bottom":case"top":return ce(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Oe,RA];case"to left":case"right":return ce(270)}return 0},ce=function(r){return Math.PI*r/180},Ne={name:"color",parse:function(r,i){if(i.type===18){var a=Ac[i.name];if(typeof a=="undefined")throw new Error('Attempting to parse an unsupported color function "'+i.name+'"');return a(r,i.values)}if(i.type===5){if(i.value.length===3){var s=i.value.substring(0,1),h=i.value.substring(1,2),g=i.value.substring(2,3);return _e(parseInt(s+s,16),parseInt(h+h,16),parseInt(g+g,16),1)}if(i.value.length===4){var s=i.value.substring(0,1),h=i.value.substring(1,2),g=i.value.substring(2,3),f=i.value.substring(3,4);return _e(parseInt(s+s,16),parseInt(h+h,16),parseInt(g+g,16),parseInt(f+f,16)/255)}if(i.value.length===6){var s=i.value.substring(0,2),h=i.value.substring(2,4),g=i.value.substring(4,6);return _e(parseInt(s,16),parseInt(h,16),parseInt(g,16),1)}if(i.value.length===8){var s=i.value.substring(0,2),h=i.value.substring(2,4),g=i.value.substring(4,6),f=i.value.substring(6,8);return _e(parseInt(s,16),parseInt(h,16),parseInt(g,16),parseInt(f,16)/255)}}if(i.type===20){var C=He[i.value.toUpperCase()];if(typeof C!="undefined")return C}return He.TRANSPARENT}},Ve=function(r){return(255&r)===0},LA=function(r){var i=255&r,a=255&r>>8,s=255&r>>16,h=255&r>>24;return i<255?"rgba("+h+","+s+","+a+","+i/255+")":"rgb("+h+","+s+","+a+")"},_e=function(r,i,a,s){return(r<<24|i<<16|a<<8|Math.round(s*255)<<0)>>>0},Jn=function(r,i){if(r.type===17)return r.number;if(r.type===16){var a=i===3?1:255;return i===3?r.number/100*a:Math.round(r.number/100*a)}return 0},Yn=function(r,i){var a=i.filter(pt);if(a.length===3){var s=a.map(Jn),h=s[0],g=s[1],f=s[2];return _e(h,g,f,1)}if(a.length===4){var C=a.map(Jn),h=C[0],g=C[1],f=C[2],w=C[3];return _e(h,g,f,w)}return 0};function ms(r,i,a){return a<0&&(a+=1),a>=1&&(a-=1),a<1/6?(i-r)*a*6+r:a<1/2?i:a<2/3?(i-r)*6*(2/3-a)+r:r}var Wn=function(r,i){var a=i.filter(pt),s=a[0],h=a[1],g=a[2],f=a[3],C=(s.type===17?ce(s.number):Mi.parse(r,s))/(Math.PI*2),w=QA(h)?h.number/100:0,y=QA(g)?g.number/100:0,S=typeof f!="undefined"&&QA(f)?uA(f,1):1;if(w===0)return _e(y*255,y*255,y*255,1);var I=y<=.5?y*(w+1):y+w-y*w,b=y*2-I,k=ms(b,I,C+1/3),L=ms(b,I,C),P=ms(b,I,C-1/3);return _e(k*255,L*255,P*255,S)},Ac={hsl:Wn,hsla:Wn,rgb:Yn,rgba:Yn},Wt=function(r,i){return Ne.parse(r,Kn.create(i).parseComponentValue())},He={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ec={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,i){return i.map(function(a){if(hA(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},tc={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Li=function(r,i){var a=Ne.parse(r,i[0]),s=i[1];return s&&QA(s)?{color:a,stop:s}:{color:a,stop:null}},$n=function(r,i){var a=r[0],s=r[r.length-1];a.stop===null&&(a.stop=RA),s.stop===null&&(s.stop=Oe);for(var h=[],g=0,f=0;f<r.length;f++){var C=r[f].stop;if(C!==null){var w=uA(C,i);w>g?h.push(w):h.push(g),g=w}else h.push(null)}for(var y=null,f=0;f<h.length;f++){var S=h[f];if(S===null)y===null&&(y=f);else if(y!==null){for(var I=f-y,b=h[y-1],k=(S-b)/(I+1),L=1;L<=I;L++)h[y+L-1]=k*L;y=null}}return r.map(function(P,$){var _=P.color;return{color:_,stop:Math.max(Math.min(1,h[$]/i),0)}})},ic=function(r,i,a){var s=i/2,h=a/2,g=uA(r[0],i)-s,f=h-uA(r[1],a);return(Math.atan2(f,g)+Math.PI*2)%(Math.PI*2)},rc=function(r,i,a){var s=typeof r=="number"?r:ic(r,i,a),h=Math.abs(i*Math.sin(s))+Math.abs(a*Math.cos(s)),g=i/2,f=a/2,C=h/2,w=Math.sin(s-Math.PI/2)*C,y=Math.cos(s-Math.PI/2)*C;return[h,g-y,g+y,f-w,f+w]},Be=function(r,i){return Math.sqrt(r*r+i*i)},qn=function(r,i,a,s,h){var g=[[0,0],[0,i],[r,0],[r,i]];return g.reduce(function(f,C){var w=C[0],y=C[1],S=Be(a-w,s-y);return(h?S<f.optimumDistance:S>f.optimumDistance)?{optimumCorner:C,optimumDistance:S}:f},{optimumDistance:h?1/0:-1/0,optimumCorner:null}).optimumCorner},sc=function(r,i,a,s,h){var g=0,f=0;switch(r.size){case 0:r.shape===0?g=f=Math.min(Math.abs(i),Math.abs(i-s),Math.abs(a),Math.abs(a-h)):r.shape===1&&(g=Math.min(Math.abs(i),Math.abs(i-s)),f=Math.min(Math.abs(a),Math.abs(a-h)));break;case 2:if(r.shape===0)g=f=Math.min(Be(i,a),Be(i,a-h),Be(i-s,a),Be(i-s,a-h));else if(r.shape===1){var C=Math.min(Math.abs(a),Math.abs(a-h))/Math.min(Math.abs(i),Math.abs(i-s)),w=qn(s,h,i,a,!0),y=w[0],S=w[1];g=Be(y-i,(S-a)/C),f=C*g}break;case 1:r.shape===0?g=f=Math.max(Math.abs(i),Math.abs(i-s),Math.abs(a),Math.abs(a-h)):r.shape===1&&(g=Math.max(Math.abs(i),Math.abs(i-s)),f=Math.max(Math.abs(a),Math.abs(a-h)));break;case 3:if(r.shape===0)g=f=Math.max(Be(i,a),Be(i,a-h),Be(i-s,a),Be(i-s,a-h));else if(r.shape===1){var C=Math.max(Math.abs(a),Math.abs(a-h))/Math.max(Math.abs(i),Math.abs(i-s)),I=qn(s,h,i,a,!1),y=I[0],S=I[1];g=Be(y-i,(S-a)/C),f=C*g}break}return Array.isArray(r.size)&&(g=uA(r.size[0],s),f=r.size.length===2?uA(r.size[1],h):g),[g,f]},nc=function(r,i){var a=ce(180),s=[];return Qe(i).forEach(function(h,g){if(g===0){var f=h[0];if(f.type===20&&f.value==="to"){a=Xn(h);return}else if(_n(f)){a=Mi.parse(r,f);return}}var C=Li(r,h);s.push(C)}),{angle:a,stops:s,type:1}},Ti=function(r,i){var a=ce(180),s=[];return Qe(i).forEach(function(h,g){if(g===0){var f=h[0];if(f.type===20&&["top","left","right","bottom"].indexOf(f.value)!==-1){a=Xn(h);return}else if(_n(f)){a=(Mi.parse(r,f)+ce(270))%ce(360);return}}var C=Li(r,h);s.push(C)}),{angle:a,stops:s,type:1}},ac=function(r,i){var a=ce(180),s=[],h=1,g=0,f=3,C=[];return Qe(i).forEach(function(w,y){var S=w[0];if(y===0){if(hA(S)&&S.value==="linear"){h=1;return}else if(hA(S)&&S.value==="radial"){h=2;return}}if(S.type===18){if(S.name==="from"){var I=Ne.parse(r,S.values[0]);s.push({stop:RA,color:I})}else if(S.name==="to"){var I=Ne.parse(r,S.values[0]);s.push({stop:Oe,color:I})}else if(S.name==="color-stop"){var b=S.values.filter(pt);if(b.length===2){var I=Ne.parse(r,b[1]),k=b[0];ut(k)&&s.push({stop:{type:16,number:k.number*100,flags:k.flags},color:I})}}}}),h===1?{angle:(a+ce(180))%ce(360),stops:s,type:h}:{size:f,shape:g,stops:s,position:C,type:h}},Zn="closest-side",zn="farthest-side",jn="closest-corner",Aa="farthest-corner",ea="circle",ta="ellipse",ia="cover",ra="contain",oc=function(r,i){var a=0,s=3,h=[],g=[];return Qe(i).forEach(function(f,C){var w=!0;if(C===0){var y=!1;w=f.reduce(function(I,b){if(y)if(hA(b))switch(b.value){case"center":return g.push(fs),I;case"top":case"left":return g.push(RA),I;case"right":case"bottom":return g.push(Oe),I}else(QA(b)||Ge(b))&&g.push(b);else if(hA(b))switch(b.value){case ea:return a=0,!1;case ta:return a=1,!1;case"at":return y=!0,!1;case Zn:return s=0,!1;case ia:case zn:return s=1,!1;case ra:case jn:return s=2,!1;case Aa:return s=3,!1}else if(Ge(b)||QA(b))return Array.isArray(s)||(s=[]),s.push(b),!1;return I},w)}if(w){var S=Li(r,f);h.push(S)}}),{size:s,shape:a,stops:h,position:g,type:2}},Di=function(r,i){var a=0,s=3,h=[],g=[];return Qe(i).forEach(function(f,C){var w=!0;if(C===0?w=f.reduce(function(S,I){if(hA(I))switch(I.value){case"center":return g.push(fs),!1;case"top":case"left":return g.push(RA),!1;case"right":case"bottom":return g.push(Oe),!1}else if(QA(I)||Ge(I))return g.push(I),!1;return S},w):C===1&&(w=f.reduce(function(S,I){if(hA(I))switch(I.value){case ea:return a=0,!1;case ta:return a=1,!1;case ra:case Zn:return s=0,!1;case zn:return s=1,!1;case jn:return s=2,!1;case ia:case Aa:return s=3,!1}else if(Ge(I)||QA(I))return Array.isArray(s)||(s=[]),s.push(I),!1;return S},w)),w){var y=Li(r,f);h.push(y)}}),{size:s,shape:a,stops:h,position:g,type:2}},lc=function(r){return r.type===1},cc=function(r){return r.type===2},Bs={name:"image",parse:function(r,i){if(i.type===22){var a={url:i.value,type:0};return r.cache.addImage(i.value),a}if(i.type===18){var s=sa[i.name];if(typeof s=="undefined")throw new Error('Attempting to parse an unsupported image function "'+i.name+'"');return s(r,i.values)}throw new Error("Unsupported image type "+i.type)}};function hc(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!sa[r.name])}var sa={"linear-gradient":nc,"-moz-linear-gradient":Ti,"-ms-linear-gradient":Ti,"-o-linear-gradient":Ti,"-webkit-linear-gradient":Ti,"radial-gradient":oc,"-moz-radial-gradient":Di,"-ms-radial-gradient":Di,"-o-radial-gradient":Di,"-webkit-radial-gradient":Di,"-webkit-gradient":ac},dc={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,i){if(i.length===0)return[];var a=i[0];return a.type===20&&a.value==="none"?[]:i.filter(function(s){return pt(s)&&hc(s)}).map(function(s){return Bs.parse(r,s)})}},gc={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,i){return i.map(function(a){if(hA(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},uc={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,i){return Qe(i).map(function(a){return a.filter(QA)}).map(kn)}},pc={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,i){return Qe(i).map(function(a){return a.filter(hA).map(function(s){return s.value}).join(" ")}).map(fc)}},fc=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},ft;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(ft||(ft={}));var mc={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,i){return Qe(i).map(function(a){return a.filter(Bc)})}},Bc=function(r){return hA(r)||QA(r)},Pi=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},wc=Pi("top"),Cc=Pi("right"),vc=Pi("bottom"),Fc=Pi("left"),Ki=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(i,a){return kn(a.filter(QA))}}},Qc=Ki("top-left"),yc=Ki("top-right"),Ec=Ki("bottom-right"),Uc=Ki("bottom-left"),Ri=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(i,a){switch(a){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Sc=Ri("top"),Ic=Ri("right"),Hc=Ri("bottom"),bc=Ri("left"),ki=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(i,a){return Jt(a)?a.number:0}}},xc=ki("top"),Mc=ki("right"),Lc=ki("bottom"),Tc=ki("left"),Dc={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Pc={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,i){switch(i){case"rtl":return 1;case"ltr":default:return 0}}},Kc={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,i){return i.filter(hA).reduce(function(a,s){return a|Rc(s.value)},0)}},Rc=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},kc={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,i){switch(i){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Gc={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,i){return i.type===20&&i.value==="normal"?0:i.type===17||i.type===15?i.number:0}},Gi;(function(r){r.NORMAL="normal",r.STRICT="strict"})(Gi||(Gi={}));var Oc={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,i){switch(i){case"strict":return Gi.STRICT;case"normal":default:return Gi.NORMAL}}},Nc={name:"line-height",initialValue:"normal",prefix:!1,type:4},na=function(r,i){return hA(r)&&r.value==="normal"?1.2*i:r.type===17?i*r.number:QA(r)?uA(r,i):i},Vc={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,i){return i.type===20&&i.value==="none"?null:Bs.parse(r,i)}},_c={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,i){switch(i){case"inside":return 0;case"outside":default:return 1}}},ws={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,i){switch(i){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Oi=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Xc=Oi("top"),Jc=Oi("right"),Yc=Oi("bottom"),Wc=Oi("left"),$c={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,i){return i.filter(hA).map(function(a){switch(a.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},qc={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,i){switch(i){case"break-word":return"break-word";case"normal":default:return"normal"}}},Ni=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Zc=Ni("top"),zc=Ni("right"),jc=Ni("bottom"),Ah=Ni("left"),eh={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,i){switch(i){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},th={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,i){switch(i){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ih={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,i){return i.length===1&&ps(i[0],"none")?[]:Qe(i).map(function(a){for(var s={color:He.TRANSPARENT,offsetX:RA,offsetY:RA,blur:RA},h=0,g=0;g<a.length;g++){var f=a[g];Ge(f)?(h===0?s.offsetX=f:h===1?s.offsetY=f:s.blur=f,h++):s.color=Ne.parse(r,f)}return s})}},rh={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,i){switch(i){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},sh={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,i){if(i.type===20&&i.value==="none")return null;if(i.type===18){var a=oh[i.name];if(typeof a=="undefined")throw new Error('Attempting to parse an unsupported transform function "'+i.name+'"');return a(i.values)}return null}},nh=function(r){var i=r.filter(function(a){return a.type===17}).map(function(a){return a.number});return i.length===6?i:null},ah=function(r){var i=r.filter(function(w){return w.type===17}).map(function(w){return w.number}),a=i[0],s=i[1];i[2],i[3];var h=i[4],g=i[5];i[6],i[7],i[8],i[9],i[10],i[11];var f=i[12],C=i[13];return i[14],i[15],i.length===16?[a,s,h,g,f,C]:null},oh={matrix:nh,matrix3d:ah},aa={type:16,number:50,flags:Ot},lh=[aa,aa],ch={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,i){var a=i.filter(QA);return a.length!==2?lh:[a[0],a[1]]}},hh={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,i){switch(i){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},$t;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})($t||($t={}));for(var dh={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,i){switch(i){case"break-all":return $t.BREAK_ALL;case"keep-all":return $t.KEEP_ALL;case"normal":default:return $t.NORMAL}}},gh={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,i){if(i.type===20)return{auto:!0,order:0};if(ut(i))return{auto:!1,order:i.number};throw new Error("Invalid z-index number parsed")}},oa={name:"time",parse:function(r,i){if(i.type===15)switch(i.unit.toLowerCase()){case"s":return 1e3*i.number;case"ms":return i.number}throw new Error("Unsupported time type")}},uh={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,i){return ut(i)?i.number:1}},ph={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fh={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,i){return i.filter(hA).map(function(a){switch(a.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(a){return a!==0})}},mh={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,i){var a=[],s=[];return i.forEach(function(h){switch(h.type){case 20:case 0:a.push(h.value);break;case 17:a.push(h.number.toString());break;case 4:s.push(a.join(" ")),a.length=0;break}}),a.length&&s.push(a.join(" ")),s.map(function(h){return h.indexOf(" ")===-1?h:"'"+h+"'"})}},Bh={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},wh={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,i){if(ut(i))return i.number;if(hA(i))switch(i.value){case"bold":return 700;case"normal":default:return 400}return 400}},Ch={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,i){return i.filter(hA).map(function(a){return a.value})}},vh={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,i){switch(i){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},HA=function(r,i){return(r&i)!==0},Fh={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,i){if(i.length===0)return[];var a=i[0];return a.type===20&&a.value==="none"?[]:i}},Qh={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,i){if(i.length===0)return null;var a=i[0];if(a.type===20&&a.value==="none")return null;for(var s=[],h=i.filter(Rn),g=0;g<h.length;g++){var f=h[g],C=h[g+1];if(f.type===20){var w=C&&ut(C)?C.number:1;s.push({counter:f.value,increment:w})}}return s}},yh={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,i){if(i.length===0)return[];for(var a=[],s=i.filter(Rn),h=0;h<s.length;h++){var g=s[h],f=s[h+1];if(hA(g)&&g.value!=="none"){var C=f&&ut(f)?f.number:0;a.push({counter:g.value,reset:C})}}return a}},Eh={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,i){return i.filter(Jt).map(function(a){return oa.parse(r,a)})}},Uh={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,i){if(i.length===0)return null;var a=i[0];if(a.type===20&&a.value==="none")return null;var s=[],h=i.filter(zl);if(h.length%2!==0)return null;for(var g=0;g<h.length;g+=2){var f=h[g].value,C=h[g+1].value;s.push({open:f,close:C})}return s}},la=function(r,i,a){if(!r)return"";var s=r[Math.min(i,r.length-1)];return s?a?s.open:s.close:""},Sh={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,i){return i.length===1&&ps(i[0],"none")?[]:Qe(i).map(function(a){for(var s={color:255,offsetX:RA,offsetY:RA,blur:RA,spread:RA,inset:!1},h=0,g=0;g<a.length;g++){var f=a[g];ps(f,"inset")?s.inset=!0:Ge(f)?(h===0?s.offsetX=f:h===1?s.offsetY=f:h===2?s.blur=f:s.spread=f,h++):s.color=Ne.parse(r,f)}return s})}},Ih={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,i){var a=[0,1,2],s=[];return i.filter(hA).forEach(function(h){switch(h.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2);break}}),a.forEach(function(h){s.indexOf(h)===-1&&s.push(h)}),s}},Hh={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},bh={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,i){return Jt(i)?i.number:0}},xh=function(){function r(i,a){var s,h;this.animationDuration=G(i,Eh,a.animationDuration),this.backgroundClip=G(i,ec,a.backgroundClip),this.backgroundColor=G(i,tc,a.backgroundColor),this.backgroundImage=G(i,dc,a.backgroundImage),this.backgroundOrigin=G(i,gc,a.backgroundOrigin),this.backgroundPosition=G(i,uc,a.backgroundPosition),this.backgroundRepeat=G(i,pc,a.backgroundRepeat),this.backgroundSize=G(i,mc,a.backgroundSize),this.borderTopColor=G(i,wc,a.borderTopColor),this.borderRightColor=G(i,Cc,a.borderRightColor),this.borderBottomColor=G(i,vc,a.borderBottomColor),this.borderLeftColor=G(i,Fc,a.borderLeftColor),this.borderTopLeftRadius=G(i,Qc,a.borderTopLeftRadius),this.borderTopRightRadius=G(i,yc,a.borderTopRightRadius),this.borderBottomRightRadius=G(i,Ec,a.borderBottomRightRadius),this.borderBottomLeftRadius=G(i,Uc,a.borderBottomLeftRadius),this.borderTopStyle=G(i,Sc,a.borderTopStyle),this.borderRightStyle=G(i,Ic,a.borderRightStyle),this.borderBottomStyle=G(i,Hc,a.borderBottomStyle),this.borderLeftStyle=G(i,bc,a.borderLeftStyle),this.borderTopWidth=G(i,xc,a.borderTopWidth),this.borderRightWidth=G(i,Mc,a.borderRightWidth),this.borderBottomWidth=G(i,Lc,a.borderBottomWidth),this.borderLeftWidth=G(i,Tc,a.borderLeftWidth),this.boxShadow=G(i,Sh,a.boxShadow),this.color=G(i,Dc,a.color),this.direction=G(i,Pc,a.direction),this.display=G(i,Kc,a.display),this.float=G(i,kc,a.cssFloat),this.fontFamily=G(i,mh,a.fontFamily),this.fontSize=G(i,Bh,a.fontSize),this.fontStyle=G(i,vh,a.fontStyle),this.fontVariant=G(i,Ch,a.fontVariant),this.fontWeight=G(i,wh,a.fontWeight),this.letterSpacing=G(i,Gc,a.letterSpacing),this.lineBreak=G(i,Oc,a.lineBreak),this.lineHeight=G(i,Nc,a.lineHeight),this.listStyleImage=G(i,Vc,a.listStyleImage),this.listStylePosition=G(i,_c,a.listStylePosition),this.listStyleType=G(i,ws,a.listStyleType),this.marginTop=G(i,Xc,a.marginTop),this.marginRight=G(i,Jc,a.marginRight),this.marginBottom=G(i,Yc,a.marginBottom),this.marginLeft=G(i,Wc,a.marginLeft),this.opacity=G(i,uh,a.opacity);var g=G(i,$c,a.overflow);this.overflowX=g[0],this.overflowY=g[g.length>1?1:0],this.overflowWrap=G(i,qc,a.overflowWrap),this.paddingTop=G(i,Zc,a.paddingTop),this.paddingRight=G(i,zc,a.paddingRight),this.paddingBottom=G(i,jc,a.paddingBottom),this.paddingLeft=G(i,Ah,a.paddingLeft),this.paintOrder=G(i,Ih,a.paintOrder),this.position=G(i,th,a.position),this.textAlign=G(i,eh,a.textAlign),this.textDecorationColor=G(i,ph,(s=a.textDecorationColor)!==null&&s!==void 0?s:a.color),this.textDecorationLine=G(i,fh,(h=a.textDecorationLine)!==null&&h!==void 0?h:a.textDecoration),this.textShadow=G(i,ih,a.textShadow),this.textTransform=G(i,rh,a.textTransform),this.transform=G(i,sh,a.transform),this.transformOrigin=G(i,ch,a.transformOrigin),this.visibility=G(i,hh,a.visibility),this.webkitTextStrokeColor=G(i,Hh,a.webkitTextStrokeColor),this.webkitTextStrokeWidth=G(i,bh,a.webkitTextStrokeWidth),this.wordBreak=G(i,dh,a.wordBreak),this.zIndex=G(i,gh,a.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return Ve(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return HA(this.display,4)||HA(this.display,33554432)||HA(this.display,268435456)||HA(this.display,536870912)||HA(this.display,67108864)||HA(this.display,134217728)},r}(),Mh=function(){function r(i,a){this.content=G(i,Fh,a.content),this.quotes=G(i,Uh,a.quotes)}return r}(),ca=function(){function r(i,a){this.counterIncrement=G(i,Qh,a.counterIncrement),this.counterReset=G(i,yh,a.counterReset)}return r}(),G=function(r,i,a){var s=new Pn,h=a!==null&&typeof a!="undefined"?a.toString():i.initialValue;s.write(h);var g=new Kn(s.read());switch(i.type){case 2:var f=g.parseComponentValue();return i.parse(r,hA(f)?f.value:i.initialValue);case 0:return i.parse(r,g.parseComponentValue());case 1:return i.parse(r,g.parseComponentValues());case 4:return g.parseComponentValue();case 3:switch(i.format){case"angle":return Mi.parse(r,g.parseComponentValue());case"color":return Ne.parse(r,g.parseComponentValue());case"image":return Bs.parse(r,g.parseComponentValue());case"length":var C=g.parseComponentValue();return Ge(C)?C:RA;case"length-percentage":var w=g.parseComponentValue();return QA(w)?w:RA;case"time":return oa.parse(r,g.parseComponentValue())}break}},Lh="data-html2canvas-debug",Th=function(r){var i=r.getAttribute(Lh);switch(i){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Cs=function(r,i){var a=Th(r);return a===1||i===a},ye=function(){function r(i,a){if(this.context=i,this.textNodes=[],this.elements=[],this.flags=0,Cs(a,3))debugger;this.styles=new xh(i,window.getComputedStyle(a,null)),Ts(a)&&(this.styles.animationDuration.some(function(s){return s>0})&&(a.style.animationDuration="0s"),this.styles.transform!==null&&(a.style.transform="none")),this.bounds=c(this.context,a),Cs(a,4)&&(this.flags|=16)}return r}(),Dh="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qt=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),Vi=0;Vi<ha.length;Vi++)qt[ha.charCodeAt(Vi)]=Vi;for(var Ph=function(r){var i=r.length*.75,a=r.length,s,h=0,g,f,C,w;r[r.length-1]==="="&&(i--,r[r.length-2]==="="&&i--);var y=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined"&&typeof Uint8Array.prototype.slice!="undefined"?new ArrayBuffer(i):new Array(i),S=Array.isArray(y)?y:new Uint8Array(y);for(s=0;s<a;s+=4)g=qt[r.charCodeAt(s)],f=qt[r.charCodeAt(s+1)],C=qt[r.charCodeAt(s+2)],w=qt[r.charCodeAt(s+3)],S[h++]=g<<2|f>>4,S[h++]=(f&15)<<4|C>>2,S[h++]=(C&3)<<6|w&63;return y},Kh=function(r){for(var i=r.length,a=[],s=0;s<i;s+=2)a.push(r[s+1]<<8|r[s]);return a},Rh=function(r){for(var i=r.length,a=[],s=0;s<i;s+=4)a.push(r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s]);return a},rt=5,vs=11,Fs=2,kh=vs-rt,da=65536>>rt,Gh=1<<rt,Qs=Gh-1,Oh=1024>>rt,Nh=da+Oh,Vh=Nh,_h=32,Xh=Vh+_h,Jh=65536>>vs,Yh=1<<kh,Wh=Yh-1,ga=function(r,i,a){return r.slice?r.slice(i,a):new Uint16Array(Array.prototype.slice.call(r,i,a))},$h=function(r,i,a){return r.slice?r.slice(i,a):new Uint32Array(Array.prototype.slice.call(r,i,a))},qh=function(r,i){var a=Ph(r),s=Array.isArray(a)?Rh(a):new Uint32Array(a),h=Array.isArray(a)?Kh(a):new Uint16Array(a),g=24,f=ga(h,g/2,s[4]/2),C=s[5]===2?ga(h,(g+s[4])/2):$h(s,Math.ceil((g+s[4])/4));return new Zh(s[0],s[1],s[2],s[3],f,C)},Zh=function(){function r(i,a,s,h,g,f){this.initialValue=i,this.errorValue=a,this.highStart=s,this.highValueIndex=h,this.index=g,this.data=f}return r.prototype.get=function(i){var a;if(i>=0){if(i<55296||i>56319&&i<=65535)return a=this.index[i>>rt],a=(a<<Fs)+(i&Qs),this.data[a];if(i<=65535)return a=this.index[da+(i-55296>>rt)],a=(a<<Fs)+(i&Qs),this.data[a];if(i<this.highStart)return a=Xh-Jh+(i>>vs),a=this.index[a],a+=i>>rt&Wh,a=this.index[a],a=(a<<Fs)+(i&Qs),this.data[a];if(i<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zh=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),_i=0;_i<ua.length;_i++)zh[ua.charCodeAt(_i)]=_i;var jh=1,ys=2,Es=3,pa=4,fa=5,Ad=7,ma=8,Us=9,Ss=10,Ba=11,wa=12,Ca=13,va=14,Is=15,ed=function(r){for(var i=[],a=0,s=r.length;a<s;){var h=r.charCodeAt(a++);if(h>=55296&&h<=56319&&a<s){var g=r.charCodeAt(a++);(g&64512)===56320?i.push(((h&1023)<<10)+(g&1023)+65536):(i.push(h),a--)}else i.push(h)}return i},td=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var a=r.length;if(!a)return"";for(var s=[],h=-1,g="";++h<a;){var f=r[h];f<=65535?s.push(f):(f-=65536,s.push((f>>10)+55296,f%1024+56320)),(h+1===a||s.length>16384)&&(g+=String.fromCharCode.apply(String,s),s.length=0)}return g},id=qh(Dh),he="\xD7",Hs="\xF7",rd=function(r){return id.get(r)},sd=function(r,i,a){var s=a-2,h=i[s],g=i[a-1],f=i[a];if(g===ys&&f===Es)return he;if(g===ys||g===Es||g===pa||f===ys||f===Es||f===pa)return Hs;if(g===ma&&[ma,Us,Ba,wa].indexOf(f)!==-1||(g===Ba||g===Us)&&(f===Us||f===Ss)||(g===wa||g===Ss)&&f===Ss||f===Ca||f===fa||f===Ad||g===jh)return he;if(g===Ca&&f===va){for(;h===fa;)h=i[--s];if(h===va)return he}if(g===Is&&f===Is){for(var C=0;h===Is;)C++,h=i[--s];if(C%2===0)return he}return Hs},nd=function(r){var i=ed(r),a=i.length,s=0,h=0,g=i.map(rd);return{next:function(){if(s>=a)return{done:!0,value:null};for(var f=he;s<a&&(f=sd(i,g,++s))===he;);if(f!==he||s===a){var C=td.apply(null,i.slice(h,s));return h=s,{value:C,done:!1}}return{done:!0,value:null}}}},ad=function(r){for(var i=nd(r),a=[],s;!(s=i.next()).done;)s.value&&a.push(s.value.slice());return a},od=function(r){var i=123;if(r.createRange){var a=r.createRange();if(a.getBoundingClientRect){var s=r.createElement("boundtest");s.style.height=i+"px",s.style.display="block",r.body.appendChild(s),a.selectNode(s);var h=a.getBoundingClientRect(),g=Math.round(h.height);if(r.body.removeChild(s),g===i)return!0}}return!1},ld=function(r){var i=r.createElement("boundtest");i.style.width="50px",i.style.display="block",i.style.fontSize="12px",i.style.letterSpacing="0px",i.style.wordSpacing="0px",r.body.appendChild(i);var a=r.createRange();i.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var s=i.firstChild,h=u(s.data).map(function(w){return p(w)}),g=0,f={},C=h.every(function(w,y){a.setStart(s,g),a.setEnd(s,g+w.length);var S=a.getBoundingClientRect();g+=w.length;var I=S.x>f.x||S.y>f.y;return f=S,y===0?!0:I});return r.body.removeChild(i),C},cd=function(){return typeof new Image().crossOrigin!="undefined"},hd=function(){return typeof new XMLHttpRequest().responseType=="string"},dd=function(r){var i=new Image,a=r.createElement("canvas"),s=a.getContext("2d");if(!s)return!1;i.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{s.drawImage(i,0,0),a.toDataURL()}catch(h){return!1}return!0},Fa=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},gd=function(r){var i=r.createElement("canvas"),a=100;i.width=a,i.height=a;var s=i.getContext("2d");if(!s)return Promise.reject(!1);s.fillStyle="rgb(0, 255, 0)",s.fillRect(0,0,a,a);var h=new Image,g=i.toDataURL();h.src=g;var f=bs(a,a,0,0,h);return s.fillStyle="red",s.fillRect(0,0,a,a),Qa(f).then(function(C){s.drawImage(C,0,0);var w=s.getImageData(0,0,a,a).data;s.fillStyle="red",s.fillRect(0,0,a,a);var y=r.createElement("div");return y.style.backgroundImage="url("+g+")",y.style.height=a+"px",Fa(w)?Qa(bs(a,a,0,0,y)):Promise.reject(!1)}).then(function(C){return s.drawImage(C,0,0),Fa(s.getImageData(0,0,a,a).data)}).catch(function(){return!1})},bs=function(r,i,a,s,h){var g="http://www.w3.org/2000/svg",f=document.createElementNS(g,"svg"),C=document.createElementNS(g,"foreignObject");return f.setAttributeNS(null,"width",r.toString()),f.setAttributeNS(null,"height",i.toString()),C.setAttributeNS(null,"width","100%"),C.setAttributeNS(null,"height","100%"),C.setAttributeNS(null,"x",a.toString()),C.setAttributeNS(null,"y",s.toString()),C.setAttributeNS(null,"externalResourcesRequired","true"),f.appendChild(C),C.appendChild(h),f},Qa=function(r){return new Promise(function(i,a){var s=new Image;s.onload=function(){return i(s)},s.onerror=a,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},kA={get SUPPORT_RANGE_BOUNDS(){var r=od(document);return Object.defineProperty(kA,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=kA.SUPPORT_RANGE_BOUNDS&&ld(document);return Object.defineProperty(kA,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=dd(document);return Object.defineProperty(kA,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?gd(document):Promise.resolve(!1);return Object.defineProperty(kA,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=cd();return Object.defineProperty(kA,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=hd();return Object.defineProperty(kA,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(kA,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl!="undefined"&&Intl.Segmenter);return Object.defineProperty(kA,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},Zt=function(){function r(i,a){this.text=i,this.bounds=a}return r}(),ud=function(r,i,a,s){var h=md(i,a),g=[],f=0;return h.forEach(function(C){if(a.textDecorationLine.length||C.trim().length>0)if(kA.SUPPORT_RANGE_BOUNDS){var w=ya(s,f,C.length).getClientRects();if(w.length>1){var y=xs(C),S=0;y.forEach(function(b){g.push(new Zt(b,l.fromDOMRectList(r,ya(s,S+f,b.length).getClientRects()))),S+=b.length})}else g.push(new Zt(C,l.fromDOMRectList(r,w)))}else{var I=s.splitText(C.length);g.push(new Zt(C,pd(r,s))),s=I}else kA.SUPPORT_RANGE_BOUNDS||(s=s.splitText(C.length));f+=C.length}),g},pd=function(r,i){var a=i.ownerDocument;if(a){var s=a.createElement("html2canvaswrapper");s.appendChild(i.cloneNode(!0));var h=i.parentNode;if(h){h.replaceChild(s,i);var g=c(r,s);return s.firstChild&&h.replaceChild(s.firstChild,s),g}}return l.EMPTY},ya=function(r,i,a){var s=r.ownerDocument;if(!s)throw new Error("Node has no owner document");var h=s.createRange();return h.setStart(r,i),h.setEnd(r,i+a),h},xs=function(r){if(kA.SUPPORT_NATIVE_TEXT_SEGMENTATION){var i=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(i.segment(r)).map(function(a){return a.segment})}return ad(r)},fd=function(r,i){if(kA.SUPPORT_NATIVE_TEXT_SEGMENTATION){var a=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(a.segment(r)).map(function(s){return s.segment})}return wd(r,i)},md=function(r,i){return i.letterSpacing!==0?xs(r):fd(r,i)},Bd=[32,160,4961,65792,65793,4153,4241],wd=function(r,i){for(var a=Jo(r,{lineBreak:i.lineBreak,wordBreak:i.overflowWrap==="break-word"?"break-word":i.wordBreak}),s=[],h,g=function(){if(h.value){var f=h.value.slice(),C=u(f),w="";C.forEach(function(y){Bd.indexOf(y)===-1?w+=p(y):(w.length&&s.push(w),s.push(p(y)),w="")}),w.length&&s.push(w)}};!(h=a.next()).done;)g();return s},Cd=function(){function r(i,a,s){this.text=vd(a.data,s.textTransform),this.textBounds=ud(i,this.text,s,a)}return r}(),vd=function(r,i){switch(i){case 1:return r.toLowerCase();case 3:return r.replace(Fd,Qd);case 2:return r.toUpperCase();default:return r}},Fd=/(^|\s|:|-|\(|\))([a-z])/g,Qd=function(r,i,a){return r.length>0?i+a.toUpperCase():r},Ea=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.src=s.currentSrc||s.src,h.intrinsicWidth=s.naturalWidth,h.intrinsicHeight=s.naturalHeight,h.context.cache.addImage(h.src),h}return i}(ye),Ua=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.canvas=s,h.intrinsicWidth=s.width,h.intrinsicHeight=s.height,h}return i}(ye),Sa=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this,g=new XMLSerializer,f=c(a,s);return s.setAttribute("width",f.width+"px"),s.setAttribute("height",f.height+"px"),h.svg="data:image/svg+xml,"+encodeURIComponent(g.serializeToString(s)),h.intrinsicWidth=s.width.baseVal.value,h.intrinsicHeight=s.height.baseVal.value,h.context.cache.addImage(h.svg),h}return i}(ye),Ia=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.value=s.value,h}return i}(ye),Ms=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.start=s.start,h.reversed=typeof s.reversed=="boolean"&&s.reversed===!0,h}return i}(ye),yd=[{type:15,flags:0,unit:"px",number:3}],Ed=[{type:16,flags:0,number:50}],Ud=function(r){return r.width>r.height?new l(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new l(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},Sd=function(r){var i=r.type===Id?new Array(r.value.length+1).join("\u2022"):r.value;return i.length===0?r.placeholder||"":i},Xi="checkbox",Ji="radio",Id="password",Ha=707406591,Ls=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;switch(h.type=s.type.toLowerCase(),h.checked=s.checked,h.value=Sd(s),(h.type===Xi||h.type===Ji)&&(h.styles.backgroundColor=3739148031,h.styles.borderTopColor=h.styles.borderRightColor=h.styles.borderBottomColor=h.styles.borderLeftColor=2779096575,h.styles.borderTopWidth=h.styles.borderRightWidth=h.styles.borderBottomWidth=h.styles.borderLeftWidth=1,h.styles.borderTopStyle=h.styles.borderRightStyle=h.styles.borderBottomStyle=h.styles.borderLeftStyle=1,h.styles.backgroundClip=[0],h.styles.backgroundOrigin=[0],h.bounds=Ud(h.bounds)),h.type){case Xi:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=yd;break;case Ji:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=Ed;break}return h}return i}(ye),ba=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this,g=s.options[s.selectedIndex||0];return h.value=g&&g.text||"",h}return i}(ye),xa=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.value=s.value,h}return i}(ye),Ma=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;h.src=s.src,h.width=parseInt(s.width,10)||0,h.height=parseInt(s.height,10)||0,h.backgroundColor=h.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){h.tree=Ta(a,s.contentWindow.document.documentElement);var g=s.contentWindow.document.documentElement?Wt(a,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):He.TRANSPARENT,f=s.contentWindow.document.body?Wt(a,getComputedStyle(s.contentWindow.document.body).backgroundColor):He.TRANSPARENT;h.backgroundColor=Ve(g)?Ve(f)?h.styles.backgroundColor:f:g}}catch(C){}return h}return i}(ye),Hd=["OL","UL","MENU"],Yi=function(r,i,a,s){for(var h=i.firstChild,g=void 0;h;h=g)if(g=h.nextSibling,Da(h)&&h.data.trim().length>0)a.textNodes.push(new Cd(r,h,a.styles));else if(mt(h))if(Oa(h)&&h.assignedNodes)h.assignedNodes().forEach(function(C){return Yi(r,C,a,s)});else{var f=La(r,h);f.styles.isVisible()&&(bd(h,f,s)?f.flags|=4:xd(f.styles)&&(f.flags|=2),Hd.indexOf(h.tagName)!==-1&&(f.flags|=8),a.elements.push(f),h.slot,h.shadowRoot?Yi(r,h.shadowRoot,f,s):!$i(h)&&!Pa(h)&&!qi(h)&&Yi(r,h,f,s))}},La=function(r,i){return Ps(i)?new Ea(r,i):Ka(i)?new Ua(r,i):Pa(i)?new Sa(r,i):Md(i)?new Ia(r,i):Ld(i)?new Ms(r,i):Td(i)?new Ls(r,i):qi(i)?new ba(r,i):$i(i)?new xa(r,i):ka(i)?new Ma(r,i):new ye(r,i)},Ta=function(r,i){var a=La(r,i);return a.flags|=4,Yi(r,i,a,a),a},bd=function(r,i,a){return i.styles.isPositionedWithZIndex()||i.styles.opacity<1||i.styles.isTransformed()||Ds(r)&&a.styles.isTransparent()},xd=function(r){return r.isPositioned()||r.isFloating()},Da=function(r){return r.nodeType===Node.TEXT_NODE},mt=function(r){return r.nodeType===Node.ELEMENT_NODE},Ts=function(r){return mt(r)&&typeof r.style!="undefined"&&!Wi(r)},Wi=function(r){return typeof r.className=="object"},Md=function(r){return r.tagName==="LI"},Ld=function(r){return r.tagName==="OL"},Td=function(r){return r.tagName==="INPUT"},Dd=function(r){return r.tagName==="HTML"},Pa=function(r){return r.tagName==="svg"},Ds=function(r){return r.tagName==="BODY"},Ka=function(r){return r.tagName==="CANVAS"},Ra=function(r){return r.tagName==="VIDEO"},Ps=function(r){return r.tagName==="IMG"},ka=function(r){return r.tagName==="IFRAME"},Ga=function(r){return r.tagName==="STYLE"},Pd=function(r){return r.tagName==="SCRIPT"},$i=function(r){return r.tagName==="TEXTAREA"},qi=function(r){return r.tagName==="SELECT"},Oa=function(r){return r.tagName==="SLOT"},Na=function(r){return r.tagName.indexOf("-")>0},Kd=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(i){var a=this.counters[i];return a&&a.length?a[a.length-1]:1},r.prototype.getCounterValues=function(i){var a=this.counters[i];return a||[]},r.prototype.pop=function(i){var a=this;i.forEach(function(s){return a.counters[s].pop()})},r.prototype.parse=function(i){var a=this,s=i.counterIncrement,h=i.counterReset,g=!0;s!==null&&s.forEach(function(C){var w=a.counters[C.counter];w&&C.increment!==0&&(g=!1,w.length||w.push(1),w[Math.max(0,w.length-1)]+=C.increment)});var f=[];return g&&h.forEach(function(C){var w=a.counters[C.counter];f.push(C.counter),w||(w=a.counters[C.counter]=[]),w.push(C.reset)}),f},r}(),Va={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},_a={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},Rd={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},kd={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Bt=function(r,i,a,s,h,g){return r<i||r>a?jt(r,h,g.length>0):s.integers.reduce(function(f,C,w){for(;r>=C;)r-=C,f+=s.values[w];return f},"")+g},Xa=function(r,i,a,s){var h="";do a||r--,h=s(r)+h,r/=i;while(r*i>=i);return h},vA=function(r,i,a,s,h){var g=a-i+1;return(r<0?"-":"")+(Xa(Math.abs(r),g,s,function(f){return p(Math.floor(f%g)+i)})+h)},st=function(r,i,a){a===void 0&&(a=". ");var s=i.length;return Xa(Math.abs(r),s,!1,function(h){return i[Math.floor(h%s)]})+a},wt=1,Xe=2,Je=4,zt=8,be=function(r,i,a,s,h,g){if(r<-9999||r>9999)return jt(r,4,h.length>0);var f=Math.abs(r),C=h;if(f===0)return i[0]+C;for(var w=0;f>0&&w<=4;w++){var y=f%10;y===0&&HA(g,wt)&&C!==""?C=i[y]+C:y>1||y===1&&w===0||y===1&&w===1&&HA(g,Xe)||y===1&&w===1&&HA(g,Je)&&r>100||y===1&&w>1&&HA(g,zt)?C=i[y]+(w>0?a[w-1]:"")+C:y===1&&w>0&&(C=a[w-1]+C),f=Math.floor(f/10)}return(r<0?s:"")+C},Ja="\u5341\u767E\u5343\u842C",Ya="\u62FE\u4F70\u4EDF\u842C",Wa="\u30DE\u30A4\u30CA\u30B9",Ks="\uB9C8\uC774\uB108\uC2A4",jt=function(r,i,a){var s=a?". ":"",h=a?"\u3001":"",g=a?", ":"",f=a?" ":"";switch(i){case 0:return"\u2022"+f;case 1:return"\u25E6"+f;case 2:return"\u25FE"+f;case 5:var C=vA(r,48,57,!0,s);return C.length<4?"0"+C:C;case 4:return st(r,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",h);case 6:return Bt(r,1,3999,Va,3,s).toLowerCase();case 7:return Bt(r,1,3999,Va,3,s);case 8:return vA(r,945,969,!1,s);case 9:return vA(r,97,122,!1,s);case 10:return vA(r,65,90,!1,s);case 11:return vA(r,1632,1641,!0,s);case 12:case 49:return Bt(r,1,9999,_a,3,s);case 35:return Bt(r,1,9999,_a,3,s).toLowerCase();case 13:return vA(r,2534,2543,!0,s);case 14:case 30:return vA(r,6112,6121,!0,s);case 15:return st(r,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",h);case 16:return st(r,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",h);case 17:case 48:return be(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ja,"\u8CA0",h,Xe|Je|zt);case 47:return be(r,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",Ya,"\u8CA0",h,wt|Xe|Je|zt);case 42:return be(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ja,"\u8D1F",h,Xe|Je|zt);case 41:return be(r,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",Ya,"\u8D1F",h,wt|Xe|Je|zt);case 26:return be(r,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",Wa,h,0);case 25:return be(r,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",Wa,h,wt|Xe|Je);case 31:return be(r,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",Ks,g,wt|Xe|Je);case 33:return be(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",Ks,g,0);case 32:return be(r,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",Ks,g,wt|Xe|Je);case 18:return vA(r,2406,2415,!0,s);case 20:return Bt(r,1,19999,kd,3,s);case 21:return vA(r,2790,2799,!0,s);case 22:return vA(r,2662,2671,!0,s);case 22:return Bt(r,1,10999,Rd,3,s);case 23:return st(r,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return st(r,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return vA(r,3302,3311,!0,s);case 28:return st(r,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",h);case 29:return st(r,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",h);case 34:return vA(r,3792,3801,!0,s);case 37:return vA(r,6160,6169,!0,s);case 38:return vA(r,4160,4169,!0,s);case 39:return vA(r,2918,2927,!0,s);case 40:return vA(r,1776,1785,!0,s);case 43:return vA(r,3046,3055,!0,s);case 44:return vA(r,3174,3183,!0,s);case 45:return vA(r,3664,3673,!0,s);case 46:return vA(r,3872,3881,!0,s);case 3:default:return vA(r,48,57,!0,s)}},$a="data-html2canvas-ignore",qa=function(){function r(i,a,s){if(this.context=i,this.options=s,this.scrolledElements=[],this.referenceElement=a,this.counters=new Kd,this.quoteDepth=0,!a.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(a.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(i,a){var s=this,h=Gd(i,a);if(!h.contentWindow)return Promise.reject("Unable to find iframe window");var g=i.defaultView.pageXOffset,f=i.defaultView.pageYOffset,C=h.contentWindow,w=C.document,y=Vd(h).then(function(){return t(s,void 0,void 0,function(){var S,I;return n(this,function(b){switch(b.label){case 0:return this.scrolledElements.forEach(Yd),C&&(C.scrollTo(a.left,a.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(C.scrollY!==a.top||C.scrollX!==a.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(C.scrollX-a.left,C.scrollY-a.top,0,0))),S=this.options.onclone,I=this.clonedReferenceElement,typeof I=="undefined"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:w.fonts&&w.fonts.ready?[4,w.fonts.ready]:[3,2];case 1:b.sent(),b.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Nd(w)]:[3,4];case 3:b.sent(),b.label=4;case 4:return typeof S=="function"?[2,Promise.resolve().then(function(){return S(w,I)}).then(function(){return h})]:[2,h]}})})});return w.open(),w.write(Xd(document.doctype)+"<html></html>"),Jd(this.referenceElement.ownerDocument,g,f),w.replaceChild(w.adoptNode(this.documentElement),w.documentElement),w.close(),y},r.prototype.createElementClone=function(i){if(Cs(i,2))debugger;if(Ka(i))return this.createCanvasClone(i);if(Ra(i))return this.createVideoClone(i);if(Ga(i))return this.createStyleClone(i);var a=i.cloneNode(!1);return Ps(a)&&(Ps(i)&&i.currentSrc&&i.currentSrc!==i.src&&(a.src=i.currentSrc,a.srcset=""),a.loading==="lazy"&&(a.loading="eager")),Na(a)?this.createCustomElementClone(a):a},r.prototype.createCustomElementClone=function(i){var a=document.createElement("html2canvascustomelement");return Rs(i.style,a),a},r.prototype.createStyleClone=function(i){try{var a=i.sheet;if(a&&a.cssRules){var s=[].slice.call(a.cssRules,0).reduce(function(g,f){return f&&typeof f.cssText=="string"?g+f.cssText:g},""),h=i.cloneNode(!1);return h.textContent=s,h}}catch(g){if(this.context.logger.error("Unable to access cssRules property",g),g.name!=="SecurityError")throw g}return i.cloneNode(!1)},r.prototype.createCanvasClone=function(i){var a;if(this.options.inlineImages&&i.ownerDocument){var s=i.ownerDocument.createElement("img");try{return s.src=i.toDataURL(),s}catch(y){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",i)}}var h=i.cloneNode(!1);try{h.width=i.width,h.height=i.height;var g=i.getContext("2d"),f=h.getContext("2d");if(f)if(!this.options.allowTaint&&g)f.putImageData(g.getImageData(0,0,i.width,i.height),0,0);else{var C=(a=i.getContext("webgl2"))!==null&&a!==void 0?a:i.getContext("webgl");if(C){var w=C.getContextAttributes();(w==null?void 0:w.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",i)}f.drawImage(i,0,0)}return h}catch(y){this.context.logger.info("Unable to clone canvas as it is tainted",i)}return h},r.prototype.createVideoClone=function(i){var a=i.ownerDocument.createElement("canvas");a.width=i.offsetWidth,a.height=i.offsetHeight;var s=a.getContext("2d");try{return s&&(s.drawImage(i,0,0,a.width,a.height),this.options.allowTaint||s.getImageData(0,0,a.width,a.height)),a}catch(g){this.context.logger.info("Unable to clone video as it is tainted",i)}var h=i.ownerDocument.createElement("canvas");return h.width=i.offsetWidth,h.height=i.offsetHeight,h},r.prototype.appendChildNode=function(i,a,s){(!mt(a)||!Pd(a)&&!a.hasAttribute($a)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(a)))&&(!this.options.copyStyles||!mt(a)||!Ga(a))&&i.appendChild(this.cloneNode(a,s))},r.prototype.cloneChildNodes=function(i,a,s){for(var h=this,g=i.shadowRoot?i.shadowRoot.firstChild:i.firstChild;g;g=g.nextSibling)if(mt(g)&&Oa(g)&&typeof g.assignedNodes=="function"){var f=g.assignedNodes();f.length&&f.forEach(function(C){return h.appendChildNode(a,C,s)})}else this.appendChildNode(a,g,s)},r.prototype.cloneNode=function(i,a){if(Da(i))return document.createTextNode(i.data);if(!i.ownerDocument)return i.cloneNode(!1);var s=i.ownerDocument.defaultView;if(s&&mt(i)&&(Ts(i)||Wi(i))){var h=this.createElementClone(i);h.style.transitionProperty="none";var g=s.getComputedStyle(i),f=s.getComputedStyle(i,":before"),C=s.getComputedStyle(i,":after");this.referenceElement===i&&Ts(h)&&(this.clonedReferenceElement=h),Ds(h)&&qd(h);var w=this.counters.parse(new ca(this.context,g)),y=this.resolvePseudoContent(i,h,f,Ai.BEFORE);Na(i)&&(a=!0),Ra(i)||this.cloneChildNodes(i,h,a),y&&h.insertBefore(y,h.firstChild);var S=this.resolvePseudoContent(i,h,C,Ai.AFTER);return S&&h.appendChild(S),this.counters.pop(w),(g&&(this.options.copyStyles||Wi(i))&&!ka(i)||a)&&Rs(g,h),(i.scrollTop!==0||i.scrollLeft!==0)&&this.scrolledElements.push([h,i.scrollLeft,i.scrollTop]),($i(i)||qi(i))&&($i(h)||qi(h))&&(h.value=i.value),h}return i.cloneNode(!1)},r.prototype.resolvePseudoContent=function(i,a,s,h){var g=this;if(s){var f=s.content,C=a.ownerDocument;if(!(!C||!f||f==="none"||f==="-moz-alt-content"||s.display==="none")){this.counters.parse(new ca(this.context,s));var w=new Mh(this.context,s),y=C.createElement("html2canvaspseudoelement");Rs(s,y),w.content.forEach(function(I){if(I.type===0)y.appendChild(C.createTextNode(I.value));else if(I.type===22){var b=C.createElement("img");b.src=I.value,b.style.opacity="1",y.appendChild(b)}else if(I.type===18){if(I.name==="attr"){var k=I.values.filter(hA);k.length&&y.appendChild(C.createTextNode(i.getAttribute(k[0].value)||""))}else if(I.name==="counter"){var L=I.values.filter(pt),P=L[0],$=L[1];if(P&&hA(P)){var _=g.counters.getCounterValue(P.value),V=$&&hA($)?ws.parse(g.context,$.value):3;y.appendChild(C.createTextNode(jt(_,V,!1)))}}else if(I.name==="counters"){var oA=I.values.filter(pt),P=oA[0],q=oA[1],$=oA[2];if(P&&hA(P)){var Y=g.counters.getCounterValues(P.value),R=$&&hA($)?ws.parse(g.context,$.value):3,rA=q&&q.type===0?q.value:"",sA=Y.map(function(jA){return jt(jA,R,!1)}).join(rA);y.appendChild(C.createTextNode(sA))}}}else if(I.type===20)switch(I.value){case"open-quote":y.appendChild(C.createTextNode(la(w.quotes,g.quoteDepth++,!0)));break;case"close-quote":y.appendChild(C.createTextNode(la(w.quotes,--g.quoteDepth,!1)));break;default:y.appendChild(C.createTextNode(I.value))}}),y.className=ks+" "+Gs;var S=h===Ai.BEFORE?" "+ks:" "+Gs;return Wi(a)?a.className.baseValue+=S:a.className+=S,y}}},r.destroy=function(i){return i.parentNode?(i.parentNode.removeChild(i),!0):!1},r}(),Ai;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(Ai||(Ai={}));var Gd=function(r,i){var a=r.createElement("iframe");return a.className="html2canvas-container",a.style.visibility="hidden",a.style.position="fixed",a.style.left="-10000px",a.style.top="0px",a.style.border="0",a.width=i.width.toString(),a.height=i.height.toString(),a.scrolling="no",a.setAttribute($a,"true"),r.body.appendChild(a),a},Od=function(r){return new Promise(function(i){if(r.complete){i();return}if(!r.src){i();return}r.onload=i,r.onerror=i})},Nd=function(r){return Promise.all([].slice.call(r.images,0).map(Od))},Vd=function(r){return new Promise(function(i,a){var s=r.contentWindow;if(!s)return a("No window assigned for iframe");var h=s.document;s.onload=r.onload=function(){s.onload=r.onload=null;var g=setInterval(function(){h.body.childNodes.length>0&&h.readyState==="complete"&&(clearInterval(g),i(r))},50)}})},_d=["all","d","content"],Rs=function(r,i){for(var a=r.length-1;a>=0;a--){var s=r.item(a);_d.indexOf(s)===-1&&i.style.setProperty(s,r.getPropertyValue(s))}return i},Xd=function(r){var i="";return r&&(i+="<!DOCTYPE ",r.name&&(i+=r.name),r.internalSubset&&(i+=r.internalSubset),r.publicId&&(i+='"'+r.publicId+'"'),r.systemId&&(i+='"'+r.systemId+'"'),i+=">"),i},Jd=function(r,i,a){r&&r.defaultView&&(i!==r.defaultView.pageXOffset||a!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(i,a)},Yd=function(r){var i=r[0],a=r[1],s=r[2];i.scrollLeft=a,i.scrollTop=s},Wd=":before",$d=":after",ks="___html2canvas___pseudoelement_before",Gs="___html2canvas___pseudoelement_after",Za=`{
    content: "" !important;
    display: none !important;
}`,qd=function(r){Zd(r,"."+ks+Wd+Za+`
         .`+Gs+$d+Za)},Zd=function(r,i){var a=r.ownerDocument;if(a){var s=a.createElement("style");s.textContent=i,r.appendChild(s)}},za=function(){function r(){}return r.getOrigin=function(i){var a=r._link;return a?(a.href=i,a.href=a.href,a.protocol+a.hostname+a.port):"about:blank"},r.isSameOrigin=function(i){return r.getOrigin(i)===r._origin},r.setContext=function(i){r._link=i.document.createElement("a"),r._origin=r.getOrigin(i.location.href)},r._origin="about:blank",r}(),zd=function(){function r(i,a){this.context=i,this._options=a,this._cache={}}return r.prototype.addImage=function(i){var a=Promise.resolve();return this.has(i)||(Ns(i)||tg(i))&&(this._cache[i]=this.loadImage(i)).catch(function(){}),a},r.prototype.match=function(i){return this._cache[i]},r.prototype.loadImage=function(i){return t(this,void 0,void 0,function(){var a,s,h,g,f=this;return n(this,function(C){switch(C.label){case 0:return a=za.isSameOrigin(i),s=!Os(i)&&this._options.useCORS===!0&&kA.SUPPORT_CORS_IMAGES&&!a,h=!Os(i)&&!a&&!Ns(i)&&typeof this._options.proxy=="string"&&kA.SUPPORT_CORS_XHR&&!s,!a&&this._options.allowTaint===!1&&!Os(i)&&!Ns(i)&&!h&&!s?[2]:(g=i,h?[4,this.proxy(g)]:[3,2]);case 1:g=C.sent(),C.label=2;case 2:return this.context.logger.debug("Added image "+i.substring(0,256)),[4,new Promise(function(w,y){var S=new Image;S.onload=function(){return w(S)},S.onerror=y,(ig(g)||s)&&(S.crossOrigin="anonymous"),S.src=g,S.complete===!0&&setTimeout(function(){return w(S)},500),f._options.imageTimeout>0&&setTimeout(function(){return y("Timed out ("+f._options.imageTimeout+"ms) loading image")},f._options.imageTimeout)})];case 3:return[2,C.sent()]}})})},r.prototype.has=function(i){return typeof this._cache[i]!="undefined"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(i){var a=this,s=this._options.proxy;if(!s)throw new Error("No proxy defined");var h=i.substring(0,256);return new Promise(function(g,f){var C=kA.SUPPORT_RESPONSE_TYPE?"blob":"text",w=new XMLHttpRequest;w.onload=function(){if(w.status===200)if(C==="text")g(w.response);else{var I=new FileReader;I.addEventListener("load",function(){return g(I.result)},!1),I.addEventListener("error",function(b){return f(b)},!1),I.readAsDataURL(w.response)}else f("Failed to proxy resource "+h+" with status code "+w.status)},w.onerror=f;var y=s.indexOf("?")>-1?"&":"?";if(w.open("GET",""+s+y+"url="+encodeURIComponent(i)+"&responseType="+C),C!=="text"&&w instanceof XMLHttpRequest&&(w.responseType=C),a._options.imageTimeout){var S=a._options.imageTimeout;w.timeout=S,w.ontimeout=function(){return f("Timed out ("+S+"ms) proxying "+h)}}w.send()})},r}(),jd=/^data:image\/svg\+xml/i,Ag=/^data:image\/.*;base64,/i,eg=/^data:image\/.*/i,tg=function(r){return kA.SUPPORT_SVG_DRAWING||!rg(r)},Os=function(r){return eg.test(r)},ig=function(r){return Ag.test(r)},Ns=function(r){return r.substr(0,4)==="blob"},rg=function(r){return r.substr(-3).toLowerCase()==="svg"||jd.test(r)},K=function(){function r(i,a){this.type=0,this.x=i,this.y=a}return r.prototype.add=function(i,a){return new r(this.x+i,this.y+a)},r}(),Ct=function(r,i,a){return new K(r.x+(i.x-r.x)*a,r.y+(i.y-r.y)*a)},Zi=function(){function r(i,a,s,h){this.type=1,this.start=i,this.startControl=a,this.endControl=s,this.end=h}return r.prototype.subdivide=function(i,a){var s=Ct(this.start,this.startControl,i),h=Ct(this.startControl,this.endControl,i),g=Ct(this.endControl,this.end,i),f=Ct(s,h,i),C=Ct(h,g,i),w=Ct(f,C,i);return a?new r(this.start,s,f,w):new r(w,C,g,this.end)},r.prototype.add=function(i,a){return new r(this.start.add(i,a),this.startControl.add(i,a),this.endControl.add(i,a),this.end.add(i,a))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),de=function(r){return r.type===1},sg=function(){function r(i){var a=i.styles,s=i.bounds,h=Yt(a.borderTopLeftRadius,s.width,s.height),g=h[0],f=h[1],C=Yt(a.borderTopRightRadius,s.width,s.height),w=C[0],y=C[1],S=Yt(a.borderBottomRightRadius,s.width,s.height),I=S[0],b=S[1],k=Yt(a.borderBottomLeftRadius,s.width,s.height),L=k[0],P=k[1],$=[];$.push((g+w)/s.width),$.push((L+I)/s.width),$.push((f+P)/s.height),$.push((y+b)/s.height);var _=Math.max.apply(Math,$);_>1&&(g/=_,f/=_,w/=_,y/=_,I/=_,b/=_,L/=_,P/=_);var V=s.width-w,oA=s.height-b,q=s.width-I,Y=s.height-P,R=a.borderTopWidth,rA=a.borderRightWidth,sA=a.borderBottomWidth,W=a.borderLeftWidth,yA=uA(a.paddingTop,i.bounds.width),jA=uA(a.paddingRight,i.bounds.width),ae=uA(a.paddingBottom,i.bounds.width),dA=uA(a.paddingLeft,i.bounds.width);this.topLeftBorderDoubleOuterBox=g>0||f>0?fA(s.left+W/3,s.top+R/3,g-W/3,f-R/3,lA.TOP_LEFT):new K(s.left+W/3,s.top+R/3),this.topRightBorderDoubleOuterBox=g>0||f>0?fA(s.left+V,s.top+R/3,w-rA/3,y-R/3,lA.TOP_RIGHT):new K(s.left+s.width-rA/3,s.top+R/3),this.bottomRightBorderDoubleOuterBox=I>0||b>0?fA(s.left+q,s.top+oA,I-rA/3,b-sA/3,lA.BOTTOM_RIGHT):new K(s.left+s.width-rA/3,s.top+s.height-sA/3),this.bottomLeftBorderDoubleOuterBox=L>0||P>0?fA(s.left+W/3,s.top+Y,L-W/3,P-sA/3,lA.BOTTOM_LEFT):new K(s.left+W/3,s.top+s.height-sA/3),this.topLeftBorderDoubleInnerBox=g>0||f>0?fA(s.left+W*2/3,s.top+R*2/3,g-W*2/3,f-R*2/3,lA.TOP_LEFT):new K(s.left+W*2/3,s.top+R*2/3),this.topRightBorderDoubleInnerBox=g>0||f>0?fA(s.left+V,s.top+R*2/3,w-rA*2/3,y-R*2/3,lA.TOP_RIGHT):new K(s.left+s.width-rA*2/3,s.top+R*2/3),this.bottomRightBorderDoubleInnerBox=I>0||b>0?fA(s.left+q,s.top+oA,I-rA*2/3,b-sA*2/3,lA.BOTTOM_RIGHT):new K(s.left+s.width-rA*2/3,s.top+s.height-sA*2/3),this.bottomLeftBorderDoubleInnerBox=L>0||P>0?fA(s.left+W*2/3,s.top+Y,L-W*2/3,P-sA*2/3,lA.BOTTOM_LEFT):new K(s.left+W*2/3,s.top+s.height-sA*2/3),this.topLeftBorderStroke=g>0||f>0?fA(s.left+W/2,s.top+R/2,g-W/2,f-R/2,lA.TOP_LEFT):new K(s.left+W/2,s.top+R/2),this.topRightBorderStroke=g>0||f>0?fA(s.left+V,s.top+R/2,w-rA/2,y-R/2,lA.TOP_RIGHT):new K(s.left+s.width-rA/2,s.top+R/2),this.bottomRightBorderStroke=I>0||b>0?fA(s.left+q,s.top+oA,I-rA/2,b-sA/2,lA.BOTTOM_RIGHT):new K(s.left+s.width-rA/2,s.top+s.height-sA/2),this.bottomLeftBorderStroke=L>0||P>0?fA(s.left+W/2,s.top+Y,L-W/2,P-sA/2,lA.BOTTOM_LEFT):new K(s.left+W/2,s.top+s.height-sA/2),this.topLeftBorderBox=g>0||f>0?fA(s.left,s.top,g,f,lA.TOP_LEFT):new K(s.left,s.top),this.topRightBorderBox=w>0||y>0?fA(s.left+V,s.top,w,y,lA.TOP_RIGHT):new K(s.left+s.width,s.top),this.bottomRightBorderBox=I>0||b>0?fA(s.left+q,s.top+oA,I,b,lA.BOTTOM_RIGHT):new K(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=L>0||P>0?fA(s.left,s.top+Y,L,P,lA.BOTTOM_LEFT):new K(s.left,s.top+s.height),this.topLeftPaddingBox=g>0||f>0?fA(s.left+W,s.top+R,Math.max(0,g-W),Math.max(0,f-R),lA.TOP_LEFT):new K(s.left+W,s.top+R),this.topRightPaddingBox=w>0||y>0?fA(s.left+Math.min(V,s.width-rA),s.top+R,V>s.width+rA?0:Math.max(0,w-rA),Math.max(0,y-R),lA.TOP_RIGHT):new K(s.left+s.width-rA,s.top+R),this.bottomRightPaddingBox=I>0||b>0?fA(s.left+Math.min(q,s.width-W),s.top+Math.min(oA,s.height-sA),Math.max(0,I-rA),Math.max(0,b-sA),lA.BOTTOM_RIGHT):new K(s.left+s.width-rA,s.top+s.height-sA),this.bottomLeftPaddingBox=L>0||P>0?fA(s.left+W,s.top+Math.min(Y,s.height-sA),Math.max(0,L-W),Math.max(0,P-sA),lA.BOTTOM_LEFT):new K(s.left+W,s.top+s.height-sA),this.topLeftContentBox=g>0||f>0?fA(s.left+W+dA,s.top+R+yA,Math.max(0,g-(W+dA)),Math.max(0,f-(R+yA)),lA.TOP_LEFT):new K(s.left+W+dA,s.top+R+yA),this.topRightContentBox=w>0||y>0?fA(s.left+Math.min(V,s.width+W+dA),s.top+R+yA,V>s.width+W+dA?0:w-W+dA,y-(R+yA),lA.TOP_RIGHT):new K(s.left+s.width-(rA+jA),s.top+R+yA),this.bottomRightContentBox=I>0||b>0?fA(s.left+Math.min(q,s.width-(W+dA)),s.top+Math.min(oA,s.height+R+yA),Math.max(0,I-(rA+jA)),b-(sA+ae),lA.BOTTOM_RIGHT):new K(s.left+s.width-(rA+jA),s.top+s.height-(sA+ae)),this.bottomLeftContentBox=L>0||P>0?fA(s.left+W+dA,s.top+Y,Math.max(0,L-(W+dA)),P-(sA+ae),lA.BOTTOM_LEFT):new K(s.left+W+dA,s.top+s.height-(sA+ae))}return r}(),lA;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(lA||(lA={}));var fA=function(r,i,a,s,h){var g=4*((Math.sqrt(2)-1)/3),f=a*g,C=s*g,w=r+a,y=i+s;switch(h){case lA.TOP_LEFT:return new Zi(new K(r,y),new K(r,y-C),new K(w-f,i),new K(w,i));case lA.TOP_RIGHT:return new Zi(new K(r,i),new K(r+f,i),new K(w,y-C),new K(w,y));case lA.BOTTOM_RIGHT:return new Zi(new K(w,i),new K(w,i+C),new K(r+f,y),new K(r,y));case lA.BOTTOM_LEFT:default:return new Zi(new K(w,y),new K(w-f,y),new K(r,i+C),new K(r,i))}},zi=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},ng=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},ji=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},ag=function(){function r(i,a,s){this.offsetX=i,this.offsetY=a,this.matrix=s,this.type=0,this.target=6}return r}(),Ar=function(){function r(i,a){this.path=i,this.target=a,this.type=1}return r}(),og=function(){function r(i){this.opacity=i,this.type=2,this.target=6}return r}(),lg=function(r){return r.type===0},ja=function(r){return r.type===1},cg=function(r){return r.type===2},Ao=function(r,i){return r.length===i.length?r.some(function(a,s){return a===i[s]}):!1},hg=function(r,i,a,s,h){return r.map(function(g,f){switch(f){case 0:return g.add(i,a);case 1:return g.add(i+s,a);case 2:return g.add(i+s,a+h);case 3:return g.add(i,a+h)}return g})},eo=function(){function r(i){this.element=i,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),to=function(){function r(i,a){if(this.container=i,this.parent=a,this.effects=[],this.curves=new sg(this.container),this.container.styles.opacity<1&&this.effects.push(new og(this.container.styles.opacity)),this.container.styles.transform!==null){var s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,h=this.container.bounds.top+this.container.styles.transformOrigin[1].number,g=this.container.styles.transform;this.effects.push(new ag(s,h,g))}if(this.container.styles.overflowX!==0){var f=zi(this.curves),C=ji(this.curves);Ao(f,C)?this.effects.push(new Ar(f,6)):(this.effects.push(new Ar(f,2)),this.effects.push(new Ar(C,4)))}}return r.prototype.getEffects=function(i){for(var a=[2,3].indexOf(this.container.styles.position)===-1,s=this.parent,h=this.effects.slice(0);s;){var g=s.effects.filter(function(w){return!ja(w)});if(a||s.container.styles.position!==0||!s.parent){if(h.unshift.apply(h,g),a=[2,3].indexOf(s.container.styles.position)===-1,s.container.styles.overflowX!==0){var f=zi(s.curves),C=ji(s.curves);Ao(f,C)||h.unshift(new Ar(C,6))}}else h.unshift.apply(h,g);s=s.parent}return h.filter(function(w){return HA(w.target,i)})},r}(),Vs=function(r,i,a,s){r.container.elements.forEach(function(h){var g=HA(h.flags,4),f=HA(h.flags,2),C=new to(h,r);HA(h.styles.display,2048)&&s.push(C);var w=HA(h.flags,8)?[]:s;if(g||f){var y=g||h.styles.isPositioned()?a:i,S=new eo(C);if(h.styles.isPositioned()||h.styles.opacity<1||h.styles.isTransformed()){var I=h.styles.zIndex.order;if(I<0){var b=0;y.negativeZIndex.some(function(L,P){return I>L.element.container.styles.zIndex.order?(b=P,!1):b>0}),y.negativeZIndex.splice(b,0,S)}else if(I>0){var k=0;y.positiveZIndex.some(function(L,P){return I>=L.element.container.styles.zIndex.order?(k=P+1,!1):k>0}),y.positiveZIndex.splice(k,0,S)}else y.zeroOrAutoZIndexOrTransformedOrOpacity.push(S)}else h.styles.isFloating()?y.nonPositionedFloats.push(S):y.nonPositionedInlineLevel.push(S);Vs(C,S,g?S:a,w)}else h.styles.isInlineLevel()?i.inlineLevel.push(C):i.nonInlineLevel.push(C),Vs(C,i,a,w);HA(h.flags,8)&&io(h,w)})},io=function(r,i){for(var a=r instanceof Ms?r.start:1,s=r instanceof Ms?r.reversed:!1,h=0;h<i.length;h++){var g=i[h];g.container instanceof Ia&&typeof g.container.value=="number"&&g.container.value!==0&&(a=g.container.value),g.listValue=jt(a,g.container.styles.listStyleType,!0),a+=s?-1:1}},dg=function(r){var i=new to(r,null),a=new eo(i),s=[];return Vs(i,a,a,s),io(i.container,s),a},ro=function(r,i){switch(i){case 0:return ge(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return ge(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return ge(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return ge(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},gg=function(r,i){switch(i){case 0:return ge(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return ge(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return ge(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return ge(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},ug=function(r,i){switch(i){case 0:return ge(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return ge(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return ge(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return ge(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},pg=function(r,i){switch(i){case 0:return er(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return er(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return er(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return er(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},er=function(r,i){var a=[];return de(r)?a.push(r.subdivide(.5,!1)):a.push(r),de(i)?a.push(i.subdivide(.5,!0)):a.push(i),a},ge=function(r,i,a,s){var h=[];return de(r)?h.push(r.subdivide(.5,!1)):h.push(r),de(a)?h.push(a.subdivide(.5,!0)):h.push(a),de(s)?h.push(s.subdivide(.5,!0).reverse()):h.push(s),de(i)?h.push(i.subdivide(.5,!1).reverse()):h.push(i),h},so=function(r){var i=r.bounds,a=r.styles;return i.add(a.borderLeftWidth,a.borderTopWidth,-(a.borderRightWidth+a.borderLeftWidth),-(a.borderTopWidth+a.borderBottomWidth))},tr=function(r){var i=r.styles,a=r.bounds,s=uA(i.paddingLeft,a.width),h=uA(i.paddingRight,a.width),g=uA(i.paddingTop,a.width),f=uA(i.paddingBottom,a.width);return a.add(s+i.borderLeftWidth,g+i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth+s+h),-(i.borderTopWidth+i.borderBottomWidth+g+f))},fg=function(r,i){return r===0?i.bounds:r===2?tr(i):so(i)},mg=function(r,i){return r===0?i.bounds:r===2?tr(i):so(i)},_s=function(r,i,a){var s=fg(Ft(r.styles.backgroundOrigin,i),r),h=mg(Ft(r.styles.backgroundClip,i),r),g=Bg(Ft(r.styles.backgroundSize,i),a,s),f=g[0],C=g[1],w=Yt(Ft(r.styles.backgroundPosition,i),s.width-f,s.height-C),y=wg(Ft(r.styles.backgroundRepeat,i),w,g,s,h),S=Math.round(s.left+w[0]),I=Math.round(s.top+w[1]);return[y,S,I,f,C]},vt=function(r){return hA(r)&&r.value===ft.AUTO},ir=function(r){return typeof r=="number"},Bg=function(r,i,a){var s=i[0],h=i[1],g=i[2],f=r[0],C=r[1];if(!f)return[0,0];if(QA(f)&&C&&QA(C))return[uA(f,a.width),uA(C,a.height)];var w=ir(g);if(hA(f)&&(f.value===ft.CONTAIN||f.value===ft.COVER)){if(ir(g)){var y=a.width/a.height;return y<g!=(f.value===ft.COVER)?[a.width,a.width/g]:[a.height*g,a.height]}return[a.width,a.height]}var S=ir(s),I=ir(h),b=S||I;if(vt(f)&&(!C||vt(C))){if(S&&I)return[s,h];if(!w&&!b)return[a.width,a.height];if(b&&w){var k=S?s:h*g,L=I?h:s/g;return[k,L]}var P=S?s:a.width,$=I?h:a.height;return[P,$]}if(w){var _=0,V=0;return QA(f)?_=uA(f,a.width):QA(C)&&(V=uA(C,a.height)),vt(f)?_=V*g:(!C||vt(C))&&(V=_/g),[_,V]}var oA=null,q=null;if(QA(f)?oA=uA(f,a.width):C&&QA(C)&&(q=uA(C,a.height)),oA!==null&&(!C||vt(C))&&(q=S&&I?oA/s*h:a.height),q!==null&&vt(f)&&(oA=S&&I?q/h*s:a.width),oA!==null&&q!==null)return[oA,q];throw new Error("Unable to calculate background-size for element")},Ft=function(r,i){var a=r[i];return typeof a=="undefined"?r[0]:a},wg=function(r,i,a,s,h){var g=i[0],f=i[1],C=a[0],w=a[1];switch(r){case 2:return[new K(Math.round(s.left),Math.round(s.top+f)),new K(Math.round(s.left+s.width),Math.round(s.top+f)),new K(Math.round(s.left+s.width),Math.round(w+s.top+f)),new K(Math.round(s.left),Math.round(w+s.top+f))];case 3:return[new K(Math.round(s.left+g),Math.round(s.top)),new K(Math.round(s.left+g+C),Math.round(s.top)),new K(Math.round(s.left+g+C),Math.round(s.height+s.top)),new K(Math.round(s.left+g),Math.round(s.height+s.top))];case 1:return[new K(Math.round(s.left+g),Math.round(s.top+f)),new K(Math.round(s.left+g+C),Math.round(s.top+f)),new K(Math.round(s.left+g+C),Math.round(s.top+f+w)),new K(Math.round(s.left+g),Math.round(s.top+f+w))];default:return[new K(Math.round(h.left),Math.round(h.top)),new K(Math.round(h.left+h.width),Math.round(h.top)),new K(Math.round(h.left+h.width),Math.round(h.height+h.top)),new K(Math.round(h.left),Math.round(h.height+h.top))]}},Cg="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",no="Hidden Text",vg=function(){function r(i){this._data={},this._document=i}return r.prototype.parseMetrics=function(i,a){var s=this._document.createElement("div"),h=this._document.createElement("img"),g=this._document.createElement("span"),f=this._document.body;s.style.visibility="hidden",s.style.fontFamily=i,s.style.fontSize=a,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",f.appendChild(s),h.src=Cg,h.width=1,h.height=1,h.style.margin="0",h.style.padding="0",h.style.verticalAlign="baseline",g.style.fontFamily=i,g.style.fontSize=a,g.style.margin="0",g.style.padding="0",g.appendChild(this._document.createTextNode(no)),s.appendChild(g),s.appendChild(h);var C=h.offsetTop-g.offsetTop+2;s.removeChild(g),s.appendChild(this._document.createTextNode(no)),s.style.lineHeight="normal",h.style.verticalAlign="super";var w=h.offsetTop-s.offsetTop+2;return f.removeChild(s),{baseline:C,middle:w}},r.prototype.getMetrics=function(i,a){var s=i+" "+a;return typeof this._data[s]=="undefined"&&(this._data[s]=this.parseMetrics(i,a)),this._data[s]},r}(),ao=function(){function r(i,a){this.context=i,this.options=a}return r}(),Fg=1e4,Qg=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h._activeEffects=[],h.canvas=s.canvas?s.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),s.canvas||(h.canvas.width=Math.floor(s.width*s.scale),h.canvas.height=Math.floor(s.height*s.scale),h.canvas.style.width=s.width+"px",h.canvas.style.height=s.height+"px"),h.fontMetrics=new vg(document),h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-s.x,-s.y),h.ctx.textBaseline="bottom",h._activeEffects=[],h.context.logger.debug("Canvas renderer initialized ("+s.width+"x"+s.height+") with scale "+s.scale),h}return i.prototype.applyEffects=function(a){for(var s=this;this._activeEffects.length;)this.popEffect();a.forEach(function(h){return s.applyEffect(h)})},i.prototype.applyEffect=function(a){this.ctx.save(),cg(a)&&(this.ctx.globalAlpha=a.opacity),lg(a)&&(this.ctx.translate(a.offsetX,a.offsetY),this.ctx.transform(a.matrix[0],a.matrix[1],a.matrix[2],a.matrix[3],a.matrix[4],a.matrix[5]),this.ctx.translate(-a.offsetX,-a.offsetY)),ja(a)&&(this.path(a.path),this.ctx.clip()),this._activeEffects.push(a)},i.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},i.prototype.renderStack=function(a){return t(this,void 0,void 0,function(){var s;return n(this,function(h){switch(h.label){case 0:return s=a.element.container.styles,s.isVisible()?[4,this.renderStackContent(a)]:[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}})})},i.prototype.renderNode=function(a){return t(this,void 0,void 0,function(){return n(this,function(s){switch(s.label){case 0:if(HA(a.container.flags,16))debugger;return a.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(a)]:[3,3];case 1:return s.sent(),[4,this.renderNodeContent(a)];case 2:s.sent(),s.label=3;case 3:return[2]}})})},i.prototype.renderTextWithLetterSpacing=function(a,s,h){var g=this;if(s===0)this.ctx.fillText(a.text,a.bounds.left,a.bounds.top+h);else{var f=xs(a.text);f.reduce(function(C,w){return g.ctx.fillText(w,C,a.bounds.top+h),C+g.ctx.measureText(w).width},a.bounds.left)}},i.prototype.createFontStyle=function(a){var s=a.fontVariant.filter(function(f){return f==="normal"||f==="small-caps"}).join(""),h=Ig(a.fontFamily).join(", "),g=Jt(a.fontSize)?""+a.fontSize.number+a.fontSize.unit:a.fontSize.number+"px";return[[a.fontStyle,s,a.fontWeight,g,h].join(" "),h,g]},i.prototype.renderTextNode=function(a,s){return t(this,void 0,void 0,function(){var h,g,f,C,w,y,S,I,b=this;return n(this,function(k){return h=this.createFontStyle(s),g=h[0],f=h[1],C=h[2],this.ctx.font=g,this.ctx.direction=s.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",w=this.fontMetrics.getMetrics(f,C),y=w.baseline,S=w.middle,I=s.paintOrder,a.textBounds.forEach(function(L){I.forEach(function(P){switch(P){case 0:b.ctx.fillStyle=LA(s.color),b.renderTextWithLetterSpacing(L,s.letterSpacing,y);var $=s.textShadow;$.length&&L.text.trim().length&&($.slice(0).reverse().forEach(function(_){b.ctx.shadowColor=LA(_.color),b.ctx.shadowOffsetX=_.offsetX.number*b.options.scale,b.ctx.shadowOffsetY=_.offsetY.number*b.options.scale,b.ctx.shadowBlur=_.blur.number,b.renderTextWithLetterSpacing(L,s.letterSpacing,y)}),b.ctx.shadowColor="",b.ctx.shadowOffsetX=0,b.ctx.shadowOffsetY=0,b.ctx.shadowBlur=0),s.textDecorationLine.length&&(b.ctx.fillStyle=LA(s.textDecorationColor||s.color),s.textDecorationLine.forEach(function(_){switch(_){case 1:b.ctx.fillRect(L.bounds.left,Math.round(L.bounds.top+y),L.bounds.width,1);break;case 2:b.ctx.fillRect(L.bounds.left,Math.round(L.bounds.top),L.bounds.width,1);break;case 3:b.ctx.fillRect(L.bounds.left,Math.ceil(L.bounds.top+S),L.bounds.width,1);break}}));break;case 1:s.webkitTextStrokeWidth&&L.text.trim().length&&(b.ctx.strokeStyle=LA(s.webkitTextStrokeColor),b.ctx.lineWidth=s.webkitTextStrokeWidth,b.ctx.lineJoin=window.chrome?"miter":"round",b.ctx.strokeText(L.text,L.bounds.left,L.bounds.top+y)),b.ctx.strokeStyle="",b.ctx.lineWidth=0,b.ctx.lineJoin="miter";break}})}),[2]})})},i.prototype.renderReplacedElement=function(a,s,h){if(h&&a.intrinsicWidth>0&&a.intrinsicHeight>0){var g=tr(a),f=ji(s);this.path(f),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(h,0,0,a.intrinsicWidth,a.intrinsicHeight,g.left,g.top,g.width,g.height),this.ctx.restore()}},i.prototype.renderNodeContent=function(a){return t(this,void 0,void 0,function(){var s,h,g,f,C,w,V,V,y,S,I,b,q,k,L,Y,P,$,_,V,oA,q,Y;return n(this,function(R){switch(R.label){case 0:this.applyEffects(a.getEffects(4)),s=a.container,h=a.curves,g=s.styles,f=0,C=s.textNodes,R.label=1;case 1:return f<C.length?(w=C[f],[4,this.renderTextNode(w,g)]):[3,4];case 2:R.sent(),R.label=3;case 3:return f++,[3,1];case 4:if(!(s instanceof Ea))return[3,8];R.label=5;case 5:return R.trys.push([5,7,,8]),[4,this.context.cache.match(s.src)];case 6:return V=R.sent(),this.renderReplacedElement(s,h,V),[3,8];case 7:return R.sent(),this.context.logger.error("Error loading image "+s.src),[3,8];case 8:if(s instanceof Ua&&this.renderReplacedElement(s,h,s.canvas),!(s instanceof Sa))return[3,12];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,this.context.cache.match(s.svg)];case 10:return V=R.sent(),this.renderReplacedElement(s,h,V),[3,12];case 11:return R.sent(),this.context.logger.error("Error loading svg "+s.svg.substring(0,255)),[3,12];case 12:return s instanceof Ma&&s.tree?(y=new i(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}),[4,y.render(s.tree)]):[3,14];case 13:S=R.sent(),s.width&&s.height&&this.ctx.drawImage(S,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height),R.label=14;case 14:if(s instanceof Ls&&(I=Math.min(s.bounds.width,s.bounds.height),s.type===Xi?s.checked&&(this.ctx.save(),this.path([new K(s.bounds.left+I*.39363,s.bounds.top+I*.79),new K(s.bounds.left+I*.16,s.bounds.top+I*.5549),new K(s.bounds.left+I*.27347,s.bounds.top+I*.44071),new K(s.bounds.left+I*.39694,s.bounds.top+I*.5649),new K(s.bounds.left+I*.72983,s.bounds.top+I*.23),new K(s.bounds.left+I*.84,s.bounds.top+I*.34085),new K(s.bounds.left+I*.39363,s.bounds.top+I*.79)]),this.ctx.fillStyle=LA(Ha),this.ctx.fill(),this.ctx.restore()):s.type===Ji&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+I/2,s.bounds.top+I/2,I/4,0,Math.PI*2,!0),this.ctx.fillStyle=LA(Ha),this.ctx.fill(),this.ctx.restore())),yg(s)&&s.value.length){switch(b=this.createFontStyle(g),q=b[0],k=b[1],L=this.fontMetrics.getMetrics(q,k).baseline,this.ctx.font=q,this.ctx.fillStyle=LA(g.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Ug(s.styles.textAlign),Y=tr(s),P=0,s.styles.textAlign){case 1:P+=Y.width/2;break;case 2:P+=Y.width;break}$=Y.add(P,0,0,-Y.height/2+1),this.ctx.save(),this.path([new K(Y.left,Y.top),new K(Y.left+Y.width,Y.top),new K(Y.left+Y.width,Y.top+Y.height),new K(Y.left,Y.top+Y.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Zt(s.value,$),g.letterSpacing,L),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!HA(s.styles.display,2048))return[3,20];if(s.styles.listStyleImage===null)return[3,19];if(_=s.styles.listStyleImage,_.type!==0)return[3,18];V=void 0,oA=_.url,R.label=15;case 15:return R.trys.push([15,17,,18]),[4,this.context.cache.match(oA)];case 16:return V=R.sent(),this.ctx.drawImage(V,s.bounds.left-(V.width+10),s.bounds.top),[3,18];case 17:return R.sent(),this.context.logger.error("Error loading list-style-image "+oA),[3,18];case 18:return[3,20];case 19:a.listValue&&s.styles.listStyleType!==-1&&(q=this.createFontStyle(g)[0],this.ctx.font=q,this.ctx.fillStyle=LA(g.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Y=new l(s.bounds.left,s.bounds.top+uA(s.styles.paddingTop,s.bounds.width),s.bounds.width,na(g.lineHeight,g.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Zt(a.listValue,Y),g.letterSpacing,na(g.lineHeight,g.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),R.label=20;case 20:return[2]}})})},i.prototype.renderStackContent=function(a){return t(this,void 0,void 0,function(){var s,h,_,g,f,_,C,w,_,y,S,_,I,b,_,k,L,_,P,$,_;return n(this,function(V){switch(V.label){case 0:if(HA(a.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(a.element)];case 1:V.sent(),s=0,h=a.negativeZIndex,V.label=2;case 2:return s<h.length?(_=h[s],[4,this.renderStack(_)]):[3,5];case 3:V.sent(),V.label=4;case 4:return s++,[3,2];case 5:return[4,this.renderNodeContent(a.element)];case 6:V.sent(),g=0,f=a.nonInlineLevel,V.label=7;case 7:return g<f.length?(_=f[g],[4,this.renderNode(_)]):[3,10];case 8:V.sent(),V.label=9;case 9:return g++,[3,7];case 10:C=0,w=a.nonPositionedFloats,V.label=11;case 11:return C<w.length?(_=w[C],[4,this.renderStack(_)]):[3,14];case 12:V.sent(),V.label=13;case 13:return C++,[3,11];case 14:y=0,S=a.nonPositionedInlineLevel,V.label=15;case 15:return y<S.length?(_=S[y],[4,this.renderStack(_)]):[3,18];case 16:V.sent(),V.label=17;case 17:return y++,[3,15];case 18:I=0,b=a.inlineLevel,V.label=19;case 19:return I<b.length?(_=b[I],[4,this.renderNode(_)]):[3,22];case 20:V.sent(),V.label=21;case 21:return I++,[3,19];case 22:k=0,L=a.zeroOrAutoZIndexOrTransformedOrOpacity,V.label=23;case 23:return k<L.length?(_=L[k],[4,this.renderStack(_)]):[3,26];case 24:V.sent(),V.label=25;case 25:return k++,[3,23];case 26:P=0,$=a.positiveZIndex,V.label=27;case 27:return P<$.length?(_=$[P],[4,this.renderStack(_)]):[3,30];case 28:V.sent(),V.label=29;case 29:return P++,[3,27];case 30:return[2]}})})},i.prototype.mask=function(a){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(a.slice(0).reverse()),this.ctx.closePath()},i.prototype.path=function(a){this.ctx.beginPath(),this.formatPath(a),this.ctx.closePath()},i.prototype.formatPath=function(a){var s=this;a.forEach(function(h,g){var f=de(h)?h.start:h;g===0?s.ctx.moveTo(f.x,f.y):s.ctx.lineTo(f.x,f.y),de(h)&&s.ctx.bezierCurveTo(h.startControl.x,h.startControl.y,h.endControl.x,h.endControl.y,h.end.x,h.end.y)})},i.prototype.renderRepeat=function(a,s,h,g){this.path(a),this.ctx.fillStyle=s,this.ctx.translate(h,g),this.ctx.fill(),this.ctx.translate(-h,-g)},i.prototype.resizeImage=function(a,s,h){var g;if(a.width===s&&a.height===h)return a;var f=(g=this.canvas.ownerDocument)!==null&&g!==void 0?g:document,C=f.createElement("canvas");C.width=Math.max(1,s),C.height=Math.max(1,h);var w=C.getContext("2d");return w.drawImage(a,0,0,a.width,a.height,0,0,s,h),C},i.prototype.renderBackgroundImage=function(a){return t(this,void 0,void 0,function(){var s,h,g,f,C,w;return n(this,function(y){switch(y.label){case 0:s=a.styles.backgroundImage.length-1,h=function(S){var I,b,k,yA,Ae,ee,dA,GA,sA,L,yA,Ae,ee,dA,GA,P,$,_,V,oA,q,Y,R,rA,sA,W,yA,jA,ae,dA,GA,Ye,Ae,ee,nt,Ee,We,at,ot,xe,lt,Me;return n(this,function(Qt){switch(Qt.label){case 0:if(S.type!==0)return[3,5];I=void 0,b=S.url,Qt.label=1;case 1:return Qt.trys.push([1,3,,4]),[4,g.context.cache.match(b)];case 2:return I=Qt.sent(),[3,4];case 3:return Qt.sent(),g.context.logger.error("Error loading background-image "+b),[3,4];case 4:return I&&(k=_s(a,s,[I.width,I.height,I.width/I.height]),yA=k[0],Ae=k[1],ee=k[2],dA=k[3],GA=k[4],sA=g.ctx.createPattern(g.resizeImage(I,dA,GA),"repeat"),g.renderRepeat(yA,sA,Ae,ee)),[3,6];case 5:lc(S)?(L=_s(a,s,[null,null,null]),yA=L[0],Ae=L[1],ee=L[2],dA=L[3],GA=L[4],P=rc(S.angle,dA,GA),$=P[0],_=P[1],V=P[2],oA=P[3],q=P[4],Y=document.createElement("canvas"),Y.width=dA,Y.height=GA,R=Y.getContext("2d"),rA=R.createLinearGradient(_,oA,V,q),$n(S.stops,$).forEach(function(ei){return rA.addColorStop(ei.stop,LA(ei.color))}),R.fillStyle=rA,R.fillRect(0,0,dA,GA),dA>0&&GA>0&&(sA=g.ctx.createPattern(Y,"repeat"),g.renderRepeat(yA,sA,Ae,ee))):cc(S)&&(W=_s(a,s,[null,null,null]),yA=W[0],jA=W[1],ae=W[2],dA=W[3],GA=W[4],Ye=S.position.length===0?[fs]:S.position,Ae=uA(Ye[0],dA),ee=uA(Ye[Ye.length-1],GA),nt=sc(S,Ae,ee,dA,GA),Ee=nt[0],We=nt[1],Ee>0&&We>0&&(at=g.ctx.createRadialGradient(jA+Ae,ae+ee,0,jA+Ae,ae+ee,Ee),$n(S.stops,Ee*2).forEach(function(ei){return at.addColorStop(ei.stop,LA(ei.color))}),g.path(yA),g.ctx.fillStyle=at,Ee!==We?(ot=a.bounds.left+.5*a.bounds.width,xe=a.bounds.top+.5*a.bounds.height,lt=We/Ee,Me=1/lt,g.ctx.save(),g.ctx.translate(ot,xe),g.ctx.transform(1,0,0,lt,0,0),g.ctx.translate(-ot,-xe),g.ctx.fillRect(jA,Me*(ae-xe)+xe,dA,GA*Me),g.ctx.restore()):g.ctx.fill())),Qt.label=6;case 6:return s--,[2]}})},g=this,f=0,C=a.styles.backgroundImage.slice(0).reverse(),y.label=1;case 1:return f<C.length?(w=C[f],[5,h(w)]):[3,4];case 2:y.sent(),y.label=3;case 3:return f++,[3,1];case 4:return[2]}})})},i.prototype.renderSolidBorder=function(a,s,h){return t(this,void 0,void 0,function(){return n(this,function(g){return this.path(ro(h,s)),this.ctx.fillStyle=LA(a),this.ctx.fill(),[2]})})},i.prototype.renderDoubleBorder=function(a,s,h,g){return t(this,void 0,void 0,function(){var f,C;return n(this,function(w){switch(w.label){case 0:return s<3?[4,this.renderSolidBorder(a,h,g)]:[3,2];case 1:return w.sent(),[2];case 2:return f=gg(g,h),this.path(f),this.ctx.fillStyle=LA(a),this.ctx.fill(),C=ug(g,h),this.path(C),this.ctx.fill(),[2]}})})},i.prototype.renderNodeBackgroundAndBorders=function(a){return t(this,void 0,void 0,function(){var s,h,g,f,C,w,y,S,I=this;return n(this,function(b){switch(b.label){case 0:return this.applyEffects(a.getEffects(2)),s=a.container.styles,h=!Ve(s.backgroundColor)||s.backgroundImage.length,g=[{style:s.borderTopStyle,color:s.borderTopColor,width:s.borderTopWidth},{style:s.borderRightStyle,color:s.borderRightColor,width:s.borderRightWidth},{style:s.borderBottomStyle,color:s.borderBottomColor,width:s.borderBottomWidth},{style:s.borderLeftStyle,color:s.borderLeftColor,width:s.borderLeftWidth}],f=Eg(Ft(s.backgroundClip,0),a.curves),h||s.boxShadow.length?(this.ctx.save(),this.path(f),this.ctx.clip(),Ve(s.backgroundColor)||(this.ctx.fillStyle=LA(s.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(a.container)]):[3,2];case 1:b.sent(),this.ctx.restore(),s.boxShadow.slice(0).reverse().forEach(function(k){I.ctx.save();var L=zi(a.curves),P=k.inset?0:Fg,$=hg(L,-P+(k.inset?1:-1)*k.spread.number,(k.inset?1:-1)*k.spread.number,k.spread.number*(k.inset?-2:2),k.spread.number*(k.inset?-2:2));k.inset?(I.path(L),I.ctx.clip(),I.mask($)):(I.mask(L),I.ctx.clip(),I.path($)),I.ctx.shadowOffsetX=k.offsetX.number+P,I.ctx.shadowOffsetY=k.offsetY.number,I.ctx.shadowColor=LA(k.color),I.ctx.shadowBlur=k.blur.number,I.ctx.fillStyle=k.inset?LA(k.color):"rgba(0,0,0,1)",I.ctx.fill(),I.ctx.restore()}),b.label=2;case 2:C=0,w=0,y=g,b.label=3;case 3:return w<y.length?(S=y[w],S.style!==0&&!Ve(S.color)&&S.width>0?S.style!==2?[3,5]:[4,this.renderDashedDottedBorder(S.color,S.width,C,a.curves,2)]:[3,11]):[3,13];case 4:return b.sent(),[3,11];case 5:return S.style!==3?[3,7]:[4,this.renderDashedDottedBorder(S.color,S.width,C,a.curves,3)];case 6:return b.sent(),[3,11];case 7:return S.style!==4?[3,9]:[4,this.renderDoubleBorder(S.color,S.width,C,a.curves)];case 8:return b.sent(),[3,11];case 9:return[4,this.renderSolidBorder(S.color,C,a.curves)];case 10:b.sent(),b.label=11;case 11:C++,b.label=12;case 12:return w++,[3,3];case 13:return[2]}})})},i.prototype.renderDashedDottedBorder=function(a,s,h,g,f){return t(this,void 0,void 0,function(){var C,w,y,S,I,b,k,L,P,$,_,V,oA,q,Y,R,Y,R;return n(this,function(rA){return this.ctx.save(),C=pg(g,h),w=ro(g,h),f===2&&(this.path(w),this.ctx.clip()),de(w[0])?(y=w[0].start.x,S=w[0].start.y):(y=w[0].x,S=w[0].y),de(w[1])?(I=w[1].end.x,b=w[1].end.y):(I=w[1].x,b=w[1].y),h===0||h===2?k=Math.abs(y-I):k=Math.abs(S-b),this.ctx.beginPath(),f===3?this.formatPath(C):this.formatPath(w.slice(0,2)),L=s<3?s*3:s*2,P=s<3?s*2:s,f===3&&(L=s,P=s),$=!0,k<=L*2?$=!1:k<=L*2+P?(_=k/(2*L+P),L*=_,P*=_):(V=Math.floor((k+P)/(L+P)),oA=(k-V*L)/(V-1),q=(k-(V+1)*L)/V,P=q<=0||Math.abs(P-oA)<Math.abs(P-q)?oA:q),$&&(f===3?this.ctx.setLineDash([0,L+P]):this.ctx.setLineDash([L,P])),f===3?(this.ctx.lineCap="round",this.ctx.lineWidth=s):this.ctx.lineWidth=s*2+1.1,this.ctx.strokeStyle=LA(a),this.ctx.stroke(),this.ctx.setLineDash([]),f===2&&(de(w[0])&&(Y=w[3],R=w[0],this.ctx.beginPath(),this.formatPath([new K(Y.end.x,Y.end.y),new K(R.start.x,R.start.y)]),this.ctx.stroke()),de(w[1])&&(Y=w[1],R=w[2],this.ctx.beginPath(),this.formatPath([new K(Y.end.x,Y.end.y),new K(R.start.x,R.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},i.prototype.render=function(a){return t(this,void 0,void 0,function(){var s;return n(this,function(h){switch(h.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=LA(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),s=dg(a),[4,this.renderStack(s)];case 1:return h.sent(),this.applyEffects([]),[2,this.canvas]}})})},i}(ao),yg=function(r){return r instanceof xa||r instanceof ba?!0:r instanceof Ls&&r.type!==Ji&&r.type!==Xi},Eg=function(r,i){switch(r){case 0:return zi(i);case 2:return ng(i);case 1:default:return ji(i)}},Ug=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Sg=["-apple-system","system-ui"],Ig=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(i){return Sg.indexOf(i)===-1}):r},Hg=function(r){e(i,r);function i(a,s){var h=r.call(this,a,s)||this;return h.canvas=s.canvas?s.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),h.options=s,h.canvas.width=Math.floor(s.width*s.scale),h.canvas.height=Math.floor(s.height*s.scale),h.canvas.style.width=s.width+"px",h.canvas.style.height=s.height+"px",h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-s.x,-s.y),h.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+s.width+"x"+s.height+" at "+s.x+","+s.y+") with scale "+s.scale),h}return i.prototype.render=function(a){return t(this,void 0,void 0,function(){var s,h;return n(this,function(g){switch(g.label){case 0:return s=bs(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,a),[4,bg(s)];case 1:return h=g.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=LA(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(h,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},i}(ao),bg=function(r){return new Promise(function(i,a){var s=new Image;s.onload=function(){i(s)},s.onerror=a,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},xg=function(){function r(i){var a=i.id,s=i.enabled;this.id=a,this.enabled=s,this.start=Date.now()}return r.prototype.debug=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&typeof window!="undefined"&&window.console&&typeof console.info=="function"&&console.info.apply(console,o([this.id,this.getTime()+"ms"],i))},r.prototype.warn=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},r.prototype.error=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.error=="function"?console.error.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},r.instances={},r}(),Mg=function(){function r(i,a){var s;this.windowBounds=a,this.instanceName="#"+r.instanceCount++,this.logger=new xg({id:this.instanceName,enabled:i.logging}),this.cache=(s=i.cache)!==null&&s!==void 0?s:new zd(this,i)}return r.instanceCount=1,r}(),Lg=function(r,i){return i===void 0&&(i={}),Tg(r,i)};typeof window!="undefined"&&za.setContext(window);var Tg=function(r,i){return t(void 0,void 0,void 0,function(){var a,s,h,g,f,C,w,y,S,I,b,k,L,P,$,_,V,oA,q,Y,rA,R,rA,sA,W,yA,jA,ae,dA,GA,Ye,Ae,ee,nt,Ee,We,at,ot,xe,lt;return n(this,function(Me){switch(Me.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(a=r.ownerDocument,!a)throw new Error("Element is not attached to a Document");if(s=a.defaultView,!s)throw new Error("Document is not attached to a Window");return h={allowTaint:(sA=i.allowTaint)!==null&&sA!==void 0?sA:!1,imageTimeout:(W=i.imageTimeout)!==null&&W!==void 0?W:15e3,proxy:i.proxy,useCORS:(yA=i.useCORS)!==null&&yA!==void 0?yA:!1},g=A({logging:(jA=i.logging)!==null&&jA!==void 0?jA:!0,cache:i.cache},h),f={windowWidth:(ae=i.windowWidth)!==null&&ae!==void 0?ae:s.innerWidth,windowHeight:(dA=i.windowHeight)!==null&&dA!==void 0?dA:s.innerHeight,scrollX:(GA=i.scrollX)!==null&&GA!==void 0?GA:s.pageXOffset,scrollY:(Ye=i.scrollY)!==null&&Ye!==void 0?Ye:s.pageYOffset},C=new l(f.scrollX,f.scrollY,f.windowWidth,f.windowHeight),w=new Mg(g,C),y=(Ae=i.foreignObjectRendering)!==null&&Ae!==void 0?Ae:!1,S={allowTaint:(ee=i.allowTaint)!==null&&ee!==void 0?ee:!1,onclone:i.onclone,ignoreElements:i.ignoreElements,inlineImages:y,copyStyles:y},w.logger.debug("Starting document clone with size "+C.width+"x"+C.height+" scrolled to "+-C.left+","+-C.top),I=new qa(w,r,S),b=I.clonedReferenceElement,b?[4,I.toIFrame(a,C)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return k=Me.sent(),L=Ds(b)||Dd(b)?d(b.ownerDocument):c(w,b),P=L.width,$=L.height,_=L.left,V=L.top,oA=Dg(w,b,i.backgroundColor),q={canvas:i.canvas,backgroundColor:oA,scale:(Ee=(nt=i.scale)!==null&&nt!==void 0?nt:s.devicePixelRatio)!==null&&Ee!==void 0?Ee:1,x:((We=i.x)!==null&&We!==void 0?We:0)+_,y:((at=i.y)!==null&&at!==void 0?at:0)+V,width:(ot=i.width)!==null&&ot!==void 0?ot:Math.ceil(P),height:(xe=i.height)!==null&&xe!==void 0?xe:Math.ceil($)},y?(w.logger.debug("Document cloned, using foreign object rendering"),rA=new Hg(w,q),[4,rA.render(b)]):[3,3];case 2:return Y=Me.sent(),[3,5];case 3:return w.logger.debug("Document cloned, element located at "+_+","+V+" with size "+P+"x"+$+" using computed rendering"),w.logger.debug("Starting DOM parsing"),R=Ta(w,b),oA===R.styles.backgroundColor&&(R.styles.backgroundColor=He.TRANSPARENT),w.logger.debug("Starting renderer for element at "+q.x+","+q.y+" with size "+q.width+"x"+q.height),rA=new Qg(w,q),[4,rA.render(R)];case 4:Y=Me.sent(),Me.label=5;case 5:return(!((lt=i.removeContainer)!==null&&lt!==void 0)||lt)&&(qa.destroy(k)||w.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),w.logger.debug("Finished rendering"),[2,Y]}})})},Dg=function(r,i,a){var s=i.ownerDocument,h=s.documentElement?Wt(r,getComputedStyle(s.documentElement).backgroundColor):He.TRANSPARENT,g=s.body?Wt(r,getComputedStyle(s.body).backgroundColor):He.TRANSPARENT,f=typeof a=="string"?Wt(r,a):a===null?He.TRANSPARENT:4294967295;return i===s.documentElement?Ve(h)?Ve(g)?f:g:h:f};return Lg})});var fu={};Vg(fu,{default:()=>zr});module.exports=_g(fu);var Mo=require("obsidian");var X=require("obsidian");var fo=require("obsidian");var cA={AGAIN:1,HARD:2,GOOD:3,EASY:4},Xs={request_retention:.9,maximum_interval:36500,newCardsPerDay:20,reviewsPerDay:100,w:[.4872,1.4003,3.7145,13.8206,5.1618,1.2298,.8975,.031,1.6474,.1367,1.0461,2.1072,.0793,.3246,1.587,.2272,2.8755]};var uo=require("obsidian");var co={"Select the AI service provider":"Select the AI service provider.","Ollama (Local)":"Ollama (local)",Model:"Model","Failed to fetch models":"Failed to fetch models.","API Key":"API key","Custom API Address":"Custom API address","If using a custom API proxy, please enter the full API address":"If using a custom API proxy, please enter the full API address.","Please enter your API Key":"Please enter your API key.","Validating API Key...":"Validating API key...","API Key verification successful!":"API key verification successful!","API Key verification failed. Please check your API Key.":"API key verification failed. Please check your API key.",Save:"Save",Cancel:"Cancel",Edit:"Edit",Delete:"Delete","Custom Model":"Custom model","API Key is valid!":"API Key is valid!","Failed to validate API Key. Please check your key and try again.":"Failed to validate API Key. Please check your key and try again.","Please enter an API Key first":"Please enter an API Key first.","Checking...":"Checking...","API Key and the current model are both available!":"API Key and the current model are both available!","API Key is invalid or there is a server error. Please check if your API Key is correct.":"API Key is invalid or there is a server error. Please check if your API Key is correct.","Select the OpenAI model to use":"Select the OpenAI model to use.","OpenAI Settings":"OpenAI service","Enter your OpenAI API Key.":"Enter your OpenAI API key.","No available models found.":"No available models found.","API Key validated successfully!":"API Key validated successfully!","No models available. Please check your API Key.":"No models available. Please check your API Key.","Anthropic Settings":"Anthropic service","Enter your Anthropic API Key.":"Enter your Anthropic API key.","Select the Anthropic model to use":"Select the Anthropic model to use.","Select a model or use a custom one":"Select a model or use a custom one.","Model ID can only contain letters, numbers, underscores, dots and hyphens":"Model ID can only contain letters, numbers, underscores, dots and hyphens.","Select the Gemini model to use":"Select the Gemini model to use.","Unable to create model selection dropdown menu.":"Unable to create model selection dropdown menu.","Gemini Settings":"Gemini service","Enter your Gemini API Key":"Enter your Gemini API key.","Deepseek Settings":"Deepseek service","Enter your Deepseek API Key":"Enter your Deepseek API key.","Ollama Settings":"Ollama service","Server Address":"Server address","Ollama server address (default: http://localhost:11434)":"Ollama server address (default: http://localhost:11434)",Check:"Check","Successfully connected to Ollama service":"Successfully connected to Ollama service.","No models found. Please download models using ollama":"No models found. Please download models using ollama.","Could not connect to Ollama service":"Could not connect to Ollama service","Failed to connect to Ollama service. Please check the server address.":"Failed to connect to Ollama service. Please check the server address.","Currently selected model (Test connection to see all available models)":"Currently selected model (Test connection to see all available models)","Select a model to use":"Select a model to use","No models available. Please load an available model first.":"No models available. Please load an available model first.","No models available":"No models available","Prompt settings":"Custom prompt","Add Prompt":"Add prompt","Input Prompt Name":"Input prompt name","Input Prompt Content\nAvailable parameters:\n{{highlight}} - Current highlighted text\n{{comment}} - Existing comment":`Input prompt content
Available parameters:
{{highlight}} - Current highlighted text
{{comment}} - Existing comment`,"Prompt added":"Prompt added","Prompt updated":"Prompt updated","Shift + Enter Wrap, Enter Save":"Shift + Enter Wrap, Enter Save","Delete comment":"Delete","Add Comment":"Add comment","Export as Image":"Export as image","Select Prompt":"Select prompt","Please add Prompt in the settings first":"Please add prompt in the settings first","AI comments have been added":"AI comments have been added","AI comments failed:":"AI comments failed:",Chat:"Chat","Failed to process dropped highlight:":"Failed to process dropped highlight:","highlighted notes":" highlighted notes","Input message...":"Input message...","Unable to access the Ollama model, please check the service.":"Unable to access the Ollama model, please check the service.","Unable to get Gemini model list, please check API Key and network connection.":"Unable to get Gemini model list, please check API key and network connection.",Download:"Download","Export successful!":"Export successful!","Export failed, please try again.":"Export failed, please try again.","Loading...":"Loading...","Search...":"Search...","No matching content found.":"No matching content found.","The current document has no highlighted content.":"The current document has no highlighted content.","No corresponding file found.":"No corresponding file found.","Export failed: Failed to load necessary components.":"Export failed: Failed to load necessary components.","All Highlight":"All highlight","Export as notes":"Export as notes","Add File Comment":"Add file comment","File Comment":"File comment","Successfully exported highlights to: ":"Successfully exported highlights to: ","Failed to export highlights: ":"Failed to export highlights: ","Default Template":"Default template","Modern minimalist knowledge card style":"Modern minimalist knowledge card style","Academic Template":"Academic template","Formal style suitable for academic citations":"Formal style suitable for academic citations","Social Template":"Social template","Modern style suitable for social media sharing":"Modern style suitable for social media sharing","Open AI chat window":"Open AI chat window","Open HiNote window":"Open HiNote window",General:"Highlight","Export Path":"Export path","Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.":"Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.",Exclusions:"Exclusions","Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md":"Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md","Custom text extraction":"Custom text extraction","Use Custom Pattern":"Use custom pattern","Enable to use a custom regular expression for extracting text.":"Enable to use a custom regular expression for extracting text.","Custom Pattern":"Custom pattern","Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.":"Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.","Default Color":"Default color","Set the default color for decorators when no color is specified. Leave empty to use system default.":"Set the default color for decorators when no color is specified. Leave empty to use system default.","Export template":"Export template","Clean orphaned data":"Clean orphaned data","Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.":"Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.","Flashcard learning":"Flashcard learning","New cards per day":"New cards per day","Maximum number of new cards to learn each day":"Maximum number of new cards to learn each day.","Reviews per day":"Reviews per day","Maximum number of cards to review each day":"Maximum number of cards to review each day.","Target retention":"Target retention","Target memory retention rate (0.8 = 80%)":"Target memory retention rate (0.8 = 80%).","Maximum interval":"Maximum interval","Maximum interval in days between reviews":"Maximum interval in days between reviews.","Reset daily stats":"Reset daily stats","Reset today's learning statistics":"Reset today's learning statistics.",Reset:"Reset","Daily statistics have been reset":"Daily statistics have been reset","No statistics to reset for today":"No statistics to reset for today",Advanced:"Advanced","These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.":"These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.","Reset algorithm parameters":"Reset algorithm parameters","Reset the FSRS algorithm parameters to default values":"Reset the FSRS algorithm parameters to default values.","Reset to Default":"Reset to default","FSRS parameters have been reset to default values":"FSRS parameters have been reset to default values.",days:"days","Activate HiCard":"Activate HiCard","Enter your license key to activate HiCard feature.":"Enter your license key to activate HiCard feature.","Enter license key":"Enter license key",Activate:"Activate","Please enter a license key":"Please enter a license key","HiCard activated successfully!":"HiCard activated successfully!","Invalid license key":"Invalid license key","Use global settings":"Use global settings","New cards per day:":"New cards per day:","Reviews per day:":"Reviews per day:","Create Group":"Create group","Group name":"Group name",Create:"Create",Again:"Again",Hard:"Hard",Good:"Good",Easy:"Easy",Card:"Card",of:"of",Settings:"Settings","Are you sure you want to delete this group?":"Are you sure you want to delete this group?",Yes:"Yes",No:"No","You've completed All cards for today!":"You've completed All cards for today!","No cards available.":"No cards available.","Return to First Card":"Return to First Card","Edit Group":"Edit group","Create New Group":"Create new group","Group Name":"Group name","Please fill in all fields":"Please fill in all fields","Saving...":"Saving...","Creating...":"Creating...","Group updated successfully":"Group updated successfully","Failed to update group":"Failed to update group","Group created successfully":"Group created successfully","Failed to create or update group":"Failed to create or update group",Due:"Due",New:"New",Review:"Review",Retention:"Retention","Limits:":"Limits:","\u6BCF\u65E5\u5B66\u4E60\u9650\u5236\n":`Daily learning limits
`,"\u65B0\u5361\u7247:":"New cards:","\u590D\u4E60\u5361\u7247:":"Review cards:","\u5B66\u4E60\u5B8C\u6210\uFF01":"Learning completed!",\u8FD4\u56DE\u7B2C\u4E00\u5F20\u5361\u7247:"Return to first card","\u60A8\u4ECA\u5929\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002":"You've reached your daily quota for new cards! Come back tomorrow.","\u60A8\u4ECA\u5929\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002":"You've reached your daily quota for reviews! Come back tomorrow.",'\u60A8\u4ECA\u5929\u5728 "':`You've reached your daily quota in "`,'" \u5206\u7EC4\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002':'" group for new cards! Come back tomorrow.','" \u5206\u7EC4\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002':'" group for reviews! Come back tomorrow.','\u606D\u559C\uFF01\u60A8\u5DF2\u5B8C\u6210 "':`Congratulations! You've completed All cards in "`,'" \u4E2D\u7684\u6240\u6709\u5361\u7247\u5B66\u4E60\u3002':'" group.','\u786E\u5B9A\u8981\u5220\u9664\u5206\u7EC4 "':'Are you sure you want to delete group "','" \u5417\uFF1F':'"?',\u5206\u7EC4\u5220\u9664\u6210\u529F:"Group deleted successfully",\u5220\u9664\u5206\u7EC4\u5931\u8D25:"Failed to delete group","\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\uFF1A\n- \u6587\u4EF6\u5939\uFF1Afolder1, folder1/folder2\n- \u7B14\u8BB0\uFF1A[[note1]], [[note2]]\n- \u6807\u7B7E\uFF1A#tag1, #tag2\n- \u901A\u914D\u7B26\uFF1A*.excalidraw.md\n- \u5185\u5BB9\uFF1A\u76F4\u63A5\u8F93\u5165\u8981\u641C\u7D22\u7684\u6587\u672C":`Supports the following formats:
- Folders: folder1, folder1/folder2
- Notes: [[note1]], [[note2]]
- Tags: #tag1, #tag2
- Wildcards: *.excalidraw.md
- Content: directly enter text to search for`,"Reverse cards (use comments as questions)":"Reverse cards (use comments as questions)","Learning settings":"Learning settings","\u8BB0\u5FC6\u4FDD\u6301\u7387 = (\u603B\u590D\u4E60\u6B21\u6570 - \u9057\u5FD8\u6B21\u6570) / \u603B\u590D\u4E60\u6B21\u6570\n\u8BE5\u6307\u6807\u53CD\u6620\u4E86\u4F60\u7684\u5B66\u4E60\u6548\u679C\uFF0C\u8D8A\u9AD8\u8BF4\u660E\u8BB0\u5FC6\u6548\u679C\u8D8A\u597D":`Memory retention = (total reviews - forgotten reviews) / total reviews
This metric reflects your learning effectiveness. Higher means better memory retention`,"Open (DoubleClick)":"Open (double-click)"};var ho={"Select the AI service provider":"\u9009\u62E9 AI \u670D\u52A1\u63D0\u4F9B\u5546\u3002","Ollama (Local)":"Ollama (\u672C\u5730)",Model:"\u6A21\u578B","Failed to fetch models":"\u83B7\u53D6\u6A21\u578B\u5931\u8D25","API Key":"API \u5BC6\u94A5","Custom API Address":"\u81EA\u5B9A\u4E49 API \u5730\u5740","If using a custom API proxy, please enter the full API address":"\u5982\u679C\u4F7F\u7528\u81EA\u5B9A\u4E49 API \u4EE3\u7406\uFF0C\u8BF7\u8F93\u5165\u5B8C\u6574\u7684 API \u5730\u5740","Please enter your API Key":"\u8BF7\u8F93\u5165\u60A8\u7684 API \u5BC6\u94A5","Validating API Key...":"\u6B63\u5728\u9A8C\u8BC1 API \u5BC6\u94A5...","API Key verification successful!":"API \u5BC6\u94A5\u9A8C\u8BC1\u6210\u529F\uFF01","API Key verification failed. Please check your API Key.":"API \u5BC6\u94A5\u9A8C\u8BC1\u5931\u8D25\u3002\u8BF7\u68C0\u67E5\u60A8\u7684 API \u5BC6\u94A5\u3002",Save:"\u4FDD\u5B58",Cancel:"\u53D6\u6D88",Edit:"\u7F16\u8F91",Delete:"\u5220\u9664","Custom Model":"\u81EA\u5B9A\u4E49\u6A21\u578B","API Key is valid!":"API \u5BC6\u94A5\u6709\u6548\uFF01","Failed to validate API Key. Please check your key and try again.":"API \u5BC6\u94A5\u9A8C\u8BC1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u60A8\u7684\u5BC6\u94A5\u5E76\u91CD\u8BD5","Please enter an API Key first":"\u8BF7\u5148\u8F93\u5165 API \u5BC6\u94A5","Checking...":"\u68C0\u67E5\u4E2D...","API Key and the current model are both available!":"API \u5BC6\u94A5\u548C\u5F53\u524D\u6A21\u578B\u90FD\u53EF\u7528\uFF01","API Key is invalid or there is a server error. Please check if your API Key is correct.":"API \u5BC6\u94A5\u65E0\u6548\u6216\u670D\u52A1\u5668\u9519\u8BEF\u3002\u8BF7\u68C0\u67E5\u60A8\u7684 API \u5BC6\u94A5\u662F\u5426\u6B63\u786E\u3002","Select the OpenAI model to use":"\u9009\u62E9 OpenAI \u6A21\u578B","OpenAI Settings":"OpenAI \u670D\u52A1","Enter your OpenAI API Key.":"\u8F93\u5165\u60A8\u7684 OpenAI API \u5BC6\u94A5\u3002","No available models found.":"\u672A\u627E\u5230\u53EF\u7528\u6A21\u578B\u3002","API Key validated successfully!":"API \u5BC6\u94A5\u9A8C\u8BC1\u6210\u529F\uFF01","No models available. Please check your API Key.":"\u6CA1\u6709\u53EF\u7528\u7684\u6A21\u578B\u3002\u8BF7\u68C0\u67E5\u60A8\u7684 API \u5BC6\u94A5\u3002","Anthropic Settings":"Anthropic \u670D\u52A1","Enter your Anthropic API Key.":"\u8F93\u5165\u60A8\u7684 Anthropic API \u5BC6\u94A5\u3002","Select the Anthropic model to use":"\u9009\u62E9 Anthropic \u6A21\u578B","Select a model or use a custom one":"\u9009\u62E9\u6A21\u578B\u6216\u4F7F\u7528\u81EA\u5B9A\u4E49\u6A21\u578B","Model ID can only contain letters, numbers, underscores, dots and hyphens":"\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u548C\u8FDE\u5B57\u7B26","Select the Gemini model to use":"\u9009\u62E9 Gemini \u6A21\u578B","Unable to create model selection dropdown menu.":"\u65E0\u6CD5\u521B\u5EFA\u6A21\u578B\u9009\u62E9\u4E0B\u62C9\u83DC\u5355\u3002","Gemini Settings":"Gemini \u670D\u52A1","Enter your Gemini API Key":"\u8F93\u5165\u60A8\u7684 Gemini API \u5BC6\u94A5","Deepseek Settings":"Deepseek \u670D\u52A1","Enter your Deepseek API Key":"\u8F93\u5165\u60A8\u7684 Deepseek API \u5BC6\u94A5","Ollama Settings":"Ollama \u670D\u52A1","Server Address":"\u670D\u52A1\u5668\u5730\u5740","Ollama server address (default: http://localhost:11434)":"Ollama \u670D\u52A1\u5668\u5730\u5740\uFF08\u9ED8\u8BA4\uFF1Ahttp://localhost:11434\uFF09",Check:"\u9A8C\u8BC1","Successfully connected to Ollama service":"\u6210\u529F\u8FDE\u63A5\u5230 Ollama \u670D\u52A1","No models found. Please download models using ollama":"\u672A\u627E\u5230\u6A21\u578B\u3002\u8BF7\u4F7F\u7528 ollama \u4E0B\u8F7D\u6A21\u578B","Could not connect to Ollama service":"\u65E0\u6CD5\u8FDE\u63A5\u5230 Ollama \u670D\u52A1","Failed to connect to Ollama service. Please check the server address.":"\u65E0\u6CD5\u8FDE\u63A5\u5230 Ollama \u670D\u52A1\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u5730\u5740\u3002","Currently selected model (Test connection to see all available models)":"\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\uFF08\u6D4B\u8BD5\u8FDE\u63A5\u4EE5\u67E5\u770B\u53EF\u7528\u6A21\u578B\uFF09","Select a model to use":"\u9009\u62E9\u4E00\u4E2A\u6A21\u578B","No models available. Please load an available model first.":"\u65E0\u53EF\u7528\u6A21\u578B\uFF0C\u8BF7\u5148\u52A0\u8F7D\u53EF\u7528\u6A21\u578B\u3002","No models available":"\u65E0\u53EF\u7528\u6A21\u578B","Prompt settings":"\u81EA\u5B9A\u4E49 Prompt","Add Prompt":"\u6DFB\u52A0 Prompt","Input Prompt Name":"\u8F93\u5165 Prompt \u540D\u79F0","Input Prompt Content\nAvailable parameters:\n{{highlight}} - Current highlighted text\n{{comment}} - Existing comment":`\u8F93\u5165 Prompt \u5185\u5BB9
\u53EF\u7528\u53C2\u6570:
{{highlight}} - \u5F53\u524D\u9AD8\u4EAE\u6587\u672C
{{comment}} - \u5DF2\u5B58\u5728\u7684\u6CE8\u91CA`,"Prompt added":"Prompt \u5DF2\u6DFB\u52A0","Prompt updated":"Prompt \u5DF2\u66F4\u65B0","Shift + Enter Wrap, Enter Save":"Shift + Enter \u6362\u884C\uFF0CEnter \u4FDD\u5B58","Delete comment":"\u5220\u9664\u8BC4\u8BBA","Add Comment":"\u6DFB\u52A0\u8BC4\u8BBA","Export as Image":"\u5BFC\u51FA\u4E3A\u56FE\u7247","Select Prompt":"\u9009\u62E9 Prompt","Please add Prompt in the settings first":"\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u6DFB\u52A0 Prompt","AI comments have been added":"AI \u8BC4\u8BBA\u5DF2\u6DFB\u52A0","AI comments failed:":"AI \u8BC4\u8BBA\u5931\u8D25\uFF1A",Chat:"\u5BF9\u8BDD","Failed to process dropped highlight:":"\u65E0\u6CD5\u5904\u7406\u5220\u9664\u7684\u9AD8\u4EAE\uFF1A","highlighted notes":" \u6761\u9AD8\u4EAE\u7B14\u8BB0","Input message...":"\u8F93\u5165\u6D88\u606F...","Unable to access the Ollama model, please check the service.":"\u65E0\u6CD5\u8BBF\u95EE Ollama \u6A21\u578B\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u662F\u5426\u6B63\u5E38\u8FD0\u884C","Unable to get Gemini model list, please check API Key and network connection.":"\u65E0\u6CD5\u83B7\u53D6 Gemini \u6A21\u578B\u5217\u8868\uFF0C\u8BF7\u68C0\u67E5 API Key \u548C\u7F51\u7EDC\u8FDE\u63A5",Download:"\u4E0B\u8F7D","Export successful!":"\u5BFC\u51FA\u6210\u529F\uFF01","Export failed, please try again.":"\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5","Loading...":"\u52A0\u8F7D\u4E2D...","Search...":"\u641C\u7D22\u9AD8\u4EAE\u6216\u8BC4\u8BBA...","No matching content found.":"\u672A\u627E\u5230\u5339\u914D\u7684\u5185\u5BB9\u3002","The current document has no highlighted content.":"\u5F53\u524D\u6587\u6863\u6CA1\u6709\u9AD8\u4EAE\u5185\u5BB9\u3002","No corresponding file found.":"\u672A\u627E\u5230\u76F8\u5E94\u7684\u6587\u4EF6\u3002","Export failed: Failed to load necessary components.":"\u5BFC\u51FA\u5931\u8D25\uFF1A\u52A0\u8F7D\u5FC5\u8981\u7EC4\u4EF6\u5931\u8D25\u3002","All Highlight":"\u5168\u90E8\u9AD8\u4EAE","Export as notes":"\u5BFC\u51FA\u4E3A\u7B14\u8BB0","Add File Comment":"\u6DFB\u52A0\u6587\u4EF6\u8BC4\u8BBA","File Comment":"\u6587\u4EF6\u8BC4\u8BBA","Successfully exported highlights to: ":"\u6210\u529F\u5BFC\u51FA\u9AD8\u4EAE\u5230\uFF1A","Failed to export highlights: ":"\u65E0\u6CD5\u5BFC\u51FA\u9AD8\u4EAE\uFF1A","Default Template":"\u9ED8\u8BA4\u6A21\u677F","Modern minimalist knowledge card style":"\u73B0\u4EE3\u6781\u7B80\u77E5\u8BC6\u5361\u7247\u98CE\u683C","Academic Template":"\u5B66\u672F\u6A21\u677F","Formal style suitable for academic citations":"\u9002\u7528\u4E8E\u5B66\u672F\u5F15\u7528\u7684\u6B63\u5F0F\u98CE\u683C","Social Template":"\u793E\u4EA4\u6A21\u677F","Modern style suitable for social media sharing":"\u9002\u7528\u4E8E\u793E\u4EA4\u5A92\u4F53\u5206\u4EAB\u7684\u73B0\u4EE3\u98CE\u683C","Open AI chat window":"\u6253\u5F00 AI \u5BF9\u8BDD\u7A97\u53E3","Open HiNote window":"\u6253\u5F00 HiNote \u7A97\u53E3","General Settings":"\u901A\u7528\u8BBE\u7F6E","Export Path":"\u5BFC\u51FA\u8DEF\u5F84","Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.":"\u8BBE\u7F6E\u9AD8\u4EAE\u7B14\u8BB0\u7684\u5BFC\u51FA\u8DEF\u5F84\u3002\u7559\u7A7A\u5219\u4F7F\u7528 vault \u6839\u76EE\u5F55\u3002\u8DEF\u5F84\u5E94\u76F8\u5BF9\u4E8E vault \u6839\u76EE\u5F55\u3002",Exclusions:"\u6392\u9664","Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md":"\u9017\u53F7\u5206\u9694\u7684\u8DEF\u5F84\uFF0C\u6807\u7B7E\uFF0C\u7B14\u8BB0\u6807\u9898\u6216\u6587\u4EF6\u6269\u5C55\u540D\uFF0C\u5C06\u4ECE\u9AD8\u4EAE\u4E2D\u6392\u9664\u3002\u4F8B\u5982\uFF1Afolder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md","Custom text extraction":"\u81EA\u5B9A\u4E49\u6587\u672C\u63D0\u53D6","Use Custom Pattern":"\u4F7F\u7528\u81EA\u5B9A\u4E49\u6A21\u5F0F","Enable to use a custom regular expression for extracting text.":"\u542F\u7528\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u4EE5\u63D0\u53D6\u6587\u672C\u3002","Custom Pattern":"\u81EA\u5B9A\u4E49\u6A21\u5F0F","Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.":"\u8F93\u5165\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u4EE5\u63D0\u53D6\u6587\u672C\u3002\u4F7F\u7528\u6355\u83B7\u7EC4 () \u6307\u5B9A\u8981\u63D0\u53D6\u7684\u6587\u672C\u3002\u7B2C\u4E00\u4E2A\u975E\u7A7A\u6355\u83B7\u7EC4\u5C06\u7528\u4F5C\u63D0\u53D6\u7684\u6587\u672C\u3002","Default Color":"\u9ED8\u8BA4\u989C\u8272","Set the default color for decorators when no color is specified. Leave empty to use system default.":"\u8BBE\u7F6E\u5F53\u672A\u6307\u5B9A\u989C\u8272\u65F6\u7684\u88C5\u9970\u5668\u7684\u9ED8\u8BA4\u989C\u8272\u3002\u7559\u7A7A\u4EE5\u4F7F\u7528\u7CFB\u7EDF\u9ED8\u8BA4\u989C\u8272\u3002","Export template":"\u5BFC\u51FA\u6A21\u677F","Clean orphaned data":"\u6E05\u7406\u5B64\u7ACB\u6570\u636E","Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.":"\u5220\u9664\u4E0D\u518D\u5B58\u5728\u4E8E\u60A8\u7684\u6587\u6863\u4E2D\u7684\u9AD8\u4EAE\u548C\u6CE8\u91CA\u3002\u8FD9\u5728\u60A8\u5220\u9664\u9AD8\u4EAE\u4F46\u6CE8\u91CA\u4ECD\u7136\u5B58\u50A8\u5728\u6570\u636E\u6587\u4EF6\u4E2D\u65F6\u5F88\u6709\u7528\u3002","Flashcard learning":"\u95EA\u5361\u5B66\u4E60\u8BBE\u7F6E","New cards per day":"\u6BCF\u65E5\u65B0\u5361\u7247\u6570\u91CF","Maximum number of new cards to learn each day":"\u6BCF\u5929\u5B66\u4E60\u7684\u65B0\u5361\u7247\u6700\u5927\u6570\u91CF","Reviews per day":"\u6BCF\u65E5\u590D\u4E60\u6570\u91CF","Maximum number of cards to review each day":"\u6BCF\u5929\u590D\u4E60\u7684\u5361\u7247\u6700\u5927\u6570\u91CF","Target retention":"\u76EE\u6807\u8BB0\u5FC6\u4FDD\u6301\u7387","Target memory retention rate (0.8 = 80%)":"\u76EE\u6807\u8BB0\u5FC6\u4FDD\u6301\u7387\uFF080.8 = 80%\uFF09","Maximum interval":"\u6700\u5927\u95F4\u9694","Maximum interval in days between reviews":"\u590D\u4E60\u4E4B\u95F4\u7684\u6700\u5927\u95F4\u9694\u5929\u6570","Reset daily stats":"\u91CD\u7F6E\u4ECA\u65E5\u7EDF\u8BA1","Reset today's learning statistics":"\u91CD\u7F6E\u4ECA\u5929\u7684\u5B66\u4E60\u7EDF\u8BA1\u6570\u636E",Reset:"\u91CD\u7F6E","Daily statistics have been reset":"\u4ECA\u65E5\u7EDF\u8BA1\u5DF2\u91CD\u7F6E","No statistics to reset for today":"\u4ECA\u5929\u6CA1\u6709\u53EF\u91CD\u7F6E\u7684\u7EDF\u8BA1\u6570\u636E",Advanced:"\u9AD8\u7EA7\u8BBE\u7F6E","These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.":"\u8FD9\u4E9B\u8BBE\u7F6E\u63A7\u5236FSRS\u7B97\u6CD5\u53C2\u6570\u3002\u4EC5\u5728\u7406\u89E3\u7B97\u6CD5\u7684\u60C5\u51B5\u4E0B\u66F4\u6539\u5B83\u4EEC\u3002","Reset algorithm parameters":"\u91CD\u7F6E\u7B97\u6CD5\u53C2\u6570","Reset the FSRS algorithm parameters to default values":"\u5C06FSRS\u7B97\u6CD5\u53C2\u6570\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C","Reset to default":"\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C","FSRS parameters have been reset to default values":"FSRS\u53C2\u6570\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C",days:"\u5929","FSRS weight parameter. The default value is obtained from a smaller sample; if adjustment is needed, please use the FSRS optimizer for calculation.":"\u7B97\u6CD5\u6743\u91CD\u53C2\u6570\u3002\u9ED8\u8BA4\u503C\u4E3A\u8F83\u5C0F\u6837\u672C\u83B7\u5F97\uFF0C\u5982\u679C\u9700\u8981\u8C03\u6574\u8BF7\u4F7F\u7528 FSRS \u4F18\u5316\u5668\u8BA1\u7B97","FSRS parameters":"FSRS \u53C2\u6570","Edit the 17 FSRS algorithm weights. Format: JSON array of numbers.":"\u7F16\u8F91 17 \u4E2A FSRS \u7B97\u6CD5\u6743\u91CD\u3002\u683C\u5F0F\uFF1A\u6570\u5B57\u6570\u7EC4\u7684 JSON \u683C\u5F0F\u3002","FSRS parameters updated successfully":"FSRS \u53C2\u6570\u66F4\u65B0\u6210\u529F","Activate HiCard":"\u6FC0\u6D3B HiCard","Enter your license key to activate HiCard feature.":"\u8F93\u5165\u60A8\u7684\u8BB8\u53EF\u8BC1\u5BC6\u94A5\u4EE5\u6FC0\u6D3B HiCard \u529F\u80FD\u3002","Enter license key":"\u8F93\u5165\u8BB8\u53EF\u8BC1\u5BC6\u94A5",Activate:"\u6FC0\u6D3B","Please enter a license key":"\u8BF7\u8F93\u5165\u8BB8\u53EF\u8BC1\u5BC6\u94A5","HiCard activated successfully!":"HiCard \u6FC0\u6D3B\u6210\u529F\uFF01","Invalid license key":"\u65E0\u6548\u7684\u8BB8\u53EF\u8BC1\u5BC6\u94A5","Use global settings":"\u4F7F\u7528\u5168\u5C40\u8BBE\u7F6E","New cards per day:":"\u6BCF\u65E5\u65B0\u5361\u6570\u91CF:","Reviews per day:":"\u6BCF\u65E5\u590D\u4E60\u6570\u91CF:","Create Group":"\u521B\u5EFA\u5206\u7EC4","Group name":"\u5206\u7EC4\u540D\u79F0",Create:"\u521B\u5EFA",Again:"\u91CD\u6765",Hard:"\u56F0\u96BE",Good:"\u826F\u597D",Easy:"\u7B80\u5355",Card:"\u5361\u7247",of:"\u5171",Settings:"\u8BBE\u7F6E","Are you sure you want to delete this group?":"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u5206\u7EC4\u5417\uFF1F",Yes:"\u662F",No:"\u5426","You've completed All cards for today!":"\u60A8\u4ECA\u5929\u5DF2\u5B8C\u6210\u6240\u6709\u5361\u7247\uFF01","No cards available.":"\u6CA1\u6709\u53EF\u7528\u7684\u5361\u7247\u3002","Return to First Card":"\u8FD4\u56DE\u7B2C\u4E00\u5F20\u5361\u7247","Edit Group":"\u7F16\u8F91\u5206\u7EC4","Create New Group":"\u521B\u5EFA\u65B0\u5206\u7EC4","Group Name":"\u5206\u7EC4\u540D\u79F0","Please fill in all fields":"\u8BF7\u586B\u5199\u6240\u6709\u5B57\u6BB5","Saving...":"\u4FDD\u5B58\u4E2D...","Creating...":"\u521B\u5EFA\u4E2D...","Group updated successfully":"\u5206\u7EC4\u66F4\u65B0\u6210\u529F","Failed to update group":"\u5206\u7EC4\u66F4\u65B0\u5931\u8D25","Group created successfully":"\u5206\u7EC4\u521B\u5EFA\u6210\u529F","Failed to create or update group":"\u521B\u5EFA\u6216\u66F4\u65B0\u5206\u7EC4\u5931\u8D25",Due:"\u5230\u671F",New:"\u65B0\u7684",Review:"\u590D\u4E60",Retention:"\u4FDD\u7559\u7387","Limits:":"\u9650\u5236\uFF1A","\u6BCF\u65E5\u5B66\u4E60\u9650\u5236\n":`\u6BCF\u65E5\u5B66\u4E60\u9650\u5236
`,"\u65B0\u5361\u7247:":"\u65B0\u5361\u7247:","\u590D\u4E60\u5361\u7247:":"\u590D\u4E60\u5361\u7247:","\u5B66\u4E60\u5B8C\u6210\uFF01":"\u5B66\u4E60\u5B8C\u6210\uFF01",\u8FD4\u56DE\u7B2C\u4E00\u5F20\u5361\u7247:"\u8FD4\u56DE\u7B2C\u4E00\u5F20\u5361\u7247","\u60A8\u4ECA\u5929\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002":"\u60A8\u4ECA\u5929\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002","\u60A8\u4ECA\u5929\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002":"\u60A8\u4ECA\u5929\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002",'\u60A8\u4ECA\u5929\u5728 "':'\u60A8\u4ECA\u5929\u5728 "','" \u5206\u7EC4\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002':'" \u5206\u7EC4\u7684\u65B0\u5361\u7247\u5B66\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u5B66\u4E60\u5427\u3002','" \u5206\u7EC4\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002':'" \u5206\u7EC4\u7684\u590D\u4E60\u914D\u989D\u5DF2\u7528\u5B8C\uFF01\u660E\u5929\u518D\u6765\u590D\u4E60\u5427\u3002','\u606D\u559C\uFF01\u60A8\u5DF2\u5B8C\u6210 "':'\u606D\u559C\uFF01\u60A8\u5DF2\u5B8C\u6210 "','" \u4E2D\u7684\u6240\u6709\u5361\u7247\u5B66\u4E60\u3002':'" \u4E2D\u7684\u6240\u6709\u5361\u7247\u5B66\u4E60\u3002','\u786E\u5B9A\u8981\u5220\u9664\u5206\u7EC4 "':'\u786E\u5B9A\u8981\u5220\u9664\u5206\u7EC4 "','" \u5417\uFF1F':'" \u5417\uFF1F',\u5206\u7EC4\u5220\u9664\u6210\u529F:"\u5206\u7EC4\u5220\u9664\u6210\u529F",\u5220\u9664\u5206\u7EC4\u5931\u8D25:"\u5220\u9664\u5206\u7EC4\u5931\u8D25","\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\uFF1A\n- \u6587\u4EF6\u5939\uFF1Afolder1, folder1/folder2\n- \u7B14\u8BB0\uFF1A[[note1]], [[note2]]\n- \u6807\u7B7E\uFF1A#tag1, #tag2\n- \u901A\u914D\u7B26\uFF1A*.excalidraw.md\n- \u5185\u5BB9\uFF1A\u76F4\u63A5\u8F93\u5165\u8981\u641C\u7D22\u7684\u6587\u672C":`\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\uFF1A
- \u6587\u4EF6\u5939\uFF1Afolder1, folder1/folder2
- \u7B14\u8BB0\uFF1A[[note1]], [[note2]]
- \u6807\u7B7E\uFF1A#tag1, #tag2
- \u901A\u914D\u7B26\uFF1A*.excalidraw.md
- \u5185\u5BB9\uFF1A\u76F4\u63A5\u8F93\u5165\u8981\u641C\u7D22\u7684\u6587\u672C`,"\u53CD\u8F6C\u5361\u7247\uFF08\u4F7F\u7528\u8BC4\u8BBA\u4F5C\u4E3A\u95EE\u9898\uFF09":"\u53CD\u8F6C\u5361\u7247\uFF08\u4F7F\u7528\u8BC4\u8BBA\u4F5C\u4E3A\u95EE\u9898\uFF09","Learning settings":"\u5B66\u4E60\u8BBE\u7F6E","\u8BB0\u5FC6\u4FDD\u6301\u7387 = (\u603B\u590D\u4E60\u6B21\u6570 - \u9057\u5FD8\u6B21\u6570) / \u603B\u590D\u4E60\u6B21\u6570\n\u8BE5\u6307\u6807\u53CD\u6620\u4E86\u4F60\u7684\u5B66\u4E60\u6548\u679C\uFF0C\u8D8A\u9AD8\u8BF4\u660E\u8BB0\u5FC6\u6548\u679C\u8D8A\u597D":`\u8BB0\u5FC6\u4FDD\u6301\u7387 = (\u603B\u590D\u4E60\u6B21\u6570 - \u9057\u5FD8\u6B21\u6570) / \u603B\u590D\u4E60\u6B21\u6570
\u8BE5\u6307\u6807\u53CD\u6620\u4E86\u4F60\u7684\u5B66\u4E60\u6548\u679C\uFF0C\u8D8A\u9AD8\u8BF4\u660E\u8BB0\u5FC6\u6548\u679C\u8D8A\u597D`,"Open (double-click)":"\u53CC\u51FB\u6253\u5F00"};var go={en:co,zh:ho};function m(F){let t=(uo.moment.locale().startsWith("zh")?go.zh:go.en)[F];return t||F}var pA=require("obsidian");var rr=class{constructor(e,A){this.containerEl=e,this.fsrsManager=A}render(){this.containerEl.empty(),this.containerEl.addClass("flashcard-stats-panel"),this.renderStatsArea(),this.renderHeatmap()}renderStatsArea(){let e=this.containerEl.createDiv("flashcard-stats-area"),A=this.fsrsManager.getProgress();this.createStatItem(e,A.newCards.toString(),"New","flashcard-stat-new"),this.createStatItem(e,A.learned.toString(),"Learning","flashcard-stat-learning"),this.createStatItem(e,A.due.toString(),"Review","flashcard-stat-due")}createStatItem(e,A,t,n){let o=e.createDiv(`flashcard-stat-item ${n}`),l=o.createDiv("flashcard-stat-value");l.textContent=A;let c=o.createDiv("flashcard-stat-label");c.textContent=t}renderHeatmap(){var e;this.createHeatmap(this.containerEl,((e=this.fsrsManager.storage)==null?void 0:e.dailyStats)||[])}createHeatmap(e,A){let t=e.createDiv("flashcard-heatmap-grid"),n=new Date;new Date(n).setDate(n.getDate()-83);let l=new Map,c=new Date(n);c.setHours(0,0,0,0);let d=c.getTime(),u=`${c.getFullYear()}-${c.getMonth()+1}-${c.getDate()}`,p=!1;[...A].forEach(N=>{let O=new Date(N.date),J=O.getFullYear(),j=O.getMonth()+1,FA=O.getDate(),wA=`${J}-${j}-${FA}`;wA===u&&(p=!0),l.set(wA,N)}),p||l.set(u,{date:d,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0});let v=7,Q=12;t.style.display="grid",t.style.gridTemplateRows=`repeat(${v}, 1fr)`,t.style.gridTemplateColumns=`repeat(${Q}, 1fr)`;let U=n.getDay(),E=U===0?6:U-1,H=new Date(n);H.setDate(n.getDate()-((U===0?7:U)-1));let M=new Date(H);M.setDate(M.getDate()-11*7);let x=[],D=[];for(let N=0;N<Q;N++){let O=new Date(M);O.setDate(O.getDate()+N*7),D.push(O)}for(let N=0;N<Q;N++){let O=[];for(let J=0;J<v;J++){let j=new Date(D[N]);j.setDate(j.getDate()+J),O.push(j)}x.push(O)}for(let N=0;N<v;N++)for(let O=0;O<Q;O++){let J=x[O][N],j=J.getFullYear(),FA=J.getMonth()+1,wA=J.getDate(),DA=`${j}-${FA}-${wA}`,aA=l.get(DA),tA=t.createDiv("flashcard-heatmap-cell"),xA=DA===u;if(aA){let mA=aA.newCardsLearned*1.5+aA.cardsReviewed;if(aA.reviewCount>0){let YA=(aA.againCount*1.5+aA.hardCount*1.2+aA.goodCount+aA.easyCount*.8)/aA.reviewCount;mA=mA*(YA+.5)}mA=Math.min(mA,20);let JA=Math.ceil(mA/4);tA.addClass(`flashcard-heatmap-level-${JA}`);let qA=`${J.toLocaleDateString()}: Learned ${aA.newCardsLearned} new cards, reviewed ${aA.cardsReviewed} cards`;aA.reviewCount>0&&(qA+=`
Rating distribution: Again(${aA.againCount}), Hard(${aA.hardCount}), Good(${aA.goodCount}), Easy(${aA.easyCount})`),tA.setAttribute("title",qA)}else xA||J>n,tA.addClass("flashcard-heatmap-level-0")}}addZoomControl(e,A){}};var sr=class{constructor(e){this.isMobileView=!1;this.isSmallScreen=!1;this.showingSidebar=!0;this.isInFlashcardMode=!1;this.component=e,this.isMobileView=pA.Platform.isMobile,this.isSmallScreen=window.innerWidth<768,this.showingSidebar=this.isMobileView,this.isInFlashcardMode=!0}renderActivation(){let e=this.component.getContainer();e.empty(),e.addClass("flashcard-mode");let A=e.createEl("div",{cls:"flashcard-activation-container"}),t=A.createEl("div",{cls:"flashcard-activation-header",text:m("Activate HiCard")}),n=A.createEl("div",{cls:"flashcard-activation-description",text:m("Enter your license key to activate HiCard feature.")}),o=A.createEl("div",{cls:"flashcard-activation-input-container"}),l=o.createEl("input",{cls:"flashcard-activation-input",type:"text",placeholder:m("Enter license key")});o.createEl("button",{cls:"flashcard-activation-button",text:m("Activate")}).addEventListener("click",async()=>{let d=l.value.trim();if(!d){new pA.Notice(m("Please enter a license key"));return}await this.component.getLicenseManager().activateLicense(d)?(new pA.Notice(m("HiCard activated successfully!")),this.render()):new pA.Notice(m("Invalid license key"))})}toggleSidebar(){this.showingSidebar=!this.showingSidebar,this.render()}isShowingSidebar(){return this.showingSidebar}showSidebar(){this.showingSidebar=!0;let e=this.component.getContainer();this.isMobileView&&this.isSmallScreen&&(e.addClass("show-sidebar"),e.removeClass("show-content")),this.render()}goBack(){this.isMobileView&&this.isSmallScreen&&(this.showingSidebar?this.component&&this.component.commentView&&(this.component.commentView.isFlashcardMode=!1,this.component.commentView.isShowingFileList=!0,this.component.commentView.updateViewLayout()):(this.showingSidebar=!0,this.render()))}render(){let e=this.component.getContainer();if(e.empty(),e.addClass("flashcard-mode"),this.isMobileView&&(e.addClass("is-mobile"),this.isSmallScreen&&e.addClass("is-small-screen"),this.showingSidebar?e.addClass("show-sidebar"):e.addClass("show-content")),!this.isMobileView||this.isMobileView&&!this.showingSidebar){let D=e.createEl("div",{cls:"flashcard-progress-container"});this.component.setProgressContainer(D),this.component.updateProgress()}let A=e.createEl("div",{cls:"flashcard-main-container"}),t=A.createEl("div",{cls:"flashcard-sidebar"}),n=t.createEl("div",{cls:"flashcard-stats-container"});new rr(n,this.component.getFsrsManager()).render();let l=t.createEl("div",{cls:"flashcard-groups"}),d=l.createEl("div",{cls:"flashcard-groups-header"}).createEl("div",{cls:"flashcard-add-group",attr:{"aria-label":m("Add Group")}});(0,pA.setIcon)(d,"plus"),d.addEventListener("click",()=>this.component.getGroupManager().showCreateGroupModal());let u=l.createEl("div",{cls:"flashcard-group-list"});(this.component.getFsrsManager().getCardGroups()||[]).forEach(D=>{let N=u.createEl("div",{cls:`flashcard-group-item ${D.name===this.component.getCurrentGroupName()?"active":""}`}),O=N.createEl("div",{cls:"flashcard-group-item-header"}),J=O.createEl("div",{cls:"flashcard-group-title"}),j=J.createEl("span",{cls:"flashcard-group-icon"});(0,pA.setIcon)(j,D.filter.startsWith("#")?"hash":"gallery-horizontal-end"),J.createEl("span",{cls:"flashcard-group-name",text:D.name});let FA=O.createEl("div",{cls:"flashcard-group-actions"}),wA=FA.createEl("div",{cls:"flashcard-group-action",attr:{"aria-label":m("Edit Group")}});(0,pA.setIcon)(wA,"edit"),wA.addEventListener("click",tA=>{tA.stopPropagation(),this.component.getGroupManager().showEditGroupModal(D)});let DA=FA.createEl("div",{cls:"flashcard-group-action",attr:{"aria-label":m("Delete Group")}});(0,pA.setIcon)(DA,"trash"),DA.addEventListener("click",async tA=>{if(tA.stopPropagation(),confirm(m('Are you sure you want to delete group "')+D.name+m('"?')))try{if(await this.component.getFsrsManager().deleteCardGroup(D.id)){if(this.component.getCurrentGroupName()===D.name){let mA=this.component.getFsrsManager().getCardGroups()||[];mA.length>0?this.component.setCurrentGroupName(mA[0].name):this.component.setCurrentGroupName("")}new pA.Notice(m("Group deleted successfully")),this.render()}else new pA.Notice(m("Delete group failed"))}catch(xA){console.error("Delete group failed:",xA),new pA.Notice(m("Delete group failed"))}});let aA=this.component.getFsrsManager().getGroupProgress(D.id);if(aA){let tA=N.createEl("div",{cls:"flashcard-group-stats"}),xA=tA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":m("Due Today")}}),mA=xA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(mA,"calendar-clock"),xA.createEl("span",{text:aA.due.toString()});let JA=tA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":m("New Cards")}}),qA=JA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(qA,"sparkle"),JA.createEl("span",{text:aA.newCards.toString()});let YA=tA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":m("Learned")}}),Se=YA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(Se,"check-small"),YA.createEl("span",{text:aA.learned.toString()})}N.addEventListener("click",()=>{this.component.setGroupCompletionMessage(this.component.getCurrentGroupName(),this.component.getCompletionMessage());let tA={currentIndex:this.component.getCurrentIndex(),isFlipped:this.component.isCardFlipped()};this.component.setCurrentGroupName(D.name),e.querySelectorAll(".flashcard-group-item").forEach(JA=>JA.classList.remove("active")),N.classList.add("active"),this.component.setCompletionMessage(this.component.getGroupCompletionMessage(D.name)||null),this.component.refreshCardList();let mA=this.component.getGroupProgress(D.name);mA&&!this.component.getCompletionMessage()?(this.component.setCurrentIndex(mA.currentIndex),this.component.setCardFlipped(mA.isFlipped)):(this.component.setCurrentIndex(0),this.component.setCardFlipped(!1)),this.isMobileView&&(this.showingSidebar=!1),this.component.saveState(),this.render()})});let v=A.createEl("div",{cls:"flashcard-content-area"}).createEl("div",{cls:"flashcard-container"}),Q=this.component.getCards(),U=this.component.getCurrentIndex(),E=Q.length>0&&U<Q.length?Q[U]:null,H=this.component.getCurrentGroupName(),M=this.component.getGroupCompletionMessage(H),x=this.component.getFsrsManager().getCardGroups().length>0;if(!x||Q.length===0){let D=this.component.getFsrsManager().getCardGroups().find(O=>O.name===H),N=D&&D.cardIds.length===0;if(x)if(N){let O=v.createEl("div",{cls:"flashcard-completion-message flashcard-empty-group"}),J=O.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"circle-slash-2"),O.createEl("h3",{text:m("No Cards in This Group")}),O.createEl("p",{text:m("This group doesn't contain any flashcards yet. Add some flashcards to this group to start learning.")})}else{let O=v.createEl("div",{cls:"flashcard-completion-message"}),J=O.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"check-circle"),O.createEl("h3",{text:m("Learning Completed!")});let j=M;j||(D?j=m("Group completed: ")+D.name+m(". All cards have been reviewed."):j=m("All flashcards completed for today!"),this.component.setGroupCompletionMessage(H,j)),O.createEl("p",{text:j})}else{let O=v.createEl("div",{cls:"flashcard-completion-message flashcard-no-group"}),J=O.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"folder-plus"),O.createEl("h3",{text:m("No Flashcard Groups")}),O.createEl("p",{text:m("You haven't created any flashcard groups yet. Create a group to get started with your flashcards.")}),O.createEl("button",{cls:"mod-cta",text:m("Create Flashcard Group")}).addEventListener("click",()=>{this.component&&this.component.groupManager?this.component.groupManager.showCreateGroupModal():console.error("Group manager is not available")})}return}if(E){let D=["flashcard"];this.component.isCardFlipped()&&D.push("is-flipped");let N=v.createEl("div",{cls:D.join(" ")}),j=this.component.getFsrsManager().getCardGroups().filter(SA=>this.component.getFsrsManager().getCardsInGroup(SA).some(gA=>gA.id===(E==null?void 0:E.id))).some(SA=>SA.isReversed),FA=j?E.answer:E.text,wA=j?E.text:E.answer,aA=N.createEl("div",{cls:"flashcard-side flashcard-front"}).createEl("div",{cls:"flashcard-content markdown-rendered"});this.renderMarkdownContent(aA,FA,E.filePath);let xA=N.createEl("div",{cls:"flashcard-side flashcard-back"}).createEl("div",{cls:"flashcard-content markdown-rendered"});this.renderMarkdownContent(xA,wA,E.filePath),N.addEventListener("click",()=>this.component.flipCard());let mA=v.createEl("div",{cls:"flashcard-rating"}),JA=E?this.component.getFsrsManager().getCardPredictions(E.id):null;this.component.getRatingButtons().forEach(SA=>{let se=mA.createEl("button",{cls:"flashcard-rating-button",attr:{"data-rating":SA.ratingText,title:`${SA.label} (${SA.key})`}});if(se.createSpan({text:SA.label}),JA&&JA[SA.rating]){let gA=new Date(JA[SA.rating].nextReview),PA=new Date,MA=gA.getTime()-PA.getTime(),ZA=se.createSpan({cls:"prediction-info"}),CA="";if(MA<60*60*1e3)CA=`${Math.max(1,Math.round(MA/6e4))}m`;else if(MA<24*60*60*1e3)CA=`${Math.round(MA/36e5)}h`;else{let KA=Math.round(MA/864e5);KA<1?CA=`${Math.round(KA*24)}h`:KA<30?CA=`${Math.round(KA)}d`:KA<365?CA=`${Math.round(KA/30)}mo`:CA=`${Math.round(KA/365)}y`}ZA.createSpan({text:CA,cls:"days"})}else{let gA=0,PA=(E==null?void 0:E.reviews)===0,MA=(E==null?void 0:E.lapses)>0;switch(SA.rating){case cA.AGAIN:gA=PA?.25:MA?.5:1;break;case cA.HARD:gA=PA?24:MA?36:48;break;case cA.GOOD:gA=PA?24*3:MA?24*5:24*7;break;case cA.EASY:gA=PA?24*5:MA?24*9:24*14;break}let ZA=gA/24,CA="";gA<1?CA=`${Math.round(gA*60)}m`:gA<24?CA=`${Math.round(gA)}h`:ZA<1?CA=`${Math.round(ZA*24)}h`:ZA<30?CA=`${Math.round(ZA)}d`:ZA<365?CA=`${Math.round(ZA/30)}mo`:CA=`${Math.round(ZA/365)}y`,se.createSpan({text:CA,cls:"days"})}se.addEventListener("click",gA=>{gA.stopPropagation(),this.component.rateCard(SA.rating)})}),this.component.isCardFlipped()&&N.classList.add("is-flipped");let qA=this.component.getCurrentGroupId(),YA=Q.length,Se=this.component.getFsrsManager(),UA=(qA?Se.getCardsForStudy(qA):[]).length,Pe=Math.max(UA,YA),Ke=Pe-YA+1;if(v.createEl("div",{cls:"flashcard-counter",text:`${Ke}/${Pe}`}),E.filePath){let se=v.createEl("div",{cls:"flashcard-source"}).createEl("span",{text:E.filePath.split("/").pop()||""});this.component.getUtils().addPagePreview(se,E.filePath),se.addEventListener("click",gA=>{gA.stopPropagation();let PA=this.component.getApp().vault.getAbstractFileByPath(E.filePath);PA&&PA instanceof pA.TFile&&this.component.getApp().workspace.getLeaf().openFile(PA)})}}else v.createEl("div",{cls:"flashcard-empty-state",text:m("No cards available")})}async renderMarkdownContent(e,A,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(!A){console.warn("renderMarkdownContent: content is empty or undefined"),e.textContent="Add answer";return}let n=e.closest(".flashcard-front")!==null,o=A;n?o=A.replace(/\{\{([^{}]+)\}\}/g,(l,c)=>{let u=c.split("").reduce((B,v)=>{let Q=/[\u4e00-\u9fa5]/.test(v);return B+(Q?3:1)},0);return c.length>5&&(u=Math.floor(u*1.2)),"_".repeat(Math.max(8,u))}):o=A.replace(/\{\{([^{}]+)\}\}/g,"$1");try{await pA.MarkdownRenderer.render(this.component.getApp(),o,e,t||"",new pA.Component),e.querySelectorAll("ul, ol").forEach(c=>{c.addClass("flashcard-markdown-list")}),n&&e.querySelectorAll("p").forEach(d=>{d.textContent&&d.textContent.includes("______")&&d.addClass("flashcard-cloze")})}catch(l){console.error("Error rendering markdown in flashcard:",l),e.textContent=o}}};var nr=class{constructor(e){this.component=e}flipCard(){let e=!this.component.isCardFlipped();this.component.setCardFlipped(e);let A=document.querySelector(".flashcard");A&&(e?A.classList.add("is-flipped"):A.classList.remove("is-flipped")),this.component.saveState()}nextCard(){let e=this.component.getCards();if(e.length===0)return;let A=this.component.getCurrentIndex()+1;A>=e.length&&(A=0),this.component.setCurrentIndex(A),this.component.setCardFlipped(!1),this.component.saveState(),this.component.getRenderer().render()}rateCard(e){let A=this.component.getCards(),t=this.component.getCurrentIndex();if(A.length===0||t>=A.length)return;let n=A[t];if(n){if(this.component.getFsrsManager().trackStudyProgress(n.id,e),A.splice(t,1),A.length===0){let o=this.component.getCurrentGroupName(),l=m("No cards due for review");if(o){let c=this.component.getFsrsManager().getCardGroups().find(d=>d.name===o);c&&(l=m("Group completed: ")+c.name+m(". Add more cards in Settings, but remember: more cards = more reviews."))}else l=m("All flashcards completed for today!");this.component.setGroupCompletionMessage(o,l),this.component.updateProgress(),this.component.getRenderer().render();return}t>=A.length&&this.component.setCurrentIndex(0),this.component.setCardFlipped(!1),this.component.saveState(),this.component.updateProgress(),this.component.getRenderer().render()}}refreshCardList(){let e=this.component.getCurrentGroupName(),A=this.component.getFsrsManager(),t=this.component.getCards(),n=this.component.getCurrentGroupName();if(t.length>0&&n&&n!==e){let v=this.component.getCards(),Q=this.component.getCurrentIndex(),U=v.length>0&&Q<v.length?v[Q].id:void 0,E={currentIndex:Q,isFlipped:this.component.isCardFlipped(),currentCardId:U},H=A.getUIState();H.groupProgress||(H.groupProgress={}),H.groupProgress[n]=E,A.updateUIState(H)}let o=A.getCardGroups().find(v=>v.name===e);if(!o){console.error(`\u672A\u627E\u5230\u540D\u79F0\u4E3A ${e} \u7684\u5206\u7EC4`);return}let l=A.getCardsByGroupId(o.id),c=A.fsrsService,d=l.filter(v=>!!(v.reviews===0&&v.lastReview===0||c.isDue(v)));if(d.length===0){let v=m("No cards due for review");e?v=m("Group completed: ")+o.name+m(". Add more cards in Settings, but remember: more cards = more reviews."):v=m("All flashcards completed for today!"),this.component.setGroupCompletionMessage(e,v),this.component.setCards([]),this.component.updateProgress();let Q=A.getUIState();Q.groupProgress||(Q.groupProgress={}),Q.groupProgress[e]={currentIndex:0,isFlipped:!1,currentCardId:null,completionMessage:v},A.updateUIState(Q),this.component.getRenderer().render(),this.component.saveState();return}let u=d,p=this.component.getGroupProgress(e),B=A.getUIState();if(B.groupProgress||(B.groupProgress={}),B.groupProgress[e]?B.groupProgress[e].completionMessage=void 0:B.groupProgress[e]={currentIndex:0,isFlipped:!1,currentCardId:void 0,completionMessage:void 0},A.updateUIState(B),this.component.setCards(u),u.length>0)if(p){let v=0;if(p.currentCardId){let Q=u.findIndex(U=>U.id===p.currentCardId);Q!==-1?v=Q:v=Math.min(p.currentIndex,u.length-1)}else v=Math.min(p.currentIndex,u.length-1);this.component.setCurrentIndex(v),this.component.setCardFlipped(p.isFlipped)}else this.component.setCurrentIndex(0),this.component.setCardFlipped(!1);else{let v=m("No cards due for review");if(e){let Q=A.getCardGroups().find(U=>U.name===e);Q&&(v=m("Group completed: ")+Q.name+m(". Add more cards in Settings, but remember: more cards = more reviews."))}else v=m("All flashcards completed for today!");this.component.setGroupCompletionMessage(e,v)}this.component.saveState()}};var ii=require("obsidian");var ar=class{constructor(e){this.component=e}showCreateGroupModal(){this.showEditGroupModal()}showEditGroupModal(e){var CA,KA,Tt;let{app:A}=this.component.getApp(),t=document.createElement("div");t.className="flashcard-modal-overlay",document.body.appendChild(t);let n=document.createElement("div");n.className="flashcard-modal-container",t.appendChild(n);let o=document.createElement("div");o.className="flashcard-modal-content",n.appendChild(o);let l=document.createElement("div");l.className="flashcard-modal-header",o.appendChild(l);let c=document.createElement("h3");c.textContent=e?m("Edit group"):m("Create group"),l.appendChild(c);let d=document.createElement("div");d.className="flashcard-group-form",o.appendChild(d);let u=e?e.name:"",p=document.createElement("input");p.type="text",p.className="flashcard-modal-input",p.placeholder=m("Enter name"),p.value=u,d.appendChild(p),p.addEventListener("input",BA=>{u=BA.target.value});let B=e?e.filter:"",v=document.createElement("textarea");v.className="flashcard-modal-input",v.placeholder=m(`Support format: 
Folder: folder1, folder1/folder2
Note: [[note1]], [[note2]]`),v.value=B,d.appendChild(v),v.addEventListener("input",BA=>{B=BA.target.value});let Q=e&&e.isReversed||!1,U=document.createElement("div");U.className="flashcard-modal-option",d.appendChild(U);let E=document.createElement("input");E.type="checkbox",E.className="flashcard-modal-checkbox",E.checked=Q,U.appendChild(E);let H=document.createElement("label");H.textContent=m("Reverse cards (use comments as questions)"),H.className="flashcard-modal-label",U.appendChild(H),E.addEventListener("change",BA=>{Q=BA.target.checked});let M=document.createElement("div");M.className="flashcard-modal-settings",d.appendChild(M);let x=document.createElement("div");x.className="flashcard-modal-settings-header",M.appendChild(x);let D=document.createElement("h4");D.textContent=m("Learning settings"),D.className="settings-title",x.appendChild(D);let N=e?((CA=e.settings)==null?void 0:CA.useGlobalSettings)!==!1:!0,O=document.createElement("div");O.className="flashcard-modal-option use-global-option",x.appendChild(O);let J=document.createElement("input");J.type="checkbox",J.className="flashcard-modal-checkbox",J.id="use-global-settings",J.checked=N,O.appendChild(J);let j=document.createElement("label");j.textContent=m("Use global settings"),j.className="flashcard-modal-label",j.htmlFor="use-global-settings",O.appendChild(j),J.addEventListener("change",BA=>{N=BA.target.checked,se()});let FA=e&&((KA=e.settings)==null?void 0:KA.newCardsPerDay)||20,wA=document.createElement("div");wA.className="flashcard-modal-option slider-option",M.appendChild(wA);let DA=document.createElement("label");DA.textContent=m("New cards per day: "),DA.className="flashcard-modal-label",wA.appendChild(DA);let aA=document.createElement("div");aA.className="slider-with-value",wA.appendChild(aA);let tA=document.createElement("input");tA.className="flashcard-modal-slider",tA.type="range",tA.min="5",tA.max="100",tA.step="5",tA.value=String(FA);let xA=parseInt(tA.value);xA<5?tA.value="5":xA%5!==0&&(tA.value=(Math.round(xA/5)*5).toString()),aA.appendChild(tA);let mA=document.createElement("span");mA.className="slider-value",mA.textContent=tA.value,aA.appendChild(mA),tA.addEventListener("input",()=>{FA=parseInt(tA.value),mA.textContent=tA.value});let JA={setDisabled:BA=>{tA.disabled=BA,wA.classList.toggle("disabled",BA)}},qA=e&&((Tt=e.settings)==null?void 0:Tt.reviewsPerDay)||100,YA=document.createElement("div");YA.className="flashcard-modal-option slider-option",M.appendChild(YA);let Se=document.createElement("label");Se.textContent=m("Reviews per day: "),Se.className="flashcard-modal-label",YA.appendChild(Se);let De=document.createElement("div");De.className="slider-with-value",YA.appendChild(De);let UA=document.createElement("input");UA.className="flashcard-modal-slider",UA.type="range",UA.min="10",UA.max="500",UA.step="10",UA.value=String(qA);let Pe=parseInt(UA.value);Pe<10?UA.value="10":Pe%10!==0&&(UA.value=(Math.round(Pe/10)*10).toString()),De.appendChild(UA);let Ke=document.createElement("span");Ke.className="slider-value",Ke.textContent=UA.value,De.appendChild(Ke),UA.addEventListener("input",()=>{qA=parseInt(UA.value),Ke.textContent=UA.value});let SA={setDisabled:BA=>{UA.disabled=BA,YA.classList.toggle("disabled",BA)}},se=()=>{N?(JA.setDisabled(!0),SA.setDisabled(!0)):(JA.setDisabled(!1),SA.setDisabled(!1))};se();let gA=document.createElement("div");gA.className="button-container",o.appendChild(gA);let PA=document.createElement("button");PA.className="flashcard-cancel-btn",PA.textContent=m("Cancel"),gA.appendChild(PA);let MA=document.createElement("button");MA.className="flashcard-save-group-btn",MA.textContent=e?m("Save"):m("Create"),gA.appendChild(MA),MA.addEventListener("click",async()=>{if(!u){new ii.Notice(m("Group name cannot be empty"));return}let BA=this.component.getFsrsManager();if(e){let me=e.name;try{await BA.updateCardGroup(e.id,{name:u,filter:B,isReversed:Q,settings:{useGlobalSettings:N,newCardsPerDay:N?void 0:FA,reviewsPerDay:N?void 0:qA},lastUpdated:Date.now()});let IA=BA.storage;IA&&IA.uiState&&(IA.uiState.groupCompletionMessages&&IA.uiState.groupCompletionMessages[me]!==void 0&&(IA.uiState.groupCompletionMessages[u]=IA.uiState.groupCompletionMessages[me],delete IA.uiState.groupCompletionMessages[me]),IA.uiState.groupProgress&&IA.uiState.groupProgress[me]&&(IA.uiState.groupProgress[u]=IA.uiState.groupProgress[me],delete IA.uiState.groupProgress[me]),IA.uiState.currentGroupName===me&&(IA.uiState.currentGroupName=u),await BA.saveStoragePublic()),this.component.getCurrentGroupName()===me&&this.component.setCurrentGroupName(u),this.component.refreshCardList(),this.component.getRenderer().render(),new ii.Notice(m("Group update successful"))}catch(IA){console.error("Update group failed:",IA),new ii.Notice(m("Update group failed"))}}else await BA.createCardGroup({name:u,filter:B,isReversed:Q,createdTime:Date.now(),sortOrder:BA.getCardGroups().length,settings:{useGlobalSettings:N,newCardsPerDay:N?void 0:FA,reviewsPerDay:N?void 0:qA}}),new ii.Notice(m("Group created")),this.component.refreshCardList(),this.component.getRenderer().render();document.body.removeChild(t),e&&this.component.getRenderer().render()});let ZA=BA=>{BA.key==="Escape"&&(document.body.removeChild(t),document.removeEventListener("keydown",ZA))};document.addEventListener("keydown",ZA),PA.addEventListener("click",()=>{document.body.removeChild(t),e&&this.component.getRenderer().render()})}};var po=require("obsidian"),or=class{constructor(e){this.component=e}getGroupProgress(){let e=this.component.getCurrentGroupId(),A=[];e?A=this.component.getFsrsManager().getCardsByGroupId(e):A=(()=>{let d=this.component.getFsrsManager(),u=d.getCardGroups(),p=[],B=new Set;return u.forEach(v=>{d.getCardsByGroupId(v.id).forEach(U=>{B.has(U.id)||(B.add(U.id),p.push(U))})}),p})();let n=A.filter(d=>this.component.getFsrsManager().fsrsService.isDue(d)).length,o=A.filter(d=>d.reviews===0).length,l=A.filter(d=>d.reviews>0).length,c=this.calculateRetention(A);return{due:n,newCards:o,learned:l,retention:c}}calculateRetention(e){let A=e.filter(n=>n.reviews>0);return A.length===0?1:A.reduce((n,o)=>n+o.retrievability,0)/A.length}updateProgress(){let e=this.component.getProgressContainer();if(!e)return;e.empty();let A=this.getGroupProgress(),t=e.createEl("div",{cls:"flashcard-progress-text"});t.createSpan({text:this.component.getCurrentGroupName()||m("Groups"),cls:"group-name"}),t.createSpan({text:"|",cls:"separator"}),[{label:m("Due"),value:A.due},{label:m("New"),value:A.newCards},{label:m("Learned"),value:A.learned},{label:m("Retention"),value:`${(A.retention*100).toFixed(1)}%`}].forEach((H,M)=>{M>0&&t.createSpan({text:"|",cls:"separator"});let x=t.createEl("div",{cls:"stat"});if(x.createSpan({text:H.label+": "}),x.createSpan({text:H.value.toString(),cls:"stat-value"}),H.label===m("Retention")){let D=x.createSpan({cls:"help-icon"});(0,po.setIcon)(D,"help-circle"),D.setAttribute("aria-label",m(`Retention = (Total Reviews - Forget Count) / Total Reviews
This metric reflects your learning effectiveness, higher means better memory retention`))}});let l=e.createEl("div",{cls:"flashcard-progress-bar-container"}).createEl("div",{cls:"flashcard-progress-bar"}),c=A.due+A.newCards,d=this.component.getCards().length,u=c>0?Math.round((c-d)/c*100):100;if(l.style.width=`${u}%`,this.component.getCurrentGroupName()){let H=this.component.getFsrsManager().getCardGroups().find(M=>M.id===this.component.getCurrentGroupName());if(H){let M=e.createEl("div",{cls:"flashcard-group-name-container"});M.createEl("div",{cls:"flashcard-group-name",text:H.name}),H.filter&&M.createEl("div",{cls:"flashcard-group-filter",text:m("Filter")+": "+H.filter})}}let p=e.createEl("div",{cls:"flashcard-index-container"}),B=this.component.getCurrentGroupId(),v=this.component.getCards().length,Q=this.component.getFsrsManager(),E=(B?Q.getCardsForStudy(B):[]).length;if(E>0||v>0){let H=Math.max(E,v),M=H-v+1;v>0?p.textContent=`${M}/${H}`:p.textContent=`${H}/${H}`}else p.textContent="0/0"}saveState(){let e=this.component.getCurrentGroupName(),A=this.component.getFsrsManager().getUIState();A.currentGroupName=e,A.currentIndex=this.component.getCurrentIndex(),A.isFlipped=this.component.isCardFlipped(),A.completionMessage=this.component.getCompletionMessage(),A.groupProgress||(A.groupProgress={}),A.groupProgress[e]={currentIndex:this.component.getCurrentIndex(),isFlipped:this.component.isCardFlipped()},A.groupCompletionMessages||(A.groupCompletionMessages={}),A.groupCompletionMessages[e]=this.component.getGroupCompletionMessage(e),this.component.getFsrsManager().updateUIState(A)}};var lr=class{constructor(e){this.component=e}addPagePreview(e,A){if(!A)return;let t;e.addEventListener("mouseenter",n=>{t=setTimeout(()=>{let o=n.target;this.component.getApp().workspace.trigger("hover-link",{event:n,source:"hi-note",hoverParent:o,targetEl:o,linktext:A})},300)}),e.addEventListener("mouseleave",()=>{t&&clearTimeout(t)})}};var ri=class extends fo.Component{constructor(A,t){super();this.progressContainer=null;this.currentIndex=0;this.isFlipped=!1;this.cards=[];this.isActive=!1;this.currentCard=null;this.currentGroupName="";this.currentGroupId="";this.completionMessage=null;this.groupProgress={};this.ratingButtons=[{label:m("Again"),rating:cA.AGAIN,key:"1",ratingText:"again"},{label:m("Hard"),rating:cA.HARD,key:"2",ratingText:"hard"},{label:m("Good"),rating:cA.GOOD,key:"3",ratingText:"good"},{label:m("Easy"),rating:cA.EASY,key:"4",ratingText:"easy"}];this.container=A,this.app=t.app,this.fsrsManager=t.fsrsManager,this.renderer=new sr(this),this.operations=new nr(this),this.groupManager=new ar(this),this.progressManager=new or(this),this.utils=new lr(this),this.groupProgress={};let n=this.fsrsManager.getUIState()||{};if(this.currentGroupName=n.currentGroupName||"",this.currentGroupName){let o=this.fsrsManager.getCardGroups().find(l=>l.name===this.currentGroupName);o?this.currentGroupId=o.id:this.currentGroupId=""}else this.currentGroupId="";this.completionMessage=n.completionMessage||null,n.groupProgress&&(this.groupProgress={...n.groupProgress}),this.currentGroupName&&this.groupProgress[this.currentGroupName]?(this.currentIndex=this.groupProgress[this.currentGroupName].currentIndex||0,this.isFlipped=this.groupProgress[this.currentGroupName].isFlipped||!1):(this.currentIndex=0,this.isFlipped=!1),(!n||!n.groupProgress||typeof n.groupProgress!="object")&&(this.groupProgress={}),n&&"groupProgress"in n&&n.groupProgress&&typeof n.groupProgress=="object"?this.groupProgress={...n.groupProgress}:this.groupProgress={}}setLicenseManager(A){this.licenseManager=A}setCards(A){this.cards=A}cleanup(){}async activate(){if(this.isActive=!0,this.licenseManager){let A=await this.licenseManager.isActivated(),t=A?await this.licenseManager.isFeatureEnabled("flashcard"):!1;if(A&&t){this.operations.refreshCardList(),this.renderer.render();return}}this.renderer.renderActivation()}renderActivation(){this.renderer.renderActivation()}deactivate(){this.isActive=!1,this.container.empty(),this.container.removeClass("flashcard-mode")}destroy(){this.container.removeClass("flashcard-mode"),this.container.empty()}getContainer(){return this.container}getApp(){return this.app}getFsrsManager(){return this.fsrsManager}getLicenseManager(){return this.licenseManager}getCards(){return this.cards}getCurrentIndex(){return this.currentIndex}setCurrentIndex(A){this.currentIndex=A}isCardFlipped(){return this.isFlipped}setCardFlipped(A){this.isFlipped=A}getCurrentGroupName(){return this.currentGroupName}setCurrentGroupName(A){if(this.currentGroupName=A,A){let t=this.fsrsManager.getCardGroups().find(n=>n.name===A);t?this.currentGroupId=t.id:this.currentGroupId=""}else this.currentGroupId=""}getCurrentGroupId(){return this.currentGroupId}setCurrentGroupId(A){if(this.currentGroupId=A,A){let t=this.fsrsManager.getCardGroups().find(n=>n.id===A);this.currentGroupName=t?t.name:""}else this.currentGroupName=""}getCompletionMessage(){return this.completionMessage}setCompletionMessage(A){this.completionMessage=A}getGroupCompletionMessage(A){return this.groupProgress[A]&&this.groupProgress[A].completionMessage||null}setGroupCompletionMessage(A,t){if(this.groupProgress[A]||(this.groupProgress[A]={currentIndex:0,isFlipped:!1,completionMessage:null}),this.groupProgress[A].completionMessage=t,this.fsrsManager){let n=this.fsrsManager.getUIState();n.groupProgress||(n.groupProgress={}),n.groupProgress[A]||(n.groupProgress[A]={currentIndex:0,isFlipped:!1,currentCardId:void 0,completionMessage:void 0}),n.groupProgress[A].completionMessage=t,t&&(n.groupProgress[A].isFlipped=!1,n.groupProgress[A].currentCardId=void 0),this.fsrsManager.updateUIState(n)}}getGroupProgress(A){let t=A||this.currentGroupName;return this.groupProgress[t]||null}isComponentActive(){return this.isActive}getProgressContainer(){return this.progressContainer}setProgressContainer(A){this.progressContainer=A}getRatingButtons(){return this.ratingButtons}flipCard(){this.operations.flipCard()}nextCard(){this.operations.nextCard()}rateCard(A){this.operations.rateCard(A)}refreshCardList(){this.operations.refreshCardList()}saveState(){let A=this.getCurrentGroupName(),t=this.fsrsManager.getUIState();if(t.currentGroupName=A,t.completionMessage=this.completionMessage,t.groupProgress||(t.groupProgress={}),A){let n=this.cards.length>0&&this.currentIndex<this.cards.length?this.cards[this.currentIndex].id:void 0,o=this.getGroupCompletionMessage(A);t.groupProgress[A]?(t.groupProgress[A].currentIndex=this.currentIndex,t.groupProgress[A].isFlipped=this.isFlipped,t.groupProgress[A].currentCardId=n,t.groupProgress[A].completionMessage=o):t.groupProgress[A]={currentIndex:this.currentIndex,isFlipped:this.isFlipped,currentCardId:n,completionMessage:o}}this.fsrsManager.updateUIState(t)}updateProgress(){this.progressManager.updateProgress()}getRenderer(){return this.renderer}getOperations(){return this.operations}getGroupManager(){return this.groupManager}getProgressManager(){return this.progressManager}getUtils(){return this.utils}};var si=require("obsidian");var mo={id:"default",name:m("Default Template"),description:m("Modern minimalist knowledge card style"),render:F=>{var Q;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-modern";let A=document.createElement("div");A.className="highlight-export-quote-section";let t=document.createElement("div");t.className="highlight-export-quote-decoration";let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("viewBox","0 0 24 24"),n.setAttribute("width","48"),n.setAttribute("height","48"),n.setAttribute("fill","none"),n.setAttribute("stroke","currentColor"),n.setAttribute("stroke-width","1");let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"),n.appendChild(o),n.appendChild(l),t.appendChild(n),A.appendChild(t);let c=document.createElement("div");c.className="highlight-export-quote",c.textContent=F.text,A.appendChild(c),e.appendChild(A);let d=document.createElement("div");d.className="highlight-export-footer";let u=document.createElement("div");u.className="highlight-export-source",u.textContent=F.fileName||((Q=F.filePath)==null?void 0:Q.split("/").pop())||"Untitled",d.appendChild(u);let p=document.createElement("div");p.className="highlight-export-date";let B=new Date,v={year:"numeric",month:"long",day:"numeric"};return p.textContent=B.toLocaleDateString(void 0,v),d.appendChild(p),e.appendChild(d),e}},Xg={id:"academic",name:m("Academic Template"),description:m("Formal style suitable for academic citations"),render:F=>{var l;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-academic";let A=document.createElement("div");A.className="highlight-export-quote",A.textContent=`"${F.text}"`,e.appendChild(A);let t=document.createElement("div");t.className="highlight-export-footer";let n=document.createElement("div");n.className="highlight-export-source",n.textContent=F.fileName||((l=F.filePath)==null?void 0:l.split("/").pop())||"Untitled",t.appendChild(n);let o=document.createElement("div");return o.className="highlight-export-date",o.textContent=`Retrieved: ${new Date().toLocaleDateString()}`,t.appendChild(o),e.appendChild(t),e}},Jg={id:"social",name:m("Social Template"),description:m("Modern style suitable for social media sharing"),render:F=>{var B;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-social";let A=document.createElement("div");A.className="highlight-export-header";let t=document.createElement("div");t.className="highlight-export-logo";let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("width","24"),n.setAttribute("height","24"),n.setAttribute("viewBox","0 0 100 100"),n.setAttribute("fill","currentColor"),n.setAttribute("stroke","none");let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M50,9.4L14.8,37.1l12.6,38.8l22.6,14.7l22.6-14.7l12.6-38.8L50,9.4z M50,19.5l25.5,20l-9.4,28.9L50,80.6 L33.9,68.4l-9.4-28.9L50,19.5z");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M50,19.5l-25.5,20l9.4,28.9L50,80.6V19.5z"),l.setAttribute("fill-opacity","0.3"),n.appendChild(o),n.appendChild(l),t.appendChild(n),A.appendChild(t);let c=document.createElement("div");c.className="highlight-export-app-name",c.textContent="HiNote",A.appendChild(c),e.appendChild(A);let d=document.createElement("div");d.className="highlight-export-quote",d.textContent=F.text,e.appendChild(d);let u=document.createElement("div");u.className="highlight-export-footer";let p=document.createElement("div");return p.className="highlight-export-source",p.textContent=F.fileName||((B=F.filePath)==null?void 0:B.split("/").pop())||"Untitled",u.appendChild(p),e.appendChild(u),e}},Js=[mo,Xg,Jg];function Ys(F){return Js.find(e=>e.id===F)||mo}var Bo=`
    /* \u5BFC\u51FA\u5361\u7247\u57FA\u7840\u6837\u5F0F */
    .highlight-export-card {
        transition: all 0.3s ease;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        
        /* \u6DFB\u52A0\u66F4\u4E25\u683C\u7684\u6587\u672C\u63A7\u5236 */
        font-size: 16px;
        line-height: 1.6;
        letter-spacing: normal;
        word-spacing: normal;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    /* \u73B0\u4EE3\u98CE\u683C\u6A21\u677F */
    .highlight-export-card-modern {
        padding: 24px;
        position: relative;
        overflow: hidden;
    }

    .highlight-export-card-modern::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(to bottom right, #5871ef 0%, #4c63e6 100%);
    }

    .highlight-export-card-modern .highlight-export-quote-decoration {
        position: absolute;
        top: 24px;
        right: 24px;
        opacity: 0.06;
        transform: scale(2);
    }

    .highlight-export-card-modern .highlight-export-quote-section {
        position: relative;
        padding: 24px 0;
        /* \u786E\u4FDD\u5F15\u7528\u90E8\u5206\u7684\u6587\u672C\u6837\u5F0F\u4E00\u81F4\u6027 */
        font-size: inherit;
        line-height: inherit;
        letter-spacing: inherit;
        word-spacing: inherit;
    }

    .highlight-export-card-modern .highlight-export-quote {
        font-size: 1em;
        line-height: 1.7;
        color: #333333;
        font-weight: 400;
        margin: 0;
        position: relative;
        z-index: 1;
        /* \u786E\u4FDD\u5F15\u7528\u6587\u672C\u7684\u6837\u5F0F\u4E00\u81F4\u6027 */
        letter-spacing: normal;
        word-spacing: normal;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
    }

    /* \u786E\u4FDD\u6240\u6709\u6587\u672C\u5143\u7D20\u7EE7\u627F\u57FA\u7840\u6837\u5F0F */
    .highlight-export-card * {
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
    }

    /* \u5BFC\u51FA\u9884\u89C8\u5BB9\u5668 */
    .highlight-export-preview {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 20px;
    }

    /* \u5BFC\u51FA\u5BB9\u5668 */
    .highlight-export-container {
        padding: 20px;
        margin: 0;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        width: 480px;
    }
`;var cr=class extends si.Modal{constructor(A,t,n){super(A);this.selectedTemplateId="default";this.includeComments=!1;this.highlight=t,this.html2canvasInstance=n}async onOpen(){let{contentEl:A}=this;A.empty(),A.addClass("highlight-export-modal");let t=A.createEl("div",{cls:"highlight-export-main-container"}),n=t.createEl("select",{cls:"highlight-template-select"});Js.forEach(l=>{let c=n.createEl("option",{text:l.name,value:l.id});this.selectedTemplateId===l.id&&(c.selected=!0)}),n.addEventListener("change",l=>{let c=l.target;this.selectedTemplateId=c.value,this.updatePreview()}),this.previewContainer=t.createEl("div",{cls:"highlight-export-preview-container"}),this.updatePreview();let o=A.createEl("div",{cls:"highlight-export-modal-buttons"});if(this.highlight.comments&&this.highlight.comments.length>0){let l=o.createEl("div",{cls:"highlight-export-checkbox-container"}),c=l.createEl("input",{attr:{type:"checkbox",id:"include-comments-checkbox"},cls:"highlight-export-checkbox"}),d=l.createEl("label",{text:m("Include Comments"),attr:{for:"include-comments-checkbox"},cls:"highlight-export-checkbox-label"});c.addEventListener("change",u=>{this.includeComments=u.target.checked,this.updatePreview()})}o.createEl("button",{cls:"highlight-btn",text:m("Cancel")}).addEventListener("click",()=>this.close()),o.createEl("button",{cls:"highlight-btn highlight-btn-primary",text:m("Download")}).addEventListener("click",async()=>{try{let l=document.createElement("div");l.className="highlight-export-container";let d=Ys(this.selectedTemplateId).render(this.highlight);l.appendChild(d),this.includeComments&&this.highlight.comments&&this.highlight.comments.length>0&&this.addCommentsToContainer(l),document.body.appendChild(l);let p=(await this.html2canvasInstance(l,{backgroundColor:null,scale:window.devicePixelRatio*2,useCORS:!0,allowTaint:!0,logging:!1,imageTimeout:0,removeContainer:!0,onclone:async v=>{let Q=v.createElement("style");Q.textContent=this.getExportStyles(),v.head.appendChild(Q),await new Promise(U=>setTimeout(U,100))}})).toDataURL("image/png",1),B=document.createElement("a");B.download=`highlight-${this.selectedTemplateId}-${Date.now()}.png`,B.href=p,B.click(),this.close(),new si.Notice(m("Export successful!"))}catch(l){new si.Notice(m("Export failed, please try again"))}})}updatePreview(){this.previewContainer.empty(),this.previewContainer.className="highlight-export-preview";let t=Ys(this.selectedTemplateId).render(this.highlight);this.previewContainer.appendChild(t),this.includeComments&&this.highlight.comments&&this.highlight.comments.length>0&&this.addCommentsToContainer(this.previewContainer)}addCommentsToContainer(A){let t=A.querySelector(".highlight-export-card");if(!t)return;let n=t.querySelector(".highlight-export-footer");if(!n)return;let o=document.createElement("div");o.className="highlight-export-comments-section";let l=document.createElement("div");l.className="highlight-export-comments-list",o.appendChild(l),this.highlight.comments&&this.highlight.comments.forEach(c=>{let d=document.createElement("div");d.className="highlight-export-comment-item";let u=document.createElement("div");if(u.className="highlight-export-comment-content",u.textContent=c.content,d.appendChild(u),c.createdAt){let p=document.createElement("div");p.className="highlight-export-comment-time",p.textContent=new Date(c.createdAt).toLocaleString(),d.appendChild(p)}l.appendChild(d)}),t.insertBefore(o,n)}getExportStyles(){return`
            body {
                margin: 0;
                background: none;
            }
            ${Bo}
        `}onClose(){let{contentEl:A}=this;A.empty()}};var ai=require("obsidian");var ni=class extends ai.Component{constructor(A,t,n,o=window.app){super();this.highlight=t;this.onHighlightClick=n;this.app=o;this.render(A).catch(l=>{console.error("Error rendering highlight content:",l)})}async render(A){this.container=A.createEl("div",{cls:"highlight-content"}),await this.renderText()}async renderText(){this.textContainer=this.container.createEl("div",{cls:"highlight-text-container"});let A=this.textContainer.createEl("div",{cls:"highlight-text-decorator"});this.highlight.backgroundColor&&(A.style.backgroundColor=this.highlight.backgroundColor);let n=this.textContainer.createEl("div",{cls:"highlight-text"}).createEl("div",{cls:`highlight-text-content ${this.highlight.isVirtual?"virtual-highlight":""} markdown-rendered`}),o=(this.highlight.isVirtual?this.highlight.displayText:this.highlight.text)||"";try{await ai.MarkdownRenderer.render(this.app,o,n,this.highlight.filePath||"",new ai.Component),n.querySelectorAll("ul, ol").forEach(c=>{c.addClass("highlight-markdown-list")}),await this.activateInternalLinks(n,this.highlight.filePath||"")}catch(l){console.error("Error rendering markdown in highlight:",l);let c=o.split(`
`);c.forEach((d,u)=>{let p=n.createEl("p",{text:d,cls:"highlight-text-line"});u<c.length-1&&p.addClass("highlight-text-line-spacing")})}this.highlight.isGlobalSearch?(n.addClass("global-search-highlight"),n.removeAttribute("aria-label"),n.style.cursor="default"):(n.setAttribute("aria-label",m("Jump to highlight")),n.addEventListener("mousedown",async l=>{l.target.closest("a")||(l.preventDefault(),l.stopPropagation(),await this.onHighlightClick(this.highlight))}))}async activateInternalLinks(A,t){A.querySelectorAll("a.internal-link").forEach(l=>{let c=l.getAttribute("data-href")||l.getAttribute("href");c&&(l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.metadataCache.getFirstLinkpathDest(c,t)&&this.app.workspace.openLinkText(c,t,!1)}),l.addEventListener("mouseenter",d=>{this.app.workspace.trigger("hover-link",{event:d,source:"hi-note",hoverParent:A,targetEl:l,linktext:c,sourcePath:t})}))}),A.querySelectorAll("a.tag").forEach(l=>{let c=l.getAttribute("href");c&&l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.workspace.trigger("search:open",c)})})}getContainer(){return this.container}};ni.dragPreview=null;var gr=require("obsidian"),wo=/#[\w\u4e00-\u9fa5]+/g,hr=/^\s*(#[\w\u4e00-\u9fa5]+(\s+#[\w\u4e00-\u9fa5]+)*\s*)$/,dr=class extends gr.Component{constructor(A,t,n){super();this.highlight=t;this.onCommentEdit=n;this.app=window.app,this.render(A)}render(A){if((this.highlight.comments||[]).length===0)return;let n=A.createEl("div",{cls:"hi-notes-section"});this.container=n.createEl("div",{cls:"hi-notes-list"}),this.renderComments().catch(o=>{console.error("Error rendering comments:",o)})}async renderComments(){let A=this.highlight.comments||[];for(A.sort((t,n)=>{let o=hr.test(t.content),l=hr.test(n.content);return o&&!l?-1:!o&&l?1:n.updatedAt-t.updatedAt});this.container.firstChild;)this.container.removeChild(this.container.firstChild);for(let t of A){let n=hr.test(t.content),o=this.container.createEl("div",{cls:`hi-note${n?" pure-tags-comment":""}`,attr:{"data-comment-id":t.id}}),l=o.createEl("div",{cls:"hi-note-content markdown-rendered"}),c=t.content;if(hr.test(c)){let u=c,p=c.match(wo)||[];for(;l.firstChild;)l.removeChild(l.firstChild);if(p.length>0){let B=u.split(wo),v=0;B.forEach((Q,U)=>{if(Q&&l.appendChild(document.createTextNode(Q)),U<p.length){let E=document.createElement("span");E.className="highlight-tag",E.textContent=p[U],l.appendChild(E)}})}else l.textContent=c}else try{await gr.MarkdownRenderer.renderMarkdown(c,l,this.highlight.filePath||"",this),l.querySelectorAll("ul, ol").forEach(p=>{p.addClass("comment-markdown-list")}),await this.activateInternalLinks(l,this.highlight.filePath||"")}catch(u){console.error("Error rendering markdown in comment:",u),l.textContent=c}l.addEventListener("dblclick",u=>{u.target.closest("a")||(u.stopPropagation(),u.preventDefault(),this.onCommentEdit(t))}),l.addEventListener("click",u=>{u.target.closest("a")||u.stopPropagation()});let d=o.createEl("div",{cls:"hi-note-footer"});d.createEl("div",{text:new Date(t.updatedAt).toLocaleString(),cls:"hi-note-time"}),d.createEl("span",{text:"Double click to edit",cls:"hi-note-edit-hint"}),d.createEl("div",{cls:"hi-note-actions"})}}async activateInternalLinks(A,t){A.querySelectorAll("a.internal-link").forEach(l=>{let c=l.getAttribute("data-href")||l.getAttribute("href");c&&(l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.metadataCache.getFirstLinkpathDest(c,t)&&this.app.workspace.openLinkText(c,t,!1)}),l.addEventListener("mouseenter",d=>{this.app.workspace.trigger("hover-link",{event:d,source:"hi-note",hoverParent:A,targetEl:l,linktext:c,sourcePath:t})}))}),A.querySelectorAll("a.tag").forEach(l=>{let c=l.getAttribute("href");c&&l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.workspace.trigger("search:open",c)})})}};var ur=class{constructor(e,A,t){this.parent=e;this.highlight=A;this.onClick=t;this.render()}render(){this.container=this.parent.createEl("div",{cls:"unfocused-comment-input"}),this.container.createEl("div",{cls:"unfocused-input-area",attr:{placeholder:m("Add comment...")}}).addEventListener("click",A=>{A.preventDefault(),A.stopPropagation(),this.onClick()})}remove(){this.container.remove()}hide(){this.container.style.display="none"}};var iA=require("obsidian");var ct=class ct{static start(e,A,t={}){var d;let{showIcon:n=!0,maxLength:o=30}=t;this.clear(),this.instance=document.createElement("div"),this.instance.className="highlight-dragging";let l=document.createElement("div");l.className="highlight-dragging-content";let c=A.length>o?A.slice(0,o)+"...":A;l.textContent=c,this.instance.appendChild(l),document.body.appendChild(this.instance),this.updatePosition(e.clientX,e.clientY),(d=e.dataTransfer)==null||d.setDragImage(this.dragImage,0,0),document.addEventListener("dragover",this.handleDragOver)}static updatePosition(e,A){this.instance&&this.instance.setAttribute("style",`left: ${e+10}px; top: ${A+10}px;`)}static clear(){this.instance&&(this.instance.remove(),this.instance=null),document.removeEventListener("dragover",this.handleDragOver)}};ct.instance=null,ct.dragImage=new Image,ct.dragImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ct.handleDragOver=e=>{e.preventDefault(),ct.updatePosition(e.clientX,e.clientY)};var oi=ct;var Co=require("obsidian"),li=class{constructor(e,A){this.highlight=e;this.plugin=A}generateSync(){var A,t,n,o;let e=[];if(this.highlight.isVirtual){let l=((t=(A=this.highlight.filePath)==null?void 0:A.split("/").pop())==null?void 0:t.replace(".md",""))||"File";e.push(`> [!note] [[${l}]]`),e.push("> ")}else{e.push("> [!quote] HiNote");let l=!1;if(this.highlight.blockId){let c=this.highlight.filePath;if(!c){let d=this.plugin.app.workspace.getActiveFile();d&&(c=d.path)}if(c){let d=(n=c.split("/").pop())==null?void 0:n.replace(".md","");if(d){let u=`> ![[${d}#^${this.highlight.blockId}]]`;e.push(u),e.push("> "),l=!0}}}else if(this.highlight.filePath&&typeof this.highlight.position=="number"){let c=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(c instanceof Co.TFile){let d=this.plugin.app.metadataCache.getFileCache(c);if(d!=null&&d.sections){let u=this.highlight.position,p=d.sections.find(B=>B.position.start.offset<=u&&B.position.end.offset>=u);if(p!=null&&p.id){let B=(o=this.highlight.filePath.split("/").pop())==null?void 0:o.replace(".md","");if(B){let v=`> ![[${B}#^${p.id}]]`;e.push(v),e.push("> "),l=!0}}}}}!l&&this.highlight.text&&(e.push(`> ${this.highlight.text}`),e.push("> "))}if(this.highlight.comments&&this.highlight.comments.length>0)for(let l of this.highlight.comments)e.push(...this.formatComment(l,!1));return e.join(`
`)}async generate(){return this.generateSync()}formatComment(e,A){let t=[],n=A?">":">>";A||t.push(">> [!note] Comment");let o=e.content.split(`
`).map(l=>(l=l.trim(),l?`${n} ${l}`:n)).join(`
`);if(t.push(o),e.updatedAt){let l=window.moment(e.updatedAt);t.push(`${n} *${l.format("YYYY-MM-DD HH:mm:ss")}*`)}return t.push(">"),t}};var Le=require("obsidian");var yt=[{id:"deepseek-chat",name:"Deepseek Chat"},{id:"deepseek-reasoner",name:"Deepseek Reasoner"}],$e=[{id:"gemini-1.5-flash",name:"Gemini 1.5 Flash"},{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro"},{id:"gemini-2.0-flash",name:"Gemini 2.0 Flash"},{id:"gemini-2.0-flash-lite-preview-02-05",name:"Gemini 2.0 Flash Lite"}],Ue=[{id:"deepseek-ai/DeepSeek-V3",name:"DeepSeek V3",isCustom:!1},{id:"Qwen/Qwen2.5-7B-Instruct",name:"Qwen2.5 7B",isCustom:!1},{id:"Qwen/Qwen2.5-14B-Instruct",name:"Qwen2.5 14B",isCustom:!1},{id:"Pro/Qwen/Qwen2-7B-Instruct",name:"Qwen2 7B",isCustom:!1},{id:"Pro/THUDM/glm-4-9b-chat",name:"GLM-4 9B",isCustom:!1},{id:"google/gemma-2-9b-it",name:"Gemma2 9B",isCustom:!1}],nA={excludePatterns:"",useCustomPattern:!1,regexRules:[{id:"default-md",name:"Default Highlight",pattern:"==\\s*([\\s\\S]*?)\\s*==",color:"#ffeb3b",enabled:!0},{id:"default-mark",name:"Mark format",pattern:"<mark[^>]*>([\\s\\S]*?)</mark>",color:"#ffeb3b",enabled:!0},{id:"default-span",name:"Span format",pattern:"<span[^>]*>([\\s\\S]*?)</span>",color:"#ffeb3b",enabled:!0}],ai:{provider:"ollama",ollama:{host:"http://localhost:11434",model:""},gemini:{apiKey:"",model:"gemini-pro",baseUrl:"",isCustomModel:!1},openai:{apiKey:"",model:"gpt-4o",baseUrl:""},anthropic:{apiKey:"",model:"claude-2",apiAddress:"",isCustomModel:!1,lastCustomModel:""},deepseek:{apiKey:"",model:"deepseek-chat",baseUrl:""},prompts:{"\u{1F914} Key Insight":"{{highlight}}.Please reinterpret the above content from a fresh perspective and summarize its core idea within 200 characters."}},export:{exportPath:""}};var Et=require("obsidian"),Ut=class{constructor(e="http://localhost:11434"){this.retryAttempts=3;this.retryDelay=1e3;!e.startsWith("http://")&&!e.startsWith("https://")&&(e="http://"+e),this.baseUrl=e.replace(/\/$/,"")}async listModels(){try{await this.ensureConnection();let e=await this.makeRequest({endpoint:"/api/tags",method:"GET"});if(!e||!e.models)throw new Error("Invalid API response format");return e.models.map(A=>A.name)}catch(e){throw this.handleError(e)}}async generateCompletion(e,A){try{await this.ensureConnection();let t=await this.makeRequest({endpoint:"/api/generate",method:"POST",body:JSON.stringify({model:e,prompt:A,stream:!1})});if(!t||!t.response)throw new Error("Invalid API response format");return t.response}catch(t){throw this.handleError(t)}}async pullModel(e){try{new Et.Notice(`Downloading model ${e}...`);let A=await this.makeRequest({endpoint:"/api/pull",method:"POST",body:JSON.stringify({name:e})});if(!A.ok)throw new Error(`Failed to download model: ${A.status}`);new Et.Notice(`Model ${e} downloaded successfully`)}catch(A){throw new Error(`Failed to download model: ${A.message}`)}}async chat(e,A){var t;try{await this.ensureConnection();let n=await this.makeRequest({endpoint:"/api/chat",method:"POST",body:JSON.stringify({model:e,messages:A,stream:!1})});if(!n||!((t=n.message)!=null&&t.content))throw new Error("Invalid API response format");return n.message.content}catch(n){throw this.handleError(n)}}async ensureConnection(){if(!this.baseUrl)throw new Error("Ollama service not configured. Please set the host in settings.");if(!await this.testConnection())throw new Error("Unable to connect to Ollama service. Please ensure the service is running.")}async testConnection(){if(!this.baseUrl)return!1;try{let e=await this.makeRequest({endpoint:"/api/version",method:"GET"});return!!(e!=null&&e.version)}catch(e){return!1}}async makeRequest(e){let A=null;for(let t=1;t<=this.retryAttempts;t++)try{let n=new URL(e.endpoint,this.baseUrl).toString(),o=await(0,Et.requestUrl)({url:n,method:e.method,headers:{"Content-Type":"application/json",Accept:"application/json"},body:e.body,throw:!1});if(o.status===200)try{return o.text?JSON.parse(o.text):{}}catch(c){throw new Error("Invalid JSON response from server")}let l=`HTTP error! status: ${o.status}`;try{let c=JSON.parse(o.text);c.error&&(l=c.error)}catch(c){o.text&&(l=o.text)}throw new Error(l)}catch(n){if(A=n,t<this.retryAttempts){await this.delay(this.retryDelay*t);continue}break}throw A}handleError(e){return e.message.includes("ECONNREFUSED")?(new Et.Notice("Ollama service is not running. Please start the service."),new Error("Unable to connect to Ollama service. Please ensure the service is running.")):e instanceof TypeError&&e.message.includes("Invalid URL")?new Error(`Invalid Ollama service URL: ${this.baseUrl}`):e}delay(e){return new Promise(A=>setTimeout(A,e))}};var Ws=require("obsidian"),St=class{constructor(e,A,t){this.apiKey=e,this.apiAddress=A||"https://api.anthropic.com",this.model=t||"claude-3-opus-20240229"}async generateResponse(e){try{let A=await(0,Ws.requestUrl)({url:`${this.apiAddress}/v1/messages`,method:"POST",headers:{"x-api-key":this.apiKey,"anthropic-version":"2023-06-01","content-type":"application/json"},body:JSON.stringify({model:this.model,max_tokens:4096,messages:[{role:"user",content:e}]})});if(A.status!==200)throw new Error(`Anthropic API error: ${A.text}`);return A.json.content[0].text}catch(A){throw new Error("Failed to generate response from Anthropic API")}}async testConnection(){try{return(await(0,Ws.requestUrl)({url:`${this.apiAddress}/v1/messages`,method:"POST",headers:{"x-api-key":this.apiKey,"anthropic-version":"2023-06-01","content-type":"application/json"},body:JSON.stringify({model:this.model,max_tokens:1,messages:[{role:"user",content:"Hi"}]})})).status===200}catch(e){return!1}}};var pr=require("obsidian"),fr=class{constructor(e,A="gemini-pro",t){this.apiKey=e,this.model=A,this.baseUrl=t||"https://generativelanguage.googleapis.com"}updateModel(e){this.model=e}async generateResponse(e){var A,t,n,o,l;try{let c=`${this.baseUrl}/v1beta/models/${this.model}:generateContent?key=${this.apiKey}`,u=await(0,pr.requestUrl)({url:c,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{maxOutputTokens:2048,temperature:.7}})});if(u.status!==200)throw new Error(`Gemini API error (${u.status}): ${u.text}`);let p=u.json;if(!((l=(o=(n=(t=(A=p.candidates)==null?void 0:A[0])==null?void 0:t.content)==null?void 0:n.parts)==null?void 0:o[0])!=null&&l.text))throw new Error("Invalid response format from Gemini API");return p.candidates[0].content.parts[0].text}catch(c){throw c instanceof Error?c:new Error("Failed to generate response from Gemini API")}}async chat(e){var A,t,n,o,l;try{let c=`${this.baseUrl}/v1beta/models/${this.model}:generateContent?key=${this.apiKey}`,u={contents:e.map(v=>({role:v.role==="assistant"?"model":"user",parts:[{text:v.content}]})),generationConfig:{maxOutputTokens:2048,temperature:.7}},p=await(0,pr.requestUrl)({url:c,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(p.status!==200)throw new Error(`Gemini Chat API error (${p.status}): ${p.text}`);let B=p.json;if(!((l=(o=(n=(t=(A=B.candidates)==null?void 0:A[0])==null?void 0:t.content)==null?void 0:n.parts)==null?void 0:o[0])!=null&&l.text))throw new Error("Invalid response format from Gemini Chat API");return B.candidates[0].content.parts[0].text}catch(c){throw c instanceof Error?c:new Error("Failed to chat with Gemini API")}}async testConnection(){try{let e=`${this.baseUrl}/v1beta/models/${this.model}?key=${this.apiKey}`,A=await(0,pr.requestUrl)({url:e,method:"GET"});return A.status,A.status===200}catch(e){return!1}}};var $s=require("obsidian"),mr=class{constructor(e){var A;if(!((A=e.siliconflow)!=null&&A.apiKey))throw new Error("SiliconFlow API key is required");this.settings=e,this.baseUrl=e.siliconflow.baseUrl||"https://api.siliconflow.cn/v1"}async chat(e,A){var t,n;try{let o=((t=this.settings.siliconflow)==null?void 0:t.model)||"deepseek-ai/DeepSeek-V3",l=await(0,$s.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(n=this.settings.siliconflow)==null?void 0:n.apiKey}`},body:JSON.stringify({model:o,messages:e.map(d=>({role:d.role,content:d.content})),stream:!1})});if(l.status!==200)throw new Error(`SiliconFlow API request failed: ${l.text}`);let c=l.json;if(!c.choices||!c.choices[0]||!c.choices[0].message)throw new Error("Unexpected API response format");return c.choices[0].message.content}catch(o){throw o}}async listModels(){var e;try{let A=await(0,$s.requestUrl)({url:`${this.baseUrl}/models`,method:"GET",headers:{Authorization:`Bearer ${(e=this.settings.siliconflow)==null?void 0:e.apiKey}`}});if(A.status!==200)throw new Error(`Failed to list models: ${A.text}`);return A.json.data.map(t=>({id:t.id,name:t.id.split("/").pop()||t.id,isCustom:!1}))}catch(A){throw A}}};var qs=require("obsidian"),Br=class{constructor(e,A="deepseek-chat",t){this.apiKey=e;this.model=A,this.baseUrl=t||"https://api.deepseek.com/v1"}updateModel(e){this.model=e}async generateResponse(e){let A=[{role:"user",content:e}];return await this.chat(A)}async chat(e){var A,t,n;try{let o=await(0,qs.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:e,temperature:.7,max_tokens:4096,frequency_penalty:0,presence_penalty:0})});if(o.status!==200)throw new Error(`Deepseek API error (${o.status}): ${o.text}`);let l=o.json;if(!((n=(t=(A=l.choices)==null?void 0:A[0])==null?void 0:t.message)!=null&&n.content))throw new Error("Invalid response format from Deepseek API");return l.choices[0].message.content}catch(o){throw o instanceof Error?o:new Error("Failed to generate response from Deepseek API")}}async testConnection(){try{return(await(0,qs.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:this.model,messages:[{role:"user",content:"test"}],max_tokens:10})})).status===200}catch(e){return!1}}};var vo=require("obsidian"),It=class{constructor(e){this.settings=e;this.anthropicService=null;this.geminiService=null;this.deepseekService=null;this.siliconflowService=null;this.currentState={provider:"",model:""};var A,t,n,o,l,c,d,u;switch((A=e.ollama)!=null&&A.host&&(this.ollamaService=new Ut(e.ollama.host)),(t=e.anthropic)!=null&&t.apiKey&&(this.anthropicService=new St(e.anthropic.apiKey,e.anthropic.apiAddress,e.anthropic.model)),(n=e.gemini)!=null&&n.apiKey&&(this.geminiService=new fr(e.gemini.apiKey,e.gemini.model,e.gemini.baseUrl)),(o=e.deepseek)!=null&&o.apiKey&&(this.deepseekService=new Br(e.deepseek.apiKey,e.deepseek.model,e.deepseek.baseUrl)),(l=e.siliconflow)!=null&&l.apiKey&&(this.siliconflowService=new mr(this.settings)),this.currentState.provider=e.provider,e.provider){case"gemini":this.currentState.model=((c=e.gemini)==null?void 0:c.model)||"";break;case"deepseek":this.currentState.model=((d=e.deepseek)==null?void 0:d.model)||"deepseek-chat";break;case"siliconflow":this.currentState.model=((u=e.siliconflow)==null?void 0:u.model)||"internlm/internlm2_5-7b-chat";break}}updateModel(e,A){switch(this.currentState.provider=e,this.currentState.model=A,e){case"gemini":this.geminiService&&this.geminiService.updateModel(A);break;case"deepseek":this.deepseekService&&this.deepseekService.updateModel(A);break}}async generateResponse(e,A,t){let n=e.replace("{{highlight}}",A);switch(t&&(n=n.replace("{{comment}}",t)),this.settings.provider){case"openai":return await this.callOpenAI(n);case"anthropic":return await this.callAnthropic(n);case"ollama":return await this.callOllama(n);case"gemini":return await this.callGemini(n);case"deepseek":return await this.callDeepseek(n);case"siliconflow":return await this.callSiliconFlow(n);default:throw new Error("AI service not configured")}}async chat(e){switch(this.settings.provider){case"openai":return await this.chatWithOpenAI(e);case"anthropic":return await this.chatWithAnthropic(e);case"ollama":return await this.chatWithOllama(e);case"gemini":return await this.chatWithGemini(e);case"deepseek":return await this.chatWithDeepseek(e);case"siliconflow":return await this.chatWithSiliconFlow(e);default:throw new Error("AI service not configured")}}async chatWithOpenAI(e){var n;if(!((n=this.settings.openai)!=null&&n.apiKey))throw new Error("OpenAI API Key not configured");let A=await(0,vo.requestUrl)({url:this.settings.openai.baseUrl||"https://api.openai.com/v1/chat/completions",method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.settings.openai.apiKey}`},body:JSON.stringify({model:this.settings.openai.model,messages:e,temperature:.7})});if(A.status!==200)throw new Error(`OpenAI API request failed: ${A.text}`);return A.json.choices[0].message.content}async chatWithAnthropic(e){if(!this.anthropicService)throw new Error("Anthropic service not configured");let A=e[e.length-1];return await this.anthropicService.generateResponse(A.content)}async chatWithOllama(e){var A;if(!this.ollamaService)throw new Error("Ollama service not configured");if(!((A=this.settings.ollama)!=null&&A.model))throw new Error("Ollama model not configured");return await this.ollamaService.chat(this.settings.ollama.model,e)}async chatWithGemini(e){if(!this.geminiService)throw new Error("Gemini service not configured");return await this.geminiService.chat(e)}async chatWithSiliconFlow(e){if(!this.siliconflowService)throw new Error("SiliconFlow service not configured");try{return await this.siliconflowService.chat(e)}catch(A){throw A}}async chatWithDeepseek(e){if(!this.deepseekService)throw new Error("Deepseek service not configured");return await this.deepseekService.chat(e)}async callOpenAI(e){return await this.chatWithOpenAI([{role:"user",content:e}])}async callAnthropic(e){if(!this.anthropicService)throw new Error("Anthropic service not configured");return await this.anthropicService.generateResponse(e)}async callOllama(e){var A;if(!this.ollamaService)throw new Error("Ollama service not configured");if(!((A=this.settings.ollama)!=null&&A.model))throw new Error("Ollama model not configured");return await this.ollamaService.generateCompletion(this.settings.ollama.model,e)}async callGemini(e){if(!this.geminiService)throw new Error("Gemini service not configured");return await this.geminiService.generateResponse(e)}async callSiliconFlow(e){if(!this.siliconflowService)throw new Error("SiliconFlow service not configured");try{return await this.siliconflowService.chat([{role:"user",content:e}])}catch(A){throw A}}async callDeepseek(e){if(!this.deepseekService)throw new Error("Deepseek service not configured");return await this.deepseekService.generateResponse(e)}async testConnection(){switch(this.settings.provider){case"openai":try{return await this.chatWithOpenAI([{role:"user",content:"test"}]),!0}catch(e){return!1}case"anthropic":return this.anthropicService?await this.anthropicService.testConnection():!1;case"ollama":return this.ollamaService?await this.ollamaService.testConnection():!1;case"gemini":return this.geminiService?await this.geminiService.testConnection():!1;case"deepseek":return this.deepseekService?await this.deepseekService.testConnection():!1;default:return!1}}async listOllamaModels(){if(!this.ollamaService)throw new Error("Ollama service not configured");return await this.ollamaService.listModels()}async listGeminiModels(){if(!this.geminiService)throw new Error("Gemini service not configured");return Promise.resolve($e)}async listDeepseekModels(){if(!this.deepseekService)throw new Error("Deepseek service not configured");return Promise.resolve([{id:"deepseek-chat",name:"Deepseek Chat"},{id:"deepseek-coder",name:"Deepseek Coder"}])}async listSiliconFlowModels(){return Ue}async listOpenAIModels(){var A,t;let e=[{id:"gpt-4",name:"GPT-4",isCustom:!1},{id:"gpt-4-turbo",name:"GPT-4 Turbo",isCustom:!1},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",isCustom:!1}];return(A=this.settings.openai)!=null&&A.isCustomModel&&((t=this.settings.openai)!=null&&t.model)&&e.push({id:this.settings.openai.model,name:this.settings.openai.model,isCustom:!0}),e}};var wr=class{constructor(e,A,t,n){var c;this.plugin=t,this.container=e,this.contentProvider=A,this.options={...n},this.initButton();let o=(c=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:c.view,l=o instanceof ue?o:null;l!=null&&l.registerAIButton&&l.registerAIButton(this)}destroy(){var t;document.removeEventListener("click",this.boundClickHandler);let e=(t=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:t.view,A=e instanceof ue?e:null;A!=null&&A.unregisterAIButton&&A.unregisterAIButton(this)}initButton(){let e=this.container.createEl("div",{cls:"highlight-ai-container"});this.options.position&&e.addClass(`highlight-ai-container-${this.options.position}`);let A=e.createEl("div",{cls:this.options.buttonClass,attr:{"aria-label":this.options.buttonLabel}});(0,Le.setIcon)(A,this.options.buttonIcon),A.addEventListener("click",t=>{t.stopPropagation(),this.toggleDropdown()}),this.aiButton=A}toggleDropdown(){let e=new Le.Menu,A=Object.entries(this.plugin.settings.ai.prompts||{});A.length>0?A.forEach(([n])=>{e.addItem(o=>o.setTitle(n).onClick(async()=>{await this.handleAIAnalysis(n)}))}):e.addItem(n=>n.setTitle(m("\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u6DFB\u52A0 Prompt")).setDisabled(!0));let t=this.aiButton.getBoundingClientRect();e.showAtPosition({x:t.left-92,y:t.bottom+8})}async handleAIAnalysis(e){try{this.setLoading(!0);let A=new It(this.plugin.settings.ai),t=this.plugin.settings.ai.prompts[e];if(!t)throw new Error(m(`\u672A\u627E\u5230\u540D\u4E3A "${e}" \u7684 Prompt`));let n=this.contentProvider.getText(),o=this.contentProvider.getComments(),l=await A.generateResponse(t,n,o);await this.options.onResponse(l),new Le.Notice(m("AI \u8BC4\u8BBA\u5DF2\u6DFB\u52A0"))}catch(A){new Le.Notice(m(`AI \u8BC4\u8BBA\u5931\u8D25: ${A.message}`))}finally{this.setLoading(!1)}}setLoading(e){e?(this.aiButton.addClass("loading"),(0,Le.setIcon)(this.aiButton,"loader")):(this.aiButton.removeClass("loading"),(0,Le.setIcon)(this.aiButton,this.options.buttonIcon||"bot-message-square"))}getButtonElement(){return this.aiButton}};var Zs=require("obsidian"),qe=class{constructor(e){this.STORAGE_KEY="flashcard-license";this.VAULT_ID_KEY="vault-id";this.API_URL="https://hi-note-license-server-production.up.railway.app";this.FEATURES=["flashcard"];this.VERIFICATION_INTERVAL_DAYS=7;this.licenseToken=null;this.plugin=e}async generateVaultId(){try{let e=await this.plugin.loadData()||{};if(e[this.VAULT_ID_KEY])return e[this.VAULT_ID_KEY];let A=this.plugin.app.vault.adapter,t=this.plugin.app.vault.getName();A&&"basePath"in A&&(t=A.basePath+"/"+t);let n=navigator.platform||"",o=[t,n].join("|"),c=new TextEncoder().encode(o),d=await crypto.subtle.digest("SHA-256",c),p=Array.from(new Uint8Array(d)).map(B=>B.toString(16).padStart(2,"0")).join("");return await this.saveVaultId(p),p}catch(e){let A=this.plugin.app.vault.getName(),n=new TextEncoder().encode(A),o=await crypto.subtle.digest("SHA-256",n),c=Array.from(new Uint8Array(o)).map(d=>d.toString(16).padStart(2,"0")).join("");return await this.saveVaultId(c),c}}async saveVaultId(e){let A=await this.plugin.loadData()||{};await this.plugin.saveData({...A,[this.VAULT_ID_KEY]:e})}async activateLicense(e){try{let A=await this.generateVaultId(),t=`${this.API_URL}/api/verify`,l=(await(0,Zs.requestUrl)({url:t,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({licenseKey:e,deviceId:A})})).json;if(l.valid){let c=await this.plugin.loadData()||{};return await this.plugin.saveData({...c,[this.STORAGE_KEY]:{key:e,token:l.token,features:l.features,vaultId:A,lastVerified:Date.now()}}),this.licenseToken=l.token,!0}return!1}catch(A){let t=A instanceof Error?A.message:"Unknown error";return!1}}async isFeatureEnabled(e){var n;let A=await this.plugin.loadData(),t=A==null?void 0:A[this.STORAGE_KEY];return((n=t==null?void 0:t.features)==null?void 0:n.includes(e))||!1}async isActivated(){try{let e=await this.plugin.loadData(),A=e==null?void 0:e[this.STORAGE_KEY];return A!=null&&A.token?this.shouldVerifyLicense(A.lastVerified)?this.verifyWithServer(A):(this.licenseToken||(this.licenseToken=A.token),!0):!1}catch(e){return!1}}shouldVerifyLicense(e){return e?(Date.now()-e)/(1e3*60*60*24)>=this.VERIFICATION_INTERVAL_DAYS:!0}async verifyWithServer(e){try{let A=await this.generateVaultId(),t=e.vaultId,n=t&&t!==A,l=(await(0,Zs.requestUrl)({url:`${this.API_URL}/api/verify`,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({licenseKey:e.key,deviceId:A,isDeviceChanged:n})})).json;if(!l)return!!this.licenseToken;if(l.valid){let c=await this.plugin.loadData()||{};return await this.plugin.saveData({...c,[this.STORAGE_KEY]:{...e,token:l.token||e.token,vaultId:A,lastVerified:Date.now()}}),this.licenseToken=l.token||e.token,!0}return!1}catch(A){return!!this.licenseToken}}};var Z=class Z{constructor(e,A,t,n,o=!1,l){this.container=e;this.highlight=A;this.plugin=t;this.options=n;this.isInMainView=o;this.isEditing=!1;this.aiButtonInstance=null;this.moreActionsDropdown=null;this.unfocusedInput=null;this.hasFlashcard=!1;this.isShowingRealInput=!1;var c;this.fileName=l,this.highlight=A,this.plugin=t,this.options=n,this.fileName=(c=this.highlight.filePath)==null?void 0:c.split("/").pop(),Z.cardInstances.add(this),this.setupCommentInputEventListeners(),this.render()}static getSelectedCards(){return Z.selectedCards}static clearSelection(){Z.selectedCards.forEach(e=>{e.removeClass("selected")}),Z.selectedCards.clear(),Z.lastSelectedCard=null}static findCardInstanceByHighlightId(e){for(let A of Z.cardInstances)if(A.highlight.id===e)return A;return null}static updateCardUIByHighlightId(e){let A=Z.findCardInstanceByHighlightId(e);A&&A.updateIconsAfterCardCreation()}static clearAllUnfocusedInputs(){Z.cardInstances.forEach(e=>{e.unfocusedInput&&(e.unfocusedInput.remove(),e.unfocusedInput=null)})}setupCommentInputEventListeners(){let e=t=>{var n;((n=t.detail)==null?void 0:n.highlightId)===this.highlight.id&&(this.isShowingRealInput=!0,this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null))},A=t=>{var n;((n=t.detail)==null?void 0:n.highlightId)===this.highlight.id&&(this.isShowingRealInput=!1)};document.addEventListener("comment-input-shown",e),document.addEventListener("comment-input-closed",A),this.plugin.register(()=>{document.removeEventListener("comment-input-shown",e),document.removeEventListener("comment-input-closed",A)})}render(){this.card=this.container.createEl("div",{cls:`highlight-card ${this.highlight.isVirtual?"virtual-highlight-card":""}`,attr:{"data-highlight":JSON.stringify(this.highlight)}}),this.card.addEventListener("click",c=>{if(this.isEditing||this.isShowingRealInput)return;let d=c.target;d.closest(".hi-note-input")||d.closest(".hi-note-actions-hint")||this.selectCard(c)});let e=this.card.createEl("div",{cls:"highlight-card-title-bar"}),A=e.createEl("div",{cls:"highlight-card-title-left"}),t=e.createEl("div",{cls:"highlight-card-title-right"});if((this.isInMainView||this.highlight.isGlobalSearch)&&this.fileName){let c=A.createEl("div",{cls:"highlight-card-icon",attr:{"aria-label":m("Open (DoubleClick)")}});this.checkHasFlashcard()?((0,iA.setIcon)(c,"book-heart"),c.addClass("has-flashcard")):(0,iA.setIcon)(c,"file-text"),c.addEventListener("dblclick",async B=>{B.stopPropagation();let v=this.highlight.filePath||this.fileName;if(!v)return;let Q=this.plugin.app.vault.getAbstractFileByPath(v);if(!Q||!(Q instanceof iA.TFile))return;let U=this.plugin.app.workspace.getLeavesOfType("markdown"),E=this.plugin.app.workspace.activeLeaf,H=U.find(M=>M!==E);if(H||(H=this.plugin.app.workspace.getLeaf("split","vertical")),await H.openFile(Q),this.highlight.position!==void 0){let M=H.view;if(M.getViewType()==="markdown"){let x=M.getViewType()==="markdown"?M.editor:null;if(x){let D=x.offsetToPos(this.highlight.position);x.setCursor(D),x.scrollIntoView({from:D,to:D},!0)}}}});let u=this.fileName?this.fileName.replace(/\.md$/,""):"",p=A.createEl("span",{text:u,cls:"highlight-card-title-text"});A.setAttribute("draggable","true"),this.highlight&&this.highlight.filePath&&typeof this.highlight.position=="number"&&this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath)instanceof iA.TFile&&this.generateDragContent().catch(v=>{console.error("[HighlightCard] Error pre-generating block ID:",v)}),A.addEventListener("dragstart",async B=>{var v,Q;try{if(!this.highlight||!this.highlight.text)throw new Error("Invalid highlight data");let U;try{let H=new Promise((M,x)=>{setTimeout(()=>x(new Error("Block ID generation timeout")),300)});U=await Promise.race([this.generateDragContent(),H])}catch(H){console.debug("[HighlightCard] Using sync fallback for drag content:",H),U=this.generateDragContentSync()}(v=B.dataTransfer)==null||v.setData("text/plain",U);let E=JSON.stringify(this.highlight);(Q=B.dataTransfer)==null||Q.setData("application/highlight",E),A.addClass("dragging"),oi.start(B,this.highlight.text)}catch(U){console.error("[HighlightCard] Error during drag start:",U),B.preventDefault(),B.stopPropagation()}}),A.addEventListener("dragend",()=>{A.removeClass("dragging"),oi.clear()}),this.addPagePreview(p,this.highlight.filePath||this.fileName)}else{let c=A.createEl("div",{cls:"highlight-card-icon"});if(this.checkHasFlashcard()?((0,iA.setIcon)(c,"book-heart"),c.addClass("has-flashcard")):(0,iA.setIcon)(c,"highlighter"),this.highlight.filePath&&typeof this.highlight.position=="number"){let u=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(u instanceof iA.TFile&&!this.highlight.isGlobalSearch){let p=this.plugin.app.workspace.getLeavesOfType("markdown").find(B=>{let v=B.view;return v instanceof iA.MarkdownView&&v.file&&v.file.path===u.path});if(p){let B=p.view;if(B.editor){let Q=B.editor.offsetToPos(this.highlight.position).line+1;A.createEl("div",{cls:"highlight-line-number-badge"}).createEl("span",{text:`L${Q}`,cls:"highlight-line-number"})}}}}}this.aiButtonInstance=new wr(t,{getText:()=>this.highlight.text,getComments:()=>(this.highlight.comments||[]).map(c=>c.content||"").join(`
`)},this.plugin,{onResponse:async c=>{await this.options.onAIResponse(c)},buttonClass:"highlight-title-btn highlight-ai-btn",buttonIcon:"sparkles",buttonLabel:m("AI comment"),position:"titlebar"});let o=t.createEl("div",{cls:"highlight-more-actions-container"}).createEl("div",{cls:"highlight-title-btn highlight-more-btn",attr:{"aria-label":m("More")}});(0,iA.setIcon)(o,"ellipsis-vertical"),o.addEventListener("click",c=>{c.stopPropagation(),this.toggleMoreActionsDropdown(o)}),this.isInMainView&&this.fileName&&this.highlight&&this.highlight.filePath&&typeof this.highlight.position=="number"&&this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath)instanceof iA.TFile&&this.generateDragContent().catch(d=>{console.error("[HighlightCard] Error pre-generating block ID:",d)});let l=this.card.createEl("div",{cls:"highlight-content"});new ni(l,this.highlight,this.options.onHighlightClick),new dr(this.card,this.highlight,c=>{this.isEditing=!0,this.selectCard(),this.options.onCommentEdit(this.highlight,c)})}showUnfocusedCommentInput(){if(this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.isEditing||this.isShowingRealInput)return;let e=this.card.querySelector(".highlight-content");e&&(this.unfocusedInput=new ur(e,this.highlight,()=>{this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.options.onCommentAdd(this.highlight)}))}static findCardInstanceByElement(e){for(let A of Z.cardInstances)if(A.card===e||A.card.contains(e))return A;return null}showCommentInput(){Z.clearAllUnfocusedInputs(),this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.options.onCommentAdd(this.highlight)}selectCard(e){if(Z.clearAllUnfocusedInputs(),e&&e.shiftKey&&Z.lastSelectedCard){this.card.hasClass("selected")?(this.card.removeClass("selected"),Z.selectedCards.delete(this.card)):(Z.selectedCards.add(Z.lastSelectedCard),Z.selectedCards.add(this.card),this.card.addClass("selected"));let n=new CustomEvent("highlight-multi-select",{detail:{selectedCards:Array.from(Z.selectedCards),lastSelected:this.card},bubbles:!0});this.card.dispatchEvent(n)}else document.querySelectorAll(".highlight-card.selected").forEach(n=>{n!==this.card&&n.removeClass("selected")}),Z.selectedCards.forEach(n=>{n!==this.card&&n.removeClass("selected")}),Z.selectedCards.clear(),Z.selectedCards.add(this.card),this.card.addClass("selected");let A=new CustomEvent("highlight-multi-select",{detail:{selectedCards:Array.from(Z.selectedCards),lastSelected:this.card},bubbles:!0});this.card.dispatchEvent(A),e!=null&&e.shiftKey||this.showUnfocusedCommentInput(),Z.lastSelectedCard=this.card}getElement(){return this.card}addPagePreview(e,A){if(!A)return;let t=this.plugin.app.vault.getAbstractFileByPath(A);if(!(t instanceof iA.TFile))return;let n;e.addEventListener("mouseenter",o=>{n=setTimeout(async()=>{let l=o.target;this.plugin.app.workspace.trigger("hover-link",{event:o,source:"hi-note",hoverParent:l,targetEl:l,linktext:t.path})},300)}),e.addEventListener("mouseleave",()=>{n&&clearTimeout(n)})}update(e){this.highlight=e,this.isEditing=!1,this.card.empty(),this.render()}generateDragContentSync(){return new li(this.highlight,this.plugin).generateSync()}async generateDragContent(){return new li(this.highlight,this.plugin).generate()}copyHighlightContent(){try{let e=`> [!quote] HiNote
`;if(e+=`> ${this.highlight.text}`,this.highlight.filePath){let A=this.fileName||this.highlight.filePath.split("/").pop()||this.highlight.filePath;e+=`
> 
`,e+=`> From: [[${A}]]`}e+=`

`,navigator.clipboard.writeText(e).then(()=>{new iA.Notice("Copied")}).catch(A=>{console.error("\u590D\u5236\u5185\u5BB9\u5931\u8D25:",A),new iA.Notice("Failed to copy content")})}catch(e){console.error("\u590D\u5236\u9AD8\u4EAE\u5185\u5BB9\u65F6\u51FA\u9519:",e),new iA.Notice("Failed to copy content")}}handleExportAsImage(){this.options.onExport(this.highlight)}toggleMoreActionsDropdown(e){let A=new iA.Menu;this.hasFlashcard=this.checkHasFlashcard(),A.addItem(n=>n.setTitle(this.hasFlashcard?m("Delete HiCard"):m("Create HiCard")).onClick(()=>this.handleCreateHiCard())),A.addItem(n=>n.setTitle(m("Copy Highlight")).onClick(()=>this.copyHighlightContent())),A.addItem(n=>n.setTitle(m("Export as Image")).onClick(()=>this.handleExportAsImage()));let t=e.getBoundingClientRect();A.showAtPosition({x:t.left-100,y:t.bottom+8})}hasVisibleMoreDropdown(){return Z.visibleDropdowns.size>0}static addVisibleDropdown(e){Z.isGlobalListenerAdded||(document.addEventListener("click",Z.handleDocumentClick,!0),Z.isGlobalListenerAdded=!0),Z.visibleDropdowns.add(e)}static removeVisibleDropdown(e){Z.visibleDropdowns.delete(e)}checkHasFlashcard(){let e=this.plugin.fsrsManager;if(!e||!this.highlight.id)return!1;let A=e.findCardsBySourceId(this.highlight.id,"highlight");return A&&A.length>0}async handleCreateHiCard(){try{let e=new qe(this.plugin),A=await e.isActivated(),t=A?await e.isFeatureEnabled("flashcard"):!1;if(!A||!t){new iA.Notice(m("Only HiNote Pro"));return}if(!this.plugin.fsrsManager){new iA.Notice(m("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}let o=this.checkHasFlashcard();this.hasFlashcard=o,o?await this.handleDeleteHiCard():await this.handleCreateNewHiCard()}catch(e){console.error("\u5904\u7406\u95EA\u5361\u64CD\u4F5C\u65F6\u51FA\u9519:",e),new iA.Notice(m(`\u64CD\u4F5C\u5931\u8D25: ${e.message}`))}}async deleteHiCardForHighlight(e=!1){try{return await this.handleDeleteHiCard(e),!0}catch(A){return console.error("\u5220\u9664\u95EA\u5361\u65F6\u51FA\u9519:",A),!1}}async handleDeleteHiCard(e=!1){try{let A=this.plugin.fsrsManager;if(!A){e||new iA.Notice(m("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}if(A.deleteCardsBySourceId(this.highlight.id||"","highlight")>0){this.hasFlashcard=!1;let n=A.cleanupInvalidCardReferences();!(this.highlight.comments&&this.highlight.comments.length>0)&&!e?(await this.deleteHighlightCompletely(),e||new iA.Notice(m("Flashcard and highlight deleted"))):e||new iA.Notice(m("Flashcard deleted, highlight and comments preserved")),this.updateIconsAfterCardDeletion(),e||this.plugin.eventManager.emitFlashcardChanged()}else e||new iA.Notice(m("Flashcard not found"))}catch(A){console.error("\u5220\u9664\u95EA\u5361\u65F6\u51FA\u9519:",A),e||new iA.Notice(m(`Failed to delete flashcard: ${A.message}`))}}async deleteHighlightCompletely(){try{if(this.highlight.filePath){let e=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(e instanceof iA.TFile){let A=window.app.plugins.plugins["hi-note"];A&&A.commentStore?await A.commentStore.removeComment(e,this.highlight):console.warn("\u65E0\u6CD5\u8BBF\u95EE commentStore"),this.plugin.eventManager.emitHighlightDelete(this.highlight.filePath,this.highlight.text||"",this.highlight.id||"")}}}catch(e){throw console.error("\u5220\u9664\u9AD8\u4EAE\u65F6\u51FA\u9519:",e),e}}async createHiCardForHighlight(e=!1){try{return await this.handleCreateNewHiCard(e),!0}catch(A){return console.error("\u521B\u5EFA\u95EA\u5361\u65F6\u51FA\u9519:",A),!1}}async handleCreateNewHiCard(e=!1){let A=this.plugin.fsrsManager;if(!A){new iA.Notice(m("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}if(this.highlight.id||(console.warn("\u9AD8\u4EAE\u7F3A\u5C11 ID\uFF0C\u6B63\u5728\u751F\u6210..."),this.highlight.id=`highlight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),this.highlight.filePath)try{let p=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(p instanceof iA.TFile){let B={id:this.highlight.id,text:this.highlight.text||"",position:this.highlight.position||0,comments:this.highlight.comments||[],createdAt:this.highlight.createdAt||Date.now(),updatedAt:this.highlight.updatedAt||Date.now(),isVirtual:this.highlight.isVirtual,filePath:this.highlight.filePath,fileType:this.highlight.fileType,displayText:this.highlight.displayText,paragraphOffset:this.highlight.paragraphOffset,backgroundColor:this.highlight.backgroundColor,isCloze:this.highlight.isCloze},v=window.app.plugins.plugins["hi-note"];v&&v.commentStore?await v.commentStore.addComment(p,B):console.warn("\u65E0\u6CD5\u8BBF\u95EE commentStore")}}catch(p){console.error("\u4FDD\u5B58\u9AD8\u4EAE\u65F6\u51FA\u9519:",p)}else console.warn("\u9AD8\u4EAE\u5BF9\u8C61\u7F3A\u5C11\u6587\u4EF6\u8DEF\u5F84");let t=this.highlight.text||"",n="",o=/\{\{([^{}]+)\}\}/g,l,c=[];for(;(l=o.exec(t))!==null;)c.push(l[1]);let d=[];if(c.length>0&&d.push(c.join(`
`)),this.highlight.comments&&this.highlight.comments.length>0&&d.push(this.highlight.comments.map(p=>p.content||"").join(`
`)),n=d.length>0?d.join(`

`):m("Add answer"),!A.addCard(t,n,this.highlight.filePath||this.fileName,this.highlight.id,"highlight")){new iA.Notice(m("Failed to create flashcard, please check highlight content"));return}this.plugin.eventManager.emitFlashcardChanged(),e||new iA.Notice(m("Flashcard created successfully!")),this.hasFlashcard=!0,this.updateIconsAfterCardCreation()}updateIconsAfterCardDeletion(){this.card.querySelectorAll(".highlight-card-icon").forEach(A=>{(0,iA.setIcon)(A,"file-text"),A.removeClass("has-flashcard")})}updateIconsAfterCardCreation(){this.card.querySelectorAll(".highlight-card-icon").forEach(A=>{(0,iA.setIcon)(A,"book-heart"),A.addClass("has-flashcard")})}updateCreateHiCardButtonText(){let e=this.card.querySelector(".create-hicard-btn");e&&(e.textContent=this.hasFlashcard?m("Delete HiCard"):m("Create HiCard"))}};window.HighlightCard={findCardInstanceByHighlightId:Z.findCardInstanceByHighlightId},Z.selectedCards=new Set,Z.lastSelectedCard=null,Z.cardInstances=new Set,Z.visibleDropdowns=new Set,Z.isGlobalListenerAdded=!1,Z.handleDocumentClick=e=>{for(let A of Z.visibleDropdowns){let t=A.closest(".highlight-card");t&&!t.contains(e.target)&&!A.contains(e.target)&&(A.classList.add("hi-note-hidden"),Z.visibleDropdowns.delete(A))}};var te=Z;var Cr=class{static shouldExclude(e,A){if(!A||A.trim().length===0)return!1;let t=A.split(",").map(l=>l.trim()).filter(l=>l.length>0),n=e.path,o=e.basename;return t.some(l=>{if(l=l.trim(),!l)return!1;if(l.startsWith("[[")&&l.endsWith("]]")){let u=l.slice(2,-2);return o===u}if(l.startsWith("*.")){let u=l.slice(2);return e.extension===u||n.endsWith(u)}let c=l.replace(/^\/+/,""),d=n.replace(/^\/+/,"");return d.startsWith(c+"/")||d===c})}};var ci=class{extractColorFromStyle(e){if(!e)return null;let A=e.match(/background(?:-color)?:\s*((?:rgba?\(.*?\)|#[0-9a-fA-F]{3,8}|var\(--[^)]+\)))/);return A?A[1]:null}extractColorFromElement(e){let A=e.match(/style=["']([^"']*)["']/);return A?this.extractColorFromStyle(A[1]):null}};ci.COLOR_PATTERNS=[/rgba?\(\d+,\s*\d+,\s*\d+(?:,\s*[0-9.]+)?\)/,/#[0-9a-fA-F]{3,8}/,/var\(--[^)]+\)/];var Fo=require("obsidian"),Ze=class{constructor(e){this.app=e;this.events=new Fo.Events}emitHighlightUpdate(e,A,t,n){this.events.trigger("highlight:update",e,A,t,n)}emitHighlightDelete(e,A,t){this.events.trigger("highlight:delete",e,A,t)}emitCommentUpdate(e,A,t,n){this.events.trigger("comment:update",e,A,t,n)}emitCommentDelete(e,A,t){this.events.trigger("comment:delete",e,A,t)}emitFlashcardChanged(){this.events.trigger("flashcard:changed")}on(e,A){return this.events.on(e,A)}off(e,A){this.events.off(e,A)}};var Te=class Te{constructor(e){this.app=e}getOrCreateBlockId(e,A){let t=e.getLine(A),n=t.match(Te.BLOCK_ID_REGEX);if(n)return n[1];let o="";for(let c=0;c<7;c++)o+=Te.BLOCK_ID_CHARS.charAt(Math.floor(Math.random()*Te.BLOCK_ID_CHARS.length));let l=t.trimEnd();return e.setLine(A,`${l} ^${o}`),o}extractBlockId(e){let A=e.match(Te.BLOCK_ID_REGEX);return A?A[1]:void 0}getParagraphBlockId(e,A){let t=this.app.metadataCache.getFileCache(e);if(!(t!=null&&t.sections))return;let n=t.sections.find(o=>o.position.start.offset<=A&&o.position.end.offset>=A);return n!=null&&n.id?`${e.path}#^${n.id}`:void 0}async createParagraphBlockId(e,A,t){let n=this.getParagraphBlockId(e,A);if(n)return n;let o=this.app.workspace.getLeaf();await o.openFile(e,{active:!1});let c=o.view.editor,u=c.offsetToPos(A).line,p=this.app.metadataCache.getFileCache(e);if(p!=null&&p.sections){let v=t||A,Q=p.sections.find(U=>U.position.start.offset<=v&&U.position.end.offset>=v);Q&&(u=c.offsetToPos(Q.position.end.offset).line,console.debug(`[BlockIdService] \u627E\u5230\u5305\u542B\u9AD8\u4EAE\u7684\u6BB5\u843D\uFF0C\u7ED3\u675F\u884C: ${u}`))}let B=this.getOrCreateBlockId(c,u);return await this.app.vault.modify(e,c.getValue()),`${e.path}#^${B}`}hasValidBlockId(e){return Te.BLOCK_ID_REGEX.test(e)}};Te.BLOCK_ID_REGEX=/\^([a-zA-Z0-9-]+)$/,Te.BLOCK_ID_CHARS="abcdefghijklmnopqrstuvwxyz0123456789";var Ht=Te;var vr=class vr{constructor(e){this.app=e;var n;let A=e.plugins,t=A&&A.plugins?A.plugins["hi-note"]:void 0;this.settings=t==null?void 0:t.settings,this.colorExtractor=new ci,this.eventManager=new Ze(e),this.blockIdService=new Ht(e),console.debug("[HighlightService] Current settings:",this.settings),console.debug("[HighlightService] Exclude patterns:",(n=this.settings)==null?void 0:n.excludePatterns)}shouldProcessFile(e){var A;return!Cr.shouldExclude(e,((A=this.settings)==null?void 0:A.excludePatterns)||"")}extractHighlights(e,A){var n;let t=[];if(this.settings.useCustomPattern&&((n=this.settings.regexRules)==null?void 0:n.length)>0)for(let o of this.settings.regexRules.filter(l=>l.enabled))try{let l=new RegExp(o.pattern,"g");this.processRegexMatches(e,l,t,A,o.color)}catch(l){console.error(`[HighlightService] \u6B63\u5219\u89C4\u5219 "${o.name}" \u9519\u8BEF:`,l)}else this.processRegexMatches(e,vr.DEFAULT_HIGHLIGHT_PATTERN,t,A,"#ffeb3b");return t.sort((o,l)=>{var c,d;return((c=o.position)!=null?c:0)-((d=l.position)!=null?d:0)})}processRegexMatches(e,A,t,n,o){let l=[];if(n){let u=this.app.metadataCache.getFileCache(n);u!=null&&u.sections&&(l=u.sections.filter(B=>["code","codeblock","fenced_code","pre"].includes(B.type)).map(B=>[B.position.start.offset,B.position.end.offset]))}function c(u,p,B){return B.some(([v,Q])=>Math.max(u,v)<Math.min(p,Q))}let d;for(;(d=A.exec(e))!==null;){let u=d,p=u[0],B=u.index,v=B+p.length;if(c(B,v,l))continue;let Q=u.slice(1).find(H=>H!==void 0);Q||(Q=p);let U=null;if(p.includes("style=")&&(U=this.colorExtractor.extractColorFromElement(p)),!t.some(H=>typeof H.position=="number"&&Math.abs(H.position-u.index)<10&&H.text===Q)&&Q&&n){let H=this.app.metadataCache.getFileCache(n);if(H!=null&&H.sections){let M=H.sections.find(O=>O.position.start.offset<=u.index&&O.position.end.offset>=u.index),x=M==null?void 0:M.id;if(!x){let O=this.blockIdService.getParagraphBlockId(n,u.index);if(O){let J=O.match(/#\^([a-zA-Z0-9-]+)/);J&&J[1]&&(x=J[1])}}let D=/\{\{([^{}]+)\}\}/.test(Q),N={text:Q,position:u.index,paragraphOffset:this.getParagraphOffset(e,u.index),backgroundColor:U||o,id:`highlight-${Date.now()}-${u.index}`,comments:[],createdAt:Date.now(),updatedAt:Date.now(),originalLength:p.length,blockId:x,isCloze:D,filePath:n.path};t.push(N)}}}}getParagraphOffset(e,A){let t=e.substring(0,A),n=t.split(/\n\s*\n/);return t.length-n[n.length-1].length}async getFilesWithHighlights(){let e=this.app.vault.getMarkdownFiles(),A=[],t=0;for(let n of e){if(!this.shouldProcessFile(n))continue;let o=await this.app.vault.read(n),l=this.extractHighlights(o,n);l.length>0&&(A.push(n),t+=l.length)}return A}async getAllHighlights(){let e=this.app.vault.getMarkdownFiles(),A=[];for(let t of e){if(!this.shouldProcessFile(t))continue;let n=await this.app.vault.read(t),o=this.extractHighlights(n,t);o.length>0&&A.push({file:t,highlights:o})}return A}async createBlockIdForHighlight(e,A,t){try{let n=this.blockIdService.getParagraphBlockId(e,A);if(n)return n;let o=t?A+t:A;return await this.blockIdService.createParagraphBlockId(e,A,o)}catch(n){throw console.error("[HighlightService] Error creating block ID for highlight:",n),n}}};vr.DEFAULT_HIGHLIGHT_PATTERN=/==\s*([\s\S]*?)\s*==|<mark[^>]*>([\s\S]*?)<\/mark>|<span[^>]*>([\s\S]*?)<\/span>/g;var oe=vr;var hi=require("obsidian");var we=class{constructor(e){this.app=e;this.SIMILARITY_THRESHOLD=.7;this.MAX_SEARCH_RANGE=5e3;this.POSITION_WEIGHT=.3;this.POSITION_TOLERANCE=100}levenshteinDistance(e,A){if(e===A)return 0;if(e.length===0)return A.length;if(A.length===0)return e.length;let t=[];for(let n=0;n<=e.length;n++)t[n]=[n];for(let n=0;n<=A.length;n++)t[0][n]=n;for(let n=1;n<=e.length;n++)for(let o=1;o<=A.length;o++)e[n-1]===A[o-1]?t[n][o]=t[n-1][o-1]:t[n][o]=Math.min(t[n-1][o-1]+1,t[n][o-1]+1,t[n-1][o]+1);return t[e.length][A.length]}calculateSimilarity(e,A){let t=this.levenshteinDistance(e,A),n=Math.max(e.length,A.length);return n===0?1:1-t/n}findBestMatch(e,A,t,n){if(e.length<10){if(t!==void 0&&t>=0){let Q=Math.max(0,t-this.POSITION_TOLERANCE),U=Math.min(A.length,t+this.POSITION_TOLERANCE),H=A.substring(Q,U).indexOf(e);if(H!==-1)return{text:e,position:Q+H}}let v=A.indexOf(e);return v!==-1?{text:e,position:v}:null}let o=n||this.SIMILARITY_THRESHOLD,l=A,c=0;if(t!==void 0&&t>=0){let v=this.MAX_SEARCH_RANGE/2,Q=Math.max(0,t-v),U=Math.min(A.length,t+v);l=A.substring(Q,U),c=Q}let d=this.extractPossibleMatches(l,e.length),u=null,p=0,B=-1;for(let v of d){let Q=this.calculateSimilarity(e,v.text);if(Q<o)continue;let U=1;if(t!==void 0&&t>=0){let M=v.position+c,x=Math.abs(M-t);U=Math.max(0,1-x/(this.POSITION_TOLERANCE*2))}let E=Q*(1-this.POSITION_WEIGHT)+U*this.POSITION_WEIGHT,H=Q===1?Q*.5+U*.5:E;H>p&&(p=H,u=v.text,B=v.position)}return u&&B!==-1?{text:u,position:B+c}:null}extractPossibleMatches(e,A){let t=[],n=new Set,o=Math.max(3,Math.floor(A*.9)),l=Math.ceil(A*1.1);for(let u=o;u<=l;u++){let p=Math.max(1,Math.floor(u/4));for(let B=0;B<e.length-u+1;B+=p){let v=e.substring(B,B+u),Q=`${B}:${v.length}`;n.has(Q)||(t.push({text:v,position:B}),n.add(Q))}}let c=e.split(/[.!?;:\n\r]+/),d=0;for(let u of c){let p=u.trim();if(p.length>=o&&p.length<=l*2&&(d=e.indexOf(p,d),d!==-1)){let B=`${d}:${p.length}`;n.has(B)||(t.push({text:p,position:d}),n.add(B)),d+=p.length}}return t}};var Fr=class{constructor(e){this.app=e;this.textSimilarityService=new we(e)}async jumpToHighlight(e,A){let t=await this.openOrActivateFile(A);t&&await this.locateAndHighlightText(t,e.text,e.position)}async openOrActivateFile(e){let t=this.app.workspace.getLeavesOfType("markdown").find(n=>{var l;return((l=n.view.file)==null?void 0:l.path)===e});if(!t)try{let n=this.app.vault.getAbstractFileByPath(e);if(!n)return new hi.Notice("\u672A\u627E\u5230\u6587\u4EF6"),null;t=await this.app.workspace.getLeaf("tab"),await t.openFile(n)}catch(n){return new hi.Notice("\u6253\u5F00\u6587\u4EF6\u5931\u8D25"),null}return await this.app.workspace.setActiveLeaf(t,{focus:!1}),t}async locateAndHighlightText(e,A,t){await new Promise(U=>setTimeout(U,300));let o=e.view.editor,l=o.getValue(),c=-1,d=[],u=A,p=0,B=-1;for(;(B=l.indexOf(A,p))!==-1;)d.push(B),p=B+1;if(t!==void 0&&t>=0){if(l.substring(t,t+A.length)===A)c=t;else if(d.length>0){let U=d[0],E=Math.abs(t-U);for(let H of d){let M=Math.abs(t-H);M<E&&(E=M,U=H)}c=U}}if(c===-1)if(d.length>0)c=d[0];else{let U=this.textSimilarityService.findBestMatch(A,l,t);if(U)c=U.position,u=U.text,new hi.Notice("\u4F7F\u7528\u6A21\u7CCA\u5339\u914D\u627E\u5230\u4E86\u76F8\u4F3C\u5185\u5BB9");else{new hi.Notice("\u672A\u627E\u5230\u9AD8\u4EAE\u5185\u5BB9");return}}let v=o.offsetToPos(c),Q=o.offsetToPos(c+u.length);o.setSelection(v,Q),o.scrollIntoView({from:v,to:Q},!0),this.app.workspace.setActiveLeaf(e,{focus:!0})}};var zs=require("obsidian");var _A=class{static generateHighlightId(e,A,t){let n=`${e}:${A}:${t}`,o=this.hashCode(n);return`highlight-${Math.abs(o)}-${A}`}static generateCommentId(){let e=Date.now(),A=Math.random().toString(36).substr(2,9);return`comment-${e}-${A}`}static generateCardId(){let e=Date.now(),A=Math.random().toString(36).substr(2,9);return`card-${e}-${A}`}static generateGroupId(){let e=Date.now(),A=Math.random().toString(36).substr(2,7);return`group-${e}-${A}`}static hashCode(e){let A=0;if(e.length===0)return A;for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);A=(A<<5)-A+n,A=A&A}return A}static isValidHighlightId(e){return/^highlight-\d+-\d+$/.test(e)}static isValidCommentId(e){return/^comment-\d+-[a-z0-9]+$/.test(e)}static isValidCardId(e){return/^card-\d+-[a-z0-9]+$/.test(e)}static extractPositionFromHighlightId(e){let A=e.match(/^highlight-\d+-(\d+)$/);return A?parseInt(A[1],10):null}};var Qr=class{constructor(e,A){this.app=e;this.commentStore=A;this.highlightService=new oe(e)}async exportHighlightsAsMarkdown(e){var B,v,Q,U;if(!e||e.length===0)return null;let A=this.app.plugins,t=A&&A.plugins?A.plugins["hi-note"]:void 0,n={};for(let E of e)E.filePath&&(n[E.filePath]||(n[E.filePath]=[]),n[E.filePath].push(E));let o=[];for(let E in n){let H=this.app.vault.getAbstractFileByPath(E);if(!(H instanceof zs.TFile))continue;o.push(`## ${H.basename}`),o.push("");let M=n[E],x=(v=(B=t==null?void 0:t.settings)==null?void 0:B.export)==null?void 0:v.exportTemplate;if(x&&x.trim()!==""){let D=await this.generateContentFromTemplate(H,M,x);D.trim()!==""&&o.push(D)}else{let D=await this.generateDefaultContent(H,M);o.push(D)}}let l=o.join(`
`),c=((U=(Q=t==null?void 0:t.settings)==null?void 0:Q.export)==null?void 0:U.exportPath)||"",d=`Selected Highlights ${window.moment().format("YYYYMMDDHHmm")}`,u=d;return c&&(this.app.vault.getAbstractFileByPath(c)||await this.app.vault.createFolder(c),u=`${c}/${d}`),await this.app.vault.create(`${u}.md`,l)}async generateContentForMultipleHighlights(e){let A=[];A.push(`# ${m("Selected Highlights")}`),A.push(""),A.push(`*${m("Exported on")} ${window.moment().format("YYYY-MM-DD HH:mm:ss")}*`),A.push("");let t={};for(let n of e)n.filePath&&(t[n.filePath]||(t[n.filePath]=[]),t[n.filePath].push(n));for(let n in t){let o=this.app.vault.getAbstractFileByPath(n);if(!(o instanceof zs.TFile))continue;A.push(`## ${o.basename}`),A.push("");let l=t[n];for(let c of l){if(A.push(`> ${c.text}`),A.push("> "),c.comments&&c.comments.length>0){A.push("> ---"),A.push("> ");for(let d of c.comments){A.push(">> [!note] Comment");let u=d.content.split(`
`).map(p=>(p=p.trim(),p?`>> ${p}`:">>")).join(`
`);if(A.push(u),d.updatedAt){let p=window.moment(d.updatedAt);A.push(`>> *${p.format("YYYY-MM-DD HH:mm:ss")}*`)}A.push(">")}}A.push("")}}return A.join(`
`)}async exportHighlightsToNote(e){var p,B;let A=await this.getFileHighlights(e);if(!A||A.length===0)throw new Error(m("No highlights found in the current file."));let t=await this.generateExportContent(e,A),n=this.app.plugins,o=n&&n.plugins?n.plugins["hi-note"]:void 0,l=((B=(p=o==null?void 0:o.settings)==null?void 0:p.export)==null?void 0:B.exportPath)||"",c=`${e.basename} - HiNote ${window.moment().format("YYYYMMDDHHmm")}`,d=c;return l&&(this.app.vault.getAbstractFileByPath(l)||await this.app.vault.createFolder(l),d=`${l}/${c}`),await this.app.vault.create(`${d}.md`,t)}async getFileHighlights(e){let A=await this.app.vault.read(e),t=this.highlightService.extractHighlights(A,e),n=this.commentStore.getFileComments(e),o=n.filter(d=>d.isVirtual&&d.comments&&d.comments.length>0),l=n.filter(d=>!d.isVirtual),c=t.map(d=>{var p,B,v,Q;let u=l.find(U=>{let E=U.text===d.text;return E&&typeof U.position=="number"&&typeof d.position=="number"?Math.abs(U.position-d.position)<1e3:E});return u?{...u,position:(p=d.position)!=null?p:0,paragraphOffset:(B=d.paragraphOffset)!=null?B:0}:{id:_A.generateHighlightId(e.path,d.position||0,d.text),...d,position:(v=d.position)!=null?v:0,paragraphOffset:(Q=d.paragraphOffset)!=null?Q:0,comments:[],createdAt:Date.now(),updatedAt:Date.now()}});return[...o,...c]}async generateExportContent(e,A){var l,c;let t=this.app.plugins,n=t&&t.plugins?t.plugins["hi-note"]:void 0,o=(c=(l=n==null?void 0:n.settings)==null?void 0:l.export)==null?void 0:c.exportTemplate;return o&&o.trim()!==""?this.generateContentFromTemplate(e,A,o):this.generateDefaultContent(e,A)}async generateContentFromTemplate(e,A,t){let n=[],o=t.includes("{{highlightText}}")||t.includes("{{highlightBlockRef}}"),l=t.includes("{{commentContent}}")||t.includes("{{commentDate}}");for(let c of A){if(c.isVirtual){if(c.comments&&c.comments.length>0)for(let d of c.comments)if(l){let u=this.replaceVariables(t,{sourceFile:e.basename,commentContent:d.content||"",commentDate:window.moment(d.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),highlightText:"",highlightBlockRef:"",highlightType:"HiNote"});n.push(u.trim())}else{let p=this.replaceVariables(`> [!note] File Comment
> {{commentContent}}
> *{{commentDate}}*`,{commentContent:d.content||"",commentDate:window.moment(d.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss")});n.push(p)}}else{let d="",u=c.text||"";if(typeof c.position=="number"&&t.includes("{{highlightBlockRef}}"))try{let p=c.originalLength||c.text.length;d=await this.highlightService.createBlockIdForHighlight(e,c.position,p)||""}catch(p){console.error("[ExportService] Error creating block ID:",p)}if(!c.comments||c.comments.length===0){if(l&&!o)continue;if(o){let p=t;if(l){let v=/\n>\s*\n>\s*---[\s\S]*?(?=\n\s*$|$)/g;p=p.replace(v,"");let Q=/\n>>\s*\[!note\]\s*Comment[\s\S]*?(?=\n>\s*$|\n\s*$|$)/g;p=p.replace(Q,""),p=p.replace(/\{\{commentContent\}\}/g,""),p=p.replace(/\{\{commentDate\}\}/g,""),p=p.replace(/\n{3,}/g,`

`),p=p.replace(/\n>\s*\n\s*$/g,`
`)}let B=this.replaceVariables(p,{sourceFile:e.basename,highlightText:u,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});n.push(B.trim())}}else if(c.comments&&c.comments.length>0){if(l&&!o)for(let p of c.comments){let B=this.replaceVariables(t,{sourceFile:e.basename,commentContent:p.content||"",commentDate:window.moment(p.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),highlightText:"",highlightBlockRef:"",highlightType:"HiNote"});n.push(B.trim())}else if(o&&l){let p=t,B=this.findCommentSectionStart(t),v="";B!==-1&&(p=t.substring(0,B),v=t.substring(B));let Q=this.replaceVariables(p,{sourceFile:e.basename,highlightText:u,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});if(n.push(Q.trim()),v&&c.comments&&c.comments.length>0)for(let U of c.comments){let E=window.moment(U.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),H=this.replaceVariables(v,{sourceFile:e.basename,highlightText:"",highlightBlockRef:"",highlightType:"HiNote",commentContent:U.content||"",commentDate:E});n.push(H.trim())}}else if(o&&!l){let p=this.replaceVariables(t,{sourceFile:e.basename,highlightText:u,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});n.push(p.trim())}}}n.push("")}return n.join(`
`)}replaceVariables(e,A){let t=e;for(let[n,o]of Object.entries(A))t=t.replace(new RegExp(`{{${n}}}`,"g"),o||"");return t}findCommentSectionStart(e){let A=["commentContent","commentDate"],t=-1;for(let n of A){let o=e.indexOf(`{{${n}}}`);o!==-1&&(t===-1||o<t)&&(t=o)}if(t!==-1){let o=e.substring(0,t).lastIndexOf(`
`);return o!==-1?o:0}return-1}async generateDefaultContent(e,A){return this.generateContentFromTemplate(e,A,`> [!quote] HiNote
> {{highlightText}}
> 
>> [!note] Comment
>> {{commentContent}}
>> *{{commentDate}}*`)}getParagraphOffset(e,A){let n=e.substring(0,A).lastIndexOf(`
`);return n===-1?A:A-n}generateHighlightId(e,A){return _A.generateHighlightId(A,e.position||0,e.text)}};var js=require("obsidian"),Yg=/#[\w\u4e00-\u9fa5]+/g,Wg=/^\s*(#[\w\u4e00-\u9fa5]+(\s+#[\w\u4e00-\u9fa5]+)*\s*)$/,yr=class{constructor(e,A,t,n){this.card=e;this.highlight=A;this.existingComment=t;this.options=n;this.cancelEdit=()=>{};this.isProcessing=!1;if(this.boundHandleOutsideClick=this.handleOutsideClick.bind(this),document.addEventListener("click",this.boundHandleOutsideClick),this.findHighlightCardInstance()){let l=new CustomEvent("comment-input-shown",{detail:{highlightId:this.highlight.id}});document.dispatchEvent(l)}}findHighlightCardInstance(){var e,A;try{return(A=(e=window.HighlightCard)==null?void 0:e.findCardInstanceByHighlightId)==null?void 0:A.call(e,this.highlight.id)}catch(t){return console.log("\u65E0\u6CD5\u627E\u5230\u5BF9\u5E94\u7684 HighlightCard \u5B9E\u4F8B"),null}}show(){this.existingComment?this.showEditMode():this.showCreateMode()}showEditMode(){var o;let e=this.card.querySelector(`[data-comment-id="${this.existingComment.id}"]`);if(!e)return;let A=e.querySelector(".hi-note-content");if(!A)return;let t=((o=this.existingComment)==null?void 0:o.content)||"";this.textarea=document.createElement("textarea"),this.textarea.value=t,this.textarea.className="hi-note-input",this.textarea.style.minHeight=`${A.offsetHeight}px`,this.textarea.addEventListener("input",()=>{this.processTagsInInput(),this.autoResizeTextarea()}),this.textarea.addEventListener("click",l=>{l.stopPropagation()}),A.replaceWith(this.textarea);let n=e.querySelector(".hi-note-footer");if(n&&n.addClass("hi-note-hidden"),this.actionHint=e.createEl("div",{cls:"hi-note-actions-hint"}),this.actionHint.addEventListener("click",l=>{l.stopPropagation()}),!js.Platform.isMobile)this.actionHint.createEl("span",{cls:"hi-note-hint",text:m("Shift + Enter Wrap, Enter Save")});else{let l=this.actionHint.createEl("button",{cls:"hi-note-save-button",text:m("Submit")});l.addEventListener("click",async c=>{if(c.stopPropagation(),this.isProcessing)return;let d=this.textarea.value.trim();if(d){this.isProcessing=!0,this.textarea.disabled=!0,l.disabled=!0;try{await this.options.onSave(d),requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}catch(u){this.isProcessing=!1,this.textarea.disabled=!1,l.disabled=!1}}})}this.options.onDelete&&this.actionHint.createEl("div",{cls:"hi-note-delete-link",text:m("Delete comment")}).addEventListener("click",async c=>{var d,u;c.stopPropagation(),await((u=(d=this.options).onDelete)==null?void 0:u.call(d))}),this.setupKeyboardEvents(A,n||void 0),setTimeout(()=>{this.textarea.focus(),this.textarea.setSelectionRange(this.textarea.value.length,this.textarea.value.length)},50)}showCreateMode(){let e=document.createElement("div");e.className="hi-note-input",this.textarea=e.createEl("textarea"),this.textarea.addEventListener("input",()=>{this.processTagsInInput(),this.autoResizeTextarea()}),e.addEventListener("click",n=>{n.stopPropagation()}),this.textarea.addEventListener("click",n=>{n.stopPropagation()});let A=this.card.querySelector(".hi-notes-section");A||(A=this.card.createEl("div",{cls:"hi-notes-section"}),A.createEl("div",{cls:"hi-notes-list"}));let t=A.querySelector(".hi-notes-list");t&&t.insertBefore(e,t.firstChild),this.setupKeyboardEvents(),setTimeout(()=>{this.textarea.focus()},50)}setupKeyboardEvents(e,A){this.cancelEdit=()=>{this.existingComment?e&&A&&requestAnimationFrame(()=>{this.textarea.replaceWith(e),this.actionHint.remove(),A.removeClass("hi-note-hidden"),document.removeEventListener("click",this.boundHandleOutsideClick)}):requestAnimationFrame(()=>{var t,n;(t=this.textarea.closest(".hi-note-input"))==null||t.remove(),this.card.querySelector(".hi-note")||(n=this.card.querySelector(".hi-notes-section"))==null||n.remove(),document.removeEventListener("click",this.boundHandleOutsideClick)}),this.options.onCancel()},this.textarea.onkeydown=async t=>{if(t.key==="Enter"){if(js.Platform.isMobile)return;if(t.shiftKey||(t.preventDefault(),this.isProcessing))return;let n=this.textarea.value.trim();if(!n)return;this.isProcessing=!0,this.textarea.disabled=!0;try{await this.options.onSave(n),requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}catch(o){this.textarea.disabled=!1,this.isProcessing=!1}}}}autoResizeTextarea(){let e=window.scrollY;this.textarea.style.height="auto";let A=this.textarea.scrollHeight;this.textarea.style.height=`${A}px`,window.scrollTo(0,e)}processTagsInInput(){var A,t,n,o;let e=this.textarea.value;if(Wg.test(e)){let l=e.match(Yg)||[];if(l.length>0){let c=(A=this.textarea.parentElement)==null?void 0:A.querySelector(".highlight-tags-preview");if(c||(c=document.createElement("div"),c.className="highlight-tags-preview",(t=this.textarea.parentElement)==null||t.insertBefore(c,this.textarea)),c){for(;c.firstChild;)c.removeChild(c.firstChild);let d=c;l.forEach(u=>{let p=document.createElement("span");p.className="highlight-tag",p.textContent=u,d.appendChild(p)})}}}else(o=(n=this.textarea.parentElement)==null?void 0:n.querySelector(".highlight-tags-preview"))==null||o.remove()}handleOutsideClick(e){if(!this.textarea||this.isProcessing)return;let A=e.target;if(!this.textarea.contains(A)&&!A.closest(".hi-note-actions-hint")){e.preventDefault(),e.stopPropagation(),this.isProcessing=!0;let n=this.textarea.value.trim();if(n){let o=n;this.textarea.disabled=!0,this.options.onSave(o).then(()=>{requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}).catch(()=>{this.textarea.disabled=!1,this.isProcessing=!1})}else requestAnimationFrame(()=>{this.cancelEdit(),this.isProcessing=!1})}}destroy(){document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1;let e=new CustomEvent("comment-input-closed",{detail:{highlightId:this.highlight.id}});document.dispatchEvent(e)}};var TA=require("obsidian");var Qo=require("obsidian");var Er=class{constructor(e){this.plugin=e;this.aiService=new It(this.plugin.settings.ai)}updateModel(e,A){this.aiService&&this.aiService.updateModel(e,A)}async sendMessage(e,A=[]){try{let t=A.map(o=>({role:o.role,content:o.content}));return t.push({role:"user",content:e}),{content:await this.aiService.chat(t),type:"assistant",timestamp:Date.now()}}catch(t){throw new Qo.Notice("\u83B7\u53D6 AI \u54CD\u5E94\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u914D\u7F6E\u548C\u7F51\u7EDC\u8FDE\u63A5"),t}}async testConnection(){return await this.aiService.testConnection()}};var WA=class WA extends TA.Component{constructor(A,t){super();this.plugin=t;this.isProcessing=!1;this.draggedContents=[];this.chatHistory=[];this.currentPreviewContainer=null;this.textarea=null;this.chatModelState={provider:"",model:""};if(WA.instance)return WA.instance;this.app=A,this.chatService=new Er(this.plugin),this.floatingButton=document.querySelector(".highlight-floating-button"),this.containerEl=document.createElement("div"),this.containerEl.addClass("highlight-chat-window");let n=this.containerEl.createEl("div",{cls:"highlight-chat-header"}),o=n.createEl("div",{cls:"highlight-chat-title"});o.createEl("span",{text:m("Chat")});let l=o.createEl("div",{cls:"highlight-chat-model",text:this.getCurrentModelName()});l.addEventListener("click",x=>{x.stopPropagation(),this.showModelSelector(l,x)});let c=n.createEl("div",{cls:"highlight-chat-buttons"}),d=c.createEl("div",{cls:"highlight-chat-clear"});(0,TA.setIcon)(d,"eraser"),d.addEventListener("click",()=>this.clearChat());let u=c.createEl("div",{cls:"highlight-chat-close"});(0,TA.setIcon)(u,"x"),u.addEventListener("click",()=>this.close());let p=this.containerEl.createEl("div",{cls:"highlight-chat-history"}),B=this.containerEl.createEl("div",{cls:"highlight-chat-input-container"});this.setupChatInput(B);let v={text:"",position:0,paragraphOffset:0,paragraphId:"chat",createdAt:Date.now(),updatedAt:Date.now()};p.addEventListener("dragenter",x=>{x.preventDefault(),p.addClass("drag-over")}),p.addEventListener("dragover",x=>{x.preventDefault(),x.stopPropagation(),p.addClass("drag-over");let D=p.getBoundingClientRect(),N=p.scrollTop,O=D.height;p.addClass("highlight-chat-history-drag-guide"),p.style.setProperty("--drag-guide-top",`${N+12}px`),p.style.setProperty("--drag-guide-height",`${O-24}px`);let J=document.querySelector(".highlight-dragging");J&&(J.addClass("highlight-chat-preview"),J.style.left=`${x.clientX+10}px`,J.style.top=`${x.clientY+10}px`)}),p.addEventListener("dragleave",x=>{p.contains(x.relatedTarget)||p.removeClass("drag-over")}),p.addEventListener("drop",async x=>{var N;x.preventDefault(),p.removeClass("drag-over");let D=(N=x.dataTransfer)==null?void 0:N.getData("application/highlight");if(D)try{let O=JSON.parse(D);if(!O.text)return;this.draggedContents.some(j=>j.text===O.text)||(this.draggedContents.push(O),this.showDraggedPreviewsInChat(p))}catch(O){}});let Q=!1,U,E,H,M;if(n.addEventListener("mousedown",x=>{x.target===u||x.target===d||(Q=!0,H=x.clientX-this.containerEl.offsetLeft,M=x.clientY-this.containerEl.offsetTop,n.addClass("dragging"))}),document.addEventListener("mousemove",x=>{if(!Q)return;x.preventDefault(),U=x.clientX-H,E=x.clientY-M;let D=window.innerWidth-this.containerEl.offsetWidth,N=window.innerHeight-this.containerEl.offsetHeight;U=Math.max(0,Math.min(U,D)),E=Math.max(0,Math.min(E,N)),this.containerEl.addClass("highlight-chat-window"),this.containerEl.style.left=`${U}px`,this.containerEl.style.top=`${E}px`}),document.addEventListener("mouseup",()=>{Q=!1,n.removeClass("dragging")}),WA.savedState){this.chatHistory=WA.savedState.chatHistory,this.draggedContents=WA.savedState.draggedContents;let x=this.containerEl.querySelector(".highlight-chat-history");if(x){for(;x.firstChild;)x.removeChild(x.firstChild);this.chatHistory.forEach(D=>{this.addMessage(x,D.content,D.role,!1)}),this.draggedContents.length>0&&this.showDraggedPreviewsInChat(x),WA.savedState.currentPreviewContainer&&(this.currentPreviewContainer=x.querySelector(".highlight-chat-preview-cards"))}}WA.instance=this}showDraggedPreviewsInChat(A){var c;if(!this.currentPreviewContainer){let u=A.createEl("div",{cls:"highlight-chat-message highlight-chat-message-preview"}).createEl("div",{cls:"highlight-chat-previews"}),p=u.createEl("div",{cls:"highlight-chat-preview-header"});p.createEl("span",{cls:"highlight-chat-preview-count",text:String(this.draggedContents.length)}),p.createSpan({text:m("highlighted notes")});let B=u.createEl("div",{cls:"highlight-chat-preview-cards"});this.currentPreviewContainer=B}let t=this.currentPreviewContainer.createEl("div",{cls:"highlight-chat-preview-card"}),n=this.draggedContents[this.draggedContents.length-1];t.createEl("div",{cls:"highlight-chat-preview-content",text:n.text});let o=t.createEl("div",{cls:"highlight-chat-preview-delete"});(0,TA.setIcon)(o,"x"),o.addEventListener("click",()=>{var u;let d=this.draggedContents.indexOf(n);if(d>-1)if(this.draggedContents.splice(d,1),t.remove(),this.draggedContents.length===0){let p=(u=this.currentPreviewContainer)==null?void 0:u.closest(".highlight-chat-message-preview");p&&(p.remove(),this.currentPreviewContainer=null)}else this.updatePreviewCount()});let l=(c=this.currentPreviewContainer.closest(".highlight-chat-message-preview"))==null?void 0:c.querySelector(".highlight-chat-preview-count");l&&(l.textContent=String(this.draggedContents.length)),A.scrollTop=A.scrollHeight}show(){document.body.contains(this.containerEl)?this.containerEl.removeClass("highlight-chat-hidden"):(this.containerEl.addClass("highlight-chat-window"),this.containerEl.addClass("highlight-chat-window-position"),document.body.appendChild(this.containerEl)),document.querySelectorAll(".highlight-floating-button").forEach(A=>{A.style.display="none"}),requestAnimationFrame(()=>{var A;(A=this.textarea)==null||A.focus()})}close(){this.containerEl.addClass("highlight-chat-hidden"),document.querySelectorAll(".highlight-floating-button").forEach(A=>{A.style.display=""})}addMessage(A,t,n,o=!0){let l=A.createEl("div",{cls:"highlight-chat-message"}),c=l.createEl("div",{cls:"highlight-chat-message-content markdown-rendered"});l.addClass(`highlight-chat-message-${n}`),c.addClass(`highlight-chat-message-content-${n}`),n==="assistant"&&o?this.typeWriter(c,t):this.renderMarkdownContent(c,t),A.scrollTop=A.scrollHeight}async typeWriter(A,t,n=30){let o=0;A.textContent="";let l=A.createEl("span",{cls:"highlight-chat-cursor"}),c=()=>{o<t.length?(A.insertBefore(document.createTextNode(t.charAt(o)),l),o++,setTimeout(c,n)):(l.remove(),this.renderMarkdownContent(A,t))};c()}static getInstance(A,t){return WA.instance||(WA.instance=new WA(A,t)),WA.instance}async renderMarkdownContent(A,t){for(;A.firstChild;)A.removeChild(A.firstChild);try{await TA.MarkdownRenderer.render(this.app,t,A,"",new TA.Component),A.querySelectorAll("ul, ol").forEach(o=>{o.addClass("chat-markdown-list")})}catch(n){console.error("Error rendering markdown in chat:",n),A.textContent=t}}setupChatInput(A){let t=A.createEl("div",{cls:"highlight-chat-input-wrapper"});this.textarea=t.createEl("textarea",{cls:"highlight-chat-input",attr:{placeholder:m("Input message..."),rows:"1"}});let n=()=>{this.textarea&&(this.textarea.addClass("highlight-chat-input"),this.textarea.style.height=`${Math.min(this.textarea.scrollHeight,150)}px`)};return this.textarea.addEventListener("input",()=>{n()}),this.textarea.addEventListener("keydown",o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),this.textarea&&this.handleSendMessage(this.textarea))}),this.textarea}async handleSendMessage(A){let t=A.value.trim();if(!(!t||this.isProcessing))try{this.isProcessing=!0;let n=t,o=t;if(this.draggedContents.length>0){let c=this.draggedContents.map(d=>d.text).join(`

---

`);if(this.chatHistory.push({role:"user",content:`\u4EE5\u4E0B\u662F\u9700\u8981\u5206\u6790\u7684\u5185\u5BB9\uFF1A

${c}`}),n=t,o=`\u7528\u6237\u63D0\u793A\uFF1A${t}`,this.currentPreviewContainer){let d=this.currentPreviewContainer.closest(".highlight-chat-message-preview");d&&d.addClass("sent"),this.currentPreviewContainer=null,this.draggedContents=[]}}this.chatHistory.push({role:"user",content:o}),requestAnimationFrame(()=>{A.value="",A.addClass("highlight-chat-input"),A.dispatchEvent(new Event("input"))});let l=this.containerEl.querySelector(".highlight-chat-history");if(l){this.addMessage(l,t,"user",!0);let c=await this.chatService.sendMessage(n,this.chatHistory);this.chatHistory.push({role:"assistant",content:c.content}),this.addMessage(l,c.content,"assistant",!0)}}catch(n){}finally{this.isProcessing=!1}}updatePreviewCount(){if(this.currentPreviewContainer){let A=this.currentPreviewContainer.closest(".highlight-chat-message-preview"),t=A==null?void 0:A.querySelector(".highlight-chat-preview-count");t&&(t.textContent=String(this.draggedContents.length),this.draggedContents.length===0&&A&&(A.remove(),this.currentPreviewContainer=null))}}clearChat(){if(this.chatHistory=[],this.draggedContents=[],this.currentPreviewContainer){let t=this.currentPreviewContainer.closest(".highlight-chat-message-preview");t&&t.remove(),this.currentPreviewContainer=null}let A=this.containerEl.querySelector(".highlight-chat-history");if(A)for(;A.firstChild;)A.removeChild(A.firstChild);this.textarea&&(this.textarea.value="",this.textarea.addClass("highlight-chat-input"))}getCurrentModelName(){var n,o,l,c,d,u,p,B;let A=this.plugin.settings.ai;switch(this.chatModelState.provider||A.provider){case"openai":return this.chatModelState.model||((n=A.openai)==null?void 0:n.model)||"GPT-4";case"anthropic":return this.chatModelState.model||((o=A.anthropic)==null?void 0:o.model)||"Claude-3";case"ollama":return this.chatModelState.model||((l=A.ollama)==null?void 0:l.model)||"Ollama";case"gemini":return this.chatModelState.model||((c=A.gemini)==null?void 0:c.model)||"Gemini Pro";case"deepseek":return this.chatModelState.model||((d=A.deepseek)==null?void 0:d.model)||"Deepseek Chat";case"siliconflow":return(u=A.siliconflow)!=null&&u.isCustomModel&&((p=A.siliconflow)!=null&&p.model)?A.siliconflow.model:this.chatModelState.model?this.chatModelState.model:((B=A.siliconflow)==null?void 0:B.model)||"SiliconFlow";default:return"Unknown model"}}async showModelSelector(A,t){var c,d,u,p,B,v;let n=new TA.Menu,o=this.plugin.settings.ai;switch(o.provider){case"siliconflow":try{if(Ue.forEach(E=>{n.addItem(H=>{var x,D;let M=!((x=o.siliconflow)!=null&&x.isCustomModel)&&(this.chatModelState.model===E.id||((D=o.siliconflow)==null?void 0:D.model)===E.id);H.setTitle(E.name).setChecked(M).onClick(async()=>{o.siliconflow?(o.siliconflow.model=E.id,o.siliconflow.isCustomModel=!1):o.siliconflow={model:E.id,isCustomModel:!1},this.chatModelState.provider="siliconflow",this.chatModelState.model=E.id,this.chatService.updateModel("siliconflow",E.id),await this.plugin.saveSettings(),A.textContent=E.name})})}),(c=o.siliconflow)!=null&&c.isCustomModel&&((d=o.siliconflow)!=null&&d.model)){n.addSeparator();let E=o.siliconflow.model;n.addItem(H=>{var x,D;let M=((x=o.siliconflow)==null?void 0:x.isCustomModel)&&(this.chatModelState.model===E||((D=o.siliconflow)==null?void 0:D.model)===E);H.setTitle(E).setChecked(M).onClick(async()=>{o.siliconflow?(o.siliconflow.model=E,o.siliconflow.isCustomModel=!0):o.siliconflow={model:E,isCustomModel:!0},this.chatModelState.provider="siliconflow",this.chatModelState.model=E,this.chatService.updateModel("siliconflow",E),await this.plugin.saveSettings(),A.textContent=E})})}}catch(U){new TA.Notice(m("Unable to get SiliconFlow model list, please check API Key and network connection."))}break;case"openai":try{let U=await this.chatService.aiService.listOpenAIModels(),E=U.filter(M=>!M.isCustom),H=U.filter(M=>M.isCustom);E.forEach(M=>{n.addItem(x=>{x.setTitle(M.name).setChecked(this.chatModelState.model===M.id).onClick(async()=>{this.chatModelState.provider="openai",this.chatModelState.model=M.id,this.chatService.updateModel("openai",M.id),A.textContent=this.getCurrentModelName()})})}),H.length>0&&(n.addSeparator(),H.forEach(M=>{n.addItem(x=>{x.setTitle(M.name).setChecked(this.chatModelState.model===M.id).onClick(async()=>{this.chatModelState.provider="openai",this.chatModelState.model=M.id,this.chatService.updateModel("openai",M.id),A.textContent=this.getCurrentModelName()})})}))}catch(U){new TA.Notice(m("Unable to get OpenAI model list, please check API Key and network connection."))}break;case"anthropic":["claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307"].forEach(U=>{n.addItem(E=>{var H;E.setTitle(U).setChecked(((H=o.anthropic)==null?void 0:H.model)===U).onClick(async()=>{o.anthropic||(o.anthropic={apiKey:"",model:U}),o.anthropic.model=U,await this.plugin.saveSettings(),A.textContent=this.getCurrentModelName()})})});break;case"ollama":try{(await this.chatService.aiService.listOllamaModels()).forEach(E=>{n.addItem(H=>{var M;H.setTitle(E).setChecked(((M=o.ollama)==null?void 0:M.model)===E).onClick(async()=>{o.ollama||(o.ollama={host:"http://localhost:11434",model:E}),o.ollama.model=E,await this.plugin.saveSettings(),A.textContent=this.getCurrentModelName()})})})}catch(U){new TA.Notice(m("Unable to access the Ollama model, please check the service."))}break;case"gemini":try{(await this.chatService.aiService.listGeminiModels()).forEach(E=>{n.addItem(H=>{var M;H.setTitle(E.name).setChecked(((M=o.gemini)==null?void 0:M.model)===E.id).onClick(async()=>{this.chatModelState.provider="gemini",this.chatModelState.model=E.id,this.chatService.updateModel("gemini",E.id),A.textContent=this.getCurrentModelName()})})}),(u=o.gemini)!=null&&u.isCustomModel&&((p=o.gemini)!=null&&p.model)&&(n.addSeparator(),n.addItem(E=>{var M,x;let H={id:((M=o.gemini)==null?void 0:M.model)||"",name:(x=o.gemini)==null?void 0:x.model,isCustom:!0};E.setTitle(H.name).setChecked(this.chatModelState.model===H.id).onClick(async()=>{this.chatModelState.provider="gemini",this.chatModelState.model=H.id,this.chatService.updateModel("gemini",H.id),A.textContent=this.getCurrentModelName()})}))}catch(U){new TA.Notice(m("Unable to get Gemini model list, please check API Key and network connection."))}break;case"deepseek":try{(await this.chatService.aiService.listDeepseekModels()).forEach(E=>{n.addItem(H=>{var M;H.setTitle(E.name).setChecked(((M=o.deepseek)==null?void 0:M.model)===E.id).onClick(async()=>{this.chatModelState.provider="deepseek",this.chatModelState.model=E.id,this.chatService.updateModel("deepseek",E.id),A.textContent=this.getCurrentModelName()})})}),(B=o.deepseek)!=null&&B.isCustomModel&&((v=o.deepseek)!=null&&v.model)&&(n.addSeparator(),n.addItem(E=>{var M,x;let H={id:((M=o.deepseek)==null?void 0:M.model)||"",name:(x=o.deepseek)==null?void 0:x.model,isCustom:!0};E.setTitle(H.name).setChecked(this.chatModelState.model===H.id).onClick(async()=>{this.chatModelState.provider="deepseek",this.chatModelState.model=H.id,this.chatService.updateModel("deepseek",H.id),A.textContent=this.getCurrentModelName()})}))}catch(U){new TA.Notice(m("Unable to get Deepseek model list, please check API Key and network connection."))}break;default:new TA.Notice(m("Unknown AI provider"));break}let l=A.getBoundingClientRect();n.showAtPosition({x:l.left,y:l.bottom})}};WA.instance=null,WA.savedState=null;var ze=WA;var ie="comment-view",ue=class extends X.ItemView{constructor(A,t){super(A);this.handleGlobalClick=A=>{if(this.isSelectionMode||this.selectedHighlights.size<=1||!this.multiSelectActionsContainer||this.multiSelectActionsContainer.style.display==="none")return;let t=A.target;t.closest(".multi-select-actions")||t.closest(".highlight-card.selected")||t.closest(".highlight-container")||this.clearSelection()};this.handleSelectionStart=A=>{A.target.closest(".highlight-card")||A.target.closest(".flashcard-mode")||A.target.closest(".flashcard-add-group")||A.target.closest(".flashcard-group-action")||A.target.closest(".highlight-floating-button")||(this.selectionStartX=A.clientX,this.selectionStartY=A.clientY,this.mouseMoved=!1,document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp))};this.handleMouseMove=A=>{let t=A.clientX-this.selectionStartX,n=A.clientY-this.selectionStartY;Math.sqrt(t*t+n*n)>=this.mouseMoveThreshold&&(this.mouseMoved=!0,document.removeEventListener("mousemove",this.handleMouseMove),this.startSelection(A))};this.handleMouseUp=A=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.mouseMoved||this.clearSelection()};this.handleSelectionMove=A=>{if(!this.isSelectionMode||!this.selectionBox)return;let t=A.clientX-this.selectionStartX,n=A.clientY-this.selectionStartY;t<0?(this.selectionBox.style.left=`${A.clientX}px`,this.selectionBox.style.width=`${-t}px`):this.selectionBox.style.width=`${t}px`,n<0?(this.selectionBox.style.top=`${A.clientY}px`,this.selectionBox.style.height=`${-n}px`):this.selectionBox.style.height=`${n}px`,this.selectCardsInBox()};this.handleSelectionEnd=A=>{this.isSelectionMode&&(this.selectionBox&&(this.selectionBox.remove(),this.selectionBox=null),this.isSelectionMode=!1,document.removeEventListener("mousemove",this.handleSelectionMove),document.removeEventListener("mouseup",this.handleSelectionEnd),this.updateSelectedHighlights())};this.selectedHighlights=new Set;this.currentFile=null;this.isFlashcardMode=!1;this.highlights=[];this.highlightsWithFlashcards=new Set;this.isDraggedToMainView=!1;this.isMobileView=!1;this.isSmallScreen=!1;this.isShowingFileList=!0;this.currentBatch=0;this.isLoading=!1;this.BATCH_SIZE=20;this.floatingButton=null;this.aiButtons=[];this.currentEditingHighlightId=null;this.flashcardComponent=null;this.isSelectionMode=!1;this.selectionBox=null;this.selectionStartX=0;this.selectionStartY=0;this.mouseMoveThreshold=5;this.mouseMoved=!1;this.commentStore=t;let n=this.app.plugins;if(n&&n.plugins&&n.plugins["hi-note"])this.plugin=n.plugins["hi-note"];else throw new Error("Hi-Note plugin not found");this.locationService=new Fr(this.app),this.exportService=new Qr(this.app,this.commentStore),this.highlightService=new oe(this.app),this.licenseManager=new qe(this.plugin),this.registerEvent(this.app.workspace.on("file-open",l=>{l&&!this.isDraggedToMainView&&(this.currentFile=l,this.updateHighlights())})),this.registerEvent(this.app.vault.on("modify",l=>{l===this.currentFile&&!this.isDraggedToMainView&&this.updateHighlights()}));let o=l=>{let{highlightId:c,text:d}=l.detail;setTimeout(()=>{this.highlightContainer.querySelectorAll(".highlight-card").forEach(p=>{p.removeClass("selected")});let u=te.findCardInstanceByHighlightId(c);if(!u){let p=Array.from(this.highlightContainer.querySelectorAll(".highlight-card")).find(B=>{var Q;return((Q=B.querySelector(".highlight-text-content"))==null?void 0:Q.textContent)===d});p&&(p.addClass("selected"),u=te.findCardInstanceByElement(p),p.scrollIntoView({behavior:"smooth"}))}u&&u.showCommentInput()},100)};window.addEventListener("open-comment-input",o),this.register(()=>window.removeEventListener("open-comment-input",o)),this.registerEvent(this.app.workspace.on("layout-change",()=>{this.checkViewPosition()})),this.loadingIndicator=createEl("div",{cls:"highlight-loading-indicator",text:m("Loading...")}),this.loadingIndicator.addClass("highlight-display-none")}clearSelection(){this.highlightContainer.querySelectorAll(".highlight-card.selected").forEach(A=>{A.removeClass("selected")}),te&&typeof te.clearSelection=="function"&&te.clearSelection(),this.selectedHighlights.clear(),this.hideMultiSelectActions(),this.isSelectionMode=!1}handleMultiSelect(A){let t=A.detail;t&&t.selectedCards&&this.updateSelectedHighlights()}updateSelectedHighlights(){this.selectedHighlights.clear(),Array.from(this.highlightContainer.querySelectorAll(".highlight-card.selected")).forEach(t=>{let n=t.getAttribute("data-highlight");if(n)try{let o=JSON.parse(n);this.selectedHighlights.add(o)}catch(o){console.error("Error parsing highlight data:",o)}}),this.selectedHighlights.size>1?this.showMultiSelectActions():this.hideMultiSelectActions()}async showMultiSelectActions(){this.hideMultiSelectActions(),this.multiSelectActionsContainer||(this.multiSelectActionsContainer=this.containerEl.createEl("div",{cls:"multi-select-actions"})),this.multiSelectActionsContainer.show(),this.multiSelectActionsContainer.empty();let A=this.multiSelectActionsContainer.createEl("div",{cls:"selected-count",text:`selected ${this.selectedHighlights.size}`}),t=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});t.setAttribute("aria-label",m("Export")),(0,X.setIcon)(t,"file-input"),t.addEventListener("click",()=>{this.exportSelectedHighlights()});let n=this.plugin.fsrsManager;if(!n){this.createDefaultFlashcardButton(this.multiSelectActionsContainer);return}let o=0;for(let l of this.selectedHighlights)if(l.id){let c=n.findCardsBySourceId(l.id,"highlight");c&&c.length>0&&o++}if(o===0){let l=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});l.setAttribute("aria-label",m("Create HiCard")),(0,X.setIcon)(l,"book-plus"),(async()=>{let d=await this.licenseManager.isActivated(),u=d?await this.licenseManager.isFeatureEnabled("flashcard"):!1;return d&&u})().then(d=>{d||(l.addClass("disabled-button"),l.setAttribute("aria-label",m("Only HiNote Pro")))}),l.addEventListener("click",async()=>{if(l.hasClass("disabled-button")){new X.Notice(m("Only HiNote Pro"));return}await this.createMissingFlashcards()})}else if(o===this.selectedHighlights.size){let l=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button delete-flashcard-button"});l.setAttribute("aria-label",m("Delete HiCard")),(0,X.setIcon)(l,"book-x"),l.addEventListener("click",()=>{this.deleteFlashcardsFromSelected()})}else{let l=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});l.setAttribute("aria-label",m("Manage HiCard")),(0,X.setIcon)(l,"book-heart"),l.addEventListener("click",c=>{this.showFlashcardManageMenu(c)})}}hideMultiSelectActions(){this.multiSelectActionsContainer&&(this.multiSelectActionsContainer.empty(),this.multiSelectActionsContainer.hide())}createDefaultFlashcardButton(A){let t=A.createEl("div",{cls:"multi-select-action-button"});t.setAttribute("aria-label",m("Create HiCard")),(0,X.setIcon)(t,"plus-circle"),t.addEventListener("click",()=>{new X.Notice(m("HiCard function is not initialized, please enable FSRS function"))})}showFlashcardManageMenu(A){let t=new X.Menu;t.addItem(o=>{o.setTitle(m("Create missing HiCard")).setIcon("plus-circle").onClick(async()=>{await this.createMissingFlashcards()})}),t.addItem(o=>{o.setTitle(m("Delete existing HiCards")).setIcon("trash").onClick(()=>{this.deleteFlashcardsFromSelected()})});let n=A.currentTarget;if(n){let o=n.getBoundingClientRect();t.showAtPosition({x:o.left-85,y:o.top-60})}else t.showAtMouseEvent(A)}async createMissingFlashcards(){let A=await this.licenseManager.isActivated(),t=A?await this.licenseManager.isFeatureEnabled("flashcard"):!1;if(!A||!t){new X.Notice(m("Only HiNote Pro"));return}let n=this.plugin.fsrsManager;if(!n){new X.Notice(m("HiCard function is not initialized, please enable FSRS function"));return}let o=0,l=0;for(let c of this.selectedHighlights)try{if(c.id){let d=n.findCardsBySourceId(c.id,"highlight");if(d&&d.length>0)continue;let u=te.findCardInstanceByHighlightId(c.id),p=!1;if(u)p=await u.createHiCardForHighlight(!0);else{let B=document.createElement("div");u=new te(B,c,this.plugin,{onHighlightClick:async()=>{},onCommentAdd:()=>{},onExport:()=>{},onCommentEdit:()=>{},onAIResponse:async()=>{}},!1),p=await u.createHiCardForHighlight(!0)}p?o++:(l++,console.error(`Create HiCard failed: ${c.text}`))}}catch(d){l++,console.error("Create HiCard failed:",d)}o>0&&this.plugin.eventManager.emitFlashcardChanged(),o>0&&l===0?new X.Notice(m(`Successfully created ${o} HiCard`)):o>0&&l>0?new X.Notice(m(`Successfully created ${o} HiCard, ${l} failed`)):o===0&&l===0?new X.Notice(m("No HiCard to create")):new X.Notice(m("Failed to create HiCard! Please check the selected highlight content")),this.clearSelection(),this.renderHighlights(this.highlights)}async exportSelectedHighlights(){if(this.selectedHighlights.size===0){new X.Notice(m("Please select highlights to export"));return}try{let A=Array.from(this.selectedHighlights),t=await this.exportService.exportHighlightsAsMarkdown(A);t?(new X.Notice(m("Successfully exported selected highlights to: ")+t.path),this.clearSelection()):new X.Notice(m("No highlights to export"))}catch(A){console.error("Failed to export highlights:",A),new X.Notice(m("Failed to export highlights: ")+(A instanceof Error?A.message:String(A)))}}deleteFlashcardsFromSelected(){let A=new X.Modal(this.app);A.titleEl.setText(m("Confirm delete HiCard"));let t=A.contentEl;t.empty(),t.createEl("p",{text:m("Are you sure you want to delete the HiCards of the selected highlights? This action cannot be undone.")});let n=t.createEl("div",{cls:"modal-button-container"});n.createEl("button",{text:m("Cancel")}).addEventListener("click",()=>{A.close()}),n.createEl("button",{cls:"mod-warning",text:m("Delete")}).addEventListener("click",async()=>{A.close(),await this.deleteExistingFlashcards()}),A.open()}async deleteExistingFlashcards(){let A=this.plugin.fsrsManager;if(!A){new X.Notice(m("HiCard function is not initialized, please enable FSRS function"));return}let t=0,n=0;for(let o of this.selectedHighlights)try{if(o.id){let l=A.findCardsBySourceId(o.id,"highlight");if(!l||l.length===0)continue;let c=te.findCardInstanceByHighlightId(o.id),d=!1;if(c)d=await c.deleteHiCardForHighlight(!0);else{let u=document.createElement("div");c=new te(u,o,this.plugin,{onHighlightClick:async()=>{},onCommentAdd:()=>{},onExport:()=>{},onCommentEdit:()=>{},onAIResponse:async()=>{}},!1),d=await c.deleteHiCardForHighlight(!0)}d?t++:(n++,console.error(`Failed to delete HiCard: ${o.text}`))}}catch(l){n++,console.error("Failed to delete HiCard:",l)}t>0&&this.plugin.eventManager.emitFlashcardChanged(),t>0&&n===0?new X.Notice(m(`Successfully deleted ${t} HiCard`)):t>0&&n>0?new X.Notice(m(`Successfully deleted ${t} HiCard, ${n} failed`)):t===0&&n===0?new X.Notice(m("No HiCard to delete")):new X.Notice(m("Failed to delete HiCard! Please check the selected highlight content")),this.clearSelection(),this.renderHighlights(this.highlights)}setupSelectionBox(){this.highlightContainer.removeEventListener("mousedown",this.handleSelectionStart),this.highlightContainer.addEventListener("mousedown",this.handleSelectionStart)}startSelection(A){let t=this.highlightContainer.querySelectorAll(".highlight-card.selected").length>0,n=window.HighlightCard,o=n&&n.selectedCards&&n.selectedCards.size>0;(this.selectedHighlights.size>0||t||o)&&this.clearSelection(),this.selectionBox=document.createElement("div"),this.selectionBox.className="selection-box",this.selectionBox.style.left=`${this.selectionStartX}px`,this.selectionBox.style.top=`${this.selectionStartY}px`,document.body.appendChild(this.selectionBox),this.isSelectionMode=!0,document.addEventListener("mousemove",this.handleSelectionMove),document.addEventListener("mouseup",this.handleSelectionEnd)}selectCardsInBox(){if(!this.selectionBox)return;let A=this.selectionBox.getBoundingClientRect(),t=this.highlightContainer.querySelectorAll(".highlight-card"),n=window.HighlightCard;t.forEach(o=>{let l=o.getBoundingClientRect();!(A.right<l.left||A.left>l.right||A.bottom<l.top||A.top>l.bottom)?(o.addClass("selected"),n&&n.selectedCards&&n.selectedCards.add(o)):document.querySelector(".multi-select-mode")||(o.removeClass("selected"),n&&n.selectedCards&&n.selectedCards.delete(o))})}getViewType(){return ie}getDisplayText(){return"HiNote"}getIcon(){return"highlighter"}async onOpen(){let A=this.containerEl.children[1];A.empty(),A.addClass("comment-view-container"),A.addEventListener("highlight-multi-select",v=>{this.handleMultiSelect(v)}),document.addEventListener("click",this.handleGlobalClick);let t=A.createEl("div",{cls:"highlight-main-container"});this.fileListContainer=t.createEl("div",{cls:"highlight-file-list-container"}),this.mainContentContainer=t.createEl("div",{cls:"highlight-content-container"});let o=this.mainContentContainer.createEl("div",{cls:"highlight-back-button-container"}).createEl("div",{cls:"highlight-back-button"});(0,X.setIcon)(o,"arrow-left"),o.createEl("span",{text:m("BACK"),cls:"highlight-back-button-text"}),o.addEventListener("click",()=>{if(this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView){if(this.isFlashcardMode&&this.flashcardComponent){let v=this.flashcardComponent.getRenderer();if(v&&!v.isShowingSidebar()){v.showSidebar();return}}this.isShowingFileList=!0,this.updateViewLayout()}}),this.searchContainer=this.mainContentContainer.createEl("div",{cls:"highlight-search-container"}),this.searchInput=this.searchContainer.createEl("input",{cls:"highlight-search-input",attr:{type:"text",placeholder:m("Search...")}}),this.searchInput.addEventListener("focus",()=>{this.searchContainer.addClass("focused")}),this.searchInput.addEventListener("blur",()=>{this.searchContainer.removeClass("focused")});let l=this.searchContainer.createEl("div",{cls:"highlight-search-icons"}),c=l.createEl("div",{cls:"highlight-icon-button"});(0,X.setIcon)(c,"message-square-plus"),c.setAttribute("aria-label",m("Add File Comment")),c.addEventListener("click",async()=>{if(!this.currentFile){new X.Notice(m("Please open a file first."));return}let v=Date.now(),U={id:`file-comment-${v}`,text:`__virtual_highlight_${v}__`,filePath:this.currentFile.path,fileType:this.currentFile.extension,displayText:m("File Comment"),isVirtual:!0,position:0,paragraphOffset:0,paragraphId:`${this.currentFile.path}#^virtual-${v}`,createdAt:v,updatedAt:v,comments:[]};await this.commentStore.addComment(this.currentFile,U),this.highlights.unshift(U),this.renderHighlights(this.highlights),setTimeout(()=>{let E=this.highlightContainer.querySelector(".highlight-card");E&&(this.showCommentInput(E,U),this.highlightContainer.scrollTo({top:0,behavior:"smooth"}))},100)});let d=l.createEl("div",{cls:"highlight-icon-button"});(0,X.setIcon)(d,"file-symlink"),d.setAttribute("aria-label",m("Export as notes")),d.addEventListener("click",async()=>{if(!this.currentFile){new X.Notice(m("Please open a file first."));return}try{let v=await this.exportService.exportHighlightsToNote(this.currentFile);new X.Notice(m("Successfully exported highlights to: ")+v.path),await this.app.workspace.getLeaf().openFile(v)}catch(v){new X.Notice(m("Failed to export highlights: ")+v.message)}}),this.searchInput.addEventListener("input",(0,X.debounce)(()=>{this.updateHighlightsList()},300)),this.highlightContainer=this.mainContentContainer.createEl("div",{cls:"highlight-container"}),this.registerDomEvent(document,"keydown",v=>{v.key==="Shift"&&this.highlightContainer.addClass("multi-select-mode")}),this.registerDomEvent(document,"keyup",v=>{v.key==="Shift"&&this.highlightContainer.removeClass("multi-select-mode")});let u=this.app.workspace.getActiveFile();u&&(this.currentFile=u,await this.updateHighlights()),this.updateViewLayout(),this.highlightContainer.empty();let p=this.searchInput.value.toLowerCase().trim(),B=this.highlights.filter(v=>{var Q,U;return!!(v.text.toLowerCase().includes(p)||(Q=v.comments)!=null&&Q.some(E=>E.content.toLowerCase().includes(p))||this.currentFile===null&&((U=v.fileName)!=null&&U.toLowerCase().includes(p)))});this.renderHighlights(B)}renderHighlights(A,t=!1){if(t||(this.highlightContainer.empty(),this.currentBatch=0,this.selectedHighlights.clear(),this.isSelectionMode=!1),A.length===0){let o=this.searchInput&&this.searchInput.value.trim()!=="",l=this.highlightContainer.createEl("div",{cls:"highlight-empty-state",text:o?m("No matching highlights found for your search."):m("The current document has no highlighted content.")});return}this.setupSelectionBox();let n=this.highlightContainer.querySelector(".highlight-list");n||(n=this.highlightContainer.createEl("div",{cls:"highlight-list"})),A.forEach(o=>{let l;this.currentFile&&!o.filePath&&(o.filePath=this.currentFile.path),l=new te(n,o,this.plugin,{onHighlightClick:async d=>await this.jumpToHighlight(d),onCommentAdd:d=>this.showCommentInput(l.getElement(),d),onExport:d=>this.exportHighlightAsImage(d),onCommentEdit:(d,u)=>this.showCommentInput(l.getElement(),d,u),onAIResponse:async d=>{await this.addComment(o,d),await this.updateHighlights()}},this.isDraggedToMainView,this.currentFile===null?o.fileName:this.currentFile.basename),o.id&&this.highlightsWithFlashcards.has(o.id)&&setTimeout(()=>{o.id&&te.updateCardUIByHighlightId(o.id)},0);let c=l.getElement();if(this.isDraggedToMainView){c.classList.add("in-main-view");let d=c.querySelector(".highlight-text-content");d&&d.removeAttribute("title")}else{c.classList.remove("in-main-view");let d=c.querySelector(".highlight-text-content");d&&d.setAttribute("aria-label","Jump to highlight")}})}async addComment(A,t){var l;let n=await this.getFileForHighlight(A);if(!n){new X.Notice(m("No corresponding file found."));return}A.id||(A.id=_A.generateHighlightId(((l=this.currentFile)==null?void 0:l.path)||"",A.position||0,A.text)),A.comments||(A.comments=[]);let o={id:_A.generateCommentId(),content:t,createdAt:Date.now(),updatedAt:Date.now()};A.comments.push(o),A.updatedAt=Date.now(),await this.commentStore.addComment(n,A),window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),await this.refreshView()}async updateComment(A,t,n){let o=await this.getFileForHighlight(A);if(!o||!A.comments)return;let l=A.comments.find(c=>c.id===t);if(l){let c=l.content;l.content=n,l.updatedAt=Date.now(),A.updatedAt=Date.now(),await this.commentStore.addComment(o,A),window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),A.id&&this.plugin.eventManager.emitCommentUpdate(o.path,c,n,A.id),await this.refreshView()}}checkHasFlashcard(A){let n=this.plugin.fsrsManager;if(!n||!A)return!1;let o=n.findCardsBySourceId(A,"highlight");return o&&o.length>0}async deleteComment(A,t){let n=await this.getFileForHighlight(A);if(!(!n||!A.comments)){if(A.comments=A.comments.filter(o=>o.id!==t),A.updatedAt=Date.now(),A.comments.length===0){let o=A.id?this.checkHasFlashcard(A.id):!1;A.isVirtual||!o?(await this.commentStore.removeComment(n,A),this.highlights=this.highlights.filter(l=>l.id!==A.id)):await this.commentStore.addComment(n,A)}else await this.commentStore.addComment(n,A);window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),await this.refreshView()}}async getFileForHighlight(A){if(this.currentFile)return this.currentFile;if(A.filePath){let t=this.app.vault.getAbstractFileByPath(A.filePath);if(t instanceof X.TFile)return t}if(A.fileName){let n=this.app.vault.getFiles().find(o=>o.basename===A.fileName||o.name===A.fileName);if(n)return n}return null}generateHighlightId(A){var t;return _A.generateHighlightId(((t=this.currentFile)==null?void 0:t.path)||"",A.position||0,A.text)}async jumpToHighlight(A){if(!this.isDraggedToMainView&&!A.isGlobalSearch){if(!this.currentFile){new X.Notice(m("No corresponding file found."));return}await this.locationService.jumpToHighlight(A,this.currentFile.path)}}async exportHighlightAsImage(A){try{let t=(await Promise.resolve().then(()=>lo(tn()))).default;new cr(this.app,A,t).open()}catch(t){new X.Notice(m("Export failed: Failed to load necessary components."))}}async showCommentInput(A,t,n){this.currentEditingHighlightId=t.id,new yr(A,t,n,{onSave:async o=>{n?await this.updateComment(t,n.id,o):await this.addComment(t,o),await this.updateHighlights()},onDelete:n?async()=>{await this.deleteComment(t,n.id)}:void 0,onCancel:async()=>{let o=this.highlights.find(l=>l.id===this.currentEditingHighlightId);if(o!=null&&o.isVirtual&&(!o.comments||o.comments.length===0)){let l=await this.getFileForHighlight(o);l&&(await this.commentStore.removeComment(l,o),this.highlights=this.highlights.filter(c=>c.id!==o.id),await this.refreshView())}}}).show()}async onload(){}async checkViewPosition(){let A=this.app.workspace.rootSplit;if(!A)return;let t=this.isViewInMainArea(this.leaf,A);if(this.isDraggedToMainView!==t){if(this.isDraggedToMainView=t,t){this.checkIfMobile()&&this.checkIfSmallScreen()&&(this.isShowingFileList=!0);let n=this.app.workspace.getActiveFile();n?(this.currentFile=n,await this.updateHighlights()):(this.currentFile=null,await this.updateAllHighlights()),this.updateFileListSelection()}else{this.isFlashcardMode&&(this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection());let n=this.app.workspace.getActiveFile();n?(this.currentFile=n,this.updateHighlights()):(this.highlights=[],this.renderHighlights([]))}this.updateViewLayout(),this.updateHighlightsList()}}isViewInMainArea(A,t){return t&&t.children?t.children.some(n=>n===A?!0:this.isViewInMainArea(A,n)):!1}checkIfMobile(){return X.Platform.isMobile}checkIfSmallScreen(){return window.innerWidth<768}async updateViewLayout(){this.isMobileView=this.checkIfMobile(),this.isSmallScreen=this.checkIfSmallScreen(),this.fileListContainer.removeClass("highlight-display-block"),this.fileListContainer.removeClass("highlight-display-none"),this.mainContentContainer.removeClass("highlight-display-none");let A=this.containerEl.children[1];if(this.isDraggedToMainView?A.addClass("is-in-main-view"):A.removeClass("is-in-main-view"),this.isSmallScreen?A.addClass("is-small-screen"):A.removeClass("is-small-screen"),this.isDraggedToMainView)await this.updateFileList(),this.createFloatingButton(),this.isMobileView&&this.isSmallScreen?this.isShowingFileList?(this.fileListContainer.addClass("highlight-display-block"),this.mainContentContainer.addClass("highlight-display-none"),this.fileListContainer.addClass("highlight-full-width")):(this.fileListContainer.addClass("highlight-display-none"),this.mainContentContainer.removeClass("highlight-display-none"),this.fileListContainer.removeClass("highlight-full-width")):(this.fileListContainer.addClass("highlight-display-block"),this.mainContentContainer.removeClass("highlight-display-none"),this.fileListContainer.removeClass("highlight-full-width"));else if(this.fileListContainer.addClass("highlight-display-none"),this.removeFloatingButton(),!this.isFlashcardMode){this.searchContainer.removeClass("highlight-display-none");let t=this.searchContainer.querySelector(".highlight-search-icons");t&&t.removeClass("highlight-display-none")}}async updateFileList(){var U;if(this.fileListContainer.children.length>0){this.updateFileListSelection();return}this.fileListContainer.empty(),this.fileListContainer.createEl("div",{cls:"highlight-file-list-header"}).createEl("div",{text:"HiNote",cls:"highlight-file-list-title"});let t=this.fileListContainer.createEl("div",{cls:"highlight-file-list"}),n=t.createEl("div",{cls:`highlight-file-item highlight-file-item-all ${this.currentFile===null?"is-active":""}`});n.addEventListener("click",()=>{this.currentFile=null,this.isFlashcardMode=!1,this.updateHighlights(),this.updateFileListSelection(),this.searchContainer.removeClass("highlight-display-none");let E=this.searchContainer.querySelector(".highlight-search-icons");E&&E.addClass("highlight-display-none")});let o=n.createEl("div",{cls:"highlight-file-item-left"}),l=o.createEl("span",{cls:"highlight-file-item-icon"});(0,X.setIcon)(l,"square-library"),o.createEl("span",{text:m("All Highlight"),cls:"highlight-file-item-name"});let c=t.createEl("div",{cls:"highlight-file-item highlight-file-item-flashcard"});c.addEventListener("click",async()=>{this.currentFile=null,this.isFlashcardMode=!0,this.updateFileListSelection(),this.searchContainer.addClass("highlight-display-none"),this.highlightContainer.empty(),this.flashcardComponent||(this.flashcardComponent=new ri(this.highlightContainer,this.plugin),this.flashcardComponent.setLicenseManager(this.licenseManager)),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.flashcardComponent.activate()});let d=c.createEl("div",{cls:"highlight-file-item-left"}),u=d.createEl("span",{cls:"highlight-file-item-icon"});(0,X.setIcon)(u,"book-heart"),d.createEl("span",{text:m("HiCard"),cls:"highlight-file-item-name"});let p=c.createEl("span",{cls:"highlight-file-item-count"}),B=async()=>{let E=this.plugin.fsrsManager.getTotalCardsCount();p.textContent=`${E}`};B(),this.registerEvent(this.plugin.eventManager.on("flashcard:changed",()=>{B()})),d.addEventListener("click",async()=>{let E=this.plugin.fsrsManager.getCardGroups(),H=[];if(E&&E.length>0){let M=E[0].id;H=this.plugin.fsrsManager.getCardsForStudy(M),this.highlightContainer.empty(),this.flashcardComponent||(this.flashcardComponent=new ri(this.highlightContainer,this.plugin),this.flashcardComponent.setLicenseManager(this.licenseManager)),await this.flashcardComponent.activate(),this.updateFileListSelection()}});let v=await this.getTotalHighlightsCount();n.createEl("span",{text:`${v}`,cls:"highlight-file-item-count"}),t.createEl("div",{cls:"highlight-file-list-separator"}),n.addEventListener("click",async()=>{this.currentFile=null,this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection(),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.updateAllHighlights()});let Q=await this.getFilesWithHighlights();for(let E of Q){let H=t.createEl("div",{cls:`highlight-file-item ${((U=this.currentFile)==null?void 0:U.path)===E.path?"is-active":""}`});H.setAttribute("data-path",E.path);let M=H.createEl("div",{cls:"highlight-file-item-left"}),x=M.createEl("span",{cls:"highlight-file-item-icon",attr:{"aria-label":m("Open (DoubleClick)")}});(0,X.setIcon)(x,"file-text"),x.addEventListener("dblclick",async O=>{O.stopPropagation(),await this.getPreferredLeaf().openFile(E)});let D=M.createEl("span",{text:E.basename,cls:"highlight-file-item-name"});this.addPagePreview(D,E);let N=await this.getFileHighlightsCount(E);H.createEl("span",{text:`${N}`,cls:"highlight-file-item-count"}),H.addEventListener("click",async()=>{this.currentFile=E,this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection(),this.searchContainer.removeClass("highlight-display-none");let O=this.searchContainer.querySelector(".highlight-search-icons");O&&O.removeClass("highlight-display-none"),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.updateHighlights()})}}updateFileListSelection(){let A=this.fileListContainer.querySelector(".highlight-file-item-all");A&&A.classList.toggle("is-active",this.currentFile===null&&!this.isFlashcardMode);let t=this.fileListContainer.querySelector(".highlight-file-item-flashcard");t&&t.classList.toggle("is-active",this.isFlashcardMode),this.fileListContainer.querySelectorAll(".highlight-file-item:not(.highlight-file-item-all):not(.highlight-file-item-flashcard)").forEach(o=>{var c;let l=((c=this.currentFile)==null?void 0:c.path)===o.getAttribute("data-path");o.classList.toggle("is-active",l)})}async getFilesWithHighlights(){let t=(await this.app.vault.getMarkdownFiles()).filter(o=>this.highlightService.shouldProcessFile(o)),n=[];for(let o of t){let l=await this.app.vault.read(o);this.highlightService.extractHighlights(l,o).length>0&&n.push(o)}return n}async updateAllHighlights(){this.currentBatch=0,this.highlights=[],this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator);try{let A=await this.highlightService.getAllHighlights(),t=new Map,n=this.app.vault.getMarkdownFiles();for(let l of n){let c=this.commentStore.getFileComments(l);c&&c.length>0&&t.set(l.path,c)}this.highlights=[];for(let{file:l,highlights:c}of A){let d=t.get(l.path)||[],u=new Set,p=c.map(v=>{let Q=d.find(U=>!u.has(U.id)&&U.id===v.id);if(Q||(Q=d.find(U=>{if(u.has(U.id))return!1;let E=U.text===v.text;return E&&v.position!==void 0&&U.position!==void 0?Math.abs(U.position-v.position)<1e3:E})),!Q&&v.position!==void 0){let U=v.position;Q=d.find(E=>!u.has(E.id)&&E.position!==void 0&&Math.abs(E.position-U)<50)}return Q?(u.add(Q.id),{...v,id:Q.id,comments:Q.comments||[],createdAt:Q.createdAt,updatedAt:Q.updatedAt,fileName:l.basename,filePath:l.path,fileIcon:"file-text"}):{...v,comments:v.comments||[],fileName:l.basename,filePath:l.path,fileIcon:"file-text"}});this.highlights.push(...p),d.filter(v=>v.isVirtual&&v.comments&&v.comments.length>0&&!u.has(v.id)).forEach(v=>{u.add(v.id),this.highlights.push({...v,fileName:l.basename,filePath:l.path,fileIcon:"file-text",position:v.position||0})})}await this.loadMoreHighlights();let o=(0,X.debounce)(async l=>{let c=l.target,{scrollTop:d,scrollHeight:u,clientHeight:p}=c;u-d-p<300&&await this.loadMoreHighlights()},100);this.highlightContainer.addEventListener("scroll",o),this.register(()=>this.highlightContainer.removeEventListener("scroll",o))}catch(A){console.error("[CommentView] Error in updateAllHighlights:",A),new X.Notice(m("Error loading all highlights")),this.highlightContainer.empty(),this.highlightContainer.createEl("div",{cls:"highlight-empty-state",text:m("Error loading highlights. Please try again.")})}finally{this.loadingIndicator.removeClass("highlight-display-block")}}async loadMoreHighlights(){if(!this.isLoading){this.isLoading=!0,this.loadingIndicator.addClass("highlight-display-block");try{let A=this.currentBatch*this.BATCH_SIZE,t=this.highlights.slice(A,A+this.BATCH_SIZE);if(t.length===0){this.loadingIndicator.remove();return}await this.renderHighlights(t,!0),this.currentBatch++}catch(A){new X.Notice("\u52A0\u8F7D\u9AD8\u4EAE\u5185\u5BB9\u65F6\u51FA\u9519")}finally{this.isLoading=!1,this.loadingIndicator.addClass("highlight-display-none")}}}async getFileHighlightsCount(A){let t=await this.app.vault.read(A);return this.highlightService.extractHighlights(t,A).length}async getTotalHighlightsCount(){let A=await this.getFilesWithHighlights(),t=0;for(let n of A)t+=await this.getFileHighlightsCount(n);return t}createFloatingButton(){if(this.floatingButton)return;this.floatingButton=document.createElement("div"),this.floatingButton.className="highlight-floating-button";let A=document.createElement("span");(0,X.setIcon)(A,"bot-message-square"),this.floatingButton.appendChild(A),this.floatingButton.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();try{let n=ze.getInstance(this.app,this.plugin);setTimeout(()=>{n.show()},0)}catch(n){console.error("\u521B\u5EFAChatView\u5931\u8D25:",n)}}),document.body.appendChild(this.floatingButton),this.registerActiveLeafChangeHandler()}removeFloatingButton(){this.floatingButton&&(this.floatingButton.remove(),this.floatingButton=null),this.unregisterActiveLeafChangeHandler()}registerActiveLeafChangeHandler(){this.unregisterActiveLeafChangeHandler(),this.activeLeafChangeHandler=()=>{this.updateFloatingButtonVisibility()},this.app.workspace.on("active-leaf-change",this.activeLeafChangeHandler),this.updateFloatingButtonVisibility()}unregisterActiveLeafChangeHandler(){this.activeLeafChangeHandler&&(this.app.workspace.off("active-leaf-change",this.activeLeafChangeHandler),this.activeLeafChangeHandler=void 0)}updateFloatingButtonVisibility(){if(!this.floatingButton)return;let A=this.app.workspace.activeLeaf;A&&A.view&&A.view.getViewType()===ie?this.floatingButton.style.display="flex":this.floatingButton.style.display="none"}onunload(){this.removeFloatingButton(),this.unregisterActiveLeafChangeHandler()}updateAIDropdowns(){this.aiButtons.forEach(A=>{}),this.app.workspace.trigger("comment-view:update-ai-dropdowns")}registerAIButton(A){this.aiButtons.push(A)}unregisterAIButton(A){let t=this.aiButtons.indexOf(A);t!==-1&&this.aiButtons.splice(t,1)}isInAllHighlightsView(){return this.currentFile===null}filterHighlightsByTerm(A,t=""){if(t==="hicard"){let n=this.plugin.fsrsManager;return n?this.highlights.filter(o=>{var c,d;return(o.id?n.findCardsBySourceId(o.id,"highlight").length>0:!1)?A?!!(o.text.toLowerCase().includes(A)||(c=o.comments)!=null&&c.some(u=>u.content.toLowerCase().includes(A))||this.currentFile===null&&((d=o.fileName)!=null&&d.toLowerCase().includes(A))):!0:!1}):[]}return t==="comment"?this.highlights.filter(n=>{var l;return n.comments&&n.comments.length>0?A?!!(n.text.toLowerCase().includes(A)||n.comments&&n.comments.some(c=>c.content.toLowerCase().includes(A))||this.currentFile===null&&((l=n.fileName)!=null&&l.toLowerCase().includes(A))):!0:!1}):this.highlights.filter(n=>{var o,l;return!!(n.text.toLowerCase().includes(A)||(o=n.comments)!=null&&o.some(c=>c.content.toLowerCase().includes(A))||this.currentFile===null&&((l=n.fileName)!=null&&l.toLowerCase().includes(A)))})}async updateHighlightsList(){let A=this.searchInput.value.toLowerCase().trim(),t=A.startsWith("all:"),n=A.startsWith("hicard:"),o=A.startsWith("comment:"),l="";t?l="all":n?l="hicard":o&&(l="comment");let c=A;if(t?c=A.substring(4).trim():n?c=A.substring(7).trim():o&&(c=A.substring(8).trim()),t&&this.currentFile!==null){this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator);let d=this.currentFile;try{this.currentFile=null,await this.updateAllHighlights(),this.highlights.forEach(p=>{p.isGlobalSearch=!0});let u=this.filterHighlightsByTerm(c,l);this.renderHighlights(u)}finally{this.currentFile=d}}else{this.highlights.forEach(u=>{u.isGlobalSearch=!1});let d=this.filterHighlightsByTerm(c,l);this.renderHighlights(d)}}async refreshView(){this.isInAllHighlightsView()?await this.updateAllHighlights():await this.updateHighlights()}async updateHighlights(){if(this.isInAllHighlightsView()){await this.updateAllHighlights();return}if(!this.currentFile){this.renderHighlights([]);return}if(!this.highlightService.shouldProcessFile(this.currentFile)){this.renderHighlights([]);return}let A=await this.app.vault.read(this.currentFile),t=this.highlightService.extractHighlights(A,this.currentFile),n=this.commentStore.getFileComments(this.currentFile),o=new Set;this.highlights=t.map(c=>{var u;let d=n.find(p=>{if(o.has(p.id))return!1;let B=p.text===c.text;return B&&c.position!==void 0&&p.position!==void 0?Math.abs(p.position-c.position)<1e3:B});if(!d&&c.position!==void 0&&(d=n.find(p=>!o.has(p.id)&&p.position!==void 0&&c.position!==void 0&&Math.abs(p.position-c.position)<50)),!d&&this.plugin.highlightMatchingService){let p={id:c.id||_A.generateHighlightId(((u=this.currentFile)==null?void 0:u.path)||"",c.position||0,c.text),text:c.text,position:c.position||0,comments:[],createdAt:c.createdAt||Date.now(),updatedAt:c.updatedAt||Date.now(),blockId:c.blockId,paragraphId:c.paragraphId,paragraphOffset:c.paragraphOffset||0,isVirtual:!1};if(this.currentFile){let B=this.plugin.highlightMatchingService.findMatchingHighlight(this.currentFile,p);B&&!o.has(B.id)&&(d=B)}}return d?(o.add(d.id),{...c,id:d.id,comments:d.comments,createdAt:d.createdAt,updatedAt:d.updatedAt}):c});let l=n.filter(c=>c.isVirtual&&c.comments&&c.comments.length>0&&!o.has(c.id));if(l.forEach(c=>o.add(c.id)),this.highlights.unshift(...l),this.highlightsWithFlashcards=new Set,this.plugin&&this.plugin.fsrsManager){let c=this.plugin.fsrsManager;for(let d of this.highlights)if(d.id){let u=c.findCardsBySourceId(d.id,"highlight");u&&u.length>0&&this.highlightsWithFlashcards.add(d.id)}}this.searchInput&&this.searchInput.value.trim()!==""?this.updateHighlightsList():this.renderHighlights(this.highlights)}addPagePreview(A,t){let n;A.addEventListener("mouseenter",o=>{n=setTimeout(async()=>{let l=o.target;this.app.workspace.trigger("hover-link",{event:o,source:"hi-note",hoverParent:l,targetEl:l,linktext:t.path})},300)}),A.addEventListener("mouseleave",()=>{n&&clearTimeout(n)})}getPreferredLeaf(){let A=this.app.workspace.getLeavesOfType("markdown");if(this.isDraggedToMainView){let t=A.find(n=>n!==this.leaf);if(t)return t}return this.app.workspace.getLeaf("split","vertical")}};var rn=require("obsidian");var Ur=class{constructor(e){this.data={};this.comments=new Map;this.commentCache=new Map;this.maxCacheSize=100;this.PERFORMANCE_THRESHOLD=100;this.plugin=e,this.eventManager=new Ze(e.app),this.blockIdService=new Ht(e.app),this.highlightService=new oe(e.app)}async loadComments(){let e=await this.plugin.loadData();this.data=(e==null?void 0:e.comments)||{},this.migrateDataToBlockId(),this.comments=new Map(Object.entries(this.data).map(([A,t])=>[A,Object.values(t)]))}migrateDataToBlockId(){let e=0;for(let A in this.data){let t=this.data[A];for(let n in t){let o=t[n];if(o.paragraphId&&!o.blockId){let l=o.paragraphId.match(/#\^([a-zA-Z0-9-]+)/);l&&l[1]&&(o.blockId=l[1],e++)}}}}async saveComments(){let A={...await this.plugin.loadData()||{},comments:this.data};await this.plugin.saveData(A);let t=await this.plugin.loadData()}async checkOrphanedDataCount(){let e=0,A=new Set;for(let t in this.data){let n=this.plugin.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof rn.TFile)){A.add(t),e+=Object.keys(this.data[t]||{}).length;continue}try{let o=await this.plugin.app.vault.read(n),l=this.highlightService.extractHighlights(o,n),c=new Set(l.map(p=>p.text)),d=this.data[t]||{},u=!1;for(let p in d){let B=d[p];B.isVirtual||c.has(B.text)||(e++,u=!0)}u&&A.add(t)}catch(o){}}return{orphanedHighlights:e,affectedFiles:A.size}}async cleanOrphanedData(){let e=0,A=new Set;for(let t in this.data){let n=this.plugin.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof rn.TFile)){delete this.data[t],this.comments.delete(t),A.add(t),e+=Object.keys(this.data[t]||{}).length;continue}try{let o=await this.plugin.app.vault.read(n),l=this.highlightService.extractHighlights(o,n),c=new Set(l.map(p=>p.text)),d=this.data[t]||{},u=!1;for(let p in d){let B=d[p];B.isVirtual||c.has(B.text)||(delete d[p],e++,u=!0)}u&&(A.add(t),this.comments.set(t,Object.values(d)),Object.keys(d).length===0&&(delete this.data[t],this.comments.delete(t)))}catch(o){}}return e>0&&await this.saveComments(),{removedHighlights:e,affectedFiles:A.size}}async updateFilePath(e,A){this.data[e]&&(this.data[A]=this.data[e],delete this.data[e]);let t=this.comments.get(e)||[];this.comments.set(A,t),this.comments.delete(e),await this.saveComments()}getHiNotes(e){let A=this.plugin.app.workspace.getActiveFile();if(!A)return[];let t=this.data[A.path]||{};return Object.values(t).filter(n=>{let o=n.text===e.text;return o&&typeof n.position=="number"&&typeof e.position=="number"?Math.abs(n.position-e.position)<1e3:o})}getFileComments(e){if(!e)return[];let A=this.data[e.path]||{};return Object.values(A)}async addComment(e,A){A.id||(A.id=_A.generateHighlightId(e.path,A.position||0,A.text));let t=Date.now();A.createdAt||(A.createdAt=t),A.updatedAt=t;let n=e.path;this.data[n]||(this.data[n]={}),this.data[n][A.id]=A,this.comments.has(n)||this.comments.set(n,[]);let o=this.comments.get(n)||[],l=o.findIndex(c=>c.id===A.id);if(l>=0?o[l]=A:o.push(A),await this.saveComments(),this.eventManager)if(A.comments&&A.comments.length>0){let c=A.comments[A.comments.length-1];this.eventManager.emitCommentUpdate(n,A.text,c.content,A.id)}else this.eventManager.emitHighlightUpdate(n,A.text,A.text,A.id);return A}async removeComment(e,A){let t=e.path;if(!this.data[t]||!this.data[t][A.id])return!1;if(delete this.data[t][A.id],Object.keys(this.data[t]).length===0&&delete this.data[t],this.comments.has(t)){let o=(this.comments.get(t)||[]).filter(l=>l.id!==A.id);o.length>0?this.comments.set(t,o):this.comments.delete(t)}if(await this.saveComments(),this.eventManager)if(A.comments&&A.comments.length>0){let n=A.comments[A.comments.length-1];this.eventManager.emitCommentDelete(t,n.content,A.id)}else this.eventManager.emitHighlightDelete(t,A.text,A.id);return!0}getCommentsByBlockId(e,A){if(!e||!A)return[];let t=e.path;return this.data[t]?Object.values(this.data[t]).filter(o=>o.blockId===A):[]}};var je=require("@codemirror/view"),sn=require("obsidian");var yo=require("@codemirror/view"),bt=require("obsidian");var Sr=class F extends yo.WidgetType{constructor(A,t,n,o){super();this.plugin=A;this.highlight=t;this.highlightItems=n;this.onClick=o;this.app=this.plugin.app,this.textSimilarityService=new we(this.plugin.app)}eq(A){return!(A instanceof F)||this.highlight.id!==A.highlight.id?!1:(this.textSimilarityService.calculateSimilarity(this.highlight.text,A.highlight.text)>.7||this.highlight.text===A.highlight.text)&&this.highlight.comments.length===A.highlight.comments.length}get estimatedHeight(){return 0}get lineBreaks(){return 0}toDOM(){let A=document.createElement("span");A.addClass("hi-note-widget"),A.setAttribute("data-highlight-id",this.highlight.id);let t=(this.highlight.comments||[]).length>0;return this.createButton(A),A}createButton(A){let t=(this.highlight.comments||[]).length>0,n=A.createEl("button",{cls:`hi-note-button clickable-icon ${t?"":"hi-note-button-hidden"}`}),o=this.createIconContainer(n),l=this.createTooltip(A);this.setupEventListeners(A,n,l)}createIconContainer(A){let t=A.createEl("span",{cls:"hi-note-icon-container"});(0,bt.setIcon)(t,"message-circle");let o=(this.highlight.comments||[]).length;return o>0&&t.createEl("span",{cls:"hi-note-count",text:o.toString()}),t}createTooltip(A){let t=document.createElement("div");t.addClass("hi-note-tooltip","hi-note-tooltip-hidden"),t.setAttribute("data-highlight-id",this.highlight.id);let n=t.createEl("div",{cls:"hi-note-tooltip-list"}),o=this.highlight.comments||[];return this.renderTooltipContent(n,o,t),document.body.appendChild(t),{tooltip:t,updateTooltipPosition:()=>{let c=A.getBoundingClientRect();t.style.position="fixed",t.style.top=`${c.bottom+4}px`,t.style.left=`${c.right-t.offsetWidth}px`}}}renderTooltipContent(A,t,n){t.length!==0&&(t.slice(0,3).forEach(o=>{let l=A.createEl("div",{cls:"hi-note-tooltip-item"}),c=l.createEl("div",{cls:"hi-note-tooltip-content markdown-rendered"});this.renderMarkdownContent(c,o.content),l.createEl("div",{cls:"hi-note-tooltip-time",text:new Date(o.createdAt).toLocaleString()})}),t.length>3&&n.createEl("div",{cls:"hi-note-tooltip-more",text:`\u8FD8\u6709 ${t.length-3} \u6761\u8BC4\u8BBA...`}))}setupEventListeners(A,t,n){let{tooltip:o,updateTooltipPosition:l}=n;(this.highlight.comments||[]).length>0?(t.removeClass("hi-note-button-hidden"),t.addEventListener("mouseenter",()=>{o.removeClass("hi-note-tooltip-hidden"),l()}),t.addEventListener("mouseleave",()=>{o.addClass("hi-note-tooltip-hidden")})):(t.addClass("hi-note-button-hidden"),A.addEventListener("mouseenter",()=>{t.removeClass("hi-note-button-hidden")}),A.addEventListener("mouseleave",()=>{t.addClass("hi-note-button-hidden")})),t.addEventListener("click",u=>{u.preventDefault(),u.stopPropagation(),this.onClick(),o.addClass("hi-note-tooltip-hidden");let p=new CustomEvent("open-comment-input",{detail:{highlightId:this.highlight.id,text:this.highlight.text}});window.dispatchEvent(p)}),window.addEventListener("resize",l)}async renderMarkdownContent(A,t){try{await bt.MarkdownRenderer.render(this.app,t,A,"",new bt.Component),A.querySelectorAll("ul, ol").forEach(o=>{o.addClass("tooltip-markdown-list")})}catch(n){console.error("Error rendering markdown in tooltip:",n),A.textContent=t}}destroy(A){let t=document.querySelector(`.hi-note-tooltip[data-highlight-id="${this.highlight.id}"]`);t&&t.remove(),A.remove()}updateDOM(A){return!1}ignoreEvent(){return!1}};var Ir=class{constructor(e,A){this.plugin=e,this.commentStore=A,this.highlightService=new oe(this.plugin.app),this.textSimilarityService=new we(this.plugin.app)}findMatchingHighlight(e,A,t){if(!t||t.length===0)return null;let n=t.find(o=>o.text===A.text&&(typeof o.position!="number"||typeof A.position!="number"||Math.abs(o.position-A.position)<10))||null;if(!n&&typeof A.position=="number"&&(n=t.find(o=>typeof o.position=="number"&&Math.abs(o.position-A.position)<30)||null),!n){let o=null,l=0;for(let c of t){if(!c.comments||c.comments.length===0)continue;let d=this.textSimilarityService.calculateSimilarity(c.text,A.text);d>l&&d>.6&&(l=d,o=c)}o&&(n=o)}return n}getActiveMarkdownView(){return this.plugin.app.workspace.getActiveViewOfType(sn.MarkdownView)}enable(){let e=this.plugin,A=this.commentStore,t=this.highlightService,n=this.textSimilarityService,o=this.findMatchingHighlight.bind(this);this.plugin.registerDomEvent(window,"comment-updated",c=>{let d=document.querySelectorAll(".hi-note-widget"),u=c.detail.text,p=this.getActiveMarkdownView();if(!p||!p.file)return;let B=this.commentStore.getFileComments(p.file);B&&d.forEach(v=>{let Q=v.getAttribute("data-highlight-text");if(Q===u){let U=B.find(x=>x.text===Q),E=(U==null?void 0:U.comments)||[],H=v.querySelector(".hi-note-count");if(H){let x=E.length;H.textContent=x.toString();let D=v.querySelector(".hi-note-button");x===0?D==null||D.addClass("hi-note-button-hidden"):D==null||D.removeClass("hi-note-button-hidden")}let M=v.querySelector(".hi-note-tooltip");M&&this.updateTooltipContent(M,E)}})});let l=je.ViewPlugin.fromClass(class{constructor(c){this.plugin=e,this.commentStore=A,this.highlightService=new oe(this.plugin.app),this.textSimilarityService=new we(this.plugin.app),this.decorations=this.buildDecorations(c)}createHiNoteFromHighlight(c){return{...c,id:c.id||`highlight-${Date.now()}-${c.position}`,comments:c.comments||[],position:c.position,paragraphOffset:c.paragraphOffset||0,blockId:c.blockId,paragraphId:c.paragraphId||`p-${c.paragraphOffset||0}`,createdAt:c.createdAt||Date.now(),updatedAt:c.updatedAt||Date.now(),text:c.text}}findExactMatchingHighlight(c,d){return d.find(u=>u.text===c.text&&(typeof u.position!="number"||typeof c.position!="number"||Math.abs(u.position-c.position)<10))||null}handleTextChanges(c,d,u){d.text!==u.text&&e.highlightMatchingService.recoverHighlight(c,d,u.text).then(p=>{p&&e.eventManager.emitHighlightUpdate(c.path,d.text,u.text)})}getCommentsForHighlight(c,d,u=!0){let p=[];if(d.blockId){let B=A.getCommentsByBlockId(c,d.blockId);if(B&&B.length>0){let v=B.find(Q=>Q.text===d.text);if(v)p=v.comments||[];else{let Q=this.findExactMatchingHighlight(d,B);if(Q)p=Q.comments||[];else if(u){let U=o(c,d,B);U&&(this.handleTextChanges(c,U,d),p=U.comments||[])}}}}else{let B=A.getHiNotes(d);if(B&&B.length>0){let v=B.find(Q=>Q.text===d.text);if(v)p=v.comments||[];else{let Q=this.findExactMatchingHighlight(d,B);if(Q)p=Q.comments||[];else if(u){let U=o(c,d,B);U&&(this.handleTextChanges(c,U,d),p=U.comments||[])}}}}return p}calculateHighlightPosition(c,d){var Q;let u=(Q=d.originalLength)!=null?Q:d.text.length+4,p=c.slice(d.position,d.position+u),B=p.startsWith("<"),v;if(B){let U=/<[^>]+>/.exec(p),E=/<\/[^>]+>/.exec(p);v=d.position+u}else v=d.position+d.text.length+4;return{highlightEndPos:v,isHtmlTag:B,originalText:p,originalLength:u}}findMatchingHighlight(c,d,u){if(!u||u.length===0)return null;let p=u.find(B=>B.text===d.text&&(typeof B.position!="number"||typeof d.position!="number"||Math.abs(B.position-d.position)<10))||null;if(!p&&typeof d.position=="number"&&(p=u.find(B=>typeof B.position=="number"&&Math.abs(B.position-d.position)<30)||null),!p){let B=null,v=0;for(let Q of u){if(!Q.comments||Q.comments.length===0)continue;let U=this.textSimilarityService.calculateSimilarity(Q.text,d.text);U>v&&U>.6&&(v=U,B=Q)}B&&(p=B)}return p}update(c){(c.docChanged||c.viewportChanged)&&(this.decorations=this.buildDecorations(c.view))}buildDecorations(c){var Q,U;let d=[],p=c.state.doc.toString(),B=this.plugin.app.workspace.getActiveViewOfType(sn.MarkdownView);if(!B||!B.file)return je.Decoration.none;if(!this.highlightService.shouldProcessFile(B.file))return je.Decoration.none;let v=this.highlightService.extractHighlights(p,B.file);for(let E of v){if(E.position===void 0)continue;let H=this.createHiNoteFromHighlight(E);if(B.file){let j=this.getCommentsForHighlight(B.file,H,!0);H.comments=j}let{highlightEndPos:M,isHtmlTag:x,originalText:D,originalLength:N}=this.calculateHighlightPosition(p,E),O=this.isAtParagraphEnd(p,M),J=this.createCommentWidget(H,[H]);if(d.push(J.range(M)),x){let j=/<[^>]+>/.exec(D),FA=/<\/[^>]+>/.exec(D);if(j&&FA){let wA=E.position+j[0].length,DA=E.position+N-FA[0].length,aA=B.file?this.getCommentsForHighlight(B.file,H,!1):[],tA=aA.length>0?(Q=aA[0])==null?void 0:Q.content:"",xA=je.Decoration.mark({class:"cm-highlight",attributes:{title:tA||"","data-highlight-type":"html",style:E.backgroundColor?`background-color: ${E.backgroundColor}`:""}});d.push(xA.range(wA,DA))}}else{let FA=E.position+E.text.length+4,wA=B.file?this.getCommentsForHighlight(B.file,H,!1):[],DA=wA.length>0?(U=wA[0])==null?void 0:U.content:""}}return je.Decoration.set(d.sort((E,H)=>E.from-H.from))}createCommentWidget(c,d){return je.Decoration.widget({widget:new Sr(this.plugin,c,d,()=>this.openCommentPanel(c)),side:2,stopEvent:u=>!0})}openCommentPanel(c){let d=this.plugin.app.workspace,u=d.getLeavesOfType("comment-view");if(u.length)d.revealLeaf(u[0]);else{let p=d.getRightLeaf(!1);p&&p.setViewState({type:"comment-view",active:!0})}}isAtParagraphEnd(c,d){if(d>=c.length)return!0;let u=c.charAt(d),p=c.substr(d,2),B=u===`
`||u==="\r"||p===`\r
`,v=B;if(B){let Q=d+(p===`\r
`?2:1);if(Q>=c.length)v=!0;else{let U=c.charAt(Q),E=c.substr(Q,2);v=U===`
`||U==="\r"||E===`\r
`}}return v}},{decorations:c=>c.decorations});this.highlightPlugin=l,this.plugin.registerEditorExtension([l])}disable(){if(this.highlightPlugin){let e=this.getActiveMarkdownView();e!=null&&e.editor&&e.editor.refresh()}document.querySelectorAll(".hi-note-widget").forEach(e=>e.remove())}updateTooltipContent(e,A){let t=e.querySelector(".hi-note-tooltip-list");t&&(t.empty(),A.slice(0,3).forEach(n=>{let o=t.createEl("div",{cls:"hi-note-tooltip-item"});o.createEl("div",{cls:"hi-note-tooltip-content",text:n.content}),o.createEl("div",{cls:"hi-note-tooltip-time",text:new Date(n.createdAt).toLocaleString()})}))}};var So=require("obsidian");var le=require("obsidian");var At=require("obsidian");var Hr=class{constructor(e,A){this.containerEl=e,this.plugin=A,this.rules=A.settings.regexRules||[],this.rulesContainer=e.createDiv({cls:"regex-rules-container"}),this.display()}display(){this.rulesContainer.empty();let e=this.rulesContainer.createDiv({cls:"regex-rule-warning"});e.innerHTML=m("Use regex with caution. If there are capture groups (), the first capture group will be used as the highlight text; if there are no capture groups, the entire match will be used."),this.rules.length===0?this.rulesContainer.createDiv().setText(m('No custom regex rules. Click "+" to add a new rule.')):this.rules.forEach((n,o)=>{this.createRuleItem(n,o)});let A=this.rulesContainer.createDiv({cls:"regex-rule-add"});A.createSpan({cls:"regex-rule-add-text"}).setText(m("Add new rule")),A.addEventListener("click",()=>{let n={id:`rule-${Date.now()}`,name:"",pattern:"",color:"#ffeb3b",enabled:!0};this.rules.push(n),this.saveRules(),this.display()})}createRuleItem(e,A){let t=this.rulesContainer.createDiv({cls:"regex-rule-item"}),n=new At.TextComponent(t);n.setPlaceholder(m("Rule name")),n.setValue(e.name),n.onChange(p=>{e.name=p,this.saveRules()});let o=new At.TextComponent(t);o.setPlaceholder(m("Regular expression with capture groups")),o.setValue(e.pattern),o.onChange(p=>{e.pattern=p,this.saveRules()});let l=t.createDiv(),c=new At.TextComponent(l);c.setPlaceholder("#ffeb3b"),c.setValue(e.color),c.inputEl.addClass("color-input"),c.onChange(p=>{let B=p.trim();B&&(B.startsWith("#")||B.startsWith("rgb")||B.startsWith("rgba"))&&(e.color=B,this.saveRules())});let d=t.createDiv({cls:"regex-rule-delete"});(0,At.setIcon)(d,"trash-2"),d.setAttr("aria-label",m("Delete rule")),d.addEventListener("click",()=>{this.rules.splice(A,1),this.saveRules(),this.display()});let u=new At.ToggleComponent(t);u.setValue(e.enabled),u.onChange(p=>{e.enabled=p,this.saveRules()}),u.toggleEl.addClass("regex-rule-toggle")}async saveRules(){this.plugin.settings.regexRules=this.rules,await this.plugin.saveSettings()}};var br=class{constructor(e,A){this.plugin=e,this.containerEl=A}async updateOrphanedDataCount(e){try{let A=e.querySelector(".orphaned-data-count, .no-orphaned-data");A&&A.remove();let t=await this.plugin.commentStore.checkOrphanedDataCount(),n=document.createElement("div");t.orphanedHighlights>0?(n.className="orphaned-data-count",n.textContent=`Found ${t.orphanedHighlights} orphaned highlights in ${t.affectedFiles} files.`):(n.className="no-orphaned-data",n.textContent="No orphaned data found."),e.appendChild(n)}catch(A){console.error("[HiNote] Error updating orphaned data count:",A)}}display(){let e=this.containerEl.createEl("div",{cls:"general-settings-container"});new le.Setting(e).setName(m("Export Path")).setDesc(m("Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.")).addText(d=>d.setPlaceholder("Example: folder 1/folder 2").setValue(this.plugin.settings.export.exportPath||"").onChange(async u=>{u=u.replace(/^\/+/,""),u=u.replace(/\/+$/,""),this.plugin.settings.export.exportPath=u,await this.plugin.saveSettings()})),new le.Setting(e).setName(m("Export template")).setDesc(m("Customize the format of exported highlights and comments using variables. Available variables: {{highlightText}}, {{highlightBlockRef}}, {{commentContent}}, {{commentDate}}. Leave empty to use default template.")).addTextArea(d=>{d.setPlaceholder(`> [!quote] HiNote
> {{highlightText}}
> 
>> [!note] Comment
>> {{commentContent}}
>> *{{commentDate}}*`).setValue(this.plugin.settings.export.exportTemplate||"").onChange(async p=>{this.plugin.settings.export.exportTemplate=p,await this.plugin.saveSettings()}),d.inputEl.rows=6,d.inputEl.cols=40}),new le.Setting(e).setName(m("Exclusions")).setDesc(m("Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md")).addTextArea(d=>{d.setPlaceholder("folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md").setValue(this.plugin.settings.excludePatterns||"").onChange(async u=>{let p=u.split(",").map(B=>B.trim()).filter(B=>B.length>0);this.plugin.settings.excludePatterns=u,await this.plugin.saveSettings()}),d.inputEl.rows=4,d.inputEl.cols=40}),new le.Setting(e).setName(m("Custom text extraction")).setHeading(),new le.Setting(e).setName(m("Use custom rules")).setDesc(m("Enable to use custom regex rules to extract highlight text.")).addToggle(d=>d.setValue(this.plugin.settings.useCustomPattern).onChange(async u=>{this.plugin.settings.useCustomPattern=u,await this.plugin.saveSettings()}));let A=e.createDiv({cls:"regex-editor-container"});new Hr(A,this.plugin),new le.Setting(e).setName(m("Data management")).setHeading();let t=new le.Setting(e).setName(m("Clean orphaned data")).setDesc(m("Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.")),n=0,o=0,l=!1,c=t.addButton(d=>{d.setButtonText(m("Check")),d.onClick(async()=>{d.setButtonText(m("Checking...")),d.setDisabled(!0);try{let u=await this.plugin.commentStore.checkOrphanedDataCount();n=u.orphanedHighlights,o=u.affectedFiles,l=!0;let p=t.descEl,B=p.querySelector(".orphaned-data-count, .no-orphaned-data");B&&B.remove();let v=document.createElement("div");n>0?(v.className="orphaned-data-count",v.textContent=`Found ${n} orphaned highlights in ${o} files.`,d.setButtonText(m("Clean data")),d.setDisabled(!1),d.onClick(async()=>{d.setButtonText(m("Cleaning...")),d.setDisabled(!0);try{let Q=await this.plugin.commentStore.cleanOrphanedData();Q.removedHighlights>0?new le.Notice(`Cleaned ${Q.removedHighlights} orphaned highlights from ${Q.affectedFiles} files.`):new le.Notice("No orphaned data found."),d.setButtonText(m("Check")),l=!1,v&&v.parentElement&&v.parentElement.removeChild(v)}catch(Q){console.error("[HiNote] Error cleaning orphaned data:",Q),new le.Notice("Error cleaning orphaned data. Check console for details."),d.setButtonText(m("Check"))}finally{d.setDisabled(!1)}})):(v.className="no-orphaned-data",v.textContent="No orphaned data found.",d.setButtonText(m("Check")),d.setDisabled(!1)),p.appendChild(v)}catch(u){console.error("[HiNote] Error checking orphaned data:",u),new le.Notice("Error checking orphaned data. Check console for details."),d.setButtonText(m("Check")),d.setDisabled(!1)}})})}};var Uo=require("obsidian");var OA=require("obsidian");var Eo=require("obsidian");var re=class{constructor(e,A){this.plugin=e,this.containerEl=A}createModelDropdown(e,A,t){new Eo.Setting(e).setName(m("Model")).setDesc(m("Select the AI model to use")).addDropdown(n=>{let o=Object.fromEntries(A.map(l=>[l.id,l.name]));return n.addOptions(o).setValue(this.plugin.settings.ai.model||t.id).onChange(async l=>{this.plugin.settings.ai.model=l,await this.plugin.saveSettings()})})}};var di=[{id:"gpt-4",name:"GPT-4"},{id:"gpt-4-turbo",name:"GPT-4 Turbo"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo"}],xr=class extends re{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={apiKey:"",model:di[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.openai,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let n=di.find(o=>o.id===A.model);t=n||di[0],n||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={});let A=this.plugin.settings.ai.openai,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new OA.Setting(t).setName(m("OpenAI Settings")).setHeading(),new OA.Setting(t).setName(m("API Key")).setDesc(m("Enter your OpenAI API Key.")).addText(u=>u.setPlaceholder("sk-...").setValue(this.modelState.apiKey).onChange(async p=>{this.modelState.apiKey=p,await this.saveModelState()})).addButton(u=>u.setButtonText(m("Check")).onClick(async()=>{if(!this.modelState.apiKey){new OA.Notice(m("Please enter an API Key first"));return}u.setDisabled(!0),u.setButtonText(m("Checking..."));try{(await this.fetchAvailableModels(this.modelState.apiKey)).length>0?new OA.Notice(m("API Key validated successfully!")):new OA.Notice(m("No models available. Please check your API Key."))}catch(p){new OA.Notice(m("Failed to validate API Key. Please check your key and try again."))}finally{u.setDisabled(!1),u.setButtonText(m("Check"))}}));let n=new OA.Setting(t).setName(m("Model")).setDesc(m("Select a model or use a custom one")).addDropdown(u=>{di.forEach(B=>{u.addOption(B.id,B.name)}),u.addOption("custom",m("Custom Model"));let p=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return u.setValue(p),this.modelSelectEl=u.selectEl,u.onChange(async B=>{if(B==="custom")await this.showCustomModelInput();else{let v=di.find(Q=>Q.id===B);if(v){if(this.modelState.selectedModel.isCustom){let Q=this.plugin.settings.ai.openai;Q.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),u});this.customModelContainer=n.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=n.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new OA.Setting(this.customModelContainer).addText(u=>u.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async p=>{let B=p.trim();if(B){if(!/^[a-zA-Z0-9-_.]+$/.test(B)){new OA.Notice(m("\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u548C\u77ED\u6760")),u.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:B,name:B,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new OA.Setting(t).setName(m("Custom API Address")).setDesc(m("If using a custom API proxy, please enter the full API address")).addText(u=>{var p;return u.setPlaceholder("https://api.openai.com/v1").setValue(((p=this.plugin.settings.ai.openai)==null?void 0:p.apiAddress)||"").onChange(async B=>{this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={}),this.plugin.settings.ai.openai.apiAddress=B,await this.plugin.saveSettings()})})}async validateModel(A,t,n){try{let o=await(0,OA.requestUrl)({url:`${n}/models/${t}`,method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(o.status!==200){let c=await o.json.catch(()=>null);return new OA.Notice(m("\u81EA\u5B9A\u4E49\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u8BF7\u68C0\u67E5\u6A21\u578B ID \u662F\u5426\u6B63\u786E\uFF0C\u4EE5\u53CA\u4F60\u662F\u5426\u6709\u6743\u9650\u8BBF\u95EE\u6B64\u6A21\u578B\u3002")),!1}let l=await(0,OA.requestUrl)({url:`${n}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:[{role:"user",content:"Hello"}],max_tokens:1})});if(l.status!==200){let c=await l.json.catch(()=>null);return!1}return!0}catch(o){return!1}}async fetchAvailableModels(A){var t;try{let n=((t=this.plugin.settings.ai.openai)==null?void 0:t.apiAddress)||"https://api.openai.com/v1";if(this.modelState.selectedModel.isCustom){let l=this.modelState.selectedModel.id;if(!await this.validateModel(A,l,n))throw new Error(`Custom model not available: ${l}`);return[this.modelState.selectedModel]}let o=await(0,OA.requestUrl)({url:`${n}/models`,method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});return o.status===200?o.json.data.map(d=>({id:d.id,name:d.id})):[]}catch(n){throw n}}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.openai;if(!this.modelState.selectedModel.isCustom){let n=A.lastCustomModel||"";this.modelState.selectedModel={id:n,name:n,isCustom:!0},A.model=n,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=n)}}}async hideCustomModelInput(){this.customModelContainer&&this.customModelContainer.removeClass("visible")}};var pe=require("obsidian");var gi=[{id:"claude-3-opus-20240229",name:"Claude 3 Opus"},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet"},{id:"claude-3-haiku-20240307",name:"Claude 3 Haiku"},{id:"claude-2",name:"Claude 2"},{id:"claude-instant-1",name:"Claude Instant"}],Mr=class extends re{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={apiKey:"",model:gi[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.anthropic,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let n=gi.find(o=>o.id===A.model);t=n||gi[0],n||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={});let A=this.plugin.settings.ai.anthropic,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new pe.Setting(t).setName(m("Anthropic Settings")).setHeading(),new pe.Setting(t).setName(m("API Key")).setDesc(m("Enter your Anthropic API Key.")).addText(u=>u.setPlaceholder("sk-ant-...").setValue(this.modelState.apiKey).onChange(async p=>{this.modelState.apiKey=p,await this.saveModelState()})).addButton(u=>u.setButtonText(m("Check")).onClick(async()=>{var p;try{let B=this.modelState.apiKey;if(!B){new pe.Notice(m("Please enter an API Key first"));return}u.setDisabled(!0),u.setButtonText(m("Checking..."));let v=((p=this.plugin.settings.ai.anthropic)==null?void 0:p.apiAddress)||"https://api.anthropic.com",Q=this.modelState.selectedModel.id;await new St(B,v,Q).testConnection()?new pe.Notice(m("API Key is valid!")):new pe.Notice(m("Failed to validate API Key. Please check your key and try again."))}catch(B){console.error("Anthropic API validation error:",B),new pe.Notice(m("Failed to validate API Key. Please check your key and try again."))}finally{u.setDisabled(!1),u.setButtonText(m("Check"))}}));let n=new pe.Setting(t).setName(m("Model")).setDesc(m("Select a model or use a custom one")).addDropdown(u=>{gi.forEach(B=>{u.addOption(B.id,B.name)}),u.addOption("custom",m("Custom Model"));let p=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return u.setValue(p),this.modelSelectEl=u.selectEl,u.onChange(async B=>{if(B==="custom")await this.showCustomModelInput();else{let v=gi.find(Q=>Q.id===B);if(v){if(this.modelState.selectedModel.isCustom){let Q=this.plugin.settings.ai.anthropic;Q.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),u});this.customModelContainer=n.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=n.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new pe.Setting(this.customModelContainer).addText(u=>u.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async p=>{let B=p.trim();if(B){if(!/^[a-zA-Z0-9-_.]+$/.test(B)){new pe.Notice(m("Model ID can only contain letters, numbers, underscores, dots and hyphens")),u.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:B,name:B,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new pe.Setting(t).setName(m("Custom API Address")).setDesc(m("If using a custom API proxy, please enter the full API address")).addText(u=>{var p;return u.setPlaceholder("https://api.anthropic.com").setValue(((p=this.plugin.settings.ai.anthropic)==null?void 0:p.apiAddress)||"").onChange(async B=>{this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={}),this.plugin.settings.ai.anthropic.apiAddress=B,await this.plugin.saveSettings()})})}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.anthropic;if(!this.modelState.selectedModel.isCustom){let n=A.lastCustomModel||"";this.modelState.selectedModel={id:n,name:n,isCustom:!0},A.model=n,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=n)}}}async hideCustomModelInput(){this.customModelContainer&&this.customModelContainer.removeClass("visible")}};var XA=require("obsidian");var Lr=class extends re{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={apiKey:"",model:yt[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.deepseek,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let n=yt.find(o=>o.id===A.model);t=n||yt[0],n||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={});let A=this.plugin.settings.ai.deepseek,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",A.apiAddress=A.apiAddress||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let n="https://api.deepseek.com",o=(t=this.plugin.settings.ai.deepseek)==null?void 0:t.apiAddress,l=o&&o.trim()?o:n,c=this.modelState.selectedModel.id,d=`${l}/models/${c}`,u=await(0,XA.requestUrl)({url:d,headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(!u.status||u.status<200||u.status>=300){if(this.modelState.selectedModel.isCustom)return new XA.Notice(m("\u81EA\u5B9A\u4E49\u6A21\u578B\u4E0D\u53EF\u7528\uFF0C\u8BF7\u68C0\u67E5\u6A21\u578B ID \u548C API \u5730\u5740")),!1;if(c!=="deepseek-chat"){let v=`${l}/models/deepseek-chat`,Q=await(0,XA.requestUrl)({url:v,headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(Q.status&&Q.status>=200&&Q.status<300)return new XA.Notice(m("\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\u4E0D\u53EF\u7528\uFF0C\u4F46 API Key \u662F\u6709\u6548\u7684")),!1}return new XA.Notice(m("Failed to validate API Key. Please check your key and try again.")),!1}let p=u.json,B=!!(p&&p.id);return B&&new XA.Notice(m("API Key and the current model are both available!")),B}catch(n){return new XA.Notice(m("Failed to validate API Key. Please check your key and try again.")),!1}}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new XA.Setting(t).setName(m("Deepseek Settings")).setHeading(),new XA.Setting(t).setName(m("API Key")).setDesc(m("Enter your Deepseek API Key")).addText(l=>l.setPlaceholder("dsk-...").setValue(this.modelState.apiKey).onChange(async c=>{this.modelState.apiKey=c,await this.saveModelState()})).addButton(l=>l.setButtonText(m("Check")).onClick(async()=>{if(!this.modelState.apiKey){new XA.Notice(m("Please enter an API Key first"));return}l.setDisabled(!0),l.setButtonText(m("Checking..."));try{await this.validateApiKey(this.modelState.apiKey)}finally{l.setDisabled(!1),l.setButtonText(m("Check"))}}));let n=new XA.Setting(t).setName(m("Model")).setDesc(m("Select a model or use a custom one")).addDropdown(l=>{yt.forEach(d=>{l.addOption(d.id,d.name)}),l.addOption("custom",m("Custom Model"));let c=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return l.setValue(c),this.modelSelectEl=l.selectEl,l.onChange(async d=>{if(d==="custom")await this.showCustomModelInput();else{let u=yt.find(p=>p.id===d);if(u){if(this.modelState.selectedModel.isCustom){let p=this.plugin.settings.ai.deepseek;p.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=u,await this.saveModelState(),await this.hideCustomModelInput()}}}),l});this.customModelContainer=n.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=n.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild)),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new XA.Setting(t).setName(m("Custom API Address")).setDesc(m("If using a custom API proxy, enter the full API address")).addText(l=>{var c;return l.setPlaceholder("https://api.deepseek.com/v1").setValue(((c=this.plugin.settings.ai.deepseek)==null?void 0:c.apiAddress)||"").onChange(async d=>{this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={}),this.plugin.settings.ai.deepseek.apiAddress=d,await this.plugin.saveSettings()})})}async showCustomModelInput(){if(!this.customModelContainer)return;this.customModelContainer.addClass("visible"),this.customModelContainer.empty();let A=document.createElement("input");A.type="text",A.className="custom-model-input",A.placeholder="model-id",A.value=this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"",A.addEventListener("input",async()=>{let t=A.value.trim();if(t){if(!/^[a-zA-Z0-9-_.]+$/.test(t)){new XA.Notice(m("\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u548C\u77ED\u6760")),A.value=this.modelState.selectedModel.id;return}this.modelState.selectedModel={id:t,name:t,isCustom:!0},await this.saveModelState()}}),this.customModelContainer.appendChild(A)}hideCustomModelInput(){this.customModelContainer&&(this.customModelContainer.removeClass("visible"),this.customModelContainer.empty())}};var bA=require("obsidian");var Tr=class extends re{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={apiKey:"",model:$e[0].id,baseUrl:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.gemini,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let n=$e.find(o=>o.id===A.model);t=n||$e[0],n||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={});let A=this.plugin.settings.ai.gemini,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",A.baseUrl=A.baseUrl||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let n="https://generativelanguage.googleapis.com",o=(t=this.plugin.settings.ai.gemini)==null?void 0:t.baseUrl,l=o&&o.trim()?o:n,c=this.modelState.selectedModel.id,d=`${l}/v1/models/${c}?key=${A}`,u=await(0,bA.requestUrl)({url:d});if(!u.status||u.status<200||u.status>=300){let v=u.json||null;if(c.includes("-exp-")){let U=`${l}/v1/models/gemini-pro?key=${A}`,E=await(0,bA.requestUrl)({url:U});throw E.status&&E.status>=200&&E.status<300?(new bA.Notice(m("API Key \u6709\u6548\uFF0C\u4F46\u65E0\u6CD5\u8BBF\u95EE\u5B9E\u9A8C\u6027\u6A21\u578B\u3002\u8BF7\u786E\u4FDD\u4F60\u6709\u6743\u9650\u8BBF\u95EE\u6B64\u6A21\u578B\uFF0C\u6216\u7B49\u5F85\u6A21\u578B\u6B63\u5F0F\u53D1\u5E03\u3002")),new Error(`Experimental model not accessible: ${c}`)):(new bA.Notice(m("API Key \u65E0\u6548\u3002\u8BF7\u68C0\u67E5\u4F60\u7684 API Key \u662F\u5426\u6B63\u786E\u3002")),new Error("Invalid API Key"))}if(this.modelState.selectedModel.isCustom)throw new bA.Notice(m("\u81EA\u5B9A\u4E49\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u8BF7\u68C0\u67E5\u6A21\u578B ID \u662F\u5426\u6B63\u786E\uFF0C\u4EE5\u53CA\u4F60\u662F\u5426\u6709\u6743\u9650\u8BBF\u95EE\u6B64\u6A21\u578B\u3002")),new Error(`Custom model not available: ${c}`);if(c!=="gemini-pro"){let U=`${l}/v1/models/gemini-pro?key=${A}`,E=await(0,bA.requestUrl)({url:U});if(E.status&&E.status>=200&&E.status<300)throw new bA.Notice(m("API Key \u6709\u6548\uFF0C\u4F46\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u53EF\u80FD\u662F\u6A21\u578B\u672A\u53D1\u5E03\u6216\u4F60\u6CA1\u6709\u8BBF\u95EE\u6743\u9650\u3002")),new Error(`Selected model not available: ${c}`)}throw new bA.Notice(m("API Key is invalid or there is a server error. Please check if your API Key is correct.")),new Error(`HTTP error! status: ${u.status}`)}let p=await u.json(),B=!!(p&&p.name);return B&&new bA.Notice(m("API Key and the current model are both available\uFF01")),B}catch(n){return!1}}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new bA.Setting(t).setName(m("Gemini Settings")).setHeading(),new bA.Setting(t).setName(m("API Key")).setDesc(m("Enter your Gemini API Key")).addText(u=>u.setPlaceholder("Enter your API key").setValue(this.modelState.apiKey).onChange(async p=>{this.modelState.apiKey=p,await this.saveModelState()})).addButton(u=>u.setButtonText(m("Check")).onClick(async()=>{if(!this.modelState.apiKey){new bA.Notice(m("Please enter an API Key first"));return}u.setDisabled(!0),u.setButtonText(m("Checking..."));try{await this.validateApiKey(this.modelState.apiKey)}finally{u.setDisabled(!1),u.setButtonText(m("Check"))}}));let n=new bA.Setting(t).setName(m("Model")).setDesc(m("Select a model or use a custom one")).addDropdown(u=>{$e.forEach(B=>{u.addOption(B.id,B.name)}),u.addOption("custom",m("Custom Model"));let p=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return u.setValue(p),this.modelSelectEl=u.selectEl,u.onChange(async B=>{if(B==="custom")await this.showCustomModelInput();else{let v=$e.find(Q=>Q.id===B);if(v){if(this.modelState.selectedModel.isCustom){let Q=this.plugin.settings.ai.gemini;Q.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),u});this.customModelContainer=n.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=n.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new bA.Setting(this.customModelContainer).addText(u=>u.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async p=>{let B=p.trim();if(B){if(!/^[a-zA-Z0-9-_.]+$/.test(B)){new bA.Notice(m("\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u548C\u77ED\u6760")),u.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:B,name:B,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new bA.Setting(t).setName(m("Custom API Address")).setDesc(m("Enter your custom API endpoint")).addText(u=>{var v;let p="https://generativelanguage.googleapis.com",B=(v=this.plugin.settings.ai.gemini)==null?void 0:v.baseUrl;return u.setPlaceholder(p).setValue(B||"").onChange(async Q=>{this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={}),this.plugin.settings.ai.gemini.baseUrl=Q||"",await this.plugin.saveSettings()}),u})}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.gemini;if(!this.modelState.selectedModel.isCustom){let n=A.lastCustomModel||"";this.modelState.selectedModel={id:n,name:n,isCustom:!0},A.model=n,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=n)}}}async hideCustomModelInput(){if(this.customModelContainer){this.customModelContainer.removeClass("visible");let A=this.plugin.settings.ai.gemini,t=this.modelState.selectedModel;if(t.isCustom&&t.id){A.lastCustomModel=t.id;let n=this.customModelContainer.querySelector("input");n&&(n.value=t.id)}A.isCustomModel=!1,await this.plugin.saveSettings()}}};var et=require("obsidian");var Dr=class extends re{async display(e){var l,c,d;let A=e.createEl("div",{cls:"ai-service-settings"});new et.Setting(A).setName(m("Ollama Settings")).setHeading();let t="http://localhost:11434";(l=this.plugin.settings.ai.ollama)!=null&&l.host||(this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.host=t,await this.plugin.saveSettings());let n=new et.Setting(A).setName(m("Server Address")).setDesc(m("Ollama server address (default: http://localhost:11434)")).addText(u=>{var p;return u.setPlaceholder(t).setValue(((p=this.plugin.settings.ai.ollama)==null?void 0:p.host)||t).onChange(async B=>{this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.host=B||t,await this.plugin.saveSettings()}),u}),o;n.addButton(u=>(o=u.buttonEl,u.setButtonText(m("Check")).onClick(async()=>{var Q;let p=((Q=this.plugin.settings.ai.ollama)==null?void 0:Q.host)||t;o.disabled=!0;let B=o.textContent;o.textContent=m("Checking...");let v=new Ut(p);try{let U=await v.listModels();o.disabled=!1,o.textContent=B,U&&U.length>0?(this.plugin.settings.ai.ollama.availableModels=U,await this.plugin.saveSettings(),this.displayOllamaModelDropdown(A,U),new et.Notice(m("Successfully connected to Ollama service"))):new et.Notice(m("No models found. Please download models using ollama"))}catch(U){o.disabled=!1,o.textContent=B,new et.Notice(m("Failed to connect to Ollama service. Please check the server address."))}}))),(d=(c=this.plugin.settings.ai.ollama)==null?void 0:c.availableModels)!=null&&d.length&&this.displayOllamaModelDropdown(A,this.plugin.settings.ai.ollama.availableModels)}displayOllamaModelDropdown(e,A){let t=e.querySelector(".model-setting");t&&t.remove(),new et.Setting(e).setName(m("Model")).setDesc(m("Select the Ollama model to use")).addDropdown(o=>{var u;let l=Object.fromEntries(A.map(p=>[p,p])),c=(u=this.plugin.settings.ai.ollama)==null?void 0:u.model,d=A.includes(c)?c:A[0];return o.addOptions(l).setValue(d).onChange(async p=>{this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.model=p,await this.plugin.saveSettings()})}).settingEl.addClass("model-setting")}};var fe=require("obsidian");var Pr=class extends re{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.siliconflow||(this.plugin.settings.ai.siliconflow={apiKey:"",model:Ue[0].id,baseUrl:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.siliconflow,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let n=Ue.find(o=>o.id===A.model);t=n||Ue[0],n||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){if(!this.plugin.settings.ai.siliconflow)this.plugin.settings.ai.siliconflow={apiKey:this.modelState.apiKey||"",model:this.modelState.selectedModel.id,baseUrl:"",isCustomModel:!!this.modelState.selectedModel.isCustom,lastCustomModel:this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:void 0};else{let A=this.plugin.settings.ai.siliconflow,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id)}await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let n="https://api.siliconflow.cn/v1",o=(t=this.plugin.settings.ai.siliconflow)==null?void 0:t.baseUrl,l=o&&o.trim()?o:n,c=this.modelState.selectedModel.id,d=`${l}/chat/completions`,u=await(0,fe.requestUrl)({url:d,method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({model:c,messages:[{role:"user",content:"Hello"}],max_tokens:1})});if(!u.status||u.status<200||u.status>=300){let p=u.json||null;return{isValid:!1,message:m("API Key \u65E0\u6548\u6216\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u8BF7\u68C0\u67E5\u4F60\u7684 API Key \u548C\u6A21\u578B ID \u662F\u5426\u6B63\u786E\u3002")}}return{isValid:!0,message:m("API Key and the current model are both available!")}}catch(n){return{isValid:!1,message:m("API Key \u65E0\u6548\u6216\u670D\u52A1\u5668\u9519\u8BEF\u3002")}}}async showCustomModelInput(){this.customModelContainer&&this.modelSelectEl&&this.customModelContainer.addClass("visible")}async hideCustomModelInput(){this.customModelContainer&&this.modelSelectEl&&this.customModelContainer.removeClass("visible")}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new fe.Setting(t).setName(m("SiliconFlow service")).setHeading();let n=new fe.Setting(t).setName(m("API key")).setDesc(m("Enter your SiliconFlow API key.")).addText(p=>p.setPlaceholder("sk-...").setValue(this.modelState.apiKey).onChange(async B=>{this.modelState.apiKey=B,await this.saveModelState()})).addButton(p=>p.setButtonText(m("Check")).onClick(async()=>{let B=this.modelState.apiKey;if(!B){new fe.Notice(m("Please input API Key"));return}p.setButtonText(m("Checking...")),p.setDisabled(!0);let v=await this.validateApiKey(B);p.setButtonText(m("Check")),p.setDisabled(!1),v.message&&new fe.Notice(v.message)})),o=new fe.Setting(t).setName(m("Model")).setDesc(m("Select the SiliconFlow model to use")).addDropdown(p=>{Ue.forEach(v=>{p.addOption(v.id,v.name)}),p.addOption("custom","Custom Model");let B=this.modelState.selectedModel;return p.setValue(B.isCustom?"custom":B.id),this.modelSelectEl=p.selectEl,p.onChange(async v=>{var Q;if(v==="custom"){let U=(Q=this.plugin.settings.ai.siliconflow)==null?void 0:Q.lastCustomModel;this.modelState.selectedModel={id:U||"",name:U||"",isCustom:!0},await this.saveModelState(),await this.showCustomModelInput()}else{let U=Ue.find(E=>E.id===v);U&&(this.modelState.selectedModel.isCustom&&this.plugin.settings.ai.siliconflow&&(this.plugin.settings.ai.siliconflow.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()),this.modelState.selectedModel=U,await this.saveModelState(),await this.hideCustomModelInput())}}),p});this.customModelContainer=o.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let l=o.settingEl.querySelector(".setting-item-control");l&&(l.addClass("openai-dropdown-container"),l.insertBefore(this.customModelContainer,l.firstChild));let d=new fe.Setting(this.customModelContainer).addText(p=>p.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async B=>{let v=B.trim();if(v){if(!/^[a-zA-Z0-9-_./]+$/.test(v)){new fe.Notice("\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u3001\u77ED\u6760\u548C\u659C\u6760"),p.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:v,name:v,isCustom:!0},await this.saveModelState()}})).settingEl;d.addClass("openai-setting-no-border");let u=d.querySelector(".setting-item-control");u&&u.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new fe.Setting(t).setName(m("Custom API address")).setDesc(m("If using a custom API proxy, please enter the full API address")).addText(p=>{var Q;let B="https://api.siliconflow.cn/v1",v=(Q=this.plugin.settings.ai.siliconflow)==null?void 0:Q.baseUrl;return p.setPlaceholder(B).setValue(v||"").onChange(async U=>{this.plugin.settings.ai.siliconflow?this.plugin.settings.ai.siliconflow.baseUrl=U||"":this.plugin.settings.ai.siliconflow={apiKey:this.modelState.apiKey||"",model:this.modelState.selectedModel.id,baseUrl:U||"",isCustomModel:!!this.modelState.selectedModel.isCustom,lastCustomModel:this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:void 0},await this.plugin.saveSettings()}),p})}};var xt=require("obsidian"),Kr=require("obsidian");var Rr=class{constructor(e,A){this.plugin=e,this.containerEl=A}display(){let e=this.containerEl.createEl("div",{cls:"prompt-settings-container"}),A=e.createEl("div",{cls:"prompt-settings-header setting-item-heading"});A.createEl("h4",{text:m("Prompt settings"),cls:"prompt-settings-title"});let t=A.createEl("button",{cls:"prompt-add-btn",attr:{"aria-label":m("Add prompt")}});(0,Kr.setIcon)(t,"plus"),t.onclick=()=>{if(e.querySelector(".new-prompt-section"))return;let n=e.querySelector(".prompt-list");n&&this.createNewPromptForm(e,n)},this.displayPromptList(e)}createNewPromptForm(e,A){var u;let t=e.createEl("div",{cls:"new-prompt-section"});(u=A.parentElement)==null||u.insertBefore(t,A);let n=t.createEl("input",{cls:"prompt-name-input",attr:{placeholder:m("Input Prompt Name"),type:"text"}}),o=new xt.TextAreaComponent(t);o.setPlaceholder(m(`Input Prompt Content
Available parameters:
{{highlight}} - Current highlighted text
{{comment}} - Existing comment`)).setValue(""),o.inputEl.addClass("prompt-textarea");let l=t.createEl("div",{cls:"prompt-buttons"}),c=l.createEl("button",{cls:"prompt-save-btn",text:m("Save")});c.onclick=async()=>{var v;let p=n.value,B=o.getValue();if(p&&B){this.plugin.settings.ai.prompts||(this.plugin.settings.ai.prompts={}),this.plugin.settings.ai.prompts[p]=B,await this.plugin.saveSettings(),t.remove(),this.displayPromptList(e),new xt.Notice(m("Prompt added"));let Q=(v=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:v.view;Q&&Q.updateAIDropdowns()}};let d=l.createEl("button",{cls:"prompt-cancel-btn",text:m("Cancel")});d.onclick=()=>{t.remove()}}displayPromptList(e){let A=e.querySelector(".prompt-list");A&&A.remove();let t=e.createEl("div",{cls:"prompt-list"}),n=this.plugin.settings.ai.prompts||{};for(let[o,l]of Object.entries(n)){let c=t.createEl("div",{cls:"prompt-item"}),d=c.createEl("div",{cls:"prompt-display-mode"}),u=d.createEl("div",{cls:"prompt-info"});u.createEl("div",{cls:"prompt-name",text:o});let p=l.replace(/\n/g," ");u.createEl("div",{cls:"prompt-content-preview",text:p});let v=d.createEl("div",{cls:"prompt-buttons"}).createEl("button",{cls:"prompt-edit-btn",attr:{"aria-label":m("Edit")}});(0,Kr.setIcon)(v,"square-pen");let Q=c.createEl("div",{cls:"prompt-edit-mode hi-note-hidden"}),U=Q.createEl("input",{cls:"prompt-name-input",attr:{value:o,type:"text"}}),E=new xt.TextAreaComponent(Q);E.setValue(l),E.inputEl.classList.add("prompt-content-input"),E.inputEl.addClass("prompt-textarea");let H=Q.createEl("div",{cls:"prompt-edit-buttons"}),M=H.createEl("button",{cls:"prompt-save-btn",text:m("Save")}),x=H.createEl("button",{cls:"prompt-cancel-btn",text:m("Cancel")}),D=H.createEl("button",{cls:"prompt-delete-btn",attr:{"aria-label":m("Delete")}});(0,Kr.setIcon)(D,"trash-2"),v.onclick=()=>{d.addClass("hi-note-hidden"),Q.removeClass("hi-note-hidden")},D.onclick=async()=>{var O;delete this.plugin.settings.ai.prompts[o],await this.plugin.saveSettings(),c.remove();let N=(O=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:O.view;N&&N.updateAIDropdowns()},M.onclick=async()=>{var J;let N=U.value,O=E.getValue();if(N&&O){N!==o&&delete this.plugin.settings.ai.prompts[o],this.plugin.settings.ai.prompts[N]=O,await this.plugin.saveSettings(),this.displayPromptList(e),new xt.Notice(m("Prompt updated"));let j=(J=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:J.view;j&&j.updateAIDropdowns()}},x.onclick=()=>{d.removeClass("hi-note-hidden"),Q.addClass("hi-note-hidden")}}}};var kr=class{constructor(e,A){this.plugin=e,this.containerEl=A}display(){switch(new Uo.Setting(this.containerEl).setName("AI service").setDesc(m("Select the AI service provider")).addDropdown(e=>{let A={openai:"OpenAI",gemini:"Gemini",anthropic:"Anthropic",deepseek:"Deepseek",siliconflow:"SiliconFlow",ollama:"Ollama (Local)"};return e.addOptions(A).setValue(this.plugin.settings.ai.provider).onChange(async t=>{this.plugin.settings.ai.provider=t,await this.plugin.saveSettings(),this.containerEl.empty(),this.display()})}),this.plugin.settings.ai.provider){case"openai":new xr(this.plugin,this.containerEl).display(this.containerEl);break;case"gemini":new Tr(this.plugin,this.containerEl).display(this.containerEl);break;case"anthropic":new Mr(this.plugin,this.containerEl).display(this.containerEl);break;case"ollama":new Dr(this.plugin,this.containerEl).display(this.containerEl);break;case"deepseek":new Lr(this.plugin,this.containerEl).display(this.containerEl);break;case"siliconflow":new Pr(this.plugin,this.containerEl).display(this.containerEl);break}new Rr(this.plugin,this.containerEl).display()}};var NA=require("obsidian");var ui=class{constructor(e,A){this.plugin=e,this.containerEl=A,this.fsrsService=e.fsrsManager.fsrsService}display(){let e=this.containerEl.createEl("div",{cls:"flashcard-settings-container"});new NA.Setting(e).setName(m("Flashcard learning")).setHeading(),new NA.Setting(e).setName(m("New cards per day")).setDesc(m("Maximum number of new cards to learn each day")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(1,200,1).setValue(l.newCardsPerDay).setDynamicTooltip().onChange(async u=>{let p=this.fsrsService.getParameters();p.newCardsPerDay=u,this.fsrsService.setParameters(p),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:String(l.newCardsPerDay)});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=String(o.getValue())})}),new NA.Setting(e).setName(m("Reviews per day")).setDesc(m("Maximum number of cards to review each day")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(10,500,10).setValue(l.reviewsPerDay).setDynamicTooltip().onChange(async u=>{let p=this.fsrsService.getParameters();p.reviewsPerDay=u,this.fsrsService.setParameters(p),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:String(l.reviewsPerDay)});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=String(o.getValue())})}),new NA.Setting(e).setName(m("Target retention")).setDesc(m("Target memory retention rate (0.8 = 80%)")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(.7,.95,.01).setValue(l.request_retention).setDynamicTooltip().onChange(async u=>{let p=this.fsrsService.getParameters();p.request_retention=u,this.fsrsService.setParameters(p),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:`${Math.round(l.request_retention*100)}%`});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=`${Math.round(o.getValue()*100)}%`})}),new NA.Setting(e).setName(m("Maximum interval")).setDesc(m("Maximum interval in days between reviews")).addText(o=>{let l=this.fsrsService.getParameters();o.setValue(l.maximum_interval.toString()).setPlaceholder("365").onChange(async u=>{let p=parseInt(u);if(!isNaN(p)&&p>0){let B=this.fsrsService.getParameters();B.maximum_interval=p,this.fsrsService.setParameters(B),await this.plugin.saveSettings()}});let c=o.inputEl;c.type="number",c.min="1",c.style.width="80px";let d=createEl("span",{text:` ${m("days")}`,cls:"setting-item-suffix"});c.after(d)}),new NA.Setting(e).setName(m("Reset daily stats")).setDesc(m("Reset today's learning statistics")).addButton(o=>o.setButtonText(m("Reset")).onClick(async()=>{let l=new Date;l.setHours(0,0,0,0);let c=this.plugin.fsrsManager.storage.dailyStats,d=c.findIndex(u=>u.date===l.getTime());d>=0?(c.splice(d,1),await this.plugin.fsrsManager.saveStorage(),new NA.Notice(m("Daily statistics have been reset"))):new NA.Notice(m("No statistics to reset for today"))})),new NA.Setting(e).setName(m("Advanced")).setHeading(),e.createEl("p",{text:m("These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm."),cls:"setting-item-description"}),new NA.Setting(e).setName(m("Reset algorithm parameters")).setDesc(m("Reset the FSRS algorithm parameters to default values")).addButton(o=>o.setButtonText(m("Reset to default")).onClick(async()=>{this.fsrsService.resetParameters(),await this.plugin.saveSettings();let l=this.fsrsService.getParameters(),c=this.containerEl.querySelector(".setting-item:nth-child(4) .slider"),d=this.containerEl.querySelector(".setting-item:nth-child(4) .slider-value");c&&d&&(c.value=String(l.request_retention),d.textContent=`${Math.round(l.request_retention*100)}%`);let u=this.containerEl.querySelector('.setting-item:nth-child(5) input[type="number"]');u&&(u.value=String(l.maximum_interval));let p=this.containerEl.querySelector(".setting-item:nth-child(2) .slider"),B=this.containerEl.querySelector(".setting-item:nth-child(2) .slider-value");p&&B&&(p.value=String(l.newCardsPerDay),B.textContent=String(l.newCardsPerDay));let v=this.containerEl.querySelector(".setting-item:nth-child(3) .slider"),Q=this.containerEl.querySelector(".setting-item:nth-child(3) .slider-value");v&&Q&&(v.value=String(l.reviewsPerDay),Q.textContent=String(l.reviewsPerDay));let U=this.containerEl.querySelector(".fsrs-weights-textarea");U&&(U.value=JSON.stringify(l.w)),new NA.Notice(m("FSRS parameters have been reset to default values"))}));let A=e.createEl("div",{cls:"fsrs-params-container"});A.createEl("p",{text:m("FSRS weight parameter. The default value is obtained from a smaller sample; if adjustment is needed, please use the FSRS optimizer for calculation."),cls:"setting-item-description"});let t=this.fsrsService.getParameters(),n=JSON.stringify(t.w);new NA.Setting(A).setName(m("FSRS parameters")).setDesc(m("Edit the 17 FSRS algorithm weights. Format: JSON array of numbers.")).addTextArea(o=>{o.setValue(n).setPlaceholder("[0.4872, 1.4003, ...]").onChange(async l=>{try{let c=JSON.parse(l);if(Array.isArray(c)&&c.length===17&&c.every(d=>typeof d=="number")){let d=this.fsrsService.getParameters();d.w=c,this.fsrsService.setParameters(d),await this.plugin.saveSettings(),new NA.Notice(m("FSRS weights updated successfully"))}else new NA.Notice(m("Invalid format. Must be an array of 17 numbers."),5e3)}catch(c){new NA.Notice(m("Invalid JSON format. Please check your input."),5e3)}}),o.inputEl.rows=2,o.inputEl.cols=32,o.inputEl.addClass("fsrs-weights-textarea")})}};var Gr=class extends So.PluginSettingTab{constructor(e,A){super(e,A),this.plugin=A,this.DEFAULT_SETTINGS=A.DEFAULT_SETTINGS,this.licenseManager=new qe(this.plugin)}async display(){let{containerEl:e}=this;e.empty();let A=e.createEl("div",{cls:"setting-tabs"}),t=e.createEl("div",{cls:"setting-tab-content"}),n=A.createEl("div",{text:m("General"),cls:"setting-tab-btn active",attr:{role:"button",tabindex:"0"}}),o=A.createEl("div",{text:m("AI service"),cls:"setting-tab-btn",attr:{role:"button",tabindex:"0"}}),l=null,c=t.createEl("div",{cls:"setting-tab-pane active"}),d=t.createEl("div",{cls:"setting-tab-pane"}),u=null,p=(B,v)=>{A.findAll(".setting-tab-btn").forEach(Q=>Q.removeClass("active")),t.findAll(".setting-tab-pane").forEach(Q=>Q.removeClass("active")),B.addClass("active"),v.addClass("active")};n.onclick=()=>p(n,c),o.onclick=()=>p(o,d),new br(this.plugin,c).display(),new kr(this.plugin,d).display(),l=A.createEl("div",{text:"HiCard",cls:"setting-tab-btn",attr:{role:"button",tabindex:"0"}}),u=t.createEl("div",{cls:"setting-tab-pane"}),l.onclick=async()=>{if(p(l,u),u.empty(),await this.licenseManager.isActivated())new ui(this.plugin,u).display();else{let v=u.createEl("div",{cls:"flashcard-activation-container"});v.createEl("div",{cls:"flashcard-activation-header",text:m("Activate HiCard")}),v.createEl("div",{cls:"flashcard-activation-description",text:m("Enter your license key to activate HiCard feature.")});let Q=v.createEl("div",{cls:"flashcard-activation-input-container"}),U=Q.createEl("input",{cls:"flashcard-activation-input",type:"text",placeholder:m("Enter license key")}),E=Q.createEl("button",{cls:"flashcard-activation-button",text:m("Activate")}),H=v.createEl("div",{cls:"activation-msg"});E.onclick=async()=>{E.setAttr("disabled","true"),H.textContent=m("Verifying..."),await this.licenseManager.activateLicense(U.value)?(H.textContent=m("Activation successful!"),u.empty(),new ui(this.plugin,u).display()):(H.textContent=m("Activation failed. Please check your license key."),E.removeAttribute("disabled"))}}}}};var Lo=lo(tn());var AA=(F=>(F[F.New=0]="New",F[F.Learning=1]="Learning",F[F.Review=2]="Review",F[F.Relearning=3]="Relearning",F))(AA||{}),T=(F=>(F[F.Manual=0]="Manual",F[F.Again=1]="Again",F[F.Hard=2]="Hard",F[F.Good=3]="Good",F[F.Easy=4]="Easy",F))(T||{}),z=class F{static card(e){return{...e,state:F.state(e.state),due:F.time(e.due),last_review:e.last_review?F.time(e.last_review):void 0}}static rating(e){if(typeof e=="string"){let A=e.charAt(0).toUpperCase(),t=e.slice(1).toLowerCase(),n=T[`${A}${t}`];if(n===void 0)throw new Error(`Invalid rating:[${e}]`);return n}else if(typeof e=="number")return e;throw new Error(`Invalid rating:[${e}]`)}static state(e){if(typeof e=="string"){let A=e.charAt(0).toUpperCase(),t=e.slice(1).toLowerCase(),n=AA[`${A}${t}`];if(n===void 0)throw new Error(`Invalid state:[${e}]`);return n}else if(typeof e=="number")return e;throw new Error(`Invalid state:[${e}]`)}static time(e){if(typeof e=="object"&&e instanceof Date)return e;if(typeof e=="string"){let A=Date.parse(e);if(isNaN(A))throw new Error(`Invalid date:[${e}]`);return new Date(A)}else if(typeof e=="number")return new Date(e);throw new Error(`Invalid date:[${e}]`)}static review_log(e){return{...e,due:F.time(e.due),rating:F.rating(e.rating),state:F.state(e.state),review:F.time(e.review)}}};Date.prototype.scheduler=function(F,e){return Ce(this,F,e)},Date.prototype.diff=function(F,e){return Mt(this,F,e)},Date.prototype.format=function(){return $g(this)},Date.prototype.dueFormat=function(F,e,A){return qg(this,F,e,A)};function Ce(F,e,A){return new Date(A?z.time(F).getTime()+e*24*60*60*1e3:z.time(F).getTime()+e*60*1e3)}function Mt(F,e,A){if(!F||!e)throw new Error("Invalid date");let t=z.time(F).getTime()-z.time(e).getTime(),n=0;switch(A){case"days":n=Math.floor(t/(24*60*60*1e3));break;case"minutes":n=Math.floor(t/(60*1e3));break}return n}function $g(F){let e=z.time(F),A=e.getFullYear(),t=e.getMonth()+1,n=e.getDate(),o=e.getHours(),l=e.getMinutes(),c=e.getSeconds();return`${A}-${pi(t)}-${pi(n)} ${pi(o)}:${pi(l)}:${pi(c)}`}function pi(F){return F<10?`0${F}`:`${F}`}var nn=[60,60,24,31,12],an=["second","min","hour","day","month","year"];function qg(F,e,A,t=an){F=z.time(F),e=z.time(e),t.length!==an.length&&(t=an);let n=F.getTime()-e.getTime(),o;for(n/=1e3,o=0;o<nn.length&&!(n<nn[o]);o++)n/=nn[o];return`${Math.floor(n)}${A?t[o]:""}`}var Zg=Object.freeze([T.Again,T.Hard,T.Good,T.Easy]),zg=[{start:2.5,end:7,factor:.15},{start:7,end:20,factor:.1},{start:20,end:1/0,factor:.05}];function jg(F,e,A){let t=1;for(let l of zg)t+=l.factor*Math.max(Math.min(F,l.end)-l.start,0);F=Math.min(F,A);let n=Math.max(2,Math.round(F-t)),o=Math.min(Math.round(F+t),A);return F>e&&(n=Math.max(n,e+1)),n=Math.min(n,o),{min_ivl:n,max_ivl:o}}function $A(F,e,A){return Math.min(Math.max(F,e),A)}function Au(F,e){let A=Date.UTC(F.getUTCFullYear(),F.getUTCMonth(),F.getUTCDate()),t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Math.floor((t-A)/864e5)}var eu="5.2.0",tu=.9,iu=36500,ru=!1,su=!0,nu=Object.freeze(["1m","10m"]),au=Object.freeze(["10m"]),TB=`v${eu} using FSRS-6.0`,ve=.001;var Or=100,Io=.5,ou=.1542,Ho=Object.freeze([.212,1.2931,2.3065,8.2956,6.4133,.8334,3.0194,.001,1.8722,.1666,.796,1.4835,.0614,.2629,1.6483,.6014,1.8729,.5425,.0912,.0658,ou]),lu=2,cu=F=>[[ve,Or],[ve,Or],[ve,Or],[ve,Or],[1,10],[.001,4],[.001,4],[.001,.75],[0,4.5],[0,.8],[.001,3.5],[.001,5],[.001,.25],[.001,.9],[0,4],[0,1],[1,6],[0,F],[0,F],[0,.8],[.1,.8]],gn=(F,e)=>{let A=lu;if(Math.max(0,e)>1){let t=-(Math.log(F[11])+Math.log(Math.pow(2,F[13])-1)+F[14]*.3)/e;A=$A(+t.toFixed(8),.01,2)}return cu(A).map(([t,n],o)=>$A(F[o],t,n))};var un=F=>{if(F===void 0)return[...Ho];switch(F.length){case 21:return[...F];case 19:return console.debug("[FSRS-6]auto fill w from 19 to 21 length"),[...F,0,Io];case 17:{let e=[...F];return e[4]=+(e[5]*2+e[4]).toFixed(8),e[5]=+(Math.log(e[5]*3+1)/3).toFixed(8),e[6]=+(e[6]+.5).toFixed(8),console.debug("[FSRS-6]auto fill w from 17 to 21 length"),e.concat([0,0,0,Io])}default:return console.warn("[FSRS]Invalid parameters length, using default parameters"),[...Ho]}},Nr=F=>{var n,o;let e=Array.isArray(F==null?void 0:F.learning_steps)?F.learning_steps:nu,A=Array.isArray(F==null?void 0:F.relearning_steps)?F.relearning_steps:au,t=gn(un(F==null?void 0:F.w),A.length);return{request_retention:(F==null?void 0:F.request_retention)||tu,maximum_interval:(F==null?void 0:F.maximum_interval)||iu,w:t,enable_fuzz:(n=F==null?void 0:F.enable_fuzz)!=null?n:ru,enable_short_term:(o=F==null?void 0:F.enable_short_term)!=null?o:su,learning_steps:e,relearning_steps:A}};function Lt(F,e){let A={due:F?z.time(F):new Date,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:0,lapses:0,learning_steps:0,state:AA.New,last_review:void 0};return e&&typeof e=="function"?e(A):A}var on=class{constructor(e){EA(this,"c");EA(this,"s0");EA(this,"s1");EA(this,"s2");let A=hu();this.c=1,this.s0=A(" "),this.s1=A(" "),this.s2=A(" "),e==null&&(e=+new Date),this.s0-=A(e),this.s0<0&&(this.s0+=1),this.s1-=A(e),this.s1<0&&(this.s1+=1),this.s2-=A(e),this.s2<0&&(this.s2+=1)}next(){let e=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=e|0),this.s2}set state(e){this.c=e.c,this.s0=e.s0,this.s1=e.s1,this.s2=e.s2}get state(){return{c:this.c,s0:this.s0,s1:this.s1,s2:this.s2}}};function hu(){let F=4022871197;return function(e){e=String(e);for(let A=0;A<e.length;A++){F+=e.charCodeAt(A);let t=.02519603282416938*F;F=t>>>0,t-=F,t*=F,F=t>>>0,t-=F,F+=t*4294967296}return(F>>>0)*23283064365386963e-26}}function du(F){let e=new on(F),A=()=>e.next();return A.int32=()=>e.next()*4294967296|0,A.double=()=>A()+(A()*2097152|0)*11102230246251565e-32,A.state=()=>e.state,A.importState=t=>(e.state=t,A),A}var bo=F=>{let e=typeof F=="number"?-F:-F[20],A=Math.exp(Math.pow(e,-1)*Math.log(.9))-1;return{decay:e,factor:+A.toFixed(8)}};function ln(F,e,A){let{decay:t,factor:n}=bo(F);return+Math.pow(1+n*e/A,t).toFixed(8)}var cn=class{constructor(e){EA(this,"param");EA(this,"intervalModifier");EA(this,"_seed");EA(this,"forgetting_curve");this.param=new Proxy(Nr(e),this.params_handler_proxy()),this.intervalModifier=this.calculate_interval_modifier(this.param.request_retention),this.forgetting_curve=ln.bind(this,this.param.w)}get interval_modifier(){return this.intervalModifier}set seed(e){this._seed=e}calculate_interval_modifier(e){if(e<=0||e>1)throw new Error("Requested retention rate should be in the range (0,1]");let{decay:A,factor:t}=bo(this.param.w);return+((Math.pow(e,1/A)-1)/t).toFixed(8)}get parameters(){return this.param}set parameters(e){this.update_parameters(e)}params_handler_proxy(){let e=this;return{set:function(A,t,n){return t==="request_retention"&&Number.isFinite(n)?e.intervalModifier=e.calculate_interval_modifier(Number(n)):t==="w"&&(n=gn(un(n),A.relearning_steps.length),e.forgetting_curve=ln.bind(this,n),e.intervalModifier=e.calculate_interval_modifier(Number(A.request_retention))),Reflect.set(A,t,n),!0}}}update_parameters(e){let A=Nr(e);for(let t in A)if(t in this.param){let n=t;this.param[n]=A[n]}}init_stability(e){return Math.max(this.param.w[e-1],.1)}init_difficulty(e){return+(this.param.w[4]-Math.exp((e-1)*this.param.w[5])+1).toFixed(8)}apply_fuzz(e,A){if(!this.param.enable_fuzz||e<2.5)return Math.round(e);let t=du(this._seed)(),{min_ivl:n,max_ivl:o}=jg(e,A,this.param.maximum_interval);return Math.floor(t*(o-n+1)+n)}next_interval(e,A){let t=Math.min(Math.max(1,Math.round(e*this.intervalModifier)),this.param.maximum_interval);return this.apply_fuzz(t,A)}linear_damping(e,A){return+(e*(10-A)/9).toFixed(8)}next_difficulty(e,A){let t=-this.param.w[6]*(A-3),n=e+this.linear_damping(t,e);return $A(this.mean_reversion(this.init_difficulty(T.Easy),n),1,10)}mean_reversion(e,A){return+(this.param.w[7]*e+(1-this.param.w[7])*A).toFixed(8)}next_recall_stability(e,A,t,n){let o=T.Hard===n?this.param.w[15]:1,l=T.Easy===n?this.param.w[16]:1;return+$A(A*(1+Math.exp(this.param.w[8])*(11-e)*Math.pow(A,-this.param.w[9])*(Math.exp((1-t)*this.param.w[10])-1)*o*l),ve,36500).toFixed(8)}next_forget_stability(e,A,t){return+$A(this.param.w[11]*Math.pow(e,-this.param.w[12])*(Math.pow(A+1,this.param.w[13])-1)*Math.exp((1-t)*this.param.w[14]),ve,36500).toFixed(8)}next_short_term_stability(e,A){let t=Math.pow(e,-this.param.w[19])*Math.exp(this.param.w[17]*(A-3+this.param.w[18])),n=A>=3?Math.max(t,1):t;return+$A(e*n,ve,36500).toFixed(8)}next_state(e,A,t){let{difficulty:n,stability:o}=e!=null?e:{difficulty:0,stability:0};if(A<0)throw new Error(`Invalid delta_t "${A}"`);if(t<0||t>4)throw new Error(`Invalid grade "${t}"`);if(n===0&&o===0)return{difficulty:$A(this.init_difficulty(t),1,10),stability:this.init_stability(t)};if(t===0)return{difficulty:n,stability:o};if(n<1||o<ve)throw new Error(`Invalid memory state { difficulty: ${n}, stability: ${o} }`);let l=this.forgetting_curve(A,o),c=this.next_recall_stability(n,o,l,t),d=this.next_forget_stability(n,o,l),u=this.next_short_term_stability(o,t),p=c;if(t===1){let[B,v]=[0,0];this.param.enable_short_term&&(B=this.param.w[17],v=this.param.w[18]);let Q=o/Math.exp(B*v);p=$A(+Q.toFixed(8),ve,d)}return A===0&&this.param.enable_short_term&&(p=u),{difficulty:this.next_difficulty(n,t),stability:p}}};function gu(){let F=this.review_time.getTime(),e=this.current.reps,A=this.current.difficulty*this.current.stability;return`${F}_${e}_${A}`}var uu=F=>{let e=F.slice(-1),A=parseInt(F.slice(0,-1),10);if(isNaN(A)||!Number.isFinite(A)||A<0)throw new Error(`Invalid step value: ${F}`);switch(e){case"m":return A;case"h":return A*60;case"d":return A*1440;default:throw new Error(`Invalid step unit: ${F}, expected m/h/d`)}},pu=(F,e,A)=>{let t=e===AA.Relearning||e===AA.Review?F.relearning_steps:F.learning_steps,n=t.length;if(n===0||A>=n)return{};let o=t[0],l=uu,c=()=>l(o),d=()=>{if(n===1)return Math.round(l(o)*1.5);let Q=t[1];return Math.round((l(o)+l(Q))/2)},u=Q=>Q<0||Q>=n?null:t[Q],p=Q=>l(Q),B={},v=u(Math.max(0,A));if(e===AA.Review)return B[T.Again]={scheduled_minutes:l(v),next_step:0},B;{B[T.Again]={scheduled_minutes:c(),next_step:0},B[T.Hard]={scheduled_minutes:d(),next_step:A};let Q=u(A+1);if(Q){let U=p(Q);U&&(B[T.Good]={scheduled_minutes:Math.round(U),next_step:A+1})}}return B},Jr=(F=>(F.SCHEDULER="Scheduler",F.LEARNING_STEPS="LearningSteps",F.SEED="Seed",F))(Jr||{}),Vr=class{constructor(e,A,t,n){EA(this,"last");EA(this,"current");EA(this,"review_time");EA(this,"next",new Map);EA(this,"algorithm");EA(this,"strategies");EA(this,"elapsed_days",0);this.algorithm=t,this.last=z.card(e),this.current=z.card(e),this.review_time=z.time(A),this.strategies=n,this.init()}checkGrade(e){if(!Number.isFinite(e)||e<0||e>4)throw new Error(`Invalid grade "${e}",expected 1-4`)}init(){let{state:e,last_review:A}=this.current,t=0;e!==AA.New&&A&&(t=Au(A,this.review_time)),this.current.last_review=this.review_time,this.elapsed_days=t,this.current.elapsed_days=t,this.current.reps+=1;let n=gu;if(this.strategies){let o=this.strategies.get(Jr.SEED);o&&(n=o)}this.algorithm.seed=n.call(this)}preview(){return{[T.Again]:this.review(T.Again),[T.Hard]:this.review(T.Hard),[T.Good]:this.review(T.Good),[T.Easy]:this.review(T.Easy),[Symbol.iterator]:this.previewIterator.bind(this)}}*previewIterator(){for(let e of Zg)yield this.review(e)}review(e){let{state:A}=this.last,t;switch(this.checkGrade(e),A){case AA.New:t=this.newState(e);break;case AA.Learning:case AA.Relearning:t=this.learningState(e);break;case AA.Review:t=this.reviewState(e);break}return t}buildLog(e){let{last_review:A,due:t,elapsed_days:n}=this.last;return{rating:e,state:this.current.state,due:A||t,stability:this.current.stability,difficulty:this.current.difficulty,elapsed_days:this.elapsed_days,last_elapsed_days:n,scheduled_days:this.current.scheduled_days,learning_steps:this.current.learning_steps,review:this.review_time}}},_r=class extends Vr{constructor(A,t,n,o){super(A,t,n,o);EA(this,"learningStepsStrategy");let l=pu;if(this.strategies){let c=this.strategies.get(Jr.LEARNING_STEPS);c&&(l=c)}this.learningStepsStrategy=l}getLearningInfo(A,t){var d,u,p,B;let n=this.algorithm.parameters;A.learning_steps=A.learning_steps||0;let o=this.learningStepsStrategy(n,A.state,this.current.state===AA.Learning?A.learning_steps+1:A.learning_steps),l=Math.max(0,(u=(d=o[t])==null?void 0:d.scheduled_minutes)!=null?u:0),c=Math.max(0,(B=(p=o[t])==null?void 0:p.next_step)!=null?B:0);return{scheduled_minutes:l,next_steps:c}}applyLearningSteps(A,t,n){let{scheduled_minutes:o,next_steps:l}=this.getLearningInfo(this.current,t);if(o>0&&o<1440)A.learning_steps=l,A.scheduled_days=0,A.state=n,A.due=Ce(this.review_time,Math.round(o),!1);else if(A.state=AA.Review,o>=1440)A.learning_steps=l,A.due=Ce(this.review_time,Math.round(o),!1),A.scheduled_days=Math.floor(o/1440);else{A.learning_steps=0;let c=this.algorithm.next_interval(A.stability,this.elapsed_days);A.scheduled_days=c,A.due=Ce(this.review_time,c,!0)}}newState(A){let t=this.next.get(A);if(t)return t;let n=z.card(this.current);n.difficulty=$A(this.algorithm.init_difficulty(A),1,10),n.stability=this.algorithm.init_stability(A),this.applyLearningSteps(n,A,AA.Learning);let o={card:n,log:this.buildLog(A)};return this.next.set(A,o),o}learningState(A){let t=this.next.get(A);if(t)return t;let{state:n,difficulty:o,stability:l}=this.last,c=z.card(this.current);c.difficulty=this.algorithm.next_difficulty(o,A),c.stability=this.algorithm.next_short_term_stability(l,A),this.applyLearningSteps(c,A,n);let d={card:c,log:this.buildLog(A)};return this.next.set(A,d),d}reviewState(A){let t=this.next.get(A);if(t)return t;let n=this.elapsed_days,{difficulty:o,stability:l}=this.last,c=this.algorithm.forgetting_curve(n,l),d=z.card(this.current),u=z.card(this.current),p=z.card(this.current),B=z.card(this.current);this.next_ds(d,u,p,B,o,l,c),this.next_interval(u,p,B,n),this.next_state(u,p,B),this.applyLearningSteps(d,T.Again,AA.Relearning),d.lapses+=1;let v={card:d,log:this.buildLog(T.Again)},Q={card:u,log:super.buildLog(T.Hard)},U={card:p,log:super.buildLog(T.Good)},E={card:B,log:super.buildLog(T.Easy)};return this.next.set(T.Again,v),this.next.set(T.Hard,Q),this.next.set(T.Good,U),this.next.set(T.Easy,E),this.next.get(A)}next_ds(A,t,n,o,l,c,d){A.difficulty=this.algorithm.next_difficulty(l,T.Again);let u=c/Math.exp(this.algorithm.parameters.w[17]*this.algorithm.parameters.w[18]),p=this.algorithm.next_forget_stability(l,c,d);A.stability=$A(+u.toFixed(8),ve,p),t.difficulty=this.algorithm.next_difficulty(l,T.Hard),t.stability=this.algorithm.next_recall_stability(l,c,d,T.Hard),n.difficulty=this.algorithm.next_difficulty(l,T.Good),n.stability=this.algorithm.next_recall_stability(l,c,d,T.Good),o.difficulty=this.algorithm.next_difficulty(l,T.Easy),o.stability=this.algorithm.next_recall_stability(l,c,d,T.Easy)}next_interval(A,t,n,o){let l,c;l=this.algorithm.next_interval(A.stability,o),c=this.algorithm.next_interval(t.stability,o),l=Math.min(l,c),c=Math.max(c,l+1);let d=Math.max(this.algorithm.next_interval(n.stability,o),c+1);A.scheduled_days=l,A.due=Ce(this.review_time,l,!0),t.scheduled_days=c,t.due=Ce(this.review_time,c,!0),n.scheduled_days=d,n.due=Ce(this.review_time,d,!0)}next_state(A,t,n){A.state=AA.Review,A.learning_steps=0,t.state=AA.Review,t.learning_steps=0,n.state=AA.Review,n.learning_steps=0}},Xr=class extends Vr{newState(e){let A=this.next.get(e);if(A)return A;this.current.scheduled_days=0,this.current.elapsed_days=0;let t=z.card(this.current),n=z.card(this.current),o=z.card(this.current),l=z.card(this.current);return this.init_ds(t,n,o,l),this.next_interval(t,n,o,l,0),this.next_state(t,n,o,l),this.update_next(t,n,o,l),this.next.get(e)}init_ds(e,A,t,n){e.difficulty=$A(this.algorithm.init_difficulty(T.Again),1,10),e.stability=this.algorithm.init_stability(T.Again),A.difficulty=$A(this.algorithm.init_difficulty(T.Hard),1,10),A.stability=this.algorithm.init_stability(T.Hard),t.difficulty=$A(this.algorithm.init_difficulty(T.Good),1,10),t.stability=this.algorithm.init_stability(T.Good),n.difficulty=$A(this.algorithm.init_difficulty(T.Easy),1,10),n.stability=this.algorithm.init_stability(T.Easy)}learningState(e){return this.reviewState(e)}reviewState(e){let A=this.next.get(e);if(A)return A;let t=this.elapsed_days,{difficulty:n,stability:o}=this.last,l=this.algorithm.forgetting_curve(t,o),c=z.card(this.current),d=z.card(this.current),u=z.card(this.current),p=z.card(this.current);return this.next_ds(c,d,u,p,n,o,l),this.next_interval(c,d,u,p,t),this.next_state(c,d,u,p),c.lapses+=1,this.update_next(c,d,u,p),this.next.get(e)}next_ds(e,A,t,n,o,l,c){e.difficulty=this.algorithm.next_difficulty(o,T.Again);let d=this.algorithm.next_forget_stability(o,l,c);e.stability=$A(l,ve,d),A.difficulty=this.algorithm.next_difficulty(o,T.Hard),A.stability=this.algorithm.next_recall_stability(o,l,c,T.Hard),t.difficulty=this.algorithm.next_difficulty(o,T.Good),t.stability=this.algorithm.next_recall_stability(o,l,c,T.Good),n.difficulty=this.algorithm.next_difficulty(o,T.Easy),n.stability=this.algorithm.next_recall_stability(o,l,c,T.Easy)}next_interval(e,A,t,n,o){let l,c,d,u;l=this.algorithm.next_interval(e.stability,o),c=this.algorithm.next_interval(A.stability,o),d=this.algorithm.next_interval(t.stability,o),u=this.algorithm.next_interval(n.stability,o),l=Math.min(l,c),c=Math.max(c,l+1),d=Math.max(d,c+1),u=Math.max(u,d+1),e.scheduled_days=l,e.due=Ce(this.review_time,l,!0),A.scheduled_days=c,A.due=Ce(this.review_time,c,!0),t.scheduled_days=d,t.due=Ce(this.review_time,d,!0),n.scheduled_days=u,n.due=Ce(this.review_time,u,!0)}next_state(e,A,t,n){e.state=AA.Review,e.learning_steps=0,A.state=AA.Review,A.learning_steps=0,t.state=AA.Review,t.learning_steps=0,n.state=AA.Review,n.learning_steps=0}update_next(e,A,t,n){let o={card:e,log:this.buildLog(T.Again)},l={card:A,log:super.buildLog(T.Hard)},c={card:t,log:super.buildLog(T.Good)},d={card:n,log:super.buildLog(T.Easy)};this.next.set(T.Again,o),this.next.set(T.Hard,l),this.next.set(T.Good,c),this.next.set(T.Easy,d)}},hn=class{constructor(e){EA(this,"fsrs");this.fsrs=e}replay(e,A,t){return this.fsrs.next(e,A,t)}handleManualRating(e,A,t,n,o,l,c){if(typeof A>"u")throw new Error("reschedule: state is required for manual rating");let d,u;if(A===AA.New)d={rating:T.Manual,state:A,due:c!=null?c:t,stability:e.stability,difficulty:e.difficulty,elapsed_days:n,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:t},u=Lt(t),u.last_review=t;else{if(typeof c>"u")throw new Error("reschedule: due is required for manual rating");let p=Mt(c,t,"days");d={rating:T.Manual,state:e.state,due:e.last_review||e.due,stability:e.stability,difficulty:e.difficulty,elapsed_days:n,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:t},u={...e,state:A,due:c,last_review:t,stability:o||e.stability,difficulty:l||e.difficulty,elapsed_days:n,scheduled_days:p,reps:e.reps+1}}return{card:u,log:d}}reschedule(e,A){let t=[],n=Lt(e.due);for(let o of A){let l;if(o.review=z.time(o.review),o.rating===T.Manual){let c=0;n.state!==AA.New&&n.last_review&&(c=Mt(o.review,n.last_review,"days")),l=this.handleManualRating(n,o.state,o.review,c,o.stability,o.difficulty,o.due?z.time(o.due):void 0)}else l=this.replay(n,o.review,o.rating);t.push(l),n=l.card}return t}calculateManualRecord(e,A,t,n){if(!t)return null;let{card:o,log:l}=t,c=z.card(e);return c.due.getTime()===o.due.getTime()?null:(c.scheduled_days=Mt(o.due,c.due,"days"),this.handleManualRating(c,o.state,z.time(A),l.elapsed_days,n?o.stability:void 0,n?o.difficulty:void 0,o.due))}},dn=class extends cn{constructor(A){super(A);EA(this,"strategyHandler",new Map);EA(this,"Scheduler");let{enable_short_term:t}=this.parameters;this.Scheduler=t?_r:Xr}params_handler_proxy(){let A=this;return{set:function(t,n,o){return n==="request_retention"&&Number.isFinite(o)?A.intervalModifier=A.calculate_interval_modifier(Number(o)):n==="enable_short_term"?A.Scheduler=o===!0?_r:Xr:n==="w"&&(o=gn(un(o),t.relearning_steps.length),A.forgetting_curve=ln.bind(this,o),A.intervalModifier=A.calculate_interval_modifier(Number(t.request_retention))),Reflect.set(t,n,o),!0}}}useStrategy(A,t){return this.strategyHandler.set(A,t),this}clearStrategy(A){return A?this.strategyHandler.delete(A):this.strategyHandler.clear(),this}getScheduler(A,t){let n=this.strategyHandler.get(Jr.SCHEDULER)||this.Scheduler;return new n(A,t,this,this.strategyHandler)}repeat(A,t,n){let o=this.getScheduler(A,t).preview();return n&&typeof n=="function"?n(o):o}next(A,t,n,o){let l=this.getScheduler(A,t),c=z.rating(n);if(c===T.Manual)throw new Error("Cannot review a manual rating");let d=l.review(c);return o&&typeof o=="function"?o(d):d}get_retrievability(A,t,n=!0){let o=z.card(A);t=t?z.time(t):new Date;let l=o.state!==AA.New?Math.max(Mt(t,o.last_review,"days"),0):0,c=o.state!==AA.New?this.forgetting_curve(l,+o.stability.toFixed(8)):0;return n?`${(c*100).toFixed(2)}%`:c}rollback(A,t,n){let o=z.card(A),l=z.review_log(t);if(l.rating===T.Manual)throw new Error("Cannot rollback a manual rating");let c,d,u;switch(l.state){case AA.New:c=l.due,d=void 0,u=0;break;case AA.Learning:case AA.Relearning:case AA.Review:c=l.review,d=l.due,u=o.lapses-(l.rating===T.Again&&l.state===AA.Review?1:0);break}let p={...o,due:c,stability:l.stability,difficulty:l.difficulty,elapsed_days:l.last_elapsed_days,scheduled_days:l.scheduled_days,reps:Math.max(0,o.reps-1),lapses:Math.max(0,u),learning_steps:l.learning_steps,state:l.state,last_review:d};return n&&typeof n=="function"?n(p):p}forget(A,t,n=!1,o){let l=z.card(A);t=z.time(t);let c=l.state===AA.New?0:Mt(t,l.due,"days"),d={rating:T.Manual,state:l.state,due:l.due,stability:l.stability,difficulty:l.difficulty,elapsed_days:0,last_elapsed_days:l.elapsed_days,scheduled_days:c,learning_steps:l.learning_steps,review:t},u={card:{...l,due:t,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:n?0:l.reps,lapses:n?0:l.lapses,learning_steps:0,state:AA.New,last_review:l.last_review},log:d};return o&&typeof o=="function"?o(u):u}reschedule(A,t=[],n={}){let{recordLogHandler:o,reviewsOrderBy:l,skipManual:c=!0,now:d=new Date,update_memory_state:u=!1}=n;l&&typeof l=="function"&&t.sort(l),c&&(t=t.filter(E=>E.rating!==T.Manual));let p=new hn(this),B=p.reschedule(n.first_card||Lt(),t),v=B.length,Q=z.card(A),U=p.calculateManualRecord(Q,d,v?B[v-1]:void 0,u);return o&&typeof o=="function"?{collections:B.map(o),reschedule_item:U?o(U):null}:{collections:B,reschedule_item:U}}},pn=F=>new dn(F||{});var Yr=class{constructor(e={}){this.params=this.convertToTsFSRSParams(e),this.fsrsInstance=pn(this.params)}convertToTsFSRSParams(e){let{request_retention:A=.9,maximum_interval:t=36500,w:n=[]}=e;return Nr({request_retention:A,maximum_interval:t,enable_fuzz:!0,enable_short_term:!0,w:e.w||[]})}toTsFSRSCard(e){if(e.lastReview===0)return Lt(new Date(e.createdAt));let A=AA.New;return e.reviews>0&&(e.lapses>0?A=AA.Relearning:A=AA.Review),{due:new Date(e.nextReview),stability:e.stability,difficulty:e.difficulty,elapsed_days:e.lastReview?(Date.now()-e.lastReview)/(24*60*60*1e3):0,scheduled_days:e.lastReview?(e.nextReview-e.lastReview)/(24*60*60*1e3):0,reps:e.reviews,lapses:e.lapses,state:A,last_review:e.lastReview?new Date(e.lastReview):void 0,learning_steps:0}}convertRating(e){switch(e){case cA.AGAIN:return T.Again;case cA.HARD:return T.Hard;case cA.GOOD:return T.Good;case cA.EASY:return T.Easy;default:return T.Good}}fromTsFSRSCard(e,A){let{card:t,log:n}=A;return{...e,difficulty:t.difficulty,stability:t.stability,retrievability:Math.exp(Math.log(.9)*t.elapsed_days/t.stability),lastReview:n.review.getTime(),nextReview:t.due.getTime(),reviews:t.reps,lapses:t.lapses,reviewHistory:[...e.reviewHistory,{timestamp:n.review.getTime(),rating:this.convertTsFSRSRatingToFSRSRating(n.rating),elapsed:n.elapsed_days}]}}convertTsFSRSRatingToFSRSRating(e){switch(e){case T.Again:return cA.AGAIN;case T.Hard:return cA.HARD;case T.Good:return cA.GOOD;case T.Easy:return cA.EASY;default:return cA.GOOD}}initializeCard(e,A,t){let n=Date.now(),o=Lt(new Date(n));return{id:_A.generateCardId(),difficulty:o.difficulty,stability:o.stability,retrievability:1,lastReview:0,nextReview:n,reviews:0,lapses:0,reviewHistory:[],text:e,answer:A,filePath:t,createdAt:n}}reviewCard(e,A){let t=this.toTsFSRSCard(e),n=this.convertRating(A),o=new Date;if(n!==T.Manual){let l=this.fsrsInstance.next(t,o,n);return this.fromTsFSRSCard(e,l)}else return e}getSchedulingCards(e){let A=this.toTsFSRSCard(e),t=new Date,n=this.fsrsInstance.repeat(A,t);return{[cA.AGAIN]:this.fromTsFSRSCard(e,n[T.Again]),[cA.HARD]:this.fromTsFSRSCard(e,n[T.Hard]),[cA.GOOD]:this.fromTsFSRSCard(e,n[T.Good]),[cA.EASY]:this.fromTsFSRSCard(e,n[T.Easy])}}isDue(e){return Date.now()>=e.nextReview}getParameters(){return{...this.params}}setParameters(e){this.params=this.convertToTsFSRSParams(e),this.fsrsInstance=pn(this.params)}};var Wr=class{constructor(e={}){this.params={...Xs,...e},this.adapter=new Yr(this.params)}initializeCard(e,A,t){return this.adapter.initializeCard(e,A,t)}reviewCard(e,A){return this.adapter.reviewCard(e,A)}isDue(e){return this.adapter.isDue(e)}getReviewableCards(e){return e.filter(A=>this.isDue(A)).sort((A,t)=>A.nextReview-t.nextReview)}getParameters(){return{...this.params}}setParameters(e){this.params={...this.params,...e},this.adapter.setParameters(this.params)}resetParameters(){this.params={...Xs},this.adapter.setParameters(this.params)}getSchedulingCards(e){return this.adapter.getSchedulingCards(e)}};var $r=class{constructor(e,A){this.plugin=e,this.fsrsService=A}get storage(){return this.plugin.fsrsManager.storage}createCard(e,A,t){try{return this.fsrsService.initializeCard(e,A,t)}catch(n){console.error("\u521B\u5EFA\u5361\u7247\u65F6\u51FA\u9519:",n);try{return this.fsrsService.initializeCard(e,A,t)}catch(o){console.error("\u7B2C\u4E8C\u6B21\u5C1D\u8BD5\u521B\u5EFA\u5361\u7247\u5931\u8D25:",o);let l=new Date;return this.fsrsService.initializeCard(e,A,t)}}}addCard(e,A,t){let n=this.createCard(e,A,t);this.storage.cards||(this.storage.cards={}),this.storage.cards[n.id]=n;try{this.plugin.eventManager.emitFlashcardChanged()}catch(o){console.error("\u4FDD\u5B58\u5361\u7247\u65F6\u51FA\u9519:",o)}return n}getCardsByFile(e){return this.storage.cards?Object.values(this.storage.cards).filter(A=>A.filePath===e):[]}deleteCard(e){try{return!this.storage.cards||!this.storage.cards[e]?!1:(delete this.storage.cards[e],this.plugin.eventManager.emitFlashcardChanged(),!0)}catch(A){return console.error("\u5220\u9664\u5361\u7247\u65F6\u51FA\u9519:",A),!1}}};var fi=class{constructor(e,A){this.plugin=e,this.storage=A}getCardGroups(){return this.storage.cardGroups||[]}getGroupById(e){return this.storage.cardGroups.find(A=>A.id===e)||null}async createCardGroup(e){Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]);let t={id:_A.generateGroupId(),name:e.name,filter:e.filter,createdTime:e.createdTime||Date.now(),sortOrder:e.sortOrder||this.storage.cardGroups.length,isReversed:e.isReversed||!1,settings:e.settings||{useGlobalSettings:!0},cardIds:[]};this.storage.cardGroups.push(t),e.filter&&e.filter.trim().length>0&&this.updateGroupCardIds(t.id);try{await this.plugin.fsrsManager.saveStoragePublic()}catch(n){console.error("\u4FDD\u5B58\u5206\u7EC4\u6570\u636E\u65F6\u51FA\u9519:",n)}return this.plugin.eventManager.emitFlashcardChanged(),t}async updateCardGroup(e,A){let t=this.storage.cardGroups.findIndex(n=>n.id===e);return t===-1?!1:(this.storage.cardGroups[t]={...this.storage.cardGroups[t],...A},A.filter&&this.updateGroupCardIds(e),this.plugin.eventManager.emitFlashcardChanged(),!0)}async deleteCardGroup(e,A=!1){let t=this.storage.cardGroups.findIndex(c=>c.id===e);if(t===-1)return!1;let n=this.storage.cardGroups[t],o=this.storage.uiState;o.currentGroupId===e&&(o.currentGroupId="",o.currentGroupName="",o.currentIndex=0,o.isFlipped=!1,o.completionMessage=null),o.groupCompletionMessages&&e in o.groupCompletionMessages&&delete o.groupCompletionMessages[e],o.groupProgress&&e in o.groupProgress&&delete o.groupProgress[e];let l=[...n.cardIds||[]];for(let c of l)this.removeCardFromGroup(c,e);return this.storage.cardGroups.splice(t,1),this.plugin.eventManager.emitFlashcardChanged(),!0}addCardToGroup(e,A){let t=this.storage.cardGroups.find(o=>o.id===A);if(!t)return!1;let n=this.storage.cards[e];return n?(t.cardIds||(t.cardIds=[]),n.groupIds||(n.groupIds=[]),t.cardIds.includes(e)||(t.cardIds.push(e),n.groupIds.includes(A)||n.groupIds.push(A)),!0):!1}removeCardFromGroup(e,A){let t=this.storage.cardGroups.find(o=>o.id===A);if(!t||!t.cardIds)return!1;let n=this.storage.cards[e];return n?(t.cardIds=t.cardIds.filter(o=>o!==e),n.groupIds&&(n.groupIds=n.groupIds.filter(o=>o!==A)),!0):!1}getCardsByGroupId(e){let A=this.getGroupById(e);if(!A)return console.error(`[getCardsByGroupId] \u9519\u8BEF: \u672A\u627E\u5230\u5206\u7EC4: ${e}`),[];let t=Object.keys(this.storage.cards||{});if(A.cardIds&&A.cardIds.length>0)return A.cardIds.filter(o=>{let l=!!this.storage.cards[o];return l||console.warn(`[getCardsByGroupId] \u5361\u7247\u4E0D\u5B58\u5728: ${o}`),l}).map(o=>this.storage.cards[o]);if(A.filter&&A.filter.trim().length>0){let n=Object.values(this.storage.cards),o=A.filter.split(",").map(d=>d.trim()).filter(d=>d.length>0),l=/\[\[([^\]]+)\]\]/;return n.filter(d=>{if(!d.filePath)return!1;let u=d.filePath.toLowerCase(),p=u.split("/").pop()||"",B=p.replace(/\.md$/i,"");for(let v of o){let Q=v.toLowerCase(),U=Q.match(l);if(U){let E=U[1].toLowerCase();if(B===E||p===E)return!0}else if(u.includes(Q)||d.text&&d.text.toLowerCase().includes(Q)||d.answer&&d.answer.toLowerCase().includes(Q))return!0}return!1})}return[]}getGroupProgress(e){if(!this.getGroupById(e))return null;let t=this.getCardsByGroupId(e),n=Date.now();return{due:t.filter(o=>o.nextReview<=n).length,newCards:t.filter(o=>o.lastReview===0).length,learned:t.filter(o=>o.lastReview>0).length,retention:this.calculateGroupRetention(t)}}calculateGroupRetention(e){let A=e.filter(n=>n.lastReview>0);return A.length===0?1:A.reduce((n,o)=>n+o.retrievability,0)/A.length}deleteCardReference(e){for(let A of this.storage.cardGroups)A.cardIds&&(A.cardIds=A.cardIds.filter(t=>t!==e))}getGroupsByCardId(e){let A=this.storage.cards[e];return!A||!A.groupIds?[]:A.groupIds.map(t=>this.storage.cardGroups.find(n=>n.id===t)).filter(t=>t!==void 0)}updateGroupCardIds(e){let A=this.getGroupById(e);if(!A||!A.filter||A.filter.trim().length===0)return!1;let t=Object.values(this.storage.cards||{}),n=A.filter.split(",").map(u=>u.trim()).filter(u=>u.length>0),o=/\[\[([^\]]+)\]\]/,c=t.filter(u=>{if(!u.filePath)return!1;let p=u.filePath.toLowerCase(),B=p.split("/").pop()||"",v=B.replace(/\.md$/i,"");for(let Q of n){let U=Q.toLowerCase(),E=U.match(o);if(E){let H=E[1].toLowerCase();if(v===H||B===H)return!0}else if(p.includes(U)||u.text&&u.text.toLowerCase().includes(U)||u.answer&&u.answer.toLowerCase().includes(U))return!0}return!1}).map(u=>u.id);A.cardIds||(A.cardIds=[]);let d=!1;for(let u of c)A.cardIds.includes(u)||(A.cardIds.push(u),d=!0);return d&&this.plugin.fsrsManager.saveStorageDebounced(),d}};var xo=require("obsidian"),qr=class{constructor(e){this.plugin=e,this.fsrsService=new Wr,this.cardFactory=new $r(e,this.fsrsService),this.storage={version:"1.0",cards:{},globalStats:{totalReviews:0,averageRetention:1,streakDays:0,lastReviewDate:0},cardGroups:[],uiState:{currentGroupName:"",completionMessage:null,groupProgress:{}},dailyStats:[]},this.saveStorageDebounced=(0,xo.debounce)(this.saveStorage.bind(this),1e3,!0),this.loadStorage().then(A=>{this.storage=A,this.groupRepository=new fi(e,this.storage),this.registerEventListeners()}).catch(A=>{console.error("Loading storage data failed:",A),this.groupRepository=new fi(e,this.storage),this.registerEventListeners()})}async loadStorage(){let e={version:"1.0",cards:{},globalStats:{totalReviews:0,averageRetention:1,streakDays:0,lastReviewDate:0},cardGroups:[],uiState:{currentGroupName:"",completionMessage:null,groupProgress:{}},dailyStats:[]};try{let A=await this.plugin.loadData();if(!(A!=null&&A.fsrs))return e;A.fsrs.cardGroups&&Array.isArray(A.fsrs.cardGroups)&&A.fsrs.cardGroups.length>0;let t=Array.isArray(A.fsrs.cardGroups)?A.fsrs.cardGroups:[];return{version:A.fsrs.version||e.version,cards:A.fsrs.cards||{},globalStats:A.fsrs.globalStats||e.globalStats,cardGroups:t,uiState:A.fsrs.uiState||e.uiState,dailyStats:A.fsrs.dailyStats||[]}}catch(A){return console.error("Loading storage data failed:",A),e}}async saveStorage(){try{let e=await this.plugin.loadData()||{};Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]),this.storage.cards||(this.storage.cards={});let A={...e,fsrs:this.storage};await this.plugin.saveData(A)}catch(e){throw console.error("Saving data failed:",e),e}}updateGlobalStats(e,A){let t=this.storage.globalStats,n=Date.now(),o=new Date(n).setHours(0,0,0,0);if(t.totalReviews++,t.averageRetention=(t.averageRetention*(t.totalReviews-1)+A)/t.totalReviews,t.lastReviewDate===0)t.streakDays=1;else{let l=new Date(t.lastReviewDate).setHours(0,0,0,0),c=(o-l)/(24*60*60*1e3);c===1?t.streakDays++:c>1&&(t.streakDays=1)}t.lastReviewDate=n}addCard(e,A,t,n,o){let l=this.cardFactory.createCard(e,A,t);return n&&o&&(l.sourceId=n,l.sourceType=o),this.storage.cards[l.id]=l,this.checkAndAddCardToGroups(l),this.saveStorageDebounced(),l}getCardsForStudy(e){if(!e)return console.warn("No group ID specified, returning empty card list"),[];let A=this.groupRepository.getCardsByGroupId(e);if(A.length===0)return[];let t=Date.now(),n=A.filter(Q=>Q.reviews===0&&Q.lastReview===0),o=A.filter(Q=>!(Q.reviews===0&&Q.lastReview===0)&&Q.nextReview<=t),l=this.getRemainingNewCardsToday(e),c=this.getRemainingReviewsToday(e),d=this.storage.cardGroups.find(Q=>Q.id===e),u=20,p=100;if(d&&d.settings)if(!d.settings.useGlobalSettings)u=d.settings.newCardsPerDay!==void 0?d.settings.newCardsPerDay:u,p=d.settings.reviewsPerDay!==void 0?d.settings.reviewsPerDay:p;else{let Q=this.fsrsService.getParameters();u=Q.newCardsPerDay,p=Q.reviewsPerDay}let B=n.slice(0,l),v=o.slice(0,c);return[...B,...v]}trackStudyProgress(e,A){let t=this.storage.cards[e];if(!t)return console.error(`Tracking study progress failed: Card ${e} does not exist`),null;let n=t.lastReview===0,o=this.fsrsService.reviewCard(t,A);return this.storage.cards[e]=o,this.updateGlobalStats(A,o.retrievability),this.updateDailyStats(n,A),t.groupIds&&t.groupIds.length>0&&t.groupIds.forEach(l=>{let c=this.groupRepository.getGroupById(l)}),this.saveStorage(),this.plugin.eventManager.emitFlashcardChanged(),this.storage.cards[e]}getCardPredictions(e){let A=this.storage.cards[e];return A?this.fsrsService.getSchedulingCards(A):null}async generateCardsForGroup(e){return 0}checkAndAddCardToGroups(e){if(!e||!e.id)return 0;let A=this.groupRepository.getCardGroups();if(!A||A.length===0)return 0;let t=0;for(let n of A){if(!n.filter||n.filter.trim().length===0)continue;let o=[e];this.checkCardMatchesGroupFilter(e,n.filter)&&this.addCardToGroup(e.id,n.id)&&t++}return t>0,t}checkCardMatchesGroupFilter(e,A){if(!e||!e.filePath||!A||A.trim().length===0)return!1;let t=A.split(",").map(d=>d.trim()).filter(d=>d.length>0);if(t.length===0)return!1;let n=/\[\[([^\]]+)\]\]/,o=e.filePath.toLowerCase(),l=o.split("/").pop()||"",c=l.replace(/\.md$/i,"");for(let d of t){let u=d.toLowerCase(),p=u.match(n);if(p){let B=p[1].toLowerCase();if(c===B||l===B)return!0}else if(o.includes(u)||e.text&&e.text.toLowerCase().includes(u)||e.answer&&e.answer.toLowerCase().includes(u))return!0}return!1}findCardsBySourceId(e,A){return!this.storage.cards||!e?[]:Object.values(this.storage.cards).filter(t=>t.sourceId===e&&(!A||t.sourceType===A))}deleteCardsBySourceId(e,A){let t=this.findCardsBySourceId(e,A),n=0;for(let o of t){if(o.groupIds)for(let l of o.groupIds)this.removeCardFromGroup(o.id,l);delete this.storage.cards[o.id],n++}return n>0&&this.saveStorageDebounced(),n}updateCardsBySourceId(e,A,t,n){let o=this.findCardsBySourceId(e,A),l=0;for(let c of o)t!==void 0&&(c.text=t),n!==void 0&&(c.answer=n),c.updatedAt=Date.now(),l++;return l>0&&this.saveStorageDebounced(),l}getTotalCardsCount(){let e=this.getCardGroups()||[];if(e.length===0)return 0;if(e.length===1&&e[0].cardIds)return e[0].cardIds.length;let A=new Set;return e.forEach(t=>{t.cardIds&&t.cardIds.forEach(n=>{this.storage.cards[n]&&A.add(n)})}),A.size}getProgress(){let e=this.getAllGroupCards(),A=Date.now();return e.length===0?{due:0,newCards:0,learned:0,retention:this.storage.globalStats.averageRetention}:{due:e.filter(t=>t.nextReview<=A).length,newCards:e.filter(t=>t.lastReview===0).length,learned:e.filter(t=>t.lastReview>0).length,retention:this.storage.globalStats.averageRetention}}getAllGroupCards(){let e=this.groupRepository.getCardGroups();if(!e||e.length===0)return[];let A=new Set,t=[];for(let n of e){let o=this.groupRepository.getCardsByGroupId(n.id);for(let l of o)A.has(l.id)||(A.add(l.id),t.push(l))}return t}getStats(){return{...this.storage.globalStats}}getUIState(){return{...this.storage.uiState}}updateUIState(e){this.storage.uiState={...this.storage.uiState,...e},this.saveStorageDebounced()}deleteCard(e){let A=this.storage.cards[e];if(!A)return!1;if(A.groupIds)for(let t of A.groupIds)this.removeCardFromGroup(e,t);return delete this.storage.cards[e],this.saveStorageDebounced(),this.plugin.eventManager.emitFlashcardChanged(),!0}getCardsByFile(e){return this.cardFactory.getCardsByFile(e)}getPlugin(){return this.plugin}async saveStoragePublic(){return this.saveStorage()}getTodayTimestamp(){let e=new Date;return e.setHours(0,0,0,0),e.getTime()}getTodayStats(){let e=new Date;e.setHours(0,0,0,0);let A=e.getTime(),t=e.toDateString(),n=this.storage.dailyStats.find(o=>new Date(o.date).toDateString()===t);return n||(n={date:A,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0},this.storage.dailyStats.push(n),this.saveStorageDebounced()),n}updateTodayStats(e){let A=this.getTodayStats();e?A.newCardsLearned++:A.cardsReviewed++,this.saveStorageDebounced()}canLearnNewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let n=this.storage.cardGroups.find(o=>o.id===e);if(n&&n.settings&&!n.settings.useGlobalSettings&&n.settings.newCardsPerDay!==void 0)return A.newCardsLearned<n.settings.newCardsPerDay}return A.newCardsLearned<t.newCardsPerDay}canReviewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let n=this.storage.cardGroups.find(o=>o.id===e);if(n&&n.settings&&!n.settings.useGlobalSettings&&n.settings.reviewsPerDay!==void 0)return A.cardsReviewed<n.settings.reviewsPerDay}return A.cardsReviewed<t.reviewsPerDay}getRemainingNewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let n=this.storage.cardGroups.find(o=>o.id===e);if(n&&n.settings&&!n.settings.useGlobalSettings&&n.settings.newCardsPerDay!==void 0)return Math.max(0,n.settings.newCardsPerDay-A.newCardsLearned)}return Math.max(0,t.newCardsPerDay-A.newCardsLearned)}getRemainingReviewsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let n=this.storage.cardGroups.find(o=>o.id===e);if(n&&n.settings&&!n.settings.useGlobalSettings&&n.settings.reviewsPerDay!==void 0)return Math.max(0,n.settings.reviewsPerDay-A.cardsReviewed)}return Math.max(0,t.reviewsPerDay-A.cardsReviewed)}async createCardGroup(e){Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]);let A=await this.groupRepository.createCardGroup(e),t=await this.generateCardsForGroup(A.id);return this.storage.cardGroups.some(n=>n.id===A.id)||this.storage.cardGroups.push(A),await this.saveStorage(),A}async updateCardGroup(e,A){let t=this.groupRepository.getGroupById(e),n=t==null?void 0:t.filter;if(!await this.groupRepository.updateCardGroup(e,A))return!1;if(A.filter!==void 0&&A.filter!==n){let l=this.groupRepository.getGroupById(e);if(l&&l.cardIds)for(let d of[...l.cardIds])this.removeCardFromGroup(d,e);let c=await this.generateCardsForGroup(e)}return await this.saveStorage(),!0}async deleteCardGroup(e,A=!1){if(!await this.groupRepository.deleteCardGroup(e,!1))return!1;try{return await this.saveStorage(),!0}catch(n){return!1}}getCardsInGroup(e){return e.cardIds&&e.cardIds.length>0?this.getCardsByGroupId(e.id):Object.values(this.storage.cards).filter(t=>{let n=e.filter.split(",").map(u=>u.trim().toLowerCase()),o=t.text.toLowerCase(),l=t.answer.toLowerCase(),c=(t.filePath||"").toLowerCase();return n.some(u=>{if(u.startsWith("#"))return o.includes(u)||l.includes(u);if(u.startsWith("path:")){let p=u.substring(5);return c.includes(p)}return o.includes(u)||l.includes(u)})})}addCardToGroup(e,A){let t=this.groupRepository.addCardToGroup(e,A);return t&&this.saveStorageDebounced(),t}removeCardFromGroup(e,A){let t=this.groupRepository.removeCardFromGroup(e,A);return t&&this.saveStorageDebounced(),t}getGroupProgress(e){return this.groupRepository.getGroupProgress(e)}getCardsByGroupId(e){return this.groupRepository.getCardsByGroupId(e)}getAllCards(){return Object.values(this.storage.cards)}getCardGroups(){return this.groupRepository.getCardGroups()}registerEventListeners(){if(!this.plugin.eventManager){console.error("\u4E8B\u4EF6\u7BA1\u7406\u5668\u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u6CE8\u518C\u4E8B\u4EF6\u76D1\u542C\u5668");return}this.plugin.eventManager.on("highlight:update",(e,A,t,n)=>{this.handleHighlightUpdate(e,A,t,n)}),this.plugin.eventManager.on("highlight:delete",(e,A,t)=>{this.handleHighlightDelete(e,A,t)}),this.plugin.eventManager.on("comment:update",(e,A,t,n)=>{this.handleCommentUpdate(e,A,t,n)}),this.plugin.eventManager.on("comment:delete",(e,A,t)=>{this.handleCommentDelete(e,A,t)})}handleHighlightUpdate(e,A,t,n){let o=this.updateCardsBySourceId(n,"highlight",t)}handleHighlightDelete(e,A,t){let n=this.deleteCardsBySourceId(t,"highlight")}handleCommentUpdate(e,A,t,n){let o=this.findCardsBySourceId(n,"highlight");if(!o||o.length===0)return;let l=0;for(let c of o){let d=c.answer||"",u=/\{\{([^{}]+)\}\}/g,p=[],B;for(;(B=u.exec(c.text))!==null;)p.push(B[1]);let Q=d.split(`
`).filter(H=>H.trim()!==""&&H.trim()!==A.trim()&&!p.includes(H.trim())),U=[];p.length>0&&U.push(p.join(`
`)),Q.length>0&&U.push(Q.join(`
`)),t&&t.trim()!==""&&U.push(t);let E=U.length>0?U.join(`

`):"";E!==d&&(c.answer=E,c.updatedAt=Date.now(),l++)}l>0&&(this.saveStorageDebounced(),this.plugin.eventManager&&this.plugin.eventManager.emitFlashcardChanged())}handleCommentDelete(e,A,t){let n=this.deleteCardsBySourceId(t,"highlight")}checkAndMaintainDailyStats(){this.storage.dailyStats||(this.storage.dailyStats=[]),this.storage.dailyStats.sort((A,t)=>t.date-A.date);let e=new Map;return this.storage.dailyStats.forEach(A=>{let t=new Date(A.date),n=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`;e.has(n)||e.set(n,A)}),this.storage.dailyStats=Array.from(e.values()),this.storage.dailyStats.sort((A,t)=>t.date-A.date),this.storage.dailyStats.length>84&&(this.storage.dailyStats=this.storage.dailyStats.slice(0,84)),this.storage.dailyStats.length}updateDailyStats(e,A){let t=new Date;t.setHours(0,0,0,0);let n=t.getTime();this.storage.globalStats.lastReviewDate?this.storage.globalStats.lastReviewDate===n||(this.storage.globalStats.lastReviewDate===n-864e5?(this.storage.globalStats.lastReviewDate=n,this.storage.globalStats.streakDays++):this.storage.globalStats.lastReviewDate<n&&(this.storage.globalStats.lastReviewDate=n,this.storage.globalStats.streakDays=1)):(this.storage.globalStats.lastReviewDate=n,this.storage.globalStats.streakDays=1);let o=t.toDateString(),l=this.storage.dailyStats.find(c=>new Date(c.date).toDateString()===o);switch(l||(l={date:n,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0},this.storage.dailyStats.push(l),this.checkAndMaintainDailyStats()),l.reviewCount++,e?(l.newCount++,l.newCardsLearned++):l.cardsReviewed++,A){case cA.AGAIN:l.againCount++;break;case cA.HARD:l.hardCount++;break;case cA.GOOD:l.goodCount++;break;case cA.EASY:l.easyCount++;break}this.saveStorageDebounced()}cleanupInvalidCardReferences(){let e=0;if(!this.storage.cardGroups)return e;for(let A of this.storage.cardGroups)if(A.cardIds&&A.cardIds.length>0){let t=A.cardIds.length;A.cardIds=A.cardIds.filter(o=>this.storage.cards&&this.storage.cards[o]);let n=t-A.cardIds.length;n>0&&(e+=n,A.lastUpdated=Date.now())}return e>0&&this.saveStorageDebounced(),e}resetGroupCompletionMessage(e){if(!e)return;let A=this.groupRepository.getGroupById(e);A&&(this.storage.uiState||(this.storage.uiState={currentGroupName:"",completionMessage:null,groupProgress:{}}),this.storage.uiState.groupProgress||(this.storage.uiState.groupProgress={}),this.storage.uiState.groupProgress[A.name]&&(this.storage.uiState.groupProgress[A.name].completionMessage=null,this.saveStorageDebounced()))}};var Zr=class{constructor(e,A){this.app=e;this.commentStore=A;this.textSimilarityService=new we(e)}findMatchingHighlight(e,A){let t=this.commentStore.getFileComments(e);if(!t||t.length===0)return null;let n=t.find(c=>c.text!==A.text?!1:typeof c.position=="number"&&typeof A.position=="number"?Math.abs(c.position-A.position)<10:c.blockId&&A.blockId?c.blockId===A.blockId:!1);if(n||A.position!==void 0&&(n=t.find(c=>typeof c.position=="number"&&Math.abs(c.position-A.position)<30),n))return n;let o=null,l=0;for(let c of t){if(!c.comments||c.comments.length===0)continue;let d=this.textSimilarityService.calculateSimilarity(c.text,A.text);d>l&&d>.6&&(l=d,o=c)}if(o)return o;if(A.blockId){let c=t.filter(d=>d.blockId===A.blockId);if(c.length>0)return c[0]}return null}async recoverHighlight(e,A,t){let n={...A,text:t,updatedAt:Date.now()};return await this.commentStore.addComment(e,n),n}};var zr=class extends Mo.Plugin{constructor(){super(...arguments);this.DEFAULT_SETTINGS={...nA,anthropic:{apiKey:"",model:"claude-2",apiAddress:"",isCustomModel:!1,lastCustomModel:""}}}async onload(){let A=await this.loadData();this.settings=Object.assign({},nA,A),window.html2canvas=Lo.default,this.commentStore=new Ur(this),await this.commentStore.loadComments(),this.eventManager=new Ze(this.app),this.fsrsManager=new qr(this),this.highlightMatchingService=new Zr(this.app,this.commentStore),this.highlightService=new oe(this.app),this.highlightDecorator=new Ir(this,this.commentStore),this.highlightDecorator.enable(),this.registerView(ie,n=>new ue(n,this.commentStore)),this.addRibbonIcon("highlighter","HiNote",async()=>{let{workspace:n}=this.app,o=n.getLeavesOfType(ie);if(o.length){n.revealLeaf(o[0]);return}let l=n.getRightLeaf(!1);l&&await l.setViewState({type:ie,active:!0})}),this.addCommand({id:"open-comment-window",name:m("Open in right sidebar"),callback:async()=>{let{workspace:n}=this.app,o=n.getLeavesOfType(ie);if(o.length){let c=o[0],d=c.view;if(d&&d instanceof ue&&d.isDraggedToMainView){n.detachLeavesOfType(ie);let u=n.getRightLeaf(!1);if(u){await u.setViewState({type:ie,active:!0});let p=u.view;p&&p instanceof ue&&(p.isDraggedToMainView=!1,p.updateViewLayout(),p.updateHighlights())}}else n.revealLeaf(c);return}let l=n.getRightLeaf(!1);if(l){await l.setViewState({type:ie,active:!0});let c=l.view;c&&c instanceof ue&&(c.isDraggedToMainView=!1,c.updateViewLayout())}}}),this.addSettingTab(new Gr(this.app,this));let t=()=>{let n=performance.now(),o=performance.now()};this.registerEvent(this.app.vault.on("rename",(n,o)=>{this.commentStore.updateFilePath(o,n.path)})),this.addCommand({id:"open-chat-window",name:m("Open AI chat window"),callback:()=>{ze.getInstance(this.app,this).show()}}),this.addCommand({id:"open-comment-main-window",name:m("Open in main window"),callback:async()=>{let{workspace:n}=this.app,o=n.getLeavesOfType(ie);if(o.length){let c=o[0];n.setActiveLeaf(c,{focus:!0}),n.detachLeavesOfType(ie);let d=n.getLeaf("tab");await d.setViewState({type:ie,active:!0});let u=d.view;u&&u instanceof ue&&(u.isDraggedToMainView=!0,u.updateViewLayout(),u.updateHighlights());return}let l=n.getLeaf("tab");l&&(await l.setViewState({type:ie,active:!0}),setTimeout(()=>{let c=l.view;c&&c instanceof ue&&(c.isDraggedToMainView=!0,c.updateViewLayout(),c.updateHighlights())},100))}})}async onunload(){try{await this.commentStore.saveComments();let A=await this.loadData()}catch(A){}this.highlightDecorator&&this.highlightDecorator.disable(),ze.instance&&ze.instance.close()}async loadSettings(){let A=await this.loadData();this.settings||(this.settings={excludePatterns:nA.excludePatterns,useCustomPattern:nA.useCustomPattern,regexRules:[...nA.regexRules],ai:{provider:nA.ai.provider,openai:nA.ai.openai?{...nA.ai.openai}:void 0,anthropic:nA.ai.anthropic?{...nA.ai.anthropic}:void 0,gemini:nA.ai.gemini?{...nA.ai.gemini}:void 0,ollama:nA.ai.ollama?{...nA.ai.ollama}:void 0,deepseek:nA.ai.deepseek?{...nA.ai.deepseek}:void 0,prompts:{...nA.ai.prompts}},export:{exportPath:nA.export.exportPath}}),(A==null?void 0:A.excludePatterns)!==void 0&&(this.settings.excludePatterns=A.excludePatterns),A!=null&&A.ai&&(A.ai.provider&&(this.settings.ai.provider=A.ai.provider),A.ai.openai&&this.settings.ai.openai&&(this.settings.ai.openai={apiKey:A.ai.openai.apiKey||this.settings.ai.openai.apiKey,model:A.ai.openai.model||this.settings.ai.openai.model,baseUrl:A.ai.openai.baseUrl}),A.ai.anthropic&&this.settings.ai.anthropic&&(this.settings.ai.anthropic={apiKey:A.ai.anthropic.apiKey||this.settings.ai.anthropic.apiKey,model:A.ai.anthropic.model||this.settings.ai.anthropic.model,availableModels:A.ai.anthropic.availableModels,apiAddress:A.ai.anthropic.apiAddress||A.ai.anthropic.baseUrl,isCustomModel:A.ai.anthropic.isCustomModel||!1,lastCustomModel:A.ai.anthropic.lastCustomModel||""}),A.ai.gemini&&this.settings.ai.gemini&&(this.settings.ai.gemini={apiKey:A.ai.gemini.apiKey||this.settings.ai.gemini.apiKey,model:A.ai.gemini.model||this.settings.ai.gemini.model,baseUrl:A.ai.gemini.baseUrl,isCustomModel:A.ai.gemini.isCustomModel||!1}),A.ai.ollama&&this.settings.ai.ollama&&(this.settings.ai.ollama={host:A.ai.ollama.host||this.settings.ai.ollama.host,model:A.ai.ollama.model||this.settings.ai.ollama.model,availableModels:A.ai.ollama.availableModels}),A.ai.deepseek&&this.settings.ai.deepseek&&(this.settings.ai.deepseek={apiKey:A.ai.deepseek.apiKey||this.settings.ai.deepseek.apiKey,model:A.ai.deepseek.model||this.settings.ai.deepseek.model,baseUrl:A.ai.deepseek.baseUrl}),A.ai.prompts&&(this.settings.ai.prompts={...this.settings.ai.prompts,...A.ai.prompts})),A!=null&&A.export&&A.export.exportPath&&(this.settings.export.exportPath=A.export.exportPath),A!=null&&A.comments&&(this.settings.comments=A.comments),A!=null&&A.comments&&(this.settings.comments=A.comments),await this.saveSettings()}async saveSettings(){var t,n,o,l,c,d,u,p,B;this.settings||(this.settings={...nA});let A=await this.loadData();A!=null&&A["flashcard-license"]&&(this.settings["flashcard-license"]=A["flashcard-license"]),this.settings.excludePatterns=(t=this.settings.excludePatterns)!=null?t:nA.excludePatterns,this.settings.useCustomPattern=(n=this.settings.useCustomPattern)!=null?n:nA.useCustomPattern,(!this.settings.regexRules||!Array.isArray(this.settings.regexRules))&&(this.settings.regexRules=[...nA.regexRules]),this.settings.ai||(this.settings.ai={...nA.ai}),this.settings.export||(this.settings.export={...nA.export}),this.settings.ai.openai||(this.settings.ai.openai={apiKey:"",model:((o=nA.ai.openai)==null?void 0:o.model)||"gpt-4o",baseUrl:(l=nA.ai.openai)==null?void 0:l.baseUrl}),this.settings.ai.anthropic||(this.settings.ai.anthropic={apiKey:"",model:"claude-2",availableModels:(c=nA.ai.anthropic)==null?void 0:c.availableModels,apiAddress:(d=nA.ai.anthropic)==null?void 0:d.apiAddress,isCustomModel:!1,lastCustomModel:""}),this.settings.ai.gemini||(this.settings.ai.gemini={apiKey:"",model:"gemini-1.5-flash",isCustomModel:!1,baseUrl:(u=nA.ai.gemini)==null?void 0:u.baseUrl}),this.settings.ai.ollama||(this.settings.ai.ollama={host:"http://localhost:11434",model:"",availableModels:(p=nA.ai.ollama)==null?void 0:p.availableModels}),this.settings.ai.deepseek||(this.settings.ai.deepseek={apiKey:"",model:"deepseek-chat",baseUrl:(B=nA.ai.deepseek)==null?void 0:B.baseUrl}),this.settings.ai.prompts||(this.settings.ai.prompts={...nA.ai.prompts}),this.settings.export||(this.settings.export={exportPath:nA.export.exportPath}),await this.saveData(this.settings)}};
/*! Bundled license information:

html2canvas/dist/html2canvas.js:
  (*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   *)
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)
*/

/* nosourcemap */